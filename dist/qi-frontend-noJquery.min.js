/* ! minified version of Javascript dependencies of https://github.com/waharnum/qi-dashboard-frontend-demo - see repository for details */!function(){function a(a){return a&&(a.ownerDocument||a.document||a).documentElement}function b(a){return a&&(a.ownerDocument&&a.ownerDocument.defaultView||a.document&&a||a.defaultView)}function c(a,b){return b>a?-1:a>b?1:a>=b?0:NaN}function d(a){return null===a?NaN:+a}function e(a){return!isNaN(a)}function f(a){return{left:function(b,c,d,e){for(arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);e>d;){var f=d+e>>>1;a(b[f],c)<0?d=f+1:e=f}return d},right:function(b,c,d,e){for(arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);e>d;){var f=d+e>>>1;a(b[f],c)>0?e=f:d=f+1}return d}}}function g(a){return a.length}function h(a){for(var b=1;a*b%1;)b*=10;return b}function i(a,b){for(var c in b)Object.defineProperty(a.prototype,c,{value:b[c],enumerable:!1})}function j(){this._=Object.create(null)}function k(a){return(a+="")===ug||a[0]===vg?vg+a:a}function l(a){return(a+="")[0]===vg?a.slice(1):a}function m(a){return k(a)in this._}function n(a){return(a=k(a))in this._&&delete this._[a]}function o(){var a=[];for(var b in this._)a.push(l(b));return a}function p(){var a=0;for(var b in this._)++a;return a}function q(){for(var a in this._)return!1;return!0}function r(){this._=Object.create(null)}function s(a){return a}function t(a,b,c){return function(){var d=c.apply(b,arguments);return d===b?a:d}}function u(a,b){if(b in a)return b;b=b.charAt(0).toUpperCase()+b.slice(1);for(var c=0,d=wg.length;d>c;++c){var e=wg[c]+b;if(e in a)return e}}function v(){}function w(){}function x(a){function b(){for(var b,d=c,e=-1,f=d.length;++e<f;)(b=d[e].on)&&b.apply(this,arguments);return a}var c=[],d=new j;return b.on=function(b,e){var f,g=d.get(b);return arguments.length<2?g&&g.on:(g&&(g.on=null,c=c.slice(0,f=c.indexOf(g)).concat(c.slice(f+1)),d.remove(b)),e&&c.push(d.set(b,{on:e})),a)},b}function y(){hg.event.preventDefault()}function z(){for(var a,b=hg.event;a=b.sourceEvent;)b=a;return b}function A(a){for(var b=new w,c=0,d=arguments.length;++c<d;)b[arguments[c]]=x(b);return b.of=function(c,d){return function(e){try{var f=e.sourceEvent=hg.event;e.target=a,hg.event=e,b[e.type].apply(c,d)}finally{hg.event=f}}},b}function B(a){return yg(a,Cg),a}function C(a){return"function"==typeof a?a:function(){return zg(a,this)}}function D(a){return"function"==typeof a?a:function(){return Ag(a,this)}}function E(a,b){function c(){this.removeAttribute(a)}function d(){this.removeAttributeNS(a.space,a.local)}function e(){this.setAttribute(a,b)}function f(){this.setAttributeNS(a.space,a.local,b)}function g(){var c=b.apply(this,arguments);null==c?this.removeAttribute(a):this.setAttribute(a,c)}function h(){var c=b.apply(this,arguments);null==c?this.removeAttributeNS(a.space,a.local):this.setAttributeNS(a.space,a.local,c)}return a=hg.ns.qualify(a),null==b?a.local?d:c:"function"==typeof b?a.local?h:g:a.local?f:e}function F(a){return a.trim().replace(/\s+/g," ")}function G(a){return new RegExp("(?:^|\\s+)"+hg.requote(a)+"(?:\\s+|$)","g")}function H(a){return(a+"").trim().split(/^|\s+/)}function I(a,b){function c(){for(var c=-1;++c<e;)a[c](this,b)}function d(){for(var c=-1,d=b.apply(this,arguments);++c<e;)a[c](this,d)}a=H(a).map(J);var e=a.length;return"function"==typeof b?d:c}function J(a){var b=G(a);return function(c,d){if(e=c.classList)return d?e.add(a):e.remove(a);var e=c.getAttribute("class")||"";d?(b.lastIndex=0,b.test(e)||c.setAttribute("class",F(e+" "+a))):c.setAttribute("class",F(e.replace(b," ")))}}function K(a,b,c){function d(){this.style.removeProperty(a)}function e(){this.style.setProperty(a,b,c)}function f(){var d=b.apply(this,arguments);null==d?this.style.removeProperty(a):this.style.setProperty(a,d,c)}return null==b?d:"function"==typeof b?f:e}function L(a,b){function c(){delete this[a]}function d(){this[a]=b}function e(){var c=b.apply(this,arguments);null==c?delete this[a]:this[a]=c}return null==b?c:"function"==typeof b?e:d}function M(a){function b(){var b=this.ownerDocument,c=this.namespaceURI;return c===Dg&&b.documentElement.namespaceURI===Dg?b.createElement(a):b.createElementNS(c,a)}function c(){return this.ownerDocument.createElementNS(a.space,a.local)}return"function"==typeof a?a:(a=hg.ns.qualify(a)).local?c:b}function N(){var a=this.parentNode;a&&a.removeChild(this)}function O(a){return{__data__:a}}function P(a){return function(){return Bg(this,a)}}function Q(a){return arguments.length||(a=c),function(b,c){return b&&c?a(b.__data__,c.__data__):!b-!c}}function R(a,b){for(var c=0,d=a.length;d>c;c++)for(var e,f=a[c],g=0,h=f.length;h>g;g++)(e=f[g])&&b(e,g,c);return a}function S(a){return yg(a,Fg),a}function T(a){var b,c;return function(d,e,f){var g,h=a[f].update,i=h.length;for(f!=c&&(c=f,b=0),e>=b&&(b=e+1);!(g=h[b])&&++b<i;);return g}}function U(a,b,c){function d(){var b=this[g];b&&(this.removeEventListener(a,b,b.$),delete this[g])}function e(){var e=i(b,jg(arguments));d.call(this),this.addEventListener(a,this[g]=e,e.$=c),e._=b}function f(){var b,c=new RegExp("^__on([^.]+)"+hg.requote(a)+"$");for(var d in this)if(b=d.match(c)){var e=this[d];this.removeEventListener(b[1],e,e.$),delete this[d]}}var g="__on"+a,h=a.indexOf("."),i=V;h>0&&(a=a.slice(0,h));var j=Gg.get(a);return j&&(a=j,i=W),h?b?e:d:b?v:f}function V(a,b){return function(c){var d=hg.event;hg.event=c,b[0]=this.__data__;try{a.apply(this,b)}finally{hg.event=d}}}function W(a,b){var c=V(a,b);return function(a){var b=this,d=a.relatedTarget;d&&(d===b||8&d.compareDocumentPosition(b))||c.call(b,a)}}function X(c){var d=".dragsuppress-"+ ++Ig,e="click"+d,f=hg.select(b(c)).on("touchmove"+d,y).on("dragstart"+d,y).on("selectstart"+d,y);if(null==Hg&&(Hg="onselectstart"in c?!1:u(c.style,"userSelect")),Hg){var g=a(c).style,h=g[Hg];g[Hg]="none"}return function(a){if(f.on(d,null),Hg&&(g[Hg]=h),a){var b=function(){f.on(e,null)};f.on(e,function(){y(),b()},!0),setTimeout(b,0)}}}function Y(a,c){c.changedTouches&&(c=c.changedTouches[0]);var d=a.ownerSVGElement||a;if(d.createSVGPoint){var e=d.createSVGPoint();if(0>Jg){var f=b(a);if(f.scrollX||f.scrollY){d=hg.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var g=d[0][0].getScreenCTM();Jg=!(g.f||g.e),d.remove()}}return Jg?(e.x=c.pageX,e.y=c.pageY):(e.x=c.clientX,e.y=c.clientY),e=e.matrixTransform(a.getScreenCTM().inverse()),[e.x,e.y]}var h=a.getBoundingClientRect();return[c.clientX-h.left-a.clientLeft,c.clientY-h.top-a.clientTop]}function Z(){return hg.event.changedTouches[0].identifier}function $(a){return a>0?1:0>a?-1:0}function _(a,b,c){return(b[0]-a[0])*(c[1]-a[1])-(b[1]-a[1])*(c[0]-a[0])}function aa(a){return a>1?0:-1>a?Mg:Math.acos(a)}function ba(a){return a>1?Pg:-1>a?-Pg:Math.asin(a)}function ca(a){return((a=Math.exp(a))-1/a)/2}function da(a){return((a=Math.exp(a))+1/a)/2}function ea(a){return((a=Math.exp(2*a))-1)/(a+1)}function fa(a){return(a=Math.sin(a/2))*a}function ga(){}function ha(a,b,c){return this instanceof ha?(this.h=+a,this.s=+b,void(this.l=+c)):arguments.length<2?a instanceof ha?new ha(a.h,a.s,a.l):va(""+a,wa,ha):new ha(a,b,c)}function ia(a,b,c){function d(a){return a>360?a-=360:0>a&&(a+=360),60>a?f+(g-f)*a/60:180>a?g:240>a?f+(g-f)*(240-a)/60:f}function e(a){return Math.round(255*d(a))}var f,g;return a=isNaN(a)?0:(a%=360)<0?a+360:a,b=isNaN(b)?0:0>b?0:b>1?1:b,c=0>c?0:c>1?1:c,g=.5>=c?c*(1+b):c+b-c*b,f=2*c-g,new ra(e(a+120),e(a),e(a-120))}function ja(a,b,c){return this instanceof ja?(this.h=+a,this.c=+b,void(this.l=+c)):arguments.length<2?a instanceof ja?new ja(a.h,a.c,a.l):a instanceof la?na(a.l,a.a,a.b):na((a=xa((a=hg.rgb(a)).r,a.g,a.b)).l,a.a,a.b):new ja(a,b,c)}function ka(a,b,c){return isNaN(a)&&(a=0),isNaN(b)&&(b=0),new la(c,Math.cos(a*=Qg)*b,Math.sin(a)*b)}function la(a,b,c){return this instanceof la?(this.l=+a,this.a=+b,void(this.b=+c)):arguments.length<2?a instanceof la?new la(a.l,a.a,a.b):a instanceof ja?ka(a.h,a.c,a.l):xa((a=ra(a)).r,a.g,a.b):new la(a,b,c)}function ma(a,b,c){var d=(a+16)/116,e=d+b/500,f=d-c/200;return e=oa(e)*_g,d=oa(d)*ah,f=oa(f)*bh,new ra(qa(3.2404542*e-1.5371385*d-.4985314*f),qa(-.969266*e+1.8760108*d+.041556*f),qa(.0556434*e-.2040259*d+1.0572252*f))}function na(a,b,c){return a>0?new ja(Math.atan2(c,b)*Rg,Math.sqrt(b*b+c*c),a):new ja(NaN,NaN,a)}function oa(a){return a>.206893034?a*a*a:(a-4/29)/7.787037}function pa(a){return a>.008856?Math.pow(a,1/3):7.787037*a+4/29}function qa(a){return Math.round(255*(.00304>=a?12.92*a:1.055*Math.pow(a,1/2.4)-.055))}function ra(a,b,c){return this instanceof ra?(this.r=~~a,this.g=~~b,void(this.b=~~c)):arguments.length<2?a instanceof ra?new ra(a.r,a.g,a.b):va(""+a,ra,ia):new ra(a,b,c)}function sa(a){return new ra(a>>16,a>>8&255,255&a)}function ta(a){return sa(a)+""}function ua(a){return 16>a?"0"+Math.max(0,a).toString(16):Math.min(255,a).toString(16)}function va(a,b,c){var d,e,f,g=0,h=0,i=0;if(d=/([a-z]+)\((.*)\)/.exec(a=a.toLowerCase()))switch(e=d[2].split(","),d[1]){case"hsl":return c(parseFloat(e[0]),parseFloat(e[1])/100,parseFloat(e[2])/100);case"rgb":return b(za(e[0]),za(e[1]),za(e[2]))}return(f=eh.get(a))?b(f.r,f.g,f.b):(null==a||"#"!==a.charAt(0)||isNaN(f=parseInt(a.slice(1),16))||(4===a.length?(g=(3840&f)>>4,g=g>>4|g,h=240&f,h=h>>4|h,i=15&f,i=i<<4|i):7===a.length&&(g=(16711680&f)>>16,h=(65280&f)>>8,i=255&f)),b(g,h,i))}function wa(a,b,c){var d,e,f=Math.min(a/=255,b/=255,c/=255),g=Math.max(a,b,c),h=g-f,i=(g+f)/2;return h?(e=.5>i?h/(g+f):h/(2-g-f),d=a==g?(b-c)/h+(c>b?6:0):b==g?(c-a)/h+2:(a-b)/h+4,d*=60):(d=NaN,e=i>0&&1>i?0:d),new ha(d,e,i)}function xa(a,b,c){a=ya(a),b=ya(b),c=ya(c);var d=pa((.4124564*a+.3575761*b+.1804375*c)/_g),e=pa((.2126729*a+.7151522*b+.072175*c)/ah),f=pa((.0193339*a+.119192*b+.9503041*c)/bh);return la(116*e-16,500*(d-e),200*(e-f))}function ya(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function za(a){var b=parseFloat(a);return"%"===a.charAt(a.length-1)?Math.round(2.55*b):b}function Aa(a){return"function"==typeof a?a:function(){return a}}function Ba(a){return function(b,c,d){return 2===arguments.length&&"function"==typeof c&&(d=c,c=null),Ca(b,c,a,d)}}function Ca(a,b,c,d){function e(){var a,b=i.status;if(!b&&Ea(i)||b>=200&&300>b||304===b){try{a=c.call(f,i)}catch(d){return void g.error.call(f,d)}g.load.call(f,a)}else g.error.call(f,i)}var f={},g=hg.dispatch("beforesend","progress","load","error"),h={},i=new XMLHttpRequest,j=null;return!this.XDomainRequest||"withCredentials"in i||!/^(http(s)?:)?\/\//.test(a)||(i=new XDomainRequest),"onload"in i?i.onload=i.onerror=e:i.onreadystatechange=function(){i.readyState>3&&e()},i.onprogress=function(a){var b=hg.event;hg.event=a;try{g.progress.call(f,i)}finally{hg.event=b}},f.header=function(a,b){return a=(a+"").toLowerCase(),arguments.length<2?h[a]:(null==b?delete h[a]:h[a]=b+"",f)},f.mimeType=function(a){return arguments.length?(b=null==a?null:a+"",f):b},f.responseType=function(a){return arguments.length?(j=a,f):j},f.response=function(a){return c=a,f},["get","post"].forEach(function(a){f[a]=function(){return f.send.apply(f,[a].concat(jg(arguments)))}}),f.send=function(c,d,e){if(2===arguments.length&&"function"==typeof d&&(e=d,d=null),i.open(c,a,!0),null==b||"accept"in h||(h.accept=b+",*/*"),i.setRequestHeader)for(var k in h)i.setRequestHeader(k,h[k]);return null!=b&&i.overrideMimeType&&i.overrideMimeType(b),null!=j&&(i.responseType=j),null!=e&&f.on("error",e).on("load",function(a){e(null,a)}),g.beforesend.call(f,i),i.send(null==d?null:d),f},f.abort=function(){return i.abort(),f},hg.rebind(f,g,"on"),null==d?f:f.get(Da(d))}function Da(a){return 1===a.length?function(b,c){a(null==b?c:null)}:a}function Ea(a){var b=a.responseType;return b&&"text"!==b?a.response:a.responseText}function Fa(a,b,c){var d=arguments.length;2>d&&(b=0),3>d&&(c=Date.now());var e=c+b,f={c:a,t:e,n:null};return gh?gh.n=f:fh=f,gh=f,hh||(ih=clearTimeout(ih),hh=1,jh(Ga)),f}function Ga(){var a=Ha(),b=Ia()-a;b>24?(isFinite(b)&&(clearTimeout(ih),ih=setTimeout(Ga,b)),hh=0):(hh=1,jh(Ga))}function Ha(){for(var a=Date.now(),b=fh;b;)a>=b.t&&b.c(a-b.t)&&(b.c=null),b=b.n;return a}function Ia(){for(var a,b=fh,c=1/0;b;)b.c?(b.t<c&&(c=b.t),b=(a=b).n):b=a?a.n=b.n:fh=b.n;return gh=a,c}function Ja(a,b){return b-(a?Math.ceil(Math.log(a)/Math.LN10):1)}function Ka(a,b){var c=Math.pow(10,3*tg(8-b));return{scale:b>8?function(a){return a/c}:function(a){return a*c},symbol:a}}function La(a){var b=a.decimal,c=a.thousands,d=a.grouping,e=a.currency,f=d&&c?function(a,b){for(var e=a.length,f=[],g=0,h=d[0],i=0;e>0&&h>0&&(i+h+1>b&&(h=Math.max(1,b-i)),f.push(a.substring(e-=h,e+h)),!((i+=h+1)>b));)h=d[g=(g+1)%d.length];return f.reverse().join(c)}:s;return function(a){var c=lh.exec(a),d=c[1]||" ",g=c[2]||">",h=c[3]||"-",i=c[4]||"",j=c[5],k=+c[6],l=c[7],m=c[8],n=c[9],o=1,p="",q="",r=!1,s=!0;switch(m&&(m=+m.substring(1)),(j||"0"===d&&"="===g)&&(j=d="0",g="="),n){case"n":l=!0,n="g";break;case"%":o=100,q="%",n="f";break;case"p":o=100,q="%",n="r";break;case"b":case"o":case"x":case"X":"#"===i&&(p="0"+n.toLowerCase());case"c":s=!1;case"d":r=!0,m=0;break;case"s":o=-1,n="r"}"$"===i&&(p=e[0],q=e[1]),"r"!=n||m||(n="g"),null!=m&&("g"==n?m=Math.max(1,Math.min(21,m)):("e"==n||"f"==n)&&(m=Math.max(0,Math.min(20,m)))),n=mh.get(n)||Ma;var t=j&&l;return function(a){var c=q;if(r&&a%1)return"";var e=0>a||0===a&&0>1/a?(a=-a,"-"):"-"===h?"":h;if(0>o){var i=hg.formatPrefix(a,m);a=i.scale(a),c=i.symbol+q}else a*=o;a=n(a,m);var u,v,w=a.lastIndexOf(".");if(0>w){var x=s?a.lastIndexOf("e"):-1;0>x?(u=a,v=""):(u=a.substring(0,x),v=a.substring(x))}else u=a.substring(0,w),v=b+a.substring(w+1);!j&&l&&(u=f(u,1/0));var y=p.length+u.length+v.length+(t?0:e.length),z=k>y?new Array(y=k-y+1).join(d):"";return t&&(u=f(z+u,z.length?k-v.length:1/0)),e+=p,a=u+v,("<"===g?e+a+z:">"===g?z+e+a:"^"===g?z.substring(0,y>>=1)+e+a+z.substring(y):e+(t?a:z+a))+c}}}function Ma(a){return a+""}function Na(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Oa(a,b,c){function d(b){var c=a(b),d=f(c,1);return d-b>b-c?c:d}function e(c){return b(c=a(new oh(c-1)),1),c}function f(a,c){return b(a=new oh(+a),c),a}function g(a,d,f){var g=e(a),h=[];if(f>1)for(;d>g;)c(g)%f||h.push(new Date(+g)),b(g,1);else for(;d>g;)h.push(new Date(+g)),b(g,1);return h}function h(a,b,c){try{oh=Na;var d=new Na;return d._=a,g(d,b,c)}finally{oh=Date}}a.floor=a,a.round=d,a.ceil=e,a.offset=f,a.range=g;var i=a.utc=Pa(a);return i.floor=i,i.round=Pa(d),i.ceil=Pa(e),i.offset=Pa(f),i.range=h,a}function Pa(a){return function(b,c){try{oh=Na;var d=new Na;return d._=b,a(d,c)._}finally{oh=Date}}}function Qa(a){function b(a){function b(b){for(var c,e,f,g=[],h=-1,i=0;++h<d;)37===a.charCodeAt(h)&&(g.push(a.slice(i,h)),null!=(e=qh[c=a.charAt(++h)])&&(c=a.charAt(++h)),(f=C[c])&&(c=f(b,null==e?"e"===c?" ":"0":e)),g.push(c),i=h+1);return g.push(a.slice(i,h)),g.join("")}var d=a.length;return b.parse=function(b){var d={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},e=c(d,a,b,0);if(e!=b.length)return null;"p"in d&&(d.H=d.H%12+12*d.p);var f=null!=d.Z&&oh!==Na,g=new(f?Na:oh);return"j"in d?g.setFullYear(d.y,0,d.j):"W"in d||"U"in d?("w"in d||(d.w="W"in d?1:0),g.setFullYear(d.y,0,1),g.setFullYear(d.y,0,"W"in d?(d.w+6)%7+7*d.W-(g.getDay()+5)%7:d.w+7*d.U-(g.getDay()+6)%7)):g.setFullYear(d.y,d.m,d.d),g.setHours(d.H+(d.Z/100|0),d.M+d.Z%100,d.S,d.L),f?g._:g},b.toString=function(){return a},b}function c(a,b,c,d){for(var e,f,g,h=0,i=b.length,j=c.length;i>h;){if(d>=j)return-1;if(e=b.charCodeAt(h++),37===e){if(g=b.charAt(h++),f=D[g in qh?b.charAt(h++):g],!f||(d=f(a,c,d))<0)return-1}else if(e!=c.charCodeAt(d++))return-1}return d}function d(a,b,c){w.lastIndex=0;var d=w.exec(b.slice(c));return d?(a.w=x.get(d[0].toLowerCase()),c+d[0].length):-1}function e(a,b,c){u.lastIndex=0;var d=u.exec(b.slice(c));return d?(a.w=v.get(d[0].toLowerCase()),c+d[0].length):-1}function f(a,b,c){A.lastIndex=0;var d=A.exec(b.slice(c));return d?(a.m=B.get(d[0].toLowerCase()),c+d[0].length):-1}function g(a,b,c){y.lastIndex=0;var d=y.exec(b.slice(c));return d?(a.m=z.get(d[0].toLowerCase()),c+d[0].length):-1}function h(a,b,d){return c(a,C.c.toString(),b,d)}function i(a,b,d){return c(a,C.x.toString(),b,d)}function j(a,b,d){return c(a,C.X.toString(),b,d)}function k(a,b,c){var d=t.get(b.slice(c,c+=2).toLowerCase());return null==d?-1:(a.p=d,c)}var l=a.dateTime,m=a.date,n=a.time,o=a.periods,p=a.days,q=a.shortDays,r=a.months,s=a.shortMonths;b.utc=function(a){function c(a){try{oh=Na;var b=new oh;return b._=a,d(b)}finally{oh=Date}}var d=b(a);return c.parse=function(a){try{oh=Na;var b=d.parse(a);return b&&b._}finally{oh=Date}},c.toString=d.toString,c},b.multi=b.utc.multi=ib;var t=hg.map(),u=Sa(p),v=Ta(p),w=Sa(q),x=Ta(q),y=Sa(r),z=Ta(r),A=Sa(s),B=Ta(s);o.forEach(function(a,b){t.set(a.toLowerCase(),b)});var C={a:function(a){return q[a.getDay()]},A:function(a){return p[a.getDay()]},b:function(a){return s[a.getMonth()]},B:function(a){return r[a.getMonth()]},c:b(l),d:function(a,b){return Ra(a.getDate(),b,2)},e:function(a,b){return Ra(a.getDate(),b,2)},H:function(a,b){return Ra(a.getHours(),b,2)},I:function(a,b){return Ra(a.getHours()%12||12,b,2)},j:function(a,b){return Ra(1+nh.dayOfYear(a),b,3)},L:function(a,b){return Ra(a.getMilliseconds(),b,3)},m:function(a,b){return Ra(a.getMonth()+1,b,2)},M:function(a,b){return Ra(a.getMinutes(),b,2)},p:function(a){return o[+(a.getHours()>=12)]},S:function(a,b){return Ra(a.getSeconds(),b,2)},U:function(a,b){return Ra(nh.sundayOfYear(a),b,2)},w:function(a){return a.getDay()},W:function(a,b){return Ra(nh.mondayOfYear(a),b,2)},x:b(m),X:b(n),y:function(a,b){return Ra(a.getFullYear()%100,b,2)},Y:function(a,b){return Ra(a.getFullYear()%1e4,b,4)},Z:gb,"%":function(){return"%"}},D={a:d,A:e,b:f,B:g,c:h,d:ab,e:ab,H:cb,I:cb,j:bb,L:fb,m:_a,M:db,p:k,S:eb,U:Va,w:Ua,W:Wa,x:i,X:j,y:Ya,Y:Xa,Z:Za,"%":hb};return b}function Ra(a,b,c){var d=0>a?"-":"",e=(d?-a:a)+"",f=e.length;return d+(c>f?new Array(c-f+1).join(b)+e:e)}function Sa(a){return new RegExp("^(?:"+a.map(hg.requote).join("|")+")","i")}function Ta(a){for(var b=new j,c=-1,d=a.length;++c<d;)b.set(a[c].toLowerCase(),c);return b}function Ua(a,b,c){rh.lastIndex=0;var d=rh.exec(b.slice(c,c+1));return d?(a.w=+d[0],c+d[0].length):-1}function Va(a,b,c){rh.lastIndex=0;var d=rh.exec(b.slice(c));return d?(a.U=+d[0],c+d[0].length):-1}function Wa(a,b,c){rh.lastIndex=0;var d=rh.exec(b.slice(c));return d?(a.W=+d[0],c+d[0].length):-1}function Xa(a,b,c){rh.lastIndex=0;var d=rh.exec(b.slice(c,c+4));return d?(a.y=+d[0],c+d[0].length):-1}function Ya(a,b,c){rh.lastIndex=0;var d=rh.exec(b.slice(c,c+2));return d?(a.y=$a(+d[0]),c+d[0].length):-1}function Za(a,b,c){return/^[+-]\d{4}$/.test(b=b.slice(c,c+5))?(a.Z=-b,c+5):-1}function $a(a){return a+(a>68?1900:2e3)}function _a(a,b,c){rh.lastIndex=0;var d=rh.exec(b.slice(c,c+2));return d?(a.m=d[0]-1,c+d[0].length):-1}function ab(a,b,c){rh.lastIndex=0;var d=rh.exec(b.slice(c,c+2));return d?(a.d=+d[0],c+d[0].length):-1}function bb(a,b,c){rh.lastIndex=0;var d=rh.exec(b.slice(c,c+3));return d?(a.j=+d[0],c+d[0].length):-1}function cb(a,b,c){rh.lastIndex=0;var d=rh.exec(b.slice(c,c+2));return d?(a.H=+d[0],c+d[0].length):-1}function db(a,b,c){rh.lastIndex=0;var d=rh.exec(b.slice(c,c+2));return d?(a.M=+d[0],c+d[0].length):-1}function eb(a,b,c){rh.lastIndex=0;var d=rh.exec(b.slice(c,c+2));return d?(a.S=+d[0],c+d[0].length):-1}function fb(a,b,c){rh.lastIndex=0;var d=rh.exec(b.slice(c,c+3));return d?(a.L=+d[0],c+d[0].length):-1}function gb(a){var b=a.getTimezoneOffset(),c=b>0?"-":"+",d=tg(b)/60|0,e=tg(b)%60;return c+Ra(d,"0",2)+Ra(e,"0",2)}function hb(a,b,c){sh.lastIndex=0;var d=sh.exec(b.slice(c,c+1));return d?c+d[0].length:-1}function ib(a){for(var b=a.length,c=-1;++c<b;)a[c][0]=this(a[c][0]);return function(b){for(var c=0,d=a[c];!d[1](b);)d=a[++c];return d[0](b)}}function jb(){}function kb(a,b,c){var d=c.s=a+b,e=d-a,f=d-e;c.t=a-f+(b-e)}function lb(a,b){a&&wh.hasOwnProperty(a.type)&&wh[a.type](a,b)}function mb(a,b,c){var d,e=-1,f=a.length-c;for(b.lineStart();++e<f;)d=a[e],b.point(d[0],d[1],d[2]);b.lineEnd()}function nb(a,b){var c=-1,d=a.length;for(b.polygonStart();++c<d;)mb(a[c],b,1);b.polygonEnd()}function ob(){function a(a,b){a*=Qg,b=b*Qg/2+Mg/4;var c=a-d,g=c>=0?1:-1,h=g*c,i=Math.cos(b),j=Math.sin(b),k=f*j,l=e*i+k*Math.cos(h),m=k*g*Math.sin(h);yh.add(Math.atan2(m,l)),d=a,e=i,f=j}var b,c,d,e,f;zh.point=function(g,h){zh.point=a,d=(b=g)*Qg,e=Math.cos(h=(c=h)*Qg/2+Mg/4),f=Math.sin(h)},zh.lineEnd=function(){a(b,c)}}function pb(a){var b=a[0],c=a[1],d=Math.cos(c);return[d*Math.cos(b),d*Math.sin(b),Math.sin(c)]}function qb(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function rb(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function sb(a,b){a[0]+=b[0],a[1]+=b[1],a[2]+=b[2]}function tb(a,b){return[a[0]*b,a[1]*b,a[2]*b]}function ub(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);a[0]/=b,a[1]/=b,a[2]/=b}function vb(a){return[Math.atan2(a[1],a[0]),ba(a[2])]}function wb(a,b){return tg(a[0]-b[0])<Kg&&tg(a[1]-b[1])<Kg}function xb(a,b){a*=Qg;var c=Math.cos(b*=Qg);yb(c*Math.cos(a),c*Math.sin(a),Math.sin(b))}function yb(a,b,c){++Ah,Ch+=(a-Ch)/Ah,Dh+=(b-Dh)/Ah,Eh+=(c-Eh)/Ah}function zb(){function a(a,e){a*=Qg;var f=Math.cos(e*=Qg),g=f*Math.cos(a),h=f*Math.sin(a),i=Math.sin(e),j=Math.atan2(Math.sqrt((j=c*i-d*h)*j+(j=d*g-b*i)*j+(j=b*h-c*g)*j),b*g+c*h+d*i);Bh+=j,Fh+=j*(b+(b=g)),Gh+=j*(c+(c=h)),Hh+=j*(d+(d=i)),yb(b,c,d)}var b,c,d;Lh.point=function(e,f){e*=Qg;var g=Math.cos(f*=Qg);b=g*Math.cos(e),c=g*Math.sin(e),d=Math.sin(f),Lh.point=a,yb(b,c,d)}}function Ab(){Lh.point=xb}function Bb(){function a(a,b){a*=Qg;var c=Math.cos(b*=Qg),g=c*Math.cos(a),h=c*Math.sin(a),i=Math.sin(b),j=e*i-f*h,k=f*g-d*i,l=d*h-e*g,m=Math.sqrt(j*j+k*k+l*l),n=d*g+e*h+f*i,o=m&&-aa(n)/m,p=Math.atan2(m,n);Ih+=o*j,Jh+=o*k,Kh+=o*l,Bh+=p,Fh+=p*(d+(d=g)),Gh+=p*(e+(e=h)),Hh+=p*(f+(f=i)),yb(d,e,f)}var b,c,d,e,f;Lh.point=function(g,h){b=g,c=h,Lh.point=a,g*=Qg;var i=Math.cos(h*=Qg);d=i*Math.cos(g),e=i*Math.sin(g),f=Math.sin(h),yb(d,e,f)},Lh.lineEnd=function(){a(b,c),Lh.lineEnd=Ab,Lh.point=xb}}function Cb(a,b){function c(c,d){return c=a(c,d),b(c[0],c[1])}return a.invert&&b.invert&&(c.invert=function(c,d){return c=b.invert(c,d),c&&a.invert(c[0],c[1])}),c}function Db(){return!0}function Eb(a,b,c,d,e){var f=[],g=[];if(a.forEach(function(a){if(!((b=a.length-1)<=0)){var b,c=a[0],d=a[b];if(wb(c,d)){e.lineStart();for(var h=0;b>h;++h)e.point((c=a[h])[0],c[1]);return void e.lineEnd()}var i=new Gb(c,a,null,!0),j=new Gb(c,null,i,!1);i.o=j,f.push(i),g.push(j),i=new Gb(d,a,null,!1),j=new Gb(d,null,i,!0),i.o=j,f.push(i),g.push(j)}}),g.sort(b),Fb(f),Fb(g),f.length){for(var h=0,i=c,j=g.length;j>h;++h)g[h].e=i=!i;for(var k,l,m=f[0];;){for(var n=m,o=!0;n.v;)if((n=n.n)===m)return;k=n.z,e.lineStart();do{if(n.v=n.o.v=!0,n.e){if(o)for(var h=0,j=k.length;j>h;++h)e.point((l=k[h])[0],l[1]);else d(n.x,n.n.x,1,e);n=n.n}else{if(o){k=n.p.z;for(var h=k.length-1;h>=0;--h)e.point((l=k[h])[0],l[1])}else d(n.x,n.p.x,-1,e);n=n.p}n=n.o,k=n.z,o=!o}while(!n.v);e.lineEnd()}}}function Fb(a){if(b=a.length){for(var b,c,d=0,e=a[0];++d<b;)e.n=c=a[d],c.p=e,e=c;e.n=c=a[0],c.p=e}}function Gb(a,b,c,d){this.x=a,this.z=b,this.o=c,this.e=d,this.v=!1,this.n=this.p=null}function Hb(a,b,c,d){return function(e,f){function g(b,c){var d=e(b,c);a(b=d[0],c=d[1])&&f.point(b,c)}function h(a,b){var c=e(a,b);q.point(c[0],c[1])}function i(){s.point=h,q.lineStart()}function j(){s.point=g,q.lineEnd()}function k(a,b){p.push([a,b]);var c=e(a,b);u.point(c[0],c[1])}function l(){u.lineStart(),p=[]}function m(){k(p[0][0],p[0][1]),u.lineEnd();var a,b=u.clean(),c=t.buffer(),d=c.length;if(p.pop(),o.push(p),p=null,d)if(1&b){a=c[0];var e,d=a.length-1,g=-1;if(d>0){for(v||(f.polygonStart(),v=!0),f.lineStart();++g<d;)f.point((e=a[g])[0],e[1]);f.lineEnd()}}else d>1&&2&b&&c.push(c.pop().concat(c.shift())),n.push(c.filter(Ib))}var n,o,p,q=b(f),r=e.invert(d[0],d[1]),s={point:g,lineStart:i,lineEnd:j,polygonStart:function(){s.point=k,s.lineStart=l,s.lineEnd=m,n=[],o=[]},polygonEnd:function(){s.point=g,s.lineStart=i,s.lineEnd=j,n=hg.merge(n);var a=Ob(r,o);n.length?(v||(f.polygonStart(),v=!0),Eb(n,Kb,a,c,f)):a&&(v||(f.polygonStart(),v=!0),f.lineStart(),c(null,null,1,f),f.lineEnd()),v&&(f.polygonEnd(),v=!1),n=o=null},sphere:function(){f.polygonStart(),f.lineStart(),c(null,null,1,f),f.lineEnd(),f.polygonEnd()}},t=Jb(),u=b(t),v=!1;return s}}function Ib(a){return a.length>1}function Jb(){var a,b=[];return{lineStart:function(){b.push(a=[])},point:function(b,c){a.push([b,c])},lineEnd:v,buffer:function(){var c=b;return b=[],a=null,c},rejoin:function(){b.length>1&&b.push(b.pop().concat(b.shift()))}}}function Kb(a,b){return((a=a.x)[0]<0?a[1]-Pg-Kg:Pg-a[1])-((b=b.x)[0]<0?b[1]-Pg-Kg:Pg-b[1])}function Lb(a){var b,c=NaN,d=NaN,e=NaN;return{lineStart:function(){a.lineStart(),b=1},point:function(f,g){var h=f>0?Mg:-Mg,i=tg(f-c);tg(i-Mg)<Kg?(a.point(c,d=(d+g)/2>0?Pg:-Pg),a.point(e,d),a.lineEnd(),a.lineStart(),a.point(h,d),a.point(f,d),b=0):e!==h&&i>=Mg&&(tg(c-e)<Kg&&(c-=e*Kg),tg(f-h)<Kg&&(f-=h*Kg),d=Mb(c,d,f,g),a.point(e,d),a.lineEnd(),a.lineStart(),a.point(h,d),b=0),a.point(c=f,d=g),e=h},lineEnd:function(){a.lineEnd(),c=d=NaN},clean:function(){return 2-b}}}function Mb(a,b,c,d){var e,f,g=Math.sin(a-c);return tg(g)>Kg?Math.atan((Math.sin(b)*(f=Math.cos(d))*Math.sin(c)-Math.sin(d)*(e=Math.cos(b))*Math.sin(a))/(e*f*g)):(b+d)/2}function Nb(a,b,c,d){var e;if(null==a)e=c*Pg,d.point(-Mg,e),d.point(0,e),d.point(Mg,e),d.point(Mg,0),d.point(Mg,-e),d.point(0,-e),d.point(-Mg,-e),d.point(-Mg,0),d.point(-Mg,e);else if(tg(a[0]-b[0])>Kg){var f=a[0]<b[0]?Mg:-Mg;e=c*f/2,d.point(-f,e),d.point(0,e),d.point(f,e)}else d.point(b[0],b[1])}function Ob(a,b){var c=a[0],d=a[1],e=[Math.sin(c),-Math.cos(c),0],f=0,g=0;yh.reset();for(var h=0,i=b.length;i>h;++h){var j=b[h],k=j.length;if(k)for(var l=j[0],m=l[0],n=l[1]/2+Mg/4,o=Math.sin(n),p=Math.cos(n),q=1;;){q===k&&(q=0),a=j[q];var r=a[0],s=a[1]/2+Mg/4,t=Math.sin(s),u=Math.cos(s),v=r-m,w=v>=0?1:-1,x=w*v,y=x>Mg,z=o*t;if(yh.add(Math.atan2(z*w*Math.sin(x),p*u+z*Math.cos(x))),f+=y?v+w*Ng:v,y^m>=c^r>=c){var A=rb(pb(l),pb(a));ub(A);var B=rb(e,A);ub(B);var C=(y^v>=0?-1:1)*ba(B[2]);(d>C||d===C&&(A[0]||A[1]))&&(g+=y^v>=0?1:-1)}if(!q++)break;m=r,o=t,p=u,l=a}}return(-Kg>f||Kg>f&&0>yh)^1&g}function Pb(a){function b(a,b){return Math.cos(a)*Math.cos(b)>f}function c(a){var c,f,i,j,k;return{lineStart:function(){j=i=!1,k=1},point:function(l,m){var n,o=[l,m],p=b(l,m),q=g?p?0:e(l,m):p?e(l+(0>l?Mg:-Mg),m):0;if(!c&&(j=i=p)&&a.lineStart(),p!==i&&(n=d(c,o),(wb(c,n)||wb(o,n))&&(o[0]+=Kg,o[1]+=Kg,p=b(o[0],o[1]))),p!==i)k=0,p?(a.lineStart(),n=d(o,c),a.point(n[0],n[1])):(n=d(c,o),a.point(n[0],n[1]),a.lineEnd()),c=n;else if(h&&c&&g^p){var r;q&f||!(r=d(o,c,!0))||(k=0,g?(a.lineStart(),a.point(r[0][0],r[0][1]),a.point(r[1][0],r[1][1]),a.lineEnd()):(a.point(r[1][0],r[1][1]),a.lineEnd(),a.lineStart(),a.point(r[0][0],r[0][1])))}!p||c&&wb(c,o)||a.point(o[0],o[1]),c=o,i=p,f=q},lineEnd:function(){i&&a.lineEnd(),c=null},clean:function(){return k|(j&&i)<<1}}}function d(a,b,c){var d=pb(a),e=pb(b),g=[1,0,0],h=rb(d,e),i=qb(h,h),j=h[0],k=i-j*j;if(!k)return!c&&a;var l=f*i/k,m=-f*j/k,n=rb(g,h),o=tb(g,l),p=tb(h,m);sb(o,p);var q=n,r=qb(o,q),s=qb(q,q),t=r*r-s*(qb(o,o)-1);if(!(0>t)){var u=Math.sqrt(t),v=tb(q,(-r-u)/s);if(sb(v,o),v=vb(v),!c)return v;var w,x=a[0],y=b[0],z=a[1],A=b[1];x>y&&(w=x,x=y,y=w);var B=y-x,C=tg(B-Mg)<Kg,D=C||Kg>B;if(!C&&z>A&&(w=z,z=A,A=w),D?C?z+A>0^v[1]<(tg(v[0]-x)<Kg?z:A):z<=v[1]&&v[1]<=A:B>Mg^(x<=v[0]&&v[0]<=y)){var E=tb(q,(-r+u)/s);return sb(E,o),[v,vb(E)]}}}function e(b,c){var d=g?a:Mg-a,e=0;return-d>b?e|=1:b>d&&(e|=2),-d>c?e|=4:c>d&&(e|=8),e}var f=Math.cos(a),g=f>0,h=tg(f)>Kg,i=oc(a,6*Qg);return Hb(b,c,i,g?[0,-a]:[-Mg,a-Mg])}function Qb(a,b,c,d){return function(e){var f,g=e.a,h=e.b,i=g.x,j=g.y,k=h.x,l=h.y,m=0,n=1,o=k-i,p=l-j;if(f=a-i,o||!(f>0)){if(f/=o,0>o){if(m>f)return;n>f&&(n=f)}else if(o>0){if(f>n)return;f>m&&(m=f)}if(f=c-i,o||!(0>f)){if(f/=o,0>o){if(f>n)return;f>m&&(m=f)}else if(o>0){if(m>f)return;n>f&&(n=f)}if(f=b-j,p||!(f>0)){if(f/=p,0>p){if(m>f)return;n>f&&(n=f)}else if(p>0){if(f>n)return;f>m&&(m=f)}if(f=d-j,p||!(0>f)){if(f/=p,0>p){if(f>n)return;f>m&&(m=f)}else if(p>0){if(m>f)return;n>f&&(n=f)}return m>0&&(e.a={x:i+m*o,y:j+m*p}),1>n&&(e.b={x:i+n*o,y:j+n*p}),e}}}}}}function Rb(a,b,c,d){function e(d,e){return tg(d[0]-a)<Kg?e>0?0:3:tg(d[0]-c)<Kg?e>0?2:1:tg(d[1]-b)<Kg?e>0?1:0:e>0?3:2}function f(a,b){return g(a.x,b.x)}function g(a,b){var c=e(a,1),d=e(b,1);return c!==d?c-d:0===c?b[1]-a[1]:1===c?a[0]-b[0]:2===c?a[1]-b[1]:b[0]-a[0]}return function(h){function i(a){for(var b=0,c=q.length,d=a[1],e=0;c>e;++e)for(var f,g=1,h=q[e],i=h.length,j=h[0];i>g;++g)f=h[g],j[1]<=d?f[1]>d&&_(j,f,a)>0&&++b:f[1]<=d&&_(j,f,a)<0&&--b,j=f;return 0!==b}function j(f,h,i,j){var k=0,l=0;if(null==f||(k=e(f,i))!==(l=e(h,i))||g(f,h)<0^i>0){do j.point(0===k||3===k?a:c,k>1?d:b);while((k=(k+i+4)%4)!==l)}else j.point(h[0],h[1])}function k(e,f){return e>=a&&c>=e&&f>=b&&d>=f}function l(a,b){k(a,b)&&h.point(a,b)}function m(){D.point=o,q&&q.push(r=[]),y=!0,x=!1,v=w=NaN}function n(){p&&(o(s,t),u&&x&&B.rejoin(),p.push(B.buffer())),D.point=l,x&&h.lineEnd()}function o(a,b){a=Math.max(-Nh,Math.min(Nh,a)),b=Math.max(-Nh,Math.min(Nh,b));var c=k(a,b);if(q&&r.push([a,b]),y)s=a,t=b,u=c,y=!1,c&&(h.lineStart(),h.point(a,b));else if(c&&x)h.point(a,b);else{var d={a:{x:v,y:w},b:{x:a,y:b}};C(d)?(x||(h.lineStart(),h.point(d.a.x,d.a.y)),h.point(d.b.x,d.b.y),c||h.lineEnd(),z=!1):c&&(h.lineStart(),h.point(a,b),z=!1)}v=a,w=b,x=c}var p,q,r,s,t,u,v,w,x,y,z,A=h,B=Jb(),C=Qb(a,b,c,d),D={point:l,lineStart:m,lineEnd:n,polygonStart:function(){h=B,p=[],q=[],z=!0},polygonEnd:function(){h=A,p=hg.merge(p);var b=i([a,d]),c=z&&b,e=p.length;(c||e)&&(h.polygonStart(),c&&(h.lineStart(),j(null,null,1,h),h.lineEnd()),e&&Eb(p,f,b,j,h),h.polygonEnd()),p=q=r=null}};return D}}function Sb(a){var b=0,c=Mg/3,d=gc(a),e=d(b,c);return e.parallels=function(a){return arguments.length?d(b=a[0]*Mg/180,c=a[1]*Mg/180):[b/Mg*180,c/Mg*180]},e}function Tb(a,b){function c(a,b){var c=Math.sqrt(f-2*e*Math.sin(b))/e;return[c*Math.sin(a*=e),g-c*Math.cos(a)]}var d=Math.sin(a),e=(d+Math.sin(b))/2,f=1+d*(2*e-d),g=Math.sqrt(f)/e;return c.invert=function(a,b){var c=g-b;return[Math.atan2(a,c)/e,ba((f-(a*a+c*c)*e*e)/(2*e))]},c}function Ub(){function a(a,b){Ph+=e*a-d*b,d=a,e=b}var b,c,d,e;Uh.point=function(f,g){Uh.point=a,b=d=f,c=e=g},Uh.lineEnd=function(){a(b,c)}}function Vb(a,b){Qh>a&&(Qh=a),a>Sh&&(Sh=a),Rh>b&&(Rh=b),b>Th&&(Th=b)}function Wb(){function a(a,b){g.push("M",a,",",b,f)}function b(a,b){g.push("M",a,",",b),h.point=c}function c(a,b){g.push("L",a,",",b)}function d(){h.point=a}function e(){g.push("Z")}var f=Xb(4.5),g=[],h={point:a,lineStart:function(){h.point=b},lineEnd:d,polygonStart:function(){h.lineEnd=e},polygonEnd:function(){h.lineEnd=d,h.point=a},pointRadius:function(a){return f=Xb(a),h},result:function(){if(g.length){var a=g.join("");return g=[],a}}};return h}function Xb(a){return"m0,"+a+"a"+a+","+a+" 0 1,1 0,"+-2*a+"a"+a+","+a+" 0 1,1 0,"+2*a+"z"}function Yb(a,b){Ch+=a,Dh+=b,++Eh}function Zb(){function a(a,d){var e=a-b,f=d-c,g=Math.sqrt(e*e+f*f);Fh+=g*(b+a)/2,Gh+=g*(c+d)/2,Hh+=g,Yb(b=a,c=d)}var b,c;Wh.point=function(d,e){Wh.point=a,Yb(b=d,c=e)}}function $b(){Wh.point=Yb}function _b(){function a(a,b){var c=a-d,f=b-e,g=Math.sqrt(c*c+f*f);Fh+=g*(d+a)/2,Gh+=g*(e+b)/2,Hh+=g,g=e*a-d*b,Ih+=g*(d+a),Jh+=g*(e+b),Kh+=3*g,Yb(d=a,e=b)}var b,c,d,e;Wh.point=function(f,g){Wh.point=a,Yb(b=d=f,c=e=g)},Wh.lineEnd=function(){a(b,c)}}function ac(a){function b(b,c){a.moveTo(b+g,c),a.arc(b,c,g,0,Ng)}function c(b,c){a.moveTo(b,c),h.point=d}function d(b,c){a.lineTo(b,c)}function e(){h.point=b}function f(){a.closePath()}var g=4.5,h={point:b,lineStart:function(){h.point=c},lineEnd:e,polygonStart:function(){h.lineEnd=f},polygonEnd:function(){h.lineEnd=e,h.point=b},pointRadius:function(a){return g=a,h},result:v};return h}function bc(a){function b(a){return(h?d:c)(a)}function c(b){return ec(b,function(c,d){c=a(c,d),b.point(c[0],c[1])})}function d(b){function c(c,d){c=a(c,d),b.point(c[0],c[1])}function d(){t=NaN,y.point=f,b.lineStart()}function f(c,d){var f=pb([c,d]),g=a(c,d);e(t,u,s,v,w,x,t=g[0],u=g[1],s=c,v=f[0],w=f[1],x=f[2],h,b),b.point(t,u)}function g(){y.point=c,b.lineEnd()}function i(){
d(),y.point=j,y.lineEnd=k}function j(a,b){f(l=a,m=b),n=t,o=u,p=v,q=w,r=x,y.point=f}function k(){e(t,u,s,v,w,x,n,o,l,p,q,r,h,b),y.lineEnd=g,g()}var l,m,n,o,p,q,r,s,t,u,v,w,x,y={point:c,lineStart:d,lineEnd:g,polygonStart:function(){b.polygonStart(),y.lineStart=i},polygonEnd:function(){b.polygonEnd(),y.lineStart=d}};return y}function e(b,c,d,h,i,j,k,l,m,n,o,p,q,r){var s=k-b,t=l-c,u=s*s+t*t;if(u>4*f&&q--){var v=h+n,w=i+o,x=j+p,y=Math.sqrt(v*v+w*w+x*x),z=Math.asin(x/=y),A=tg(tg(x)-1)<Kg||tg(d-m)<Kg?(d+m)/2:Math.atan2(w,v),B=a(A,z),C=B[0],D=B[1],E=C-b,F=D-c,G=t*E-s*F;(G*G/u>f||tg((s*E+t*F)/u-.5)>.3||g>h*n+i*o+j*p)&&(e(b,c,d,h,i,j,C,D,A,v/=y,w/=y,x,q,r),r.point(C,D),e(C,D,A,v,w,x,k,l,m,n,o,p,q,r))}}var f=.5,g=Math.cos(30*Qg),h=16;return b.precision=function(a){return arguments.length?(h=(f=a*a)>0&&16,b):Math.sqrt(f)},b}function cc(a){var b=bc(function(b,c){return a([b*Rg,c*Rg])});return function(a){return hc(b(a))}}function dc(a){this.stream=a}function ec(a,b){return{point:b,sphere:function(){a.sphere()},lineStart:function(){a.lineStart()},lineEnd:function(){a.lineEnd()},polygonStart:function(){a.polygonStart()},polygonEnd:function(){a.polygonEnd()}}}function fc(a){return gc(function(){return a})()}function gc(a){function b(a){return a=h(a[0]*Qg,a[1]*Qg),[a[0]*m+i,j-a[1]*m]}function c(a){return a=h.invert((a[0]-i)/m,(j-a[1])/m),a&&[a[0]*Rg,a[1]*Rg]}function d(){h=Cb(g=kc(r,t,u),f);var a=f(p,q);return i=n-a[0]*m,j=o+a[1]*m,e()}function e(){return k&&(k.valid=!1,k=null),b}var f,g,h,i,j,k,l=bc(function(a,b){return a=f(a,b),[a[0]*m+i,j-a[1]*m]}),m=150,n=480,o=250,p=0,q=0,r=0,t=0,u=0,v=Mh,w=s,x=null,y=null;return b.stream=function(a){return k&&(k.valid=!1),k=hc(v(g,l(w(a)))),k.valid=!0,k},b.clipAngle=function(a){return arguments.length?(v=null==a?(x=a,Mh):Pb((x=+a)*Qg),e()):x},b.clipExtent=function(a){return arguments.length?(y=a,w=a?Rb(a[0][0],a[0][1],a[1][0],a[1][1]):s,e()):y},b.scale=function(a){return arguments.length?(m=+a,d()):m},b.translate=function(a){return arguments.length?(n=+a[0],o=+a[1],d()):[n,o]},b.center=function(a){return arguments.length?(p=a[0]%360*Qg,q=a[1]%360*Qg,d()):[p*Rg,q*Rg]},b.rotate=function(a){return arguments.length?(r=a[0]%360*Qg,t=a[1]%360*Qg,u=a.length>2?a[2]%360*Qg:0,d()):[r*Rg,t*Rg,u*Rg]},hg.rebind(b,l,"precision"),function(){return f=a.apply(this,arguments),b.invert=f.invert&&c,d()}}function hc(a){return ec(a,function(b,c){a.point(b*Qg,c*Qg)})}function ic(a,b){return[a,b]}function jc(a,b){return[a>Mg?a-Ng:-Mg>a?a+Ng:a,b]}function kc(a,b,c){return a?b||c?Cb(mc(a),nc(b,c)):mc(a):b||c?nc(b,c):jc}function lc(a){return function(b,c){return b+=a,[b>Mg?b-Ng:-Mg>b?b+Ng:b,c]}}function mc(a){var b=lc(a);return b.invert=lc(-a),b}function nc(a,b){function c(a,b){var c=Math.cos(b),h=Math.cos(a)*c,i=Math.sin(a)*c,j=Math.sin(b),k=j*d+h*e;return[Math.atan2(i*f-k*g,h*d-j*e),ba(k*f+i*g)]}var d=Math.cos(a),e=Math.sin(a),f=Math.cos(b),g=Math.sin(b);return c.invert=function(a,b){var c=Math.cos(b),h=Math.cos(a)*c,i=Math.sin(a)*c,j=Math.sin(b),k=j*f-i*g;return[Math.atan2(i*f+j*g,h*d+k*e),ba(k*d-h*e)]},c}function oc(a,b){var c=Math.cos(a),d=Math.sin(a);return function(e,f,g,h){var i=g*b;null!=e?(e=pc(c,e),f=pc(c,f),(g>0?f>e:e>f)&&(e+=g*Ng)):(e=a+g*Ng,f=a-.5*i);for(var j,k=e;g>0?k>f:f>k;k-=i)h.point((j=vb([c,-d*Math.cos(k),-d*Math.sin(k)]))[0],j[1])}}function pc(a,b){var c=pb(b);c[0]-=a,ub(c);var d=aa(-c[1]);return((-c[2]<0?-d:d)+2*Math.PI-Kg)%(2*Math.PI)}function qc(a,b,c){var d=hg.range(a,b-Kg,c).concat(b);return function(a){return d.map(function(b){return[a,b]})}}function rc(a,b,c){var d=hg.range(a,b-Kg,c).concat(b);return function(a){return d.map(function(b){return[b,a]})}}function sc(a){return a.source}function tc(a){return a.target}function uc(a,b,c,d){var e=Math.cos(b),f=Math.sin(b),g=Math.cos(d),h=Math.sin(d),i=e*Math.cos(a),j=e*Math.sin(a),k=g*Math.cos(c),l=g*Math.sin(c),m=2*Math.asin(Math.sqrt(fa(d-b)+e*g*fa(c-a))),n=1/Math.sin(m),o=m?function(a){var b=Math.sin(a*=m)*n,c=Math.sin(m-a)*n,d=c*i+b*k,e=c*j+b*l,g=c*f+b*h;return[Math.atan2(e,d)*Rg,Math.atan2(g,Math.sqrt(d*d+e*e))*Rg]}:function(){return[a*Rg,b*Rg]};return o.distance=m,o}function vc(){function a(a,e){var f=Math.sin(e*=Qg),g=Math.cos(e),h=tg((a*=Qg)-b),i=Math.cos(h);Xh+=Math.atan2(Math.sqrt((h=g*Math.sin(h))*h+(h=d*f-c*g*i)*h),c*f+d*g*i),b=a,c=f,d=g}var b,c,d;Yh.point=function(e,f){b=e*Qg,c=Math.sin(f*=Qg),d=Math.cos(f),Yh.point=a},Yh.lineEnd=function(){Yh.point=Yh.lineEnd=v}}function wc(a,b){function c(b,c){var d=Math.cos(b),e=Math.cos(c),f=a(d*e);return[f*e*Math.sin(b),f*Math.sin(c)]}return c.invert=function(a,c){var d=Math.sqrt(a*a+c*c),e=b(d),f=Math.sin(e),g=Math.cos(e);return[Math.atan2(a*f,d*g),Math.asin(d&&c*f/d)]},c}function xc(a,b){function c(a,b){g>0?-Pg+Kg>b&&(b=-Pg+Kg):b>Pg-Kg&&(b=Pg-Kg);var c=g/Math.pow(e(b),f);return[c*Math.sin(f*a),g-c*Math.cos(f*a)]}var d=Math.cos(a),e=function(a){return Math.tan(Mg/4+a/2)},f=a===b?Math.sin(a):Math.log(d/Math.cos(b))/Math.log(e(b)/e(a)),g=d*Math.pow(e(a),f)/f;return f?(c.invert=function(a,b){var c=g-b,d=$(f)*Math.sqrt(a*a+c*c);return[Math.atan2(a,c)/f,2*Math.atan(Math.pow(g/d,1/f))-Pg]},c):zc}function yc(a,b){function c(a,b){var c=f-b;return[c*Math.sin(e*a),f-c*Math.cos(e*a)]}var d=Math.cos(a),e=a===b?Math.sin(a):(d-Math.cos(b))/(b-a),f=d/e+a;return tg(e)<Kg?ic:(c.invert=function(a,b){var c=f-b;return[Math.atan2(a,c)/e,f-$(e)*Math.sqrt(a*a+c*c)]},c)}function zc(a,b){return[a,Math.log(Math.tan(Mg/4+b/2))]}function Ac(a){var b,c=fc(a),d=c.scale,e=c.translate,f=c.clipExtent;return c.scale=function(){var a=d.apply(c,arguments);return a===c?b?c.clipExtent(null):c:a},c.translate=function(){var a=e.apply(c,arguments);return a===c?b?c.clipExtent(null):c:a},c.clipExtent=function(a){var g=f.apply(c,arguments);if(g===c){if(b=null==a){var h=Mg*d(),i=e();f([[i[0]-h,i[1]-h],[i[0]+h,i[1]+h]])}}else b&&(g=null);return g},c.clipExtent(null)}function Bc(a,b){return[Math.log(Math.tan(Mg/4+b/2)),-a]}function Cc(a){return a[0]}function Dc(a){return a[1]}function Ec(a){for(var b=a.length,c=[0,1],d=2,e=2;b>e;e++){for(;d>1&&_(a[c[d-2]],a[c[d-1]],a[e])<=0;)--d;c[d++]=e}return c.slice(0,d)}function Fc(a,b){return a[0]-b[0]||a[1]-b[1]}function Gc(a,b,c){return(c[0]-b[0])*(a[1]-b[1])<(c[1]-b[1])*(a[0]-b[0])}function Hc(a,b,c,d){var e=a[0],f=c[0],g=b[0]-e,h=d[0]-f,i=a[1],j=c[1],k=b[1]-i,l=d[1]-j,m=(h*(i-j)-l*(e-f))/(l*g-h*k);return[e+m*g,i+m*k]}function Ic(a){var b=a[0],c=a[a.length-1];return!(b[0]-c[0]||b[1]-c[1])}function Jc(){cd(this),this.edge=this.site=this.circle=null}function Kc(a){var b=ii.pop()||new Jc;return b.site=a,b}function Lc(a){Vc(a),fi.remove(a),ii.push(a),cd(a)}function Mc(a){var b=a.circle,c=b.x,d=b.cy,e={x:c,y:d},f=a.P,g=a.N,h=[a];Lc(a);for(var i=f;i.circle&&tg(c-i.circle.x)<Kg&&tg(d-i.circle.cy)<Kg;)f=i.P,h.unshift(i),Lc(i),i=f;h.unshift(i),Vc(i);for(var j=g;j.circle&&tg(c-j.circle.x)<Kg&&tg(d-j.circle.cy)<Kg;)g=j.N,h.push(j),Lc(j),j=g;h.push(j),Vc(j);var k,l=h.length;for(k=1;l>k;++k)j=h[k],i=h[k-1],_c(j.edge,i.site,j.site,e);i=h[0],j=h[l-1],j.edge=Zc(i.site,j.site,null,e),Uc(i),Uc(j)}function Nc(a){for(var b,c,d,e,f=a.x,g=a.y,h=fi._;h;)if(d=Oc(h,g)-f,d>Kg)h=h.L;else{if(e=f-Pc(h,g),!(e>Kg)){d>-Kg?(b=h.P,c=h):e>-Kg?(b=h,c=h.N):b=c=h;break}if(!h.R){b=h;break}h=h.R}var i=Kc(a);if(fi.insert(b,i),b||c){if(b===c)return Vc(b),c=Kc(b.site),fi.insert(i,c),i.edge=c.edge=Zc(b.site,i.site),Uc(b),void Uc(c);if(!c)return void(i.edge=Zc(b.site,i.site));Vc(b),Vc(c);var j=b.site,k=j.x,l=j.y,m=a.x-k,n=a.y-l,o=c.site,p=o.x-k,q=o.y-l,r=2*(m*q-n*p),s=m*m+n*n,t=p*p+q*q,u={x:(q*s-n*t)/r+k,y:(m*t-p*s)/r+l};_c(c.edge,j,o,u),i.edge=Zc(j,a,null,u),c.edge=Zc(a,o,null,u),Uc(b),Uc(c)}}function Oc(a,b){var c=a.site,d=c.x,e=c.y,f=e-b;if(!f)return d;var g=a.P;if(!g)return-(1/0);c=g.site;var h=c.x,i=c.y,j=i-b;if(!j)return h;var k=h-d,l=1/f-1/j,m=k/j;return l?(-m+Math.sqrt(m*m-2*l*(k*k/(-2*j)-i+j/2+e-f/2)))/l+d:(d+h)/2}function Pc(a,b){var c=a.N;if(c)return Oc(c,b);var d=a.site;return d.y===b?d.x:1/0}function Qc(a){this.site=a,this.edges=[]}function Rc(a){for(var b,c,d,e,f,g,h,i,j,k,l=a[0][0],m=a[1][0],n=a[0][1],o=a[1][1],p=ei,q=p.length;q--;)if(f=p[q],f&&f.prepare())for(h=f.edges,i=h.length,g=0;i>g;)k=h[g].end(),d=k.x,e=k.y,j=h[++g%i].start(),b=j.x,c=j.y,(tg(d-b)>Kg||tg(e-c)>Kg)&&(h.splice(g,0,new ad($c(f.site,k,tg(d-l)<Kg&&o-e>Kg?{x:l,y:tg(b-l)<Kg?c:o}:tg(e-o)<Kg&&m-d>Kg?{x:tg(c-o)<Kg?b:m,y:o}:tg(d-m)<Kg&&e-n>Kg?{x:m,y:tg(b-m)<Kg?c:n}:tg(e-n)<Kg&&d-l>Kg?{x:tg(c-n)<Kg?b:l,y:n}:null),f.site,null)),++i)}function Sc(a,b){return b.angle-a.angle}function Tc(){cd(this),this.x=this.y=this.arc=this.site=this.cy=null}function Uc(a){var b=a.P,c=a.N;if(b&&c){var d=b.site,e=a.site,f=c.site;if(d!==f){var g=e.x,h=e.y,i=d.x-g,j=d.y-h,k=f.x-g,l=f.y-h,m=2*(i*l-j*k);if(!(m>=-Lg)){var n=i*i+j*j,o=k*k+l*l,p=(l*n-j*o)/m,q=(i*o-k*n)/m,l=q+h,r=ji.pop()||new Tc;r.arc=a,r.site=e,r.x=p+g,r.y=l+Math.sqrt(p*p+q*q),r.cy=l,a.circle=r;for(var s=null,t=hi._;t;)if(r.y<t.y||r.y===t.y&&r.x<=t.x){if(!t.L){s=t.P;break}t=t.L}else{if(!t.R){s=t;break}t=t.R}hi.insert(s,r),s||(gi=r)}}}}function Vc(a){var b=a.circle;b&&(b.P||(gi=b.N),hi.remove(b),ji.push(b),cd(b),a.circle=null)}function Wc(a){for(var b,c=di,d=Qb(a[0][0],a[0][1],a[1][0],a[1][1]),e=c.length;e--;)b=c[e],(!Xc(b,a)||!d(b)||tg(b.a.x-b.b.x)<Kg&&tg(b.a.y-b.b.y)<Kg)&&(b.a=b.b=null,c.splice(e,1))}function Xc(a,b){var c=a.b;if(c)return!0;var d,e,f=a.a,g=b[0][0],h=b[1][0],i=b[0][1],j=b[1][1],k=a.l,l=a.r,m=k.x,n=k.y,o=l.x,p=l.y,q=(m+o)/2,r=(n+p)/2;if(p===n){if(g>q||q>=h)return;if(m>o){if(f){if(f.y>=j)return}else f={x:q,y:i};c={x:q,y:j}}else{if(f){if(f.y<i)return}else f={x:q,y:j};c={x:q,y:i}}}else if(d=(m-o)/(p-n),e=r-d*q,-1>d||d>1)if(m>o){if(f){if(f.y>=j)return}else f={x:(i-e)/d,y:i};c={x:(j-e)/d,y:j}}else{if(f){if(f.y<i)return}else f={x:(j-e)/d,y:j};c={x:(i-e)/d,y:i}}else if(p>n){if(f){if(f.x>=h)return}else f={x:g,y:d*g+e};c={x:h,y:d*h+e}}else{if(f){if(f.x<g)return}else f={x:h,y:d*h+e};c={x:g,y:d*g+e}}return a.a=f,a.b=c,!0}function Yc(a,b){this.l=a,this.r=b,this.a=this.b=null}function Zc(a,b,c,d){var e=new Yc(a,b);return di.push(e),c&&_c(e,a,b,c),d&&_c(e,b,a,d),ei[a.i].edges.push(new ad(e,a,b)),ei[b.i].edges.push(new ad(e,b,a)),e}function $c(a,b,c){var d=new Yc(a,null);return d.a=b,d.b=c,di.push(d),d}function _c(a,b,c,d){a.a||a.b?a.l===c?a.b=d:a.a=d:(a.a=d,a.l=b,a.r=c)}function ad(a,b,c){var d=a.a,e=a.b;this.edge=a,this.site=b,this.angle=c?Math.atan2(c.y-b.y,c.x-b.x):a.l===b?Math.atan2(e.x-d.x,d.y-e.y):Math.atan2(d.x-e.x,e.y-d.y)}function bd(){this._=null}function cd(a){a.U=a.C=a.L=a.R=a.P=a.N=null}function dd(a,b){var c=b,d=b.R,e=c.U;e?e.L===c?e.L=d:e.R=d:a._=d,d.U=e,c.U=d,c.R=d.L,c.R&&(c.R.U=c),d.L=c}function ed(a,b){var c=b,d=b.L,e=c.U;e?e.L===c?e.L=d:e.R=d:a._=d,d.U=e,c.U=d,c.L=d.R,c.L&&(c.L.U=c),d.R=c}function fd(a){for(;a.L;)a=a.L;return a}function gd(a,b){var c,d,e,f=a.sort(hd).pop();for(di=[],ei=new Array(a.length),fi=new bd,hi=new bd;;)if(e=gi,f&&(!e||f.y<e.y||f.y===e.y&&f.x<e.x))(f.x!==c||f.y!==d)&&(ei[f.i]=new Qc(f),Nc(f),c=f.x,d=f.y),f=a.pop();else{if(!e)break;Mc(e.arc)}b&&(Wc(b),Rc(b));var g={cells:ei,edges:di};return fi=hi=di=ei=null,g}function hd(a,b){return b.y-a.y||b.x-a.x}function id(a,b,c){return(a.x-c.x)*(b.y-a.y)-(a.x-b.x)*(c.y-a.y)}function jd(a){return a.x}function kd(a){return a.y}function ld(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function md(a,b,c,d,e,f){if(!a(b,c,d,e,f)){var g=.5*(c+e),h=.5*(d+f),i=b.nodes;i[0]&&md(a,i[0],c,d,g,h),i[1]&&md(a,i[1],g,d,e,h),i[2]&&md(a,i[2],c,h,g,f),i[3]&&md(a,i[3],g,h,e,f)}}function nd(a,b,c,d,e,f,g){var h,i=1/0;return function j(a,k,l,m,n){if(!(k>f||l>g||d>m||e>n)){if(o=a.point){var o,p=b-a.x,q=c-a.y,r=p*p+q*q;if(i>r){var s=Math.sqrt(i=r);d=b-s,e=c-s,f=b+s,g=c+s,h=o}}for(var t=a.nodes,u=.5*(k+m),v=.5*(l+n),w=b>=u,x=c>=v,y=x<<1|w,z=y+4;z>y;++y)if(a=t[3&y])switch(3&y){case 0:j(a,k,l,u,v);break;case 1:j(a,u,l,m,v);break;case 2:j(a,k,v,u,n);break;case 3:j(a,u,v,m,n)}}}(a,d,e,f,g),h}function od(a,b){a=hg.rgb(a),b=hg.rgb(b);var c=a.r,d=a.g,e=a.b,f=b.r-c,g=b.g-d,h=b.b-e;return function(a){return"#"+ua(Math.round(c+f*a))+ua(Math.round(d+g*a))+ua(Math.round(e+h*a))}}function pd(a,b){var c,d={},e={};for(c in a)c in b?d[c]=sd(a[c],b[c]):e[c]=a[c];for(c in b)c in a||(e[c]=b[c]);return function(a){for(c in d)e[c]=d[c](a);return e}}function qd(a,b){return a=+a,b=+b,function(c){return a*(1-c)+b*c}}function rd(a,b){var c,d,e,f=li.lastIndex=mi.lastIndex=0,g=-1,h=[],i=[];for(a+="",b+="";(c=li.exec(a))&&(d=mi.exec(b));)(e=d.index)>f&&(e=b.slice(f,e),h[g]?h[g]+=e:h[++g]=e),(c=c[0])===(d=d[0])?h[g]?h[g]+=d:h[++g]=d:(h[++g]=null,i.push({i:g,x:qd(c,d)})),f=mi.lastIndex;return f<b.length&&(e=b.slice(f),h[g]?h[g]+=e:h[++g]=e),h.length<2?i[0]?(b=i[0].x,function(a){return b(a)+""}):function(){return b}:(b=i.length,function(a){for(var c,d=0;b>d;++d)h[(c=i[d]).i]=c.x(a);return h.join("")})}function sd(a,b){for(var c,d=hg.interpolators.length;--d>=0&&!(c=hg.interpolators[d](a,b)););return c}function td(a,b){var c,d=[],e=[],f=a.length,g=b.length,h=Math.min(a.length,b.length);for(c=0;h>c;++c)d.push(sd(a[c],b[c]));for(;f>c;++c)e[c]=a[c];for(;g>c;++c)e[c]=b[c];return function(a){for(c=0;h>c;++c)e[c]=d[c](a);return e}}function ud(a){return function(b){return 0>=b?0:b>=1?1:a(b)}}function vd(a){return function(b){return 1-a(1-b)}}function wd(a){return function(b){return.5*(.5>b?a(2*b):2-a(2-2*b))}}function xd(a){return a*a}function yd(a){return a*a*a}function zd(a){if(0>=a)return 0;if(a>=1)return 1;var b=a*a,c=b*a;return 4*(.5>a?c:3*(a-b)+c-.75)}function Ad(a){return function(b){return Math.pow(b,a)}}function Bd(a){return 1-Math.cos(a*Pg)}function Cd(a){return Math.pow(2,10*(a-1))}function Dd(a){return 1-Math.sqrt(1-a*a)}function Ed(a,b){var c;return arguments.length<2&&(b=.45),arguments.length?c=b/Ng*Math.asin(1/a):(a=1,c=b/4),function(d){return 1+a*Math.pow(2,-10*d)*Math.sin((d-c)*Ng/b)}}function Fd(a){return a||(a=1.70158),function(b){return b*b*((a+1)*b-a)}}function Gd(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}function Hd(a,b){a=hg.hcl(a),b=hg.hcl(b);var c=a.h,d=a.c,e=a.l,f=b.h-c,g=b.c-d,h=b.l-e;return isNaN(g)&&(g=0,d=isNaN(d)?b.c:d),isNaN(f)?(f=0,c=isNaN(c)?b.h:c):f>180?f-=360:-180>f&&(f+=360),function(a){return ka(c+f*a,d+g*a,e+h*a)+""}}function Id(a,b){a=hg.hsl(a),b=hg.hsl(b);var c=a.h,d=a.s,e=a.l,f=b.h-c,g=b.s-d,h=b.l-e;return isNaN(g)&&(g=0,d=isNaN(d)?b.s:d),isNaN(f)?(f=0,c=isNaN(c)?b.h:c):f>180?f-=360:-180>f&&(f+=360),function(a){return ia(c+f*a,d+g*a,e+h*a)+""}}function Jd(a,b){a=hg.lab(a),b=hg.lab(b);var c=a.l,d=a.a,e=a.b,f=b.l-c,g=b.a-d,h=b.b-e;return function(a){return ma(c+f*a,d+g*a,e+h*a)+""}}function Kd(a,b){return b-=a,function(c){return Math.round(a+b*c)}}function Ld(a){var b=[a.a,a.b],c=[a.c,a.d],d=Nd(b),e=Md(b,c),f=Nd(Od(c,b,-e))||0;b[0]*c[1]<c[0]*b[1]&&(b[0]*=-1,b[1]*=-1,d*=-1,e*=-1),this.rotate=(d?Math.atan2(b[1],b[0]):Math.atan2(-c[0],c[1]))*Rg,this.translate=[a.e,a.f],this.scale=[d,f],this.skew=f?Math.atan2(e,f)*Rg:0}function Md(a,b){return a[0]*b[0]+a[1]*b[1]}function Nd(a){var b=Math.sqrt(Md(a,a));return b&&(a[0]/=b,a[1]/=b),b}function Od(a,b,c){return a[0]+=c*b[0],a[1]+=c*b[1],a}function Pd(a){return a.length?a.pop()+",":""}function Qd(a,b,c,d){if(a[0]!==b[0]||a[1]!==b[1]){var e=c.push("translate(",null,",",null,")");d.push({i:e-4,x:qd(a[0],b[0])},{i:e-2,x:qd(a[1],b[1])})}else(b[0]||b[1])&&c.push("translate("+b+")")}function Rd(a,b,c,d){a!==b?(a-b>180?b+=360:b-a>180&&(a+=360),d.push({i:c.push(Pd(c)+"rotate(",null,")")-2,x:qd(a,b)})):b&&c.push(Pd(c)+"rotate("+b+")")}function Sd(a,b,c,d){a!==b?d.push({i:c.push(Pd(c)+"skewX(",null,")")-2,x:qd(a,b)}):b&&c.push(Pd(c)+"skewX("+b+")")}function Td(a,b,c,d){if(a[0]!==b[0]||a[1]!==b[1]){var e=c.push(Pd(c)+"scale(",null,",",null,")");d.push({i:e-4,x:qd(a[0],b[0])},{i:e-2,x:qd(a[1],b[1])})}else(1!==b[0]||1!==b[1])&&c.push(Pd(c)+"scale("+b+")")}function Ud(a,b){var c=[],d=[];return a=hg.transform(a),b=hg.transform(b),Qd(a.translate,b.translate,c,d),Rd(a.rotate,b.rotate,c,d),Sd(a.skew,b.skew,c,d),Td(a.scale,b.scale,c,d),a=b=null,function(a){for(var b,e=-1,f=d.length;++e<f;)c[(b=d[e]).i]=b.x(a);return c.join("")}}function Vd(a,b){return b=(b-=a=+a)||1/b,function(c){return(c-a)/b}}function Wd(a,b){return b=(b-=a=+a)||1/b,function(c){return Math.max(0,Math.min(1,(c-a)/b))}}function Xd(a){for(var b=a.source,c=a.target,d=Zd(b,c),e=[b];b!==d;)b=b.parent,e.push(b);for(var f=e.length;c!==d;)e.splice(f,0,c),c=c.parent;return e}function Yd(a){for(var b=[],c=a.parent;null!=c;)b.push(a),a=c,c=c.parent;return b.push(a),b}function Zd(a,b){if(a===b)return a;for(var c=Yd(a),d=Yd(b),e=c.pop(),f=d.pop(),g=null;e===f;)g=e,e=c.pop(),f=d.pop();return g}function $d(a){a.fixed|=2}function _d(a){a.fixed&=-7}function ae(a){a.fixed|=4,a.px=a.x,a.py=a.y}function be(a){a.fixed&=-5}function ce(a,b,c){var d=0,e=0;if(a.charge=0,!a.leaf)for(var f,g=a.nodes,h=g.length,i=-1;++i<h;)f=g[i],null!=f&&(ce(f,b,c),a.charge+=f.charge,d+=f.charge*f.cx,e+=f.charge*f.cy);if(a.point){a.leaf||(a.point.x+=Math.random()-.5,a.point.y+=Math.random()-.5);var j=b*c[a.point.index];a.charge+=a.pointCharge=j,d+=j*a.point.x,e+=j*a.point.y}a.cx=d/a.charge,a.cy=e/a.charge}function de(a,b){return hg.rebind(a,b,"sort","children","value"),a.nodes=a,a.links=je,a}function ee(a,b){for(var c=[a];null!=(a=c.pop());)if(b(a),(e=a.children)&&(d=e.length))for(var d,e;--d>=0;)c.push(e[d])}function fe(a,b){for(var c=[a],d=[];null!=(a=c.pop());)if(d.push(a),(f=a.children)&&(e=f.length))for(var e,f,g=-1;++g<e;)c.push(f[g]);for(;null!=(a=d.pop());)b(a)}function ge(a){return a.children}function he(a){return a.value}function ie(a,b){return b.value-a.value}function je(a){return hg.merge(a.map(function(a){return(a.children||[]).map(function(b){return{source:a,target:b}})}))}function ke(a){return a.x}function le(a){return a.y}function me(a,b,c){a.y0=b,a.y=c}function ne(a){return hg.range(a.length)}function oe(a){for(var b=-1,c=a[0].length,d=[];++b<c;)d[b]=0;return d}function pe(a){for(var b,c=1,d=0,e=a[0][1],f=a.length;f>c;++c)(b=a[c][1])>e&&(d=c,e=b);return d}function qe(a){return a.reduce(re,0)}function re(a,b){return a+b[1]}function se(a,b){return te(a,Math.ceil(Math.log(b.length)/Math.LN2+1))}function te(a,b){for(var c=-1,d=+a[0],e=(a[1]-d)/b,f=[];++c<=b;)f[c]=e*c+d;return f}function ue(a){return[hg.min(a),hg.max(a)]}function ve(a,b){return a.value-b.value}function we(a,b){var c=a._pack_next;a._pack_next=b,b._pack_prev=a,b._pack_next=c,c._pack_prev=b}function xe(a,b){a._pack_next=b,b._pack_prev=a}function ye(a,b){var c=b.x-a.x,d=b.y-a.y,e=a.r+b.r;return.999*e*e>c*c+d*d}function ze(a){function b(a){k=Math.min(a.x-a.r,k),l=Math.max(a.x+a.r,l),m=Math.min(a.y-a.r,m),n=Math.max(a.y+a.r,n)}if((c=a.children)&&(j=c.length)){var c,d,e,f,g,h,i,j,k=1/0,l=-(1/0),m=1/0,n=-(1/0);if(c.forEach(Ae),d=c[0],d.x=-d.r,d.y=0,b(d),j>1&&(e=c[1],e.x=e.r,e.y=0,b(e),j>2))for(f=c[2],De(d,e,f),b(f),we(d,f),d._pack_prev=f,we(f,e),e=d._pack_next,g=3;j>g;g++){De(d,e,f=c[g]);var o=0,p=1,q=1;for(h=e._pack_next;h!==e;h=h._pack_next,p++)if(ye(h,f)){o=1;break}if(1==o)for(i=d._pack_prev;i!==h._pack_prev&&!ye(i,f);i=i._pack_prev,q++);o?(q>p||p==q&&e.r<d.r?xe(d,e=h):xe(d=i,e),g--):(we(d,f),e=f,b(f))}var r=(k+l)/2,s=(m+n)/2,t=0;for(g=0;j>g;g++)f=c[g],f.x-=r,f.y-=s,t=Math.max(t,f.r+Math.sqrt(f.x*f.x+f.y*f.y));a.r=t,c.forEach(Be)}}function Ae(a){a._pack_next=a._pack_prev=a}function Be(a){delete a._pack_next,delete a._pack_prev}function Ce(a,b,c,d){var e=a.children;if(a.x=b+=d*a.x,a.y=c+=d*a.y,a.r*=d,e)for(var f=-1,g=e.length;++f<g;)Ce(e[f],b,c,d)}function De(a,b,c){var d=a.r+c.r,e=b.x-a.x,f=b.y-a.y;if(d&&(e||f)){var g=b.r+c.r,h=e*e+f*f;g*=g,d*=d;var i=.5+(d-g)/(2*h),j=Math.sqrt(Math.max(0,2*g*(d+h)-(d-=h)*d-g*g))/(2*h);c.x=a.x+i*e+j*f,c.y=a.y+i*f-j*e}else c.x=a.x+d,c.y=a.y}function Ee(a,b){return a.parent==b.parent?1:2}function Fe(a){var b=a.children;return b.length?b[0]:a.t}function Ge(a){var b,c=a.children;return(b=c.length)?c[b-1]:a.t}function He(a,b,c){var d=c/(b.i-a.i);b.c-=d,b.s+=c,a.c+=d,b.z+=c,b.m+=c}function Ie(a){for(var b,c=0,d=0,e=a.children,f=e.length;--f>=0;)b=e[f],b.z+=c,b.m+=c,c+=b.s+(d+=b.c)}function Je(a,b,c){return a.a.parent===b.parent?a.a:c}function Ke(a){return 1+hg.max(a,function(a){return a.y})}function Le(a){return a.reduce(function(a,b){return a+b.x},0)/a.length}function Me(a){var b=a.children;return b&&b.length?Me(b[0]):a}function Ne(a){var b,c=a.children;return c&&(b=c.length)?Ne(c[b-1]):a}function Oe(a){return{x:a.x,y:a.y,dx:a.dx,dy:a.dy}}function Pe(a,b){var c=a.x+b[3],d=a.y+b[0],e=a.dx-b[1]-b[3],f=a.dy-b[0]-b[2];return 0>e&&(c+=e/2,e=0),0>f&&(d+=f/2,f=0),{x:c,y:d,dx:e,dy:f}}function Qe(a){var b=a[0],c=a[a.length-1];return c>b?[b,c]:[c,b]}function Re(a){return a.rangeExtent?a.rangeExtent():Qe(a.range())}function Se(a,b,c,d){var e=c(a[0],a[1]),f=d(b[0],b[1]);return function(a){return f(e(a))}}function Te(a,b){var c,d=0,e=a.length-1,f=a[d],g=a[e];return f>g&&(c=d,d=e,e=c,c=f,f=g,g=c),a[d]=b.floor(f),a[e]=b.ceil(g),a}function Ue(a){return a?{floor:function(b){return Math.floor(b/a)*a},ceil:function(b){return Math.ceil(b/a)*a}}:xi}function Ve(a,b,c,d){var e=[],f=[],g=0,h=Math.min(a.length,b.length)-1;for(a[h]<a[0]&&(a=a.slice().reverse(),b=b.slice().reverse());++g<=h;)e.push(c(a[g-1],a[g])),f.push(d(b[g-1],b[g]));return function(b){var c=hg.bisect(a,b,1,h)-1;return f[c](e[c](b))}}function We(a,b,c,d){function e(){var e=Math.min(a.length,b.length)>2?Ve:Se,i=d?Wd:Vd;return g=e(a,b,i,c),h=e(b,a,i,sd),f}function f(a){return g(a)}var g,h;return f.invert=function(a){return h(a)},f.domain=function(b){return arguments.length?(a=b.map(Number),e()):a},f.range=function(a){return arguments.length?(b=a,e()):b},f.rangeRound=function(a){return f.range(a).interpolate(Kd)},f.clamp=function(a){return arguments.length?(d=a,e()):d},f.interpolate=function(a){return arguments.length?(c=a,e()):c},f.ticks=function(b){return $e(a,b)},f.tickFormat=function(b,c){return _e(a,b,c)},f.nice=function(b){return Ye(a,b),e()},f.copy=function(){return We(a,b,c,d)},e()}function Xe(a,b){return hg.rebind(a,b,"range","rangeRound","interpolate","clamp")}function Ye(a,b){return Te(a,Ue(Ze(a,b)[2])),Te(a,Ue(Ze(a,b)[2])),a}function Ze(a,b){null==b&&(b=10);var c=Qe(a),d=c[1]-c[0],e=Math.pow(10,Math.floor(Math.log(d/b)/Math.LN10)),f=b/d*e;return.15>=f?e*=10:.35>=f?e*=5:.75>=f&&(e*=2),c[0]=Math.ceil(c[0]/e)*e,c[1]=Math.floor(c[1]/e)*e+.5*e,c[2]=e,c}function $e(a,b){return hg.range.apply(hg,Ze(a,b))}function _e(a,b,c){var d=Ze(a,b);if(c){var e=lh.exec(c);if(e.shift(),"s"===e[8]){var f=hg.formatPrefix(Math.max(tg(d[0]),tg(d[1])));return e[7]||(e[7]="."+af(f.scale(d[2]))),e[8]="f",c=hg.format(e.join("")),function(a){return c(f.scale(a))+f.symbol}}e[7]||(e[7]="."+bf(e[8],d)),c=e.join("")}else c=",."+af(d[2])+"f";return hg.format(c)}function af(a){return-Math.floor(Math.log(a)/Math.LN10+.01)}function bf(a,b){var c=af(b[2]);return a in yi?Math.abs(c-af(Math.max(tg(b[0]),tg(b[1]))))+ +("e"!==a):c-2*("%"===a)}function cf(a,b,c,d){function e(a){return(c?Math.log(0>a?0:a):-Math.log(a>0?0:-a))/Math.log(b)}function f(a){return c?Math.pow(b,a):-Math.pow(b,-a)}function g(b){return a(e(b))}return g.invert=function(b){return f(a.invert(b))},g.domain=function(b){return arguments.length?(c=b[0]>=0,a.domain((d=b.map(Number)).map(e)),g):d},g.base=function(c){return arguments.length?(b=+c,a.domain(d.map(e)),g):b},g.nice=function(){var b=Te(d.map(e),c?Math:Ai);return a.domain(b),d=b.map(f),g},g.ticks=function(){var a=Qe(d),g=[],h=a[0],i=a[1],j=Math.floor(e(h)),k=Math.ceil(e(i)),l=b%1?2:b;if(isFinite(k-j)){if(c){for(;k>j;j++)for(var m=1;l>m;m++)g.push(f(j)*m);g.push(f(j))}else for(g.push(f(j));j++<k;)for(var m=l-1;m>0;m--)g.push(f(j)*m);for(j=0;g[j]<h;j++);for(k=g.length;g[k-1]>i;k--);g=g.slice(j,k)}return g},g.tickFormat=function(a,c){if(!arguments.length)return zi;arguments.length<2?c=zi:"function"!=typeof c&&(c=hg.format(c));var d=Math.max(1,b*a/g.ticks().length);return function(a){var g=a/f(Math.round(e(a)));return b-.5>g*b&&(g*=b),d>=g?c(a):""}},g.copy=function(){return cf(a.copy(),b,c,d)},Xe(g,a)}function df(a,b,c){function d(b){return a(e(b))}var e=ef(b),f=ef(1/b);return d.invert=function(b){return f(a.invert(b))},d.domain=function(b){return arguments.length?(a.domain((c=b.map(Number)).map(e)),d):c},d.ticks=function(a){return $e(c,a)},d.tickFormat=function(a,b){return _e(c,a,b)},d.nice=function(a){return d.domain(Ye(c,a))},d.exponent=function(g){return arguments.length?(e=ef(b=g),f=ef(1/b),a.domain(c.map(e)),d):b},d.copy=function(){return df(a.copy(),b,c)},Xe(d,a)}function ef(a){return function(b){return 0>b?-Math.pow(-b,a):Math.pow(b,a)}}function ff(a,b){function c(c){return f[((e.get(c)||("range"===b.t?e.set(c,a.push(c)):NaN))-1)%f.length]}function d(b,c){return hg.range(a.length).map(function(a){return b+c*a})}var e,f,g;return c.domain=function(d){if(!arguments.length)return a;a=[],e=new j;for(var f,g=-1,h=d.length;++g<h;)e.has(f=d[g])||e.set(f,a.push(f));return c[b.t].apply(c,b.a)},c.range=function(a){return arguments.length?(f=a,g=0,b={t:"range",a:arguments},c):f},c.rangePoints=function(e,h){arguments.length<2&&(h=0);var i=e[0],j=e[1],k=a.length<2?(i=(i+j)/2,0):(j-i)/(a.length-1+h);return f=d(i+k*h/2,k),g=0,b={t:"rangePoints",a:arguments},c},c.rangeRoundPoints=function(e,h){arguments.length<2&&(h=0);var i=e[0],j=e[1],k=a.length<2?(i=j=Math.round((i+j)/2),0):(j-i)/(a.length-1+h)|0;return f=d(i+Math.round(k*h/2+(j-i-(a.length-1+h)*k)/2),k),g=0,b={t:"rangeRoundPoints",a:arguments},c},c.rangeBands=function(e,h,i){arguments.length<2&&(h=0),arguments.length<3&&(i=h);var j=e[1]<e[0],k=e[j-0],l=e[1-j],m=(l-k)/(a.length-h+2*i);return f=d(k+m*i,m),j&&f.reverse(),g=m*(1-h),b={t:"rangeBands",a:arguments},c},c.rangeRoundBands=function(e,h,i){arguments.length<2&&(h=0),arguments.length<3&&(i=h);var j=e[1]<e[0],k=e[j-0],l=e[1-j],m=Math.floor((l-k)/(a.length-h+2*i));return f=d(k+Math.round((l-k-(a.length-h)*m)/2),m),j&&f.reverse(),g=Math.round(m*(1-h)),b={t:"rangeRoundBands",a:arguments},c},c.rangeBand=function(){return g},c.rangeExtent=function(){return Qe(b.a[0])},c.copy=function(){return ff(a,b)},c.domain(a)}function gf(a,b){function f(){var c=0,d=b.length;for(h=[];++c<d;)h[c-1]=hg.quantile(a,c/d);return g}function g(a){return isNaN(a=+a)?void 0:b[hg.bisect(h,a)]}var h;return g.domain=function(b){return arguments.length?(a=b.map(d).filter(e).sort(c),f()):a},g.range=function(a){return arguments.length?(b=a,f()):b},g.quantiles=function(){return h},g.invertExtent=function(c){return c=b.indexOf(c),0>c?[NaN,NaN]:[c>0?h[c-1]:a[0],c<h.length?h[c]:a[a.length-1]]},g.copy=function(){return gf(a,b)},f()}function hf(a,b,c){function d(b){return c[Math.max(0,Math.min(g,Math.floor(f*(b-a))))]}function e(){return f=c.length/(b-a),g=c.length-1,d}var f,g;return d.domain=function(c){return arguments.length?(a=+c[0],b=+c[c.length-1],e()):[a,b]},d.range=function(a){return arguments.length?(c=a,e()):c},d.invertExtent=function(b){return b=c.indexOf(b),b=0>b?NaN:b/f+a,[b,b+1/f]},d.copy=function(){return hf(a,b,c)},e()}function jf(a,b){function c(c){return c>=c?b[hg.bisect(a,c)]:void 0}return c.domain=function(b){return arguments.length?(a=b,c):a},c.range=function(a){return arguments.length?(b=a,c):b},c.invertExtent=function(c){return c=b.indexOf(c),[a[c-1],a[c]]},c.copy=function(){return jf(a,b)},c}function kf(a){function b(a){return+a}return b.invert=b,b.domain=b.range=function(c){return arguments.length?(a=c.map(b),b):a},b.ticks=function(b){return $e(a,b)},b.tickFormat=function(b,c){return _e(a,b,c)},b.copy=function(){return kf(a)},b}function lf(){return 0}function mf(a){return a.innerRadius}function nf(a){return a.outerRadius}function of(a){return a.startAngle}function pf(a){return a.endAngle}function qf(a){return a&&a.padAngle}function rf(a,b,c,d){return(a-c)*b-(b-d)*a>0?0:1}function sf(a,b,c,d,e){var f=a[0]-b[0],g=a[1]-b[1],h=(e?d:-d)/Math.sqrt(f*f+g*g),i=h*g,j=-h*f,k=a[0]+i,l=a[1]+j,m=b[0]+i,n=b[1]+j,o=(k+m)/2,p=(l+n)/2,q=m-k,r=n-l,s=q*q+r*r,t=c-d,u=k*n-m*l,v=(0>r?-1:1)*Math.sqrt(Math.max(0,t*t*s-u*u)),w=(u*r-q*v)/s,x=(-u*q-r*v)/s,y=(u*r+q*v)/s,z=(-u*q+r*v)/s,A=w-o,B=x-p,C=y-o,D=z-p;return A*A+B*B>C*C+D*D&&(w=y,x=z),[[w-i,x-j],[w*c/t,x*c/t]]}function tf(a){function b(b){function g(){j.push("M",f(a(k),h))}for(var i,j=[],k=[],l=-1,m=b.length,n=Aa(c),o=Aa(d);++l<m;)e.call(this,i=b[l],l)?k.push([+n.call(this,i,l),+o.call(this,i,l)]):k.length&&(g(),k=[]);return k.length&&g(),j.length?j.join(""):null}var c=Cc,d=Dc,e=Db,f=uf,g=f.key,h=.7;return b.x=function(a){return arguments.length?(c=a,b):c},b.y=function(a){return arguments.length?(d=a,b):d},b.defined=function(a){return arguments.length?(e=a,b):e},b.interpolate=function(a){return arguments.length?(g="function"==typeof a?f=a:(f=Gi.get(a)||uf).key,b):g},b.tension=function(a){return arguments.length?(h=a,b):h},b}function uf(a){return a.length>1?a.join("L"):a+"Z"}function vf(a){return a.join("L")+"Z"}function wf(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("H",(d[0]+(d=a[b])[0])/2,"V",d[1]);return c>1&&e.push("H",d[0]),e.join("")}function xf(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("V",(d=a[b])[1],"H",d[0]);return e.join("")}function yf(a){for(var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];++b<c;)e.push("H",(d=a[b])[0],"V",d[1]);return e.join("")}function zf(a,b){return a.length<4?uf(a):a[1]+Cf(a.slice(1,-1),Df(a,b))}function Af(a,b){return a.length<3?vf(a):a[0]+Cf((a.push(a[0]),a),Df([a[a.length-2]].concat(a,[a[1]]),b))}function Bf(a,b){return a.length<3?uf(a):a[0]+Cf(a,Df(a,b))}function Cf(a,b){if(b.length<1||a.length!=b.length&&a.length!=b.length+2)return uf(a);var c=a.length!=b.length,d="",e=a[0],f=a[1],g=b[0],h=g,i=1;if(c&&(d+="Q"+(f[0]-2*g[0]/3)+","+(f[1]-2*g[1]/3)+","+f[0]+","+f[1],e=a[1],i=2),b.length>1){h=b[1],f=a[i],i++,d+="C"+(e[0]+g[0])+","+(e[1]+g[1])+","+(f[0]-h[0])+","+(f[1]-h[1])+","+f[0]+","+f[1];for(var j=2;j<b.length;j++,i++)f=a[i],h=b[j],d+="S"+(f[0]-h[0])+","+(f[1]-h[1])+","+f[0]+","+f[1]}if(c){var k=a[i];d+="Q"+(f[0]+2*h[0]/3)+","+(f[1]+2*h[1]/3)+","+k[0]+","+k[1]}return d}function Df(a,b){for(var c,d=[],e=(1-b)/2,f=a[0],g=a[1],h=1,i=a.length;++h<i;)c=f,f=g,g=a[h],d.push([e*(g[0]-c[0]),e*(g[1]-c[1])]);return d}function Ef(a){if(a.length<3)return uf(a);var b=1,c=a.length,d=a[0],e=d[0],f=d[1],g=[e,e,e,(d=a[1])[0]],h=[f,f,f,d[1]],i=[e,",",f,"L",If(Ji,g),",",If(Ji,h)];for(a.push(a[c-1]);++b<=c;)d=a[b],g.shift(),g.push(d[0]),h.shift(),h.push(d[1]),Jf(i,g,h);return a.pop(),i.push("L",d),i.join("")}function Ff(a){if(a.length<4)return uf(a);for(var b,c=[],d=-1,e=a.length,f=[0],g=[0];++d<3;)b=a[d],f.push(b[0]),g.push(b[1]);for(c.push(If(Ji,f)+","+If(Ji,g)),--d;++d<e;)b=a[d],f.shift(),f.push(b[0]),g.shift(),g.push(b[1]),Jf(c,f,g);return c.join("")}function Gf(a){for(var b,c,d=-1,e=a.length,f=e+4,g=[],h=[];++d<4;)c=a[d%e],g.push(c[0]),h.push(c[1]);for(b=[If(Ji,g),",",If(Ji,h)],--d;++d<f;)c=a[d%e],g.shift(),g.push(c[0]),h.shift(),h.push(c[1]),Jf(b,g,h);return b.join("")}function Hf(a,b){var c=a.length-1;if(c)for(var d,e,f=a[0][0],g=a[0][1],h=a[c][0]-f,i=a[c][1]-g,j=-1;++j<=c;)d=a[j],e=j/c,d[0]=b*d[0]+(1-b)*(f+e*h),d[1]=b*d[1]+(1-b)*(g+e*i);return Ef(a)}function If(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}function Jf(a,b,c){a.push("C",If(Hi,b),",",If(Hi,c),",",If(Ii,b),",",If(Ii,c),",",If(Ji,b),",",If(Ji,c))}function Kf(a,b){return(b[1]-a[1])/(b[0]-a[0])}function Lf(a){for(var b=0,c=a.length-1,d=[],e=a[0],f=a[1],g=d[0]=Kf(e,f);++b<c;)d[b]=(g+(g=Kf(e=f,f=a[b+1])))/2;return d[b]=g,d}function Mf(a){for(var b,c,d,e,f=[],g=Lf(a),h=-1,i=a.length-1;++h<i;)b=Kf(a[h],a[h+1]),tg(b)<Kg?g[h]=g[h+1]=0:(c=g[h]/b,d=g[h+1]/b,e=c*c+d*d,e>9&&(e=3*b/Math.sqrt(e),g[h]=e*c,g[h+1]=e*d));for(h=-1;++h<=i;)e=(a[Math.min(i,h+1)][0]-a[Math.max(0,h-1)][0])/(6*(1+g[h]*g[h])),f.push([e||0,g[h]*e||0]);return f}function Nf(a){return a.length<3?uf(a):a[0]+Cf(a,Mf(a))}function Of(a){for(var b,c,d,e=-1,f=a.length;++e<f;)b=a[e],c=b[0],d=b[1]-Pg,b[0]=c*Math.cos(d),b[1]=c*Math.sin(d);return a}function Pf(a){function b(b){function i(){p.push("M",h(a(r),l),k,j(a(q.reverse()),l),"Z")}for(var m,n,o,p=[],q=[],r=[],s=-1,t=b.length,u=Aa(c),v=Aa(e),w=c===d?function(){
return n}:Aa(d),x=e===f?function(){return o}:Aa(f);++s<t;)g.call(this,m=b[s],s)?(q.push([n=+u.call(this,m,s),o=+v.call(this,m,s)]),r.push([+w.call(this,m,s),+x.call(this,m,s)])):q.length&&(i(),q=[],r=[]);return q.length&&i(),p.length?p.join(""):null}var c=Cc,d=Cc,e=0,f=Dc,g=Db,h=uf,i=h.key,j=h,k="L",l=.7;return b.x=function(a){return arguments.length?(c=d=a,b):d},b.x0=function(a){return arguments.length?(c=a,b):c},b.x1=function(a){return arguments.length?(d=a,b):d},b.y=function(a){return arguments.length?(e=f=a,b):f},b.y0=function(a){return arguments.length?(e=a,b):e},b.y1=function(a){return arguments.length?(f=a,b):f},b.defined=function(a){return arguments.length?(g=a,b):g},b.interpolate=function(a){return arguments.length?(i="function"==typeof a?h=a:(h=Gi.get(a)||uf).key,j=h.reverse||h,k=h.closed?"M":"L",b):i},b.tension=function(a){return arguments.length?(l=a,b):l},b}function Qf(a){return a.radius}function Rf(a){return[a.x,a.y]}function Sf(a){return function(){var b=a.apply(this,arguments),c=b[0],d=b[1]-Pg;return[c*Math.cos(d),c*Math.sin(d)]}}function Tf(){return 64}function Uf(){return"circle"}function Vf(a){var b=Math.sqrt(a/Mg);return"M0,"+b+"A"+b+","+b+" 0 1,1 0,"+-b+"A"+b+","+b+" 0 1,1 0,"+b+"Z"}function Wf(a){return function(){var b,c,d;(b=this[a])&&(d=b[c=b.active])&&(d.timer.c=null,d.timer.t=NaN,--b.count?delete b[c]:delete this[a],b.active+=.5,d.event&&d.event.interrupt.call(this,this.__data__,d.index))}}function Xf(a,b,c){return yg(a,Qi),a.namespace=b,a.id=c,a}function Yf(a,b,c,d){var e=a.id,f=a.namespace;return R(a,"function"==typeof c?function(a,g,h){a[f][e].tween.set(b,d(c.call(a,a.__data__,g,h)))}:(c=d(c),function(a){a[f][e].tween.set(b,c)}))}function Zf(a){return null==a&&(a=""),function(){this.textContent=a}}function $f(a){return null==a?"__transition__":"__transition_"+a+"__"}function _f(a,b,c,d,e){function f(a){var b=p.delay;return k.t=b+i,a>=b?g(a-b):void(k.c=g)}function g(c){var e=o.active,f=o[e];f&&(f.timer.c=null,f.timer.t=NaN,--o.count,delete o[e],f.event&&f.event.interrupt.call(a,a.__data__,f.index));for(var g in o)if(d>+g){var j=o[g];j.timer.c=null,j.timer.t=NaN,--o.count,delete o[g]}k.c=h,Fa(function(){return k.c&&h(c||1)&&(k.c=null,k.t=NaN),1},0,i),o.active=d,p.event&&p.event.start.call(a,a.__data__,b),n=[],p.tween.forEach(function(c,d){(d=d.call(a,a.__data__,b))&&n.push(d)}),m=p.ease,l=p.duration}function h(e){for(var f=e/l,g=m(f),h=n.length;h>0;)n[--h].call(a,g);return f>=1?(p.event&&p.event.end.call(a,a.__data__,b),--o.count?delete o[d]:delete a[c],1):void 0}var i,k,l,m,n,o=a[c]||(a[c]={active:0,count:0}),p=o[d];p||(i=e.time,k=Fa(f,0,i),p=o[d]={tween:new j,time:i,timer:k,delay:e.delay,duration:e.duration,ease:e.ease,index:b},e=null,++o.count)}function ag(a,b,c){a.attr("transform",function(a){var d=b(a);return"translate("+(isFinite(d)?d:c(a))+",0)"})}function bg(a,b,c){a.attr("transform",function(a){var d=b(a);return"translate(0,"+(isFinite(d)?d:c(a))+")"})}function cg(a){return a.toISOString()}function dg(a,b,c){function d(b){return a(b)}function e(a,c){var d=a[1]-a[0],e=d/c,f=hg.bisect(Zi,e);return f==Zi.length?[b.year,Ze(a.map(function(a){return a/31536e6}),c)[2]]:f?b[e/Zi[f-1]<Zi[f]/e?f-1:f]:[aj,Ze(a,c)[2]]}return d.invert=function(b){return eg(a.invert(b))},d.domain=function(b){return arguments.length?(a.domain(b),d):a.domain().map(eg)},d.nice=function(a,b){function c(c){return!isNaN(c)&&!a.range(c,eg(+c+1),b).length}var f=d.domain(),g=Qe(f),h=null==a?e(g,10):"number"==typeof a&&e(g,a);return h&&(a=h[0],b=h[1]),d.domain(Te(f,b>1?{floor:function(b){for(;c(b=a.floor(b));)b=eg(b-1);return b},ceil:function(b){for(;c(b=a.ceil(b));)b=eg(+b+1);return b}}:a))},d.ticks=function(a,b){var c=Qe(d.domain()),f=null==a?e(c,10):"number"==typeof a?e(c,a):!a.range&&[{range:a},b];return f&&(a=f[0],b=f[1]),a.range(c[0],eg(+c[1]+1),1>b?1:b)},d.tickFormat=function(){return c},d.copy=function(){return dg(a.copy(),b,c)},Xe(d,a)}function eg(a){return new Date(a)}function fg(a){return JSON.parse(a.responseText)}function gg(a){var b=kg.createRange();return b.selectNode(kg.body),b.createContextualFragment(a.responseText)}var hg={version:"3.5.16"},ig=[].slice,jg=function(a){return ig.call(a)},kg=this.document;if(kg)try{jg(kg.documentElement.childNodes)[0].nodeType}catch(lg){jg=function(a){for(var b=a.length,c=new Array(b);b--;)c[b]=a[b];return c}}if(Date.now||(Date.now=function(){return+new Date}),kg)try{kg.createElement("DIV").style.setProperty("opacity",0,"")}catch(mg){var ng=this.Element.prototype,og=ng.setAttribute,pg=ng.setAttributeNS,qg=this.CSSStyleDeclaration.prototype,rg=qg.setProperty;ng.setAttribute=function(a,b){og.call(this,a,b+"")},ng.setAttributeNS=function(a,b,c){pg.call(this,a,b,c+"")},qg.setProperty=function(a,b,c){rg.call(this,a,b+"",c)}}hg.ascending=c,hg.descending=function(a,b){return a>b?-1:b>a?1:b>=a?0:NaN},hg.min=function(a,b){var c,d,e=-1,f=a.length;if(1===arguments.length){for(;++e<f;)if(null!=(d=a[e])&&d>=d){c=d;break}for(;++e<f;)null!=(d=a[e])&&c>d&&(c=d)}else{for(;++e<f;)if(null!=(d=b.call(a,a[e],e))&&d>=d){c=d;break}for(;++e<f;)null!=(d=b.call(a,a[e],e))&&c>d&&(c=d)}return c},hg.max=function(a,b){var c,d,e=-1,f=a.length;if(1===arguments.length){for(;++e<f;)if(null!=(d=a[e])&&d>=d){c=d;break}for(;++e<f;)null!=(d=a[e])&&d>c&&(c=d)}else{for(;++e<f;)if(null!=(d=b.call(a,a[e],e))&&d>=d){c=d;break}for(;++e<f;)null!=(d=b.call(a,a[e],e))&&d>c&&(c=d)}return c},hg.extent=function(a,b){var c,d,e,f=-1,g=a.length;if(1===arguments.length){for(;++f<g;)if(null!=(d=a[f])&&d>=d){c=e=d;break}for(;++f<g;)null!=(d=a[f])&&(c>d&&(c=d),d>e&&(e=d))}else{for(;++f<g;)if(null!=(d=b.call(a,a[f],f))&&d>=d){c=e=d;break}for(;++f<g;)null!=(d=b.call(a,a[f],f))&&(c>d&&(c=d),d>e&&(e=d))}return[c,e]},hg.sum=function(a,b){var c,d=0,f=a.length,g=-1;if(1===arguments.length)for(;++g<f;)e(c=+a[g])&&(d+=c);else for(;++g<f;)e(c=+b.call(a,a[g],g))&&(d+=c);return d},hg.mean=function(a,b){var c,f=0,g=a.length,h=-1,i=g;if(1===arguments.length)for(;++h<g;)e(c=d(a[h]))?f+=c:--i;else for(;++h<g;)e(c=d(b.call(a,a[h],h)))?f+=c:--i;return i?f/i:void 0},hg.quantile=function(a,b){var c=(a.length-1)*b+1,d=Math.floor(c),e=+a[d-1],f=c-d;return f?e+f*(a[d]-e):e},hg.median=function(a,b){var f,g=[],h=a.length,i=-1;if(1===arguments.length)for(;++i<h;)e(f=d(a[i]))&&g.push(f);else for(;++i<h;)e(f=d(b.call(a,a[i],i)))&&g.push(f);return g.length?hg.quantile(g.sort(c),.5):void 0},hg.variance=function(a,b){var c,f,g=a.length,h=0,i=0,j=-1,k=0;if(1===arguments.length)for(;++j<g;)e(c=d(a[j]))&&(f=c-h,h+=f/++k,i+=f*(c-h));else for(;++j<g;)e(c=d(b.call(a,a[j],j)))&&(f=c-h,h+=f/++k,i+=f*(c-h));return k>1?i/(k-1):void 0},hg.deviation=function(){var a=hg.variance.apply(this,arguments);return a?Math.sqrt(a):a};var sg=f(c);hg.bisectLeft=sg.left,hg.bisect=hg.bisectRight=sg.right,hg.bisector=function(a){return f(1===a.length?function(b,d){return c(a(b),d)}:a)},hg.shuffle=function(a,b,c){(f=arguments.length)<3&&(c=a.length,2>f&&(b=0));for(var d,e,f=c-b;f;)e=Math.random()*f--|0,d=a[f+b],a[f+b]=a[e+b],a[e+b]=d;return a},hg.permute=function(a,b){for(var c=b.length,d=new Array(c);c--;)d[c]=a[b[c]];return d},hg.pairs=function(a){for(var b,c=0,d=a.length-1,e=a[0],f=new Array(0>d?0:d);d>c;)f[c]=[b=e,e=a[++c]];return f},hg.transpose=function(a){if(!(e=a.length))return[];for(var b=-1,c=hg.min(a,g),d=new Array(c);++b<c;)for(var e,f=-1,h=d[b]=new Array(e);++f<e;)h[f]=a[f][b];return d},hg.zip=function(){return hg.transpose(arguments)},hg.keys=function(a){var b=[];for(var c in a)b.push(c);return b},hg.values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},hg.entries=function(a){var b=[];for(var c in a)b.push({key:c,value:a[c]});return b},hg.merge=function(a){for(var b,c,d,e=a.length,f=-1,g=0;++f<e;)g+=a[f].length;for(c=new Array(g);--e>=0;)for(d=a[e],b=d.length;--b>=0;)c[--g]=d[b];return c};var tg=Math.abs;hg.range=function(a,b,c){if(arguments.length<3&&(c=1,arguments.length<2&&(b=a,a=0)),(b-a)/c===1/0)throw new Error("infinite range");var d,e=[],f=h(tg(c)),g=-1;if(a*=f,b*=f,c*=f,0>c)for(;(d=a+c*++g)>b;)e.push(d/f);else for(;(d=a+c*++g)<b;)e.push(d/f);return e},hg.map=function(a,b){var c=new j;if(a instanceof j)a.forEach(function(a,b){c.set(a,b)});else if(Array.isArray(a)){var d,e=-1,f=a.length;if(1===arguments.length)for(;++e<f;)c.set(e,a[e]);else for(;++e<f;)c.set(b.call(a,d=a[e],e),d)}else for(var g in a)c.set(g,a[g]);return c};var ug="__proto__",vg="\x00";i(j,{has:m,get:function(a){return this._[k(a)]},set:function(a,b){return this._[k(a)]=b},remove:n,keys:o,values:function(){var a=[];for(var b in this._)a.push(this._[b]);return a},entries:function(){var a=[];for(var b in this._)a.push({key:l(b),value:this._[b]});return a},size:p,empty:q,forEach:function(a){for(var b in this._)a.call(this,l(b),this._[b])}}),hg.nest=function(){function a(b,g,h){if(h>=f.length)return d?d.call(e,g):c?g.sort(c):g;for(var i,k,l,m,n=-1,o=g.length,p=f[h++],q=new j;++n<o;)(m=q.get(i=p(k=g[n])))?m.push(k):q.set(i,[k]);return b?(k=b(),l=function(c,d){k.set(c,a(b,d,h))}):(k={},l=function(c,d){k[c]=a(b,d,h)}),q.forEach(l),k}function b(a,c){if(c>=f.length)return a;var d=[],e=g[c++];return a.forEach(function(a,e){d.push({key:a,values:b(e,c)})}),e?d.sort(function(a,b){return e(a.key,b.key)}):d}var c,d,e={},f=[],g=[];return e.map=function(b,c){return a(c,b,0)},e.entries=function(c){return b(a(hg.map,c,0),0)},e.key=function(a){return f.push(a),e},e.sortKeys=function(a){return g[f.length-1]=a,e},e.sortValues=function(a){return c=a,e},e.rollup=function(a){return d=a,e},e},hg.set=function(a){var b=new r;if(a)for(var c=0,d=a.length;d>c;++c)b.add(a[c]);return b},i(r,{has:m,add:function(a){return this._[k(a+="")]=!0,a},remove:n,values:o,size:p,empty:q,forEach:function(a){for(var b in this._)a.call(this,l(b))}}),hg.behavior={},hg.rebind=function(a,b){for(var c,d=1,e=arguments.length;++d<e;)a[c=arguments[d]]=t(a,b,b[c]);return a};var wg=["webkit","ms","moz","Moz","o","O"];hg.dispatch=function(){for(var a=new w,b=-1,c=arguments.length;++b<c;)a[arguments[b]]=x(a);return a},w.prototype.on=function(a,b){var c=a.indexOf("."),d="";if(c>=0&&(d=a.slice(c+1),a=a.slice(0,c)),a)return arguments.length<2?this[a].on(d):this[a].on(d,b);if(2===arguments.length){if(null==b)for(a in this)this.hasOwnProperty(a)&&this[a].on(d,null);return this}},hg.event=null,hg.requote=function(a){return a.replace(xg,"\\$&")};var xg=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,yg={}.__proto__?function(a,b){a.__proto__=b}:function(a,b){for(var c in b)a[c]=b[c]},zg=function(a,b){return b.querySelector(a)},Ag=function(a,b){return b.querySelectorAll(a)},Bg=function(a,b){var c=a.matches||a[u(a,"matchesSelector")];return(Bg=function(a,b){return c.call(a,b)})(a,b)};"function"==typeof Sizzle&&(zg=function(a,b){return Sizzle(a,b)[0]||null},Ag=Sizzle,Bg=Sizzle.matchesSelector),hg.selection=function(){return hg.select(kg.documentElement)};var Cg=hg.selection.prototype=[];Cg.select=function(a){var b,c,d,e,f=[];a=C(a);for(var g=-1,h=this.length;++g<h;){f.push(b=[]),b.parentNode=(d=this[g]).parentNode;for(var i=-1,j=d.length;++i<j;)(e=d[i])?(b.push(c=a.call(e,e.__data__,i,g)),c&&"__data__"in e&&(c.__data__=e.__data__)):b.push(null)}return B(f)},Cg.selectAll=function(a){var b,c,d=[];a=D(a);for(var e=-1,f=this.length;++e<f;)for(var g=this[e],h=-1,i=g.length;++h<i;)(c=g[h])&&(d.push(b=jg(a.call(c,c.__data__,h,e))),b.parentNode=c);return B(d)};var Dg="http://www.w3.org/1999/xhtml",Eg={svg:"http://www.w3.org/2000/svg",xhtml:Dg,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};hg.ns={prefix:Eg,qualify:function(a){var b=a.indexOf(":"),c=a;return b>=0&&"xmlns"!==(c=a.slice(0,b))&&(a=a.slice(b+1)),Eg.hasOwnProperty(c)?{space:Eg[c],local:a}:a}},Cg.attr=function(a,b){if(arguments.length<2){if("string"==typeof a){var c=this.node();return a=hg.ns.qualify(a),a.local?c.getAttributeNS(a.space,a.local):c.getAttribute(a)}for(b in a)this.each(E(b,a[b]));return this}return this.each(E(a,b))},Cg.classed=function(a,b){if(arguments.length<2){if("string"==typeof a){var c=this.node(),d=(a=H(a)).length,e=-1;if(b=c.classList){for(;++e<d;)if(!b.contains(a[e]))return!1}else for(b=c.getAttribute("class");++e<d;)if(!G(a[e]).test(b))return!1;return!0}for(b in a)this.each(I(b,a[b]));return this}return this.each(I(a,b))},Cg.style=function(a,c,d){var e=arguments.length;if(3>e){if("string"!=typeof a){2>e&&(c="");for(d in a)this.each(K(d,a[d],c));return this}if(2>e){var f=this.node();return b(f).getComputedStyle(f,null).getPropertyValue(a)}d=""}return this.each(K(a,c,d))},Cg.property=function(a,b){if(arguments.length<2){if("string"==typeof a)return this.node()[a];for(b in a)this.each(L(b,a[b]));return this}return this.each(L(a,b))},Cg.text=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.textContent=null==b?"":b}:null==a?function(){this.textContent=""}:function(){this.textContent=a}):this.node().textContent},Cg.html=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.innerHTML=null==b?"":b}:null==a?function(){this.innerHTML=""}:function(){this.innerHTML=a}):this.node().innerHTML},Cg.append=function(a){return a=M(a),this.select(function(){return this.appendChild(a.apply(this,arguments))})},Cg.insert=function(a,b){return a=M(a),b=C(b),this.select(function(){return this.insertBefore(a.apply(this,arguments),b.apply(this,arguments)||null)})},Cg.remove=function(){return this.each(N)},Cg.data=function(a,b){function c(a,c){var d,e,f,g=a.length,l=c.length,m=Math.min(g,l),n=new Array(l),o=new Array(l),p=new Array(g);if(b){var q,r=new j,s=new Array(g);for(d=-1;++d<g;)(e=a[d])&&(r.has(q=b.call(e,e.__data__,d))?p[d]=e:r.set(q,e),s[d]=q);for(d=-1;++d<l;)(e=r.get(q=b.call(c,f=c[d],d)))?e!==!0&&(n[d]=e,e.__data__=f):o[d]=O(f),r.set(q,!0);for(d=-1;++d<g;)d in s&&r.get(s[d])!==!0&&(p[d]=a[d])}else{for(d=-1;++d<m;)e=a[d],f=c[d],e?(e.__data__=f,n[d]=e):o[d]=O(f);for(;l>d;++d)o[d]=O(c[d]);for(;g>d;++d)p[d]=a[d]}o.update=n,o.parentNode=n.parentNode=p.parentNode=a.parentNode,h.push(o),i.push(n),k.push(p)}var d,e,f=-1,g=this.length;if(!arguments.length){for(a=new Array(g=(d=this[0]).length);++f<g;)(e=d[f])&&(a[f]=e.__data__);return a}var h=S([]),i=B([]),k=B([]);if("function"==typeof a)for(;++f<g;)c(d=this[f],a.call(d,d.parentNode.__data__,f));else for(;++f<g;)c(d=this[f],a);return i.enter=function(){return h},i.exit=function(){return k},i},Cg.datum=function(a){return arguments.length?this.property("__data__",a):this.property("__data__")},Cg.filter=function(a){var b,c,d,e=[];"function"!=typeof a&&(a=P(a));for(var f=0,g=this.length;g>f;f++){e.push(b=[]),b.parentNode=(c=this[f]).parentNode;for(var h=0,i=c.length;i>h;h++)(d=c[h])&&a.call(d,d.__data__,h,f)&&b.push(d)}return B(e)},Cg.order=function(){for(var a=-1,b=this.length;++a<b;)for(var c,d=this[a],e=d.length-1,f=d[e];--e>=0;)(c=d[e])&&(f&&f!==c.nextSibling&&f.parentNode.insertBefore(c,f),f=c);return this},Cg.sort=function(a){a=Q.apply(this,arguments);for(var b=-1,c=this.length;++b<c;)this[b].sort(a);return this.order()},Cg.each=function(a){return R(this,function(b,c,d){a.call(b,b.__data__,c,d)})},Cg.call=function(a){var b=jg(arguments);return a.apply(b[0]=this,b),this},Cg.empty=function(){return!this.node()},Cg.node=function(){for(var a=0,b=this.length;b>a;a++)for(var c=this[a],d=0,e=c.length;e>d;d++){var f=c[d];if(f)return f}return null},Cg.size=function(){var a=0;return R(this,function(){++a}),a};var Fg=[];hg.selection.enter=S,hg.selection.enter.prototype=Fg,Fg.append=Cg.append,Fg.empty=Cg.empty,Fg.node=Cg.node,Fg.call=Cg.call,Fg.size=Cg.size,Fg.select=function(a){for(var b,c,d,e,f,g=[],h=-1,i=this.length;++h<i;){d=(e=this[h]).update,g.push(b=[]),b.parentNode=e.parentNode;for(var j=-1,k=e.length;++j<k;)(f=e[j])?(b.push(d[j]=c=a.call(e.parentNode,f.__data__,j,h)),c.__data__=f.__data__):b.push(null)}return B(g)},Fg.insert=function(a,b){return arguments.length<2&&(b=T(this)),Cg.insert.call(this,a,b)},hg.select=function(b){var c;return"string"==typeof b?(c=[zg(b,kg)],c.parentNode=kg.documentElement):(c=[b],c.parentNode=a(b)),B([c])},hg.selectAll=function(a){var b;return"string"==typeof a?(b=jg(Ag(a,kg)),b.parentNode=kg.documentElement):(b=jg(a),b.parentNode=null),B([b])},Cg.on=function(a,b,c){var d=arguments.length;if(3>d){if("string"!=typeof a){2>d&&(b=!1);for(c in a)this.each(U(c,a[c],b));return this}if(2>d)return(d=this.node()["__on"+a])&&d._;c=!1}return this.each(U(a,b,c))};var Gg=hg.map({mouseenter:"mouseover",mouseleave:"mouseout"});kg&&Gg.forEach(function(a){"on"+a in kg&&Gg.remove(a)});var Hg,Ig=0;hg.mouse=function(a){return Y(a,z())};var Jg=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;hg.touch=function(a,b,c){if(arguments.length<3&&(c=b,b=z().changedTouches),b)for(var d,e=0,f=b.length;f>e;++e)if((d=b[e]).identifier===c)return Y(a,d)},hg.behavior.drag=function(){function a(){this.on("mousedown.drag",f).on("touchstart.drag",g)}function c(a,b,c,f,g){return function(){function h(){var a,c,d=b(m,p);d&&(a=d[0]-t[0],c=d[1]-t[1],o|=a|c,t=d,n({type:"drag",x:d[0]+j[0],y:d[1]+j[1],dx:a,dy:c}))}function i(){b(m,p)&&(r.on(f+q,null).on(g+q,null),s(o),n({type:"dragend"}))}var j,k=this,l=hg.event.target.correspondingElement||hg.event.target,m=k.parentNode,n=d.of(k,arguments),o=0,p=a(),q=".drag"+(null==p?"":"-"+p),r=hg.select(c(l)).on(f+q,h).on(g+q,i),s=X(l),t=b(m,p);e?(j=e.apply(k,arguments),j=[j.x-t[0],j.y-t[1]]):j=[0,0],n({type:"dragstart"})}}var d=A(a,"drag","dragstart","dragend"),e=null,f=c(v,hg.mouse,b,"mousemove","mouseup"),g=c(Z,hg.touch,s,"touchmove","touchend");return a.origin=function(b){return arguments.length?(e=b,a):e},hg.rebind(a,d,"on")},hg.touches=function(a,b){return arguments.length<2&&(b=z().touches),b?jg(b).map(function(b){var c=Y(a,b);return c.identifier=b.identifier,c}):[]};var Kg=1e-6,Lg=Kg*Kg,Mg=Math.PI,Ng=2*Mg,Og=Ng-Kg,Pg=Mg/2,Qg=Mg/180,Rg=180/Mg,Sg=Math.SQRT2,Tg=2,Ug=4;hg.interpolateZoom=function(a,b){var c,d,e=a[0],f=a[1],g=a[2],h=b[0],i=b[1],j=b[2],k=h-e,l=i-f,m=k*k+l*l;if(Lg>m)d=Math.log(j/g)/Sg,c=function(a){return[e+a*k,f+a*l,g*Math.exp(Sg*a*d)]};else{var n=Math.sqrt(m),o=(j*j-g*g+Ug*m)/(2*g*Tg*n),p=(j*j-g*g-Ug*m)/(2*j*Tg*n),q=Math.log(Math.sqrt(o*o+1)-o),r=Math.log(Math.sqrt(p*p+1)-p);d=(r-q)/Sg,c=function(a){var b=a*d,c=da(q),h=g/(Tg*n)*(c*ea(Sg*b+q)-ca(q));return[e+h*k,f+h*l,g*c/da(Sg*b+q)]}}return c.duration=1e3*d,c},hg.behavior.zoom=function(){function a(a){a.on(F,l).on(Wg+".zoom",n).on("dblclick.zoom",o).on(I,m)}function c(a){return[(a[0]-z.x)/z.k,(a[1]-z.y)/z.k]}function d(a){return[a[0]*z.k+z.x,a[1]*z.k+z.y]}function e(a){z.k=Math.max(C[0],Math.min(C[1],a))}function f(a,b){b=d(b),z.x+=a[0]-b[0],z.y+=a[1]-b[1]}function g(b,c,d,g){b.__chart__={x:z.x,y:z.y,k:z.k},e(Math.pow(2,g)),f(q=c,d),b=hg.select(b),D>0&&(b=b.transition().duration(D)),b.call(a.event)}function h(){v&&v.domain(u.range().map(function(a){return(a-z.x)/z.k}).map(u.invert)),x&&x.domain(w.range().map(function(a){return(a-z.y)/z.k}).map(w.invert))}function i(a){E++||a({type:"zoomstart"})}function j(a){h(),a({type:"zoom",scale:z.k,translate:[z.x,z.y]})}function k(a){--E||(a({type:"zoomend"}),q=null)}function l(){function a(){h=1,f(hg.mouse(e),m),j(g)}function d(){l.on(G,null).on(H,null),n(h),k(g)}var e=this,g=J.of(e,arguments),h=0,l=hg.select(b(e)).on(G,a).on(H,d),m=c(hg.mouse(e)),n=X(e);Pi.call(e),i(g)}function m(){function a(){var a=hg.touches(o);return n=z.k,a.forEach(function(a){a.identifier in q&&(q[a.identifier]=c(a))}),a}function b(){var b=hg.event.target;hg.select(b).on(u,d).on(v,h),w.push(b);for(var c=hg.event.changedTouches,e=0,f=c.length;f>e;++e)q[c[e].identifier]=null;var i=a(),j=Date.now();if(1===i.length){if(500>j-t){var k=i[0];g(o,k,q[k.identifier],Math.floor(Math.log(z.k)/Math.LN2)+1),y()}t=j}else if(i.length>1){var k=i[0],l=i[1],m=k[0]-l[0],n=k[1]-l[1];r=m*m+n*n}}function d(){var a,b,c,d,g=hg.touches(o);Pi.call(o);for(var h=0,i=g.length;i>h;++h,d=null)if(c=g[h],d=q[c.identifier]){if(b)break;a=c,b=d}if(d){var k=(k=c[0]-a[0])*k+(k=c[1]-a[1])*k,l=r&&Math.sqrt(k/r);a=[(a[0]+c[0])/2,(a[1]+c[1])/2],b=[(b[0]+d[0])/2,(b[1]+d[1])/2],e(l*n)}t=null,f(a,b),j(p)}function h(){if(hg.event.touches.length){for(var b=hg.event.changedTouches,c=0,d=b.length;d>c;++c)delete q[b[c].identifier];for(var e in q)return void a()}hg.selectAll(w).on(s,null),x.on(F,l).on(I,m),A(),k(p)}var n,o=this,p=J.of(o,arguments),q={},r=0,s=".zoom-"+hg.event.changedTouches[0].identifier,u="touchmove"+s,v="touchend"+s,w=[],x=hg.select(o),A=X(o);b(),i(p),x.on(F,null).on(I,b)}function n(){var a=J.of(this,arguments);s?clearTimeout(s):(Pi.call(this),p=c(q=r||hg.mouse(this)),i(a)),s=setTimeout(function(){s=null,k(a)},50),y(),e(Math.pow(2,.002*Vg())*z.k),f(q,p),j(a)}function o(){var a=hg.mouse(this),b=Math.log(z.k)/Math.LN2;g(this,a,c(a),hg.event.shiftKey?Math.ceil(b)-1:Math.floor(b)+1)}var p,q,r,s,t,u,v,w,x,z={x:0,y:0,k:1},B=[960,500],C=Xg,D=250,E=0,F="mousedown.zoom",G="mousemove.zoom",H="mouseup.zoom",I="touchstart.zoom",J=A(a,"zoomstart","zoom","zoomend");return Wg||(Wg="onwheel"in kg?(Vg=function(){return-hg.event.deltaY*(hg.event.deltaMode?120:1)},"wheel"):"onmousewheel"in kg?(Vg=function(){return hg.event.wheelDelta},"mousewheel"):(Vg=function(){return-hg.event.detail},"MozMousePixelScroll")),a.event=function(a){a.each(function(){var a=J.of(this,arguments),b=z;Ni?hg.select(this).transition().each("start.zoom",function(){z=this.__chart__||{x:0,y:0,k:1},i(a)}).tween("zoom:zoom",function(){var c=B[0],d=B[1],e=q?q[0]:c/2,f=q?q[1]:d/2,g=hg.interpolateZoom([(e-z.x)/z.k,(f-z.y)/z.k,c/z.k],[(e-b.x)/b.k,(f-b.y)/b.k,c/b.k]);return function(b){var d=g(b),h=c/d[2];this.__chart__=z={x:e-d[0]*h,y:f-d[1]*h,k:h},j(a)}}).each("interrupt.zoom",function(){k(a)}).each("end.zoom",function(){k(a)}):(this.__chart__=z,i(a),j(a),k(a))})},a.translate=function(b){return arguments.length?(z={x:+b[0],y:+b[1],k:z.k},h(),a):[z.x,z.y]},a.scale=function(b){return arguments.length?(z={x:z.x,y:z.y,k:null},e(+b),h(),a):z.k},a.scaleExtent=function(b){return arguments.length?(C=null==b?Xg:[+b[0],+b[1]],a):C},a.center=function(b){return arguments.length?(r=b&&[+b[0],+b[1]],a):r},a.size=function(b){return arguments.length?(B=b&&[+b[0],+b[1]],a):B},a.duration=function(b){return arguments.length?(D=+b,a):D},a.x=function(b){return arguments.length?(v=b,u=b.copy(),z={x:0,y:0,k:1},a):v},a.y=function(b){return arguments.length?(x=b,w=b.copy(),z={x:0,y:0,k:1},a):x},hg.rebind(a,J,"on")};var Vg,Wg,Xg=[0,1/0];hg.color=ga,ga.prototype.toString=function(){return this.rgb()+""},hg.hsl=ha;var Yg=ha.prototype=new ga;Yg.brighter=function(a){return a=Math.pow(.7,arguments.length?a:1),new ha(this.h,this.s,this.l/a)},Yg.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),new ha(this.h,this.s,a*this.l)},Yg.rgb=function(){return ia(this.h,this.s,this.l)},hg.hcl=ja;var Zg=ja.prototype=new ga;Zg.brighter=function(a){return new ja(this.h,this.c,Math.min(100,this.l+$g*(arguments.length?a:1)))},Zg.darker=function(a){return new ja(this.h,this.c,Math.max(0,this.l-$g*(arguments.length?a:1)))},Zg.rgb=function(){return ka(this.h,this.c,this.l).rgb()},hg.lab=la;var $g=18,_g=.95047,ah=1,bh=1.08883,ch=la.prototype=new ga;ch.brighter=function(a){return new la(Math.min(100,this.l+$g*(arguments.length?a:1)),this.a,this.b)},ch.darker=function(a){return new la(Math.max(0,this.l-$g*(arguments.length?a:1)),this.a,this.b)},ch.rgb=function(){return ma(this.l,this.a,this.b)},hg.rgb=ra;var dh=ra.prototype=new ga;dh.brighter=function(a){a=Math.pow(.7,arguments.length?a:1);var b=this.r,c=this.g,d=this.b,e=30;return b||c||d?(b&&e>b&&(b=e),c&&e>c&&(c=e),d&&e>d&&(d=e),new ra(Math.min(255,b/a),Math.min(255,c/a),Math.min(255,d/a))):new ra(e,e,e)},dh.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),new ra(a*this.r,a*this.g,a*this.b)},dh.hsl=function(){return wa(this.r,this.g,this.b)},dh.toString=function(){return"#"+ua(this.r)+ua(this.g)+ua(this.b)};var eh=hg.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});eh.forEach(function(a,b){eh.set(a,sa(b))}),hg.functor=Aa,hg.xhr=Ba(s),hg.dsv=function(a,b){function c(a,c,f){arguments.length<3&&(f=c,c=null);var g=Ca(a,b,null==c?d:e(c),f);return g.row=function(a){return arguments.length?g.response(null==(c=a)?d:e(a)):c},g}function d(a){return c.parse(a.responseText)}function e(a){return function(b){return c.parse(b.responseText,a)}}function f(b){return b.map(g).join(a)}function g(a){return h.test(a)?'"'+a.replace(/\"/g,'""')+'"':a}var h=new RegExp('["'+a+"\n]"),i=a.charCodeAt(0);return c.parse=function(a,b){var d;return c.parseRows(a,function(a,c){if(d)return d(a,c-1);var e=new Function("d","return {"+a.map(function(a,b){return JSON.stringify(a)+": d["+b+"]"}).join(",")+"}");d=b?function(a,c){return b(e(a),c)}:e})},c.parseRows=function(a,b){function c(){if(k>=j)return g;if(e)return e=!1,f;var b=k;if(34===a.charCodeAt(b)){for(var c=b;c++<j;)if(34===a.charCodeAt(c)){if(34!==a.charCodeAt(c+1))break;++c}k=c+2;var d=a.charCodeAt(c+1);return 13===d?(e=!0,10===a.charCodeAt(c+2)&&++k):10===d&&(e=!0),a.slice(b+1,c).replace(/""/g,'"')}for(;j>k;){var d=a.charCodeAt(k++),h=1;if(10===d)e=!0;else if(13===d)e=!0,10===a.charCodeAt(k)&&(++k,++h);else if(d!==i)continue;return a.slice(b,k-h)}return a.slice(b)}for(var d,e,f={},g={},h=[],j=a.length,k=0,l=0;(d=c())!==g;){for(var m=[];d!==f&&d!==g;)m.push(d),d=c();b&&null==(m=b(m,l++))||h.push(m)}return h},c.format=function(b){if(Array.isArray(b[0]))return c.formatRows(b);var d=new r,e=[];return b.forEach(function(a){for(var b in a)d.has(b)||e.push(d.add(b))}),[e.map(g).join(a)].concat(b.map(function(b){return e.map(function(a){return g(b[a])}).join(a)})).join("\n")},c.formatRows=function(a){return a.map(f).join("\n")},c},hg.csv=hg.dsv(",","text/csv"),hg.tsv=hg.dsv("	","text/tab-separated-values");var fh,gh,hh,ih,jh=this[u(this,"requestAnimationFrame")]||function(a){setTimeout(a,17)};hg.timer=function(){Fa.apply(this,arguments)},hg.timer.flush=function(){Ha(),Ia()},hg.round=function(a,b){return b?Math.round(a*(b=Math.pow(10,b)))/b:Math.round(a)};var kh=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(Ka);hg.formatPrefix=function(a,b){var c=0;return(a=+a)&&(0>a&&(a*=-1),b&&(a=hg.round(a,Ja(a,b))),c=1+Math.floor(1e-12+Math.log(a)/Math.LN10),c=Math.max(-24,Math.min(24,3*Math.floor((c-1)/3)))),kh[8+c/3]};var lh=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,mh=hg.map({b:function(a){return a.toString(2)},c:function(a){return String.fromCharCode(a)},o:function(a){return a.toString(8)},x:function(a){return a.toString(16)},X:function(a){return a.toString(16).toUpperCase()},g:function(a,b){return a.toPrecision(b)},e:function(a,b){return a.toExponential(b)},f:function(a,b){return a.toFixed(b)},r:function(a,b){return(a=hg.round(a,Ja(a,b))).toFixed(Math.max(0,Math.min(20,Ja(a*(1+1e-15),b))))}}),nh=hg.time={},oh=Date;Na.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){ph.setUTCDate.apply(this._,arguments)},setDay:function(){ph.setUTCDay.apply(this._,arguments)},setFullYear:function(){ph.setUTCFullYear.apply(this._,arguments)},setHours:function(){ph.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){ph.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){ph.setUTCMinutes.apply(this._,arguments)},setMonth:function(){ph.setUTCMonth.apply(this._,arguments)},setSeconds:function(){ph.setUTCSeconds.apply(this._,arguments)},setTime:function(){ph.setTime.apply(this._,arguments)}};var ph=Date.prototype;nh.year=Oa(function(a){return a=nh.day(a),a.setMonth(0,1),a},function(a,b){a.setFullYear(a.getFullYear()+b)},function(a){return a.getFullYear()}),nh.years=nh.year.range,nh.years.utc=nh.year.utc.range,nh.day=Oa(function(a){var b=new oh(2e3,0);return b.setFullYear(a.getFullYear(),a.getMonth(),a.getDate()),b},function(a,b){a.setDate(a.getDate()+b)},function(a){return a.getDate()-1}),nh.days=nh.day.range,nh.days.utc=nh.day.utc.range,nh.dayOfYear=function(a){var b=nh.year(a);return Math.floor((a-b-6e4*(a.getTimezoneOffset()-b.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(a,b){b=7-b;var c=nh[a]=Oa(function(a){return(a=nh.day(a)).setDate(a.getDate()-(a.getDay()+b)%7),a},function(a,b){a.setDate(a.getDate()+7*Math.floor(b))},function(a){var c=nh.year(a).getDay();return Math.floor((nh.dayOfYear(a)+(c+b)%7)/7)-(c!==b)});nh[a+"s"]=c.range,nh[a+"s"].utc=c.utc.range,nh[a+"OfYear"]=function(a){var c=nh.year(a).getDay();return Math.floor((nh.dayOfYear(a)+(c+b)%7)/7)}}),nh.week=nh.sunday,nh.weeks=nh.sunday.range,nh.weeks.utc=nh.sunday.utc.range,nh.weekOfYear=nh.sundayOfYear;var qh={"-":"",_:" ",0:"0"},rh=/^\s*\d+/,sh=/^%/;hg.locale=function(a){return{numberFormat:La(a),timeFormat:Qa(a)}};var th=hg.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],
shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});hg.format=th.numberFormat,hg.geo={},jb.prototype={s:0,t:0,add:function(a){kb(a,this.t,uh),kb(uh.s,this.s,this),this.s?this.t+=uh.t:this.s=uh.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var uh=new jb;hg.geo.stream=function(a,b){a&&vh.hasOwnProperty(a.type)?vh[a.type](a,b):lb(a,b)};var vh={Feature:function(a,b){lb(a.geometry,b)},FeatureCollection:function(a,b){for(var c=a.features,d=-1,e=c.length;++d<e;)lb(c[d].geometry,b)}},wh={Sphere:function(a,b){b.sphere()},Point:function(a,b){a=a.coordinates,b.point(a[0],a[1],a[2])},MultiPoint:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)a=c[d],b.point(a[0],a[1],a[2])},LineString:function(a,b){mb(a.coordinates,b,0)},MultiLineString:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)mb(c[d],b,0)},Polygon:function(a,b){nb(a.coordinates,b)},MultiPolygon:function(a,b){for(var c=a.coordinates,d=-1,e=c.length;++d<e;)nb(c[d],b)},GeometryCollection:function(a,b){for(var c=a.geometries,d=-1,e=c.length;++d<e;)lb(c[d],b)}};hg.geo.area=function(a){return xh=0,hg.geo.stream(a,zh),xh};var xh,yh=new jb,zh={sphere:function(){xh+=4*Mg},point:v,lineStart:v,lineEnd:v,polygonStart:function(){yh.reset(),zh.lineStart=ob},polygonEnd:function(){var a=2*yh;xh+=0>a?4*Mg+a:a,zh.lineStart=zh.lineEnd=zh.point=v}};hg.geo.bounds=function(){function a(a,b){t.push(u=[k=a,m=a]),l>b&&(l=b),b>n&&(n=b)}function b(b,c){var d=pb([b*Qg,c*Qg]);if(r){var e=rb(r,d),f=[e[1],-e[0],0],g=rb(f,e);ub(g),g=vb(g);var i=b-o,j=i>0?1:-1,p=g[0]*Rg*j,q=tg(i)>180;if(q^(p>j*o&&j*b>p)){var s=g[1]*Rg;s>n&&(n=s)}else if(p=(p+360)%360-180,q^(p>j*o&&j*b>p)){var s=-g[1]*Rg;l>s&&(l=s)}else l>c&&(l=c),c>n&&(n=c);q?o>b?h(k,b)>h(k,m)&&(m=b):h(b,m)>h(k,m)&&(k=b):m>=k?(k>b&&(k=b),b>m&&(m=b)):b>o?h(k,b)>h(k,m)&&(m=b):h(b,m)>h(k,m)&&(k=b)}else a(b,c);r=d,o=b}function c(){v.point=b}function d(){u[0]=k,u[1]=m,v.point=a,r=null}function e(a,c){if(r){var d=a-o;s+=tg(d)>180?d+(d>0?360:-360):d}else p=a,q=c;zh.point(a,c),b(a,c)}function f(){zh.lineStart()}function g(){e(p,q),zh.lineEnd(),tg(s)>Kg&&(k=-(m=180)),u[0]=k,u[1]=m,r=null}function h(a,b){return(b-=a)<0?b+360:b}function i(a,b){return a[0]-b[0]}function j(a,b){return b[0]<=b[1]?b[0]<=a&&a<=b[1]:a<b[0]||b[1]<a}var k,l,m,n,o,p,q,r,s,t,u,v={point:a,lineStart:c,lineEnd:d,polygonStart:function(){v.point=e,v.lineStart=f,v.lineEnd=g,s=0,zh.polygonStart()},polygonEnd:function(){zh.polygonEnd(),v.point=a,v.lineStart=c,v.lineEnd=d,0>yh?(k=-(m=180),l=-(n=90)):s>Kg?n=90:-Kg>s&&(l=-90),u[0]=k,u[1]=m}};return function(a){n=m=-(k=l=1/0),t=[],hg.geo.stream(a,v);var b=t.length;if(b){t.sort(i);for(var c,d=1,e=t[0],f=[e];b>d;++d)c=t[d],j(c[0],e)||j(c[1],e)?(h(e[0],c[1])>h(e[0],e[1])&&(e[1]=c[1]),h(c[0],e[1])>h(e[0],e[1])&&(e[0]=c[0])):f.push(e=c);for(var g,c,o=-(1/0),b=f.length-1,d=0,e=f[b];b>=d;e=c,++d)c=f[d],(g=h(e[1],c[0]))>o&&(o=g,k=c[0],m=e[1])}return t=u=null,k===1/0||l===1/0?[[NaN,NaN],[NaN,NaN]]:[[k,l],[m,n]]}}(),hg.geo.centroid=function(a){Ah=Bh=Ch=Dh=Eh=Fh=Gh=Hh=Ih=Jh=Kh=0,hg.geo.stream(a,Lh);var b=Ih,c=Jh,d=Kh,e=b*b+c*c+d*d;return Lg>e&&(b=Fh,c=Gh,d=Hh,Kg>Bh&&(b=Ch,c=Dh,d=Eh),e=b*b+c*c+d*d,Lg>e)?[NaN,NaN]:[Math.atan2(c,b)*Rg,ba(d/Math.sqrt(e))*Rg]};var Ah,Bh,Ch,Dh,Eh,Fh,Gh,Hh,Ih,Jh,Kh,Lh={sphere:v,point:xb,lineStart:zb,lineEnd:Ab,polygonStart:function(){Lh.lineStart=Bb},polygonEnd:function(){Lh.lineStart=zb}},Mh=Hb(Db,Lb,Nb,[-Mg,-Mg/2]),Nh=1e9;hg.geo.clipExtent=function(){var a,b,c,d,e,f,g={stream:function(a){return e&&(e.valid=!1),e=f(a),e.valid=!0,e},extent:function(h){return arguments.length?(f=Rb(a=+h[0][0],b=+h[0][1],c=+h[1][0],d=+h[1][1]),e&&(e.valid=!1,e=null),g):[[a,b],[c,d]]}};return g.extent([[0,0],[960,500]])},(hg.geo.conicEqualArea=function(){return Sb(Tb)}).raw=Tb,hg.geo.albers=function(){return hg.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},hg.geo.albersUsa=function(){function a(a){var f=a[0],g=a[1];return b=null,c(f,g),b||(d(f,g),b)||e(f,g),b}var b,c,d,e,f=hg.geo.albers(),g=hg.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),h=hg.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),i={point:function(a,c){b=[a,c]}};return a.invert=function(a){var b=f.scale(),c=f.translate(),d=(a[0]-c[0])/b,e=(a[1]-c[1])/b;return(e>=.12&&.234>e&&d>=-.425&&-.214>d?g:e>=.166&&.234>e&&d>=-.214&&-.115>d?h:f).invert(a)},a.stream=function(a){var b=f.stream(a),c=g.stream(a),d=h.stream(a);return{point:function(a,e){b.point(a,e),c.point(a,e),d.point(a,e)},sphere:function(){b.sphere(),c.sphere(),d.sphere()},lineStart:function(){b.lineStart(),c.lineStart(),d.lineStart()},lineEnd:function(){b.lineEnd(),c.lineEnd(),d.lineEnd()},polygonStart:function(){b.polygonStart(),c.polygonStart(),d.polygonStart()},polygonEnd:function(){b.polygonEnd(),c.polygonEnd(),d.polygonEnd()}}},a.precision=function(b){return arguments.length?(f.precision(b),g.precision(b),h.precision(b),a):f.precision()},a.scale=function(b){return arguments.length?(f.scale(b),g.scale(.35*b),h.scale(b),a.translate(f.translate())):f.scale()},a.translate=function(b){if(!arguments.length)return f.translate();var j=f.scale(),k=+b[0],l=+b[1];return c=f.translate(b).clipExtent([[k-.455*j,l-.238*j],[k+.455*j,l+.238*j]]).stream(i).point,d=g.translate([k-.307*j,l+.201*j]).clipExtent([[k-.425*j+Kg,l+.12*j+Kg],[k-.214*j-Kg,l+.234*j-Kg]]).stream(i).point,e=h.translate([k-.205*j,l+.212*j]).clipExtent([[k-.214*j+Kg,l+.166*j+Kg],[k-.115*j-Kg,l+.234*j-Kg]]).stream(i).point,a},a.scale(1070)};var Oh,Ph,Qh,Rh,Sh,Th,Uh={point:v,lineStart:v,lineEnd:v,polygonStart:function(){Ph=0,Uh.lineStart=Ub},polygonEnd:function(){Uh.lineStart=Uh.lineEnd=Uh.point=v,Oh+=tg(Ph/2)}},Vh={point:Vb,lineStart:v,lineEnd:v,polygonStart:v,polygonEnd:v},Wh={point:Yb,lineStart:Zb,lineEnd:$b,polygonStart:function(){Wh.lineStart=_b},polygonEnd:function(){Wh.point=Yb,Wh.lineStart=Zb,Wh.lineEnd=$b}};hg.geo.path=function(){function a(a){return a&&("function"==typeof h&&f.pointRadius(+h.apply(this,arguments)),g&&g.valid||(g=e(f)),hg.geo.stream(a,g)),f.result()}function b(){return g=null,a}var c,d,e,f,g,h=4.5;return a.area=function(a){return Oh=0,hg.geo.stream(a,e(Uh)),Oh},a.centroid=function(a){return Ch=Dh=Eh=Fh=Gh=Hh=Ih=Jh=Kh=0,hg.geo.stream(a,e(Wh)),Kh?[Ih/Kh,Jh/Kh]:Hh?[Fh/Hh,Gh/Hh]:Eh?[Ch/Eh,Dh/Eh]:[NaN,NaN]},a.bounds=function(a){return Sh=Th=-(Qh=Rh=1/0),hg.geo.stream(a,e(Vh)),[[Qh,Rh],[Sh,Th]]},a.projection=function(a){return arguments.length?(e=(c=a)?a.stream||cc(a):s,b()):c},a.context=function(a){return arguments.length?(f=null==(d=a)?new Wb:new ac(a),"function"!=typeof h&&f.pointRadius(h),b()):d},a.pointRadius=function(b){return arguments.length?(h="function"==typeof b?b:(f.pointRadius(+b),+b),a):h},a.projection(hg.geo.albersUsa()).context(null)},hg.geo.transform=function(a){return{stream:function(b){var c=new dc(b);for(var d in a)c[d]=a[d];return c}}},dc.prototype={point:function(a,b){this.stream.point(a,b)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},hg.geo.projection=fc,hg.geo.projectionMutator=gc,(hg.geo.equirectangular=function(){return fc(ic)}).raw=ic.invert=ic,hg.geo.rotation=function(a){function b(b){return b=a(b[0]*Qg,b[1]*Qg),b[0]*=Rg,b[1]*=Rg,b}return a=kc(a[0]%360*Qg,a[1]*Qg,a.length>2?a[2]*Qg:0),b.invert=function(b){return b=a.invert(b[0]*Qg,b[1]*Qg),b[0]*=Rg,b[1]*=Rg,b},b},jc.invert=ic,hg.geo.circle=function(){function a(){var a="function"==typeof d?d.apply(this,arguments):d,b=kc(-a[0]*Qg,-a[1]*Qg,0).invert,e=[];return c(null,null,1,{point:function(a,c){e.push(a=b(a,c)),a[0]*=Rg,a[1]*=Rg}}),{type:"Polygon",coordinates:[e]}}var b,c,d=[0,0],e=6;return a.origin=function(b){return arguments.length?(d=b,a):d},a.angle=function(d){return arguments.length?(c=oc((b=+d)*Qg,e*Qg),a):b},a.precision=function(d){return arguments.length?(c=oc(b*Qg,(e=+d)*Qg),a):e},a.angle(90)},hg.geo.distance=function(a,b){var c,d=(b[0]-a[0])*Qg,e=a[1]*Qg,f=b[1]*Qg,g=Math.sin(d),h=Math.cos(d),i=Math.sin(e),j=Math.cos(e),k=Math.sin(f),l=Math.cos(f);return Math.atan2(Math.sqrt((c=l*g)*c+(c=j*k-i*l*h)*c),i*k+j*l*h)},hg.geo.graticule=function(){function a(){return{type:"MultiLineString",coordinates:b()}}function b(){return hg.range(Math.ceil(f/q)*q,e,q).map(m).concat(hg.range(Math.ceil(j/r)*r,i,r).map(n)).concat(hg.range(Math.ceil(d/o)*o,c,o).filter(function(a){return tg(a%q)>Kg}).map(k)).concat(hg.range(Math.ceil(h/p)*p,g,p).filter(function(a){return tg(a%r)>Kg}).map(l))}var c,d,e,f,g,h,i,j,k,l,m,n,o=10,p=o,q=90,r=360,s=2.5;return a.lines=function(){return b().map(function(a){return{type:"LineString",coordinates:a}})},a.outline=function(){return{type:"Polygon",coordinates:[m(f).concat(n(i).slice(1),m(e).reverse().slice(1),n(j).reverse().slice(1))]}},a.extent=function(b){return arguments.length?a.majorExtent(b).minorExtent(b):a.minorExtent()},a.majorExtent=function(b){return arguments.length?(f=+b[0][0],e=+b[1][0],j=+b[0][1],i=+b[1][1],f>e&&(b=f,f=e,e=b),j>i&&(b=j,j=i,i=b),a.precision(s)):[[f,j],[e,i]]},a.minorExtent=function(b){return arguments.length?(d=+b[0][0],c=+b[1][0],h=+b[0][1],g=+b[1][1],d>c&&(b=d,d=c,c=b),h>g&&(b=h,h=g,g=b),a.precision(s)):[[d,h],[c,g]]},a.step=function(b){return arguments.length?a.majorStep(b).minorStep(b):a.minorStep()},a.majorStep=function(b){return arguments.length?(q=+b[0],r=+b[1],a):[q,r]},a.minorStep=function(b){return arguments.length?(o=+b[0],p=+b[1],a):[o,p]},a.precision=function(b){return arguments.length?(s=+b,k=qc(h,g,90),l=rc(d,c,s),m=qc(j,i,90),n=rc(f,e,s),a):s},a.majorExtent([[-180,-90+Kg],[180,90-Kg]]).minorExtent([[-180,-80-Kg],[180,80+Kg]])},hg.geo.greatArc=function(){function a(){return{type:"LineString",coordinates:[b||d.apply(this,arguments),c||e.apply(this,arguments)]}}var b,c,d=sc,e=tc;return a.distance=function(){return hg.geo.distance(b||d.apply(this,arguments),c||e.apply(this,arguments))},a.source=function(c){return arguments.length?(d=c,b="function"==typeof c?null:c,a):d},a.target=function(b){return arguments.length?(e=b,c="function"==typeof b?null:b,a):e},a.precision=function(){return arguments.length?a:0},a},hg.geo.interpolate=function(a,b){return uc(a[0]*Qg,a[1]*Qg,b[0]*Qg,b[1]*Qg)},hg.geo.length=function(a){return Xh=0,hg.geo.stream(a,Yh),Xh};var Xh,Yh={sphere:v,point:v,lineStart:vc,lineEnd:v,polygonStart:v,polygonEnd:v},Zh=wc(function(a){return Math.sqrt(2/(1+a))},function(a){return 2*Math.asin(a/2)});(hg.geo.azimuthalEqualArea=function(){return fc(Zh)}).raw=Zh;var $h=wc(function(a){var b=Math.acos(a);return b&&b/Math.sin(b)},s);(hg.geo.azimuthalEquidistant=function(){return fc($h)}).raw=$h,(hg.geo.conicConformal=function(){return Sb(xc)}).raw=xc,(hg.geo.conicEquidistant=function(){return Sb(yc)}).raw=yc;var _h=wc(function(a){return 1/a},Math.atan);(hg.geo.gnomonic=function(){return fc(_h)}).raw=_h,zc.invert=function(a,b){return[a,2*Math.atan(Math.exp(b))-Pg]},(hg.geo.mercator=function(){return Ac(zc)}).raw=zc;var ai=wc(function(){return 1},Math.asin);(hg.geo.orthographic=function(){return fc(ai)}).raw=ai;var bi=wc(function(a){return 1/(1+a)},function(a){return 2*Math.atan(a)});(hg.geo.stereographic=function(){return fc(bi)}).raw=bi,Bc.invert=function(a,b){return[-b,2*Math.atan(Math.exp(a))-Pg]},(hg.geo.transverseMercator=function(){var a=Ac(Bc),b=a.center,c=a.rotate;return a.center=function(a){return a?b([-a[1],a[0]]):(a=b(),[a[1],-a[0]])},a.rotate=function(a){return a?c([a[0],a[1],a.length>2?a[2]+90:90]):(a=c(),[a[0],a[1],a[2]-90])},c([0,0,90])}).raw=Bc,hg.geom={},hg.geom.hull=function(a){function b(a){if(a.length<3)return[];var b,e=Aa(c),f=Aa(d),g=a.length,h=[],i=[];for(b=0;g>b;b++)h.push([+e.call(this,a[b],b),+f.call(this,a[b],b),b]);for(h.sort(Fc),b=0;g>b;b++)i.push([h[b][0],-h[b][1]]);var j=Ec(h),k=Ec(i),l=k[0]===j[0],m=k[k.length-1]===j[j.length-1],n=[];for(b=j.length-1;b>=0;--b)n.push(a[h[j[b]][2]]);for(b=+l;b<k.length-m;++b)n.push(a[h[k[b]][2]]);return n}var c=Cc,d=Dc;return arguments.length?b(a):(b.x=function(a){return arguments.length?(c=a,b):c},b.y=function(a){return arguments.length?(d=a,b):d},b)},hg.geom.polygon=function(a){return yg(a,ci),a};var ci=hg.geom.polygon.prototype=[];ci.area=function(){for(var a,b=-1,c=this.length,d=this[c-1],e=0;++b<c;)a=d,d=this[b],e+=a[1]*d[0]-a[0]*d[1];return.5*e},ci.centroid=function(a){var b,c,d=-1,e=this.length,f=0,g=0,h=this[e-1];for(arguments.length||(a=-1/(6*this.area()));++d<e;)b=h,h=this[d],c=b[0]*h[1]-h[0]*b[1],f+=(b[0]+h[0])*c,g+=(b[1]+h[1])*c;return[f*a,g*a]},ci.clip=function(a){for(var b,c,d,e,f,g,h=Ic(a),i=-1,j=this.length-Ic(this),k=this[j-1];++i<j;){for(b=a.slice(),a.length=0,e=this[i],f=b[(d=b.length-h)-1],c=-1;++c<d;)g=b[c],Gc(g,k,e)?(Gc(f,k,e)||a.push(Hc(f,g,k,e)),a.push(g)):Gc(f,k,e)&&a.push(Hc(f,g,k,e)),f=g;h&&a.push(a[0]),k=e}return a};var di,ei,fi,gi,hi,ii=[],ji=[];Qc.prototype.prepare=function(){for(var a,b=this.edges,c=b.length;c--;)a=b[c].edge,a.b&&a.a||b.splice(c,1);return b.sort(Sc),b.length},ad.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},bd.prototype={insert:function(a,b){var c,d,e;if(a){if(b.P=a,b.N=a.N,a.N&&(a.N.P=b),a.N=b,a.R){for(a=a.R;a.L;)a=a.L;a.L=b}else a.R=b;c=a}else this._?(a=fd(this._),b.P=null,b.N=a,a.P=a.L=b,c=a):(b.P=b.N=null,this._=b,c=null);for(b.L=b.R=null,b.U=c,b.C=!0,a=b;c&&c.C;)d=c.U,c===d.L?(e=d.R,e&&e.C?(c.C=e.C=!1,d.C=!0,a=d):(a===c.R&&(dd(this,c),a=c,c=a.U),c.C=!1,d.C=!0,ed(this,d))):(e=d.L,e&&e.C?(c.C=e.C=!1,d.C=!0,a=d):(a===c.L&&(ed(this,c),a=c,c=a.U),c.C=!1,d.C=!0,dd(this,d))),c=a.U;this._.C=!1},remove:function(a){a.N&&(a.N.P=a.P),a.P&&(a.P.N=a.N),a.N=a.P=null;var b,c,d,e=a.U,f=a.L,g=a.R;if(c=f?g?fd(g):f:g,e?e.L===a?e.L=c:e.R=c:this._=c,f&&g?(d=c.C,c.C=a.C,c.L=f,f.U=c,c!==g?(e=c.U,c.U=a.U,a=c.R,e.L=a,c.R=g,g.U=c):(c.U=e,e=c,a=c.R)):(d=a.C,a=c),a&&(a.U=e),!d){if(a&&a.C)return void(a.C=!1);do{if(a===this._)break;if(a===e.L){if(b=e.R,b.C&&(b.C=!1,e.C=!0,dd(this,e),b=e.R),b.L&&b.L.C||b.R&&b.R.C){b.R&&b.R.C||(b.L.C=!1,b.C=!0,ed(this,b),b=e.R),b.C=e.C,e.C=b.R.C=!1,dd(this,e),a=this._;break}}else if(b=e.L,b.C&&(b.C=!1,e.C=!0,ed(this,e),b=e.L),b.L&&b.L.C||b.R&&b.R.C){b.L&&b.L.C||(b.R.C=!1,b.C=!0,dd(this,b),b=e.L),b.C=e.C,e.C=b.L.C=!1,ed(this,e),a=this._;break}b.C=!0,a=e,e=e.U}while(!a.C);a&&(a.C=!1)}}},hg.geom.voronoi=function(a){function b(a){var b=new Array(a.length),d=h[0][0],e=h[0][1],f=h[1][0],g=h[1][1];return gd(c(a),h).cells.forEach(function(c,h){var i=c.edges,j=c.site,k=b[h]=i.length?i.map(function(a){var b=a.start();return[b.x,b.y]}):j.x>=d&&j.x<=f&&j.y>=e&&j.y<=g?[[d,g],[f,g],[f,e],[d,e]]:[];k.point=a[h]}),b}function c(a){return a.map(function(a,b){return{x:Math.round(f(a,b)/Kg)*Kg,y:Math.round(g(a,b)/Kg)*Kg,i:b}})}var d=Cc,e=Dc,f=d,g=e,h=ki;return a?b(a):(b.links=function(a){return gd(c(a)).edges.filter(function(a){return a.l&&a.r}).map(function(b){return{source:a[b.l.i],target:a[b.r.i]}})},b.triangles=function(a){var b=[];return gd(c(a)).cells.forEach(function(c,d){for(var e,f,g=c.site,h=c.edges.sort(Sc),i=-1,j=h.length,k=h[j-1].edge,l=k.l===g?k.r:k.l;++i<j;)e=k,f=l,k=h[i].edge,l=k.l===g?k.r:k.l,d<f.i&&d<l.i&&id(g,f,l)<0&&b.push([a[d],a[f.i],a[l.i]])}),b},b.x=function(a){return arguments.length?(f=Aa(d=a),b):d},b.y=function(a){return arguments.length?(g=Aa(e=a),b):e},b.clipExtent=function(a){return arguments.length?(h=null==a?ki:a,b):h===ki?null:h},b.size=function(a){return arguments.length?b.clipExtent(a&&[[0,0],a]):h===ki?null:h&&h[1]},b)};var ki=[[-1e6,-1e6],[1e6,1e6]];hg.geom.delaunay=function(a){return hg.geom.voronoi().triangles(a)},hg.geom.quadtree=function(a,b,c,d,e){function f(a){function f(a,b,c,d,e,f,g,h){if(!isNaN(c)&&!isNaN(d))if(a.leaf){var i=a.x,k=a.y;if(null!=i)if(tg(i-c)+tg(k-d)<.01)j(a,b,c,d,e,f,g,h);else{var l=a.point;a.x=a.y=a.point=null,j(a,l,i,k,e,f,g,h),j(a,b,c,d,e,f,g,h)}else a.x=c,a.y=d,a.point=b}else j(a,b,c,d,e,f,g,h)}function j(a,b,c,d,e,g,h,i){var j=.5*(e+h),k=.5*(g+i),l=c>=j,m=d>=k,n=m<<1|l;a.leaf=!1,a=a.nodes[n]||(a.nodes[n]=ld()),l?e=j:h=j,m?g=k:i=k,f(a,b,c,d,e,g,h,i)}var k,l,m,n,o,p,q,r,s,t=Aa(h),u=Aa(i);if(null!=b)p=b,q=c,r=d,s=e;else if(r=s=-(p=q=1/0),l=[],m=[],o=a.length,g)for(n=0;o>n;++n)k=a[n],k.x<p&&(p=k.x),k.y<q&&(q=k.y),k.x>r&&(r=k.x),k.y>s&&(s=k.y),l.push(k.x),m.push(k.y);else for(n=0;o>n;++n){var v=+t(k=a[n],n),w=+u(k,n);p>v&&(p=v),q>w&&(q=w),v>r&&(r=v),w>s&&(s=w),l.push(v),m.push(w)}var x=r-p,y=s-q;x>y?s=q+x:r=p+y;var z=ld();if(z.add=function(a){f(z,a,+t(a,++n),+u(a,n),p,q,r,s)},z.visit=function(a){md(a,z,p,q,r,s)},z.find=function(a){return nd(z,a[0],a[1],p,q,r,s)},n=-1,null==b){for(;++n<o;)f(z,a[n],l[n],m[n],p,q,r,s);--n}else a.forEach(z.add);return l=m=a=k=null,z}var g,h=Cc,i=Dc;return(g=arguments.length)?(h=jd,i=kd,3===g&&(e=c,d=b,c=b=0),f(a)):(f.x=function(a){return arguments.length?(h=a,f):h},f.y=function(a){return arguments.length?(i=a,f):i},f.extent=function(a){return arguments.length?(null==a?b=c=d=e=null:(b=+a[0][0],c=+a[0][1],d=+a[1][0],e=+a[1][1]),f):null==b?null:[[b,c],[d,e]]},f.size=function(a){return arguments.length?(null==a?b=c=d=e=null:(b=c=0,d=+a[0],e=+a[1]),f):null==b?null:[d-b,e-c]},f)},hg.interpolateRgb=od,hg.interpolateObject=pd,hg.interpolateNumber=qd,hg.interpolateString=rd;var li=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,mi=new RegExp(li.source,"g");hg.interpolate=sd,hg.interpolators=[function(a,b){var c=typeof b;return("string"===c?eh.has(b.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(b)?od:rd:b instanceof ga?od:Array.isArray(b)?td:"object"===c&&isNaN(b)?pd:qd)(a,b)}],hg.interpolateArray=td;var ni=function(){return s},oi=hg.map({linear:ni,poly:Ad,quad:function(){return xd},cubic:function(){return yd},sin:function(){return Bd},exp:function(){return Cd},circle:function(){return Dd},elastic:Ed,back:Fd,bounce:function(){return Gd}}),pi=hg.map({"in":s,out:vd,"in-out":wd,"out-in":function(a){return wd(vd(a))}});hg.ease=function(a){var b=a.indexOf("-"),c=b>=0?a.slice(0,b):a,d=b>=0?a.slice(b+1):"in";return c=oi.get(c)||ni,d=pi.get(d)||s,ud(d(c.apply(null,ig.call(arguments,1))))},hg.interpolateHcl=Hd,hg.interpolateHsl=Id,hg.interpolateLab=Jd,hg.interpolateRound=Kd,hg.transform=function(a){var b=kg.createElementNS(hg.ns.prefix.svg,"g");return(hg.transform=function(a){if(null!=a){b.setAttribute("transform",a);var c=b.transform.baseVal.consolidate()}return new Ld(c?c.matrix:qi)})(a)},Ld.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var qi={a:1,b:0,c:0,d:1,e:0,f:0};hg.interpolateTransform=Ud,hg.layout={},hg.layout.bundle=function(){return function(a){for(var b=[],c=-1,d=a.length;++c<d;)b.push(Xd(a[c]));return b}},hg.layout.chord=function(){function a(){var a,j,l,m,n,o={},p=[],q=hg.range(f),r=[];for(c=[],d=[],a=0,m=-1;++m<f;){for(j=0,n=-1;++n<f;)j+=e[m][n];p.push(j),r.push(hg.range(f)),a+=j}for(g&&q.sort(function(a,b){return g(p[a],p[b])}),h&&r.forEach(function(a,b){a.sort(function(a,c){return h(e[b][a],e[b][c])})}),a=(Ng-k*f)/a,j=0,m=-1;++m<f;){for(l=j,n=-1;++n<f;){var s=q[m],t=r[s][n],u=e[s][t],v=j,w=j+=u*a;o[s+"-"+t]={index:s,subindex:t,startAngle:v,endAngle:w,value:u}}d[s]={index:s,startAngle:l,endAngle:j,value:p[s]},j+=k}for(m=-1;++m<f;)for(n=m-1;++n<f;){var x=o[m+"-"+n],y=o[n+"-"+m];(x.value||y.value)&&c.push(x.value<y.value?{source:y,target:x}:{source:x,target:y})}i&&b()}function b(){c.sort(function(a,b){return i((a.source.value+a.target.value)/2,(b.source.value+b.target.value)/2)})}var c,d,e,f,g,h,i,j={},k=0;return j.matrix=function(a){return arguments.length?(f=(e=a)&&e.length,c=d=null,j):e},j.padding=function(a){return arguments.length?(k=a,c=d=null,j):k},j.sortGroups=function(a){return arguments.length?(g=a,c=d=null,j):g},j.sortSubgroups=function(a){return arguments.length?(h=a,c=null,j):h},j.sortChords=function(a){return arguments.length?(i=a,c&&b(),j):i},j.chords=function(){return c||a(),c},j.groups=function(){return d||a(),d},j},hg.layout.force=function(){function a(a){return function(b,c,d,e){if(b.point!==a){var f=b.cx-a.x,g=b.cy-a.y,h=e-c,i=f*f+g*g;if(i>h*h/r){if(p>i){var j=b.charge/i;a.px-=f*j,a.py-=g*j}return!0}if(b.point&&i&&p>i){var j=b.pointCharge/i;a.px-=f*j,a.py-=g*j}}return!b.charge}}function b(a){a.px=hg.event.x,a.py=hg.event.y,i.resume()}var c,d,e,f,g,h,i={},j=hg.dispatch("start","tick","end"),k=[1,1],l=.9,m=ri,n=si,o=-30,p=ti,q=.1,r=.64,t=[],u=[];return i.tick=function(){if((e*=.99)<.005)return c=null,j.end({type:"end",alpha:e=0}),!0;var b,d,i,m,n,p,r,s,v,w=t.length,x=u.length;for(d=0;x>d;++d)i=u[d],m=i.source,n=i.target,s=n.x-m.x,v=n.y-m.y,(p=s*s+v*v)&&(p=e*g[d]*((p=Math.sqrt(p))-f[d])/p,s*=p,v*=p,n.x-=s*(r=m.weight+n.weight?m.weight/(m.weight+n.weight):.5),n.y-=v*r,m.x+=s*(r=1-r),m.y+=v*r);if((r=e*q)&&(s=k[0]/2,v=k[1]/2,d=-1,r))for(;++d<w;)i=t[d],i.x+=(s-i.x)*r,i.y+=(v-i.y)*r;if(o)for(ce(b=hg.geom.quadtree(t),e,h),d=-1;++d<w;)(i=t[d]).fixed||b.visit(a(i));for(d=-1;++d<w;)i=t[d],i.fixed?(i.x=i.px,i.y=i.py):(i.x-=(i.px-(i.px=i.x))*l,i.y-=(i.py-(i.py=i.y))*l);j.tick({type:"tick",alpha:e})},i.nodes=function(a){return arguments.length?(t=a,i):t},i.links=function(a){return arguments.length?(u=a,i):u},i.size=function(a){return arguments.length?(k=a,i):k},i.linkDistance=function(a){return arguments.length?(m="function"==typeof a?a:+a,i):m},i.distance=i.linkDistance,i.linkStrength=function(a){return arguments.length?(n="function"==typeof a?a:+a,i):n},i.friction=function(a){return arguments.length?(l=+a,i):l},i.charge=function(a){return arguments.length?(o="function"==typeof a?a:+a,i):o},i.chargeDistance=function(a){return arguments.length?(p=a*a,i):Math.sqrt(p)},i.gravity=function(a){return arguments.length?(q=+a,i):q},i.theta=function(a){return arguments.length?(r=a*a,i):Math.sqrt(r)},i.alpha=function(a){return arguments.length?(a=+a,e?a>0?e=a:(c.c=null,c.t=NaN,c=null,j.end({type:"end",alpha:e=0})):a>0&&(j.start({type:"start",alpha:e=a}),c=Fa(i.tick)),i):e},i.start=function(){function a(a,d){if(!c){for(c=new Array(e),i=0;e>i;++i)c[i]=[];for(i=0;j>i;++i){var f=u[i];c[f.source.index].push(f.target),c[f.target.index].push(f.source)}}for(var g,h=c[b],i=-1,k=h.length;++i<k;)if(!isNaN(g=h[i][a]))return g;return Math.random()*d}var b,c,d,e=t.length,j=u.length,l=k[0],p=k[1];for(b=0;e>b;++b)(d=t[b]).index=b,d.weight=0;for(b=0;j>b;++b)d=u[b],"number"==typeof d.source&&(d.source=t[d.source]),"number"==typeof d.target&&(d.target=t[d.target]),++d.source.weight,++d.target.weight;for(b=0;e>b;++b)d=t[b],isNaN(d.x)&&(d.x=a("x",l)),isNaN(d.y)&&(d.y=a("y",p)),isNaN(d.px)&&(d.px=d.x),isNaN(d.py)&&(d.py=d.y);if(f=[],"function"==typeof m)for(b=0;j>b;++b)f[b]=+m.call(this,u[b],b);else for(b=0;j>b;++b)f[b]=m;if(g=[],"function"==typeof n)for(b=0;j>b;++b)g[b]=+n.call(this,u[b],b);else for(b=0;j>b;++b)g[b]=n;if(h=[],"function"==typeof o)for(b=0;e>b;++b)h[b]=+o.call(this,t[b],b);else for(b=0;e>b;++b)h[b]=o;return i.resume()},i.resume=function(){return i.alpha(.1)},i.stop=function(){return i.alpha(0)},i.drag=function(){return d||(d=hg.behavior.drag().origin(s).on("dragstart.force",$d).on("drag.force",b).on("dragend.force",_d)),arguments.length?void this.on("mouseover.force",ae).on("mouseout.force",be).call(d):d},hg.rebind(i,j,"on")};var ri=20,si=1,ti=1/0;hg.layout.hierarchy=function(){function a(e){var f,g=[e],h=[];for(e.depth=0;null!=(f=g.pop());)if(h.push(f),(j=c.call(a,f,f.depth))&&(i=j.length)){for(var i,j,k;--i>=0;)g.push(k=j[i]),k.parent=f,k.depth=f.depth+1;d&&(f.value=0),f.children=j}else d&&(f.value=+d.call(a,f,f.depth)||0),delete f.children;return fe(e,function(a){var c,e;b&&(c=a.children)&&c.sort(b),d&&(e=a.parent)&&(e.value+=a.value)}),h}var b=ie,c=ge,d=he;return a.sort=function(c){return arguments.length?(b=c,a):b},a.children=function(b){return arguments.length?(c=b,a):c},a.value=function(b){return arguments.length?(d=b,a):d},a.revalue=function(b){return d&&(ee(b,function(a){a.children&&(a.value=0)}),fe(b,function(b){var c;b.children||(b.value=+d.call(a,b,b.depth)||0),(c=b.parent)&&(c.value+=b.value)})),b},a},hg.layout.partition=function(){function a(b,c,d,e){var f=b.children;if(b.x=c,b.y=b.depth*e,b.dx=d,b.dy=e,f&&(g=f.length)){var g,h,i,j=-1;for(d=b.value?d/b.value:0;++j<g;)a(h=f[j],c,i=h.value*d,e),c+=i}}function b(a){var c=a.children,d=0;if(c&&(e=c.length))for(var e,f=-1;++f<e;)d=Math.max(d,b(c[f]));return 1+d}function c(c,f){var g=d.call(this,c,f);return a(g[0],0,e[0],e[1]/b(g[0])),g}var d=hg.layout.hierarchy(),e=[1,1];return c.size=function(a){return arguments.length?(e=a,c):e},de(c,d)},hg.layout.pie=function(){function a(g){var h,i=g.length,j=g.map(function(c,d){return+b.call(a,c,d)}),k=+("function"==typeof d?d.apply(this,arguments):d),l=("function"==typeof e?e.apply(this,arguments):e)-k,m=Math.min(Math.abs(l)/i,+("function"==typeof f?f.apply(this,arguments):f)),n=m*(0>l?-1:1),o=hg.sum(j),p=o?(l-i*n)/o:0,q=hg.range(i),r=[];return null!=c&&q.sort(c===ui?function(a,b){return j[b]-j[a]}:function(a,b){return c(g[a],g[b])}),q.forEach(function(a){r[a]={data:g[a],value:h=j[a],startAngle:k,endAngle:k+=h*p+n,padAngle:m}}),r}var b=Number,c=ui,d=0,e=Ng,f=0;return a.value=function(c){return arguments.length?(b=c,a):b},a.sort=function(b){return arguments.length?(c=b,a):c},a.startAngle=function(b){return arguments.length?(d=b,a):d},a.endAngle=function(b){return arguments.length?(e=b,a):e},a.padAngle=function(b){return arguments.length?(f=b,a):f},a};var ui={};hg.layout.stack=function(){function a(h,i){if(!(m=h.length))return h;var j=h.map(function(c,d){return b.call(a,c,d)}),k=j.map(function(b){return b.map(function(b,c){return[f.call(a,b,c),g.call(a,b,c)]})}),l=c.call(a,k,i);j=hg.permute(j,l),k=hg.permute(k,l);var m,n,o,p,q=d.call(a,k,i),r=j[0].length;for(o=0;r>o;++o)for(e.call(a,j[0][o],p=q[o],k[0][o][1]),n=1;m>n;++n)e.call(a,j[n][o],p+=k[n-1][o][1],k[n][o][1]);return h}var b=s,c=ne,d=oe,e=me,f=ke,g=le;return a.values=function(c){return arguments.length?(b=c,a):b},a.order=function(b){return arguments.length?(c="function"==typeof b?b:vi.get(b)||ne,a):c},a.offset=function(b){return arguments.length?(d="function"==typeof b?b:wi.get(b)||oe,a):d},a.x=function(b){return arguments.length?(f=b,a):f},a.y=function(b){return arguments.length?(g=b,a):g},a.out=function(b){return arguments.length?(e=b,a):e},a};var vi=hg.map({"inside-out":function(a){var b,c,d=a.length,e=a.map(pe),f=a.map(qe),g=hg.range(d).sort(function(a,b){return e[a]-e[b]}),h=0,i=0,j=[],k=[];for(b=0;d>b;++b)c=g[b],i>h?(h+=f[c],j.push(c)):(i+=f[c],k.push(c));return k.reverse().concat(j)},reverse:function(a){return hg.range(a.length).reverse()},"default":ne}),wi=hg.map({silhouette:function(a){var b,c,d,e=a.length,f=a[0].length,g=[],h=0,i=[];for(c=0;f>c;++c){for(b=0,d=0;e>b;b++)d+=a[b][c][1];d>h&&(h=d),g.push(d)}for(c=0;f>c;++c)i[c]=(h-g[c])/2;return i},wiggle:function(a){var b,c,d,e,f,g,h,i,j,k=a.length,l=a[0],m=l.length,n=[];for(n[0]=i=j=0,c=1;m>c;++c){for(b=0,e=0;k>b;++b)e+=a[b][c][1];for(b=0,f=0,h=l[c][0]-l[c-1][0];k>b;++b){for(d=0,g=(a[b][c][1]-a[b][c-1][1])/(2*h);b>d;++d)g+=(a[d][c][1]-a[d][c-1][1])/h;f+=g*a[b][c][1]}n[c]=i-=e?f/e*h:0,j>i&&(j=i)}for(c=0;m>c;++c)n[c]-=j;return n},expand:function(a){var b,c,d,e=a.length,f=a[0].length,g=1/e,h=[];for(c=0;f>c;++c){for(b=0,d=0;e>b;b++)d+=a[b][c][1];if(d)for(b=0;e>b;b++)a[b][c][1]/=d;else for(b=0;e>b;b++)a[b][c][1]=g}for(c=0;f>c;++c)h[c]=0;return h},zero:oe});hg.layout.histogram=function(){function a(a,f){for(var g,h,i=[],j=a.map(c,this),k=d.call(this,j,f),l=e.call(this,k,j,f),f=-1,m=j.length,n=l.length-1,o=b?1:1/m;++f<n;)g=i[f]=[],g.dx=l[f+1]-(g.x=l[f]),g.y=0;if(n>0)for(f=-1;++f<m;)h=j[f],h>=k[0]&&h<=k[1]&&(g=i[hg.bisect(l,h,1,n)-1],g.y+=o,g.push(a[f]));return i}var b=!0,c=Number,d=ue,e=se;return a.value=function(b){return arguments.length?(c=b,a):c},a.range=function(b){return arguments.length?(d=Aa(b),a):d},a.bins=function(b){return arguments.length?(e="number"==typeof b?function(a){return te(a,b)}:Aa(b),a):e},a.frequency=function(c){return arguments.length?(b=!!c,a):b},a},hg.layout.pack=function(){function a(a,f){var g=c.call(this,a,f),h=g[0],i=e[0],j=e[1],k=null==b?Math.sqrt:"function"==typeof b?b:function(){return b};if(h.x=h.y=0,fe(h,function(a){a.r=+k(a.value)}),fe(h,ze),d){var l=d*(b?1:Math.max(2*h.r/i,2*h.r/j))/2;fe(h,function(a){a.r+=l}),fe(h,ze),fe(h,function(a){a.r-=l})}return Ce(h,i/2,j/2,b?1:1/Math.max(2*h.r/i,2*h.r/j)),g}var b,c=hg.layout.hierarchy().sort(ve),d=0,e=[1,1];return a.size=function(b){return arguments.length?(e=b,a):e},a.radius=function(c){return arguments.length?(b=null==c||"function"==typeof c?c:+c,a):b},a.padding=function(b){return arguments.length?(d=+b,a):d},de(a,c)},hg.layout.tree=function(){function a(a,e){var k=g.call(this,a,e),l=k[0],m=b(l);if(fe(m,c),m.parent.m=-m.z,ee(m,d),j)ee(l,f);else{var n=l,o=l,p=l;ee(l,function(a){a.x<n.x&&(n=a),a.x>o.x&&(o=a),a.depth>p.depth&&(p=a)});var q=h(n,o)/2-n.x,r=i[0]/(o.x+h(o,n)/2+q),s=i[1]/(p.depth||1);ee(l,function(a){a.x=(a.x+q)*r,a.y=a.depth*s})}return k}function b(a){for(var b,c={A:null,children:[a]},d=[c];null!=(b=d.pop());)for(var e,f=b.children,g=0,h=f.length;h>g;++g)d.push((f[g]=e={_:f[g],parent:b,children:(e=f[g].children)&&e.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:g}).a=e);return c.children[0]}function c(a){var b=a.children,c=a.parent.children,d=a.i?c[a.i-1]:null;if(b.length){Ie(a);var f=(b[0].z+b[b.length-1].z)/2;d?(a.z=d.z+h(a._,d._),a.m=a.z-f):a.z=f}else d&&(a.z=d.z+h(a._,d._));a.parent.A=e(a,d,a.parent.A||c[0])}function d(a){a._.x=a.z+a.parent.m,a.m+=a.parent.m}function e(a,b,c){if(b){for(var d,e=a,f=a,g=b,i=e.parent.children[0],j=e.m,k=f.m,l=g.m,m=i.m;g=Ge(g),e=Fe(e),g&&e;)i=Fe(i),f=Ge(f),f.a=a,d=g.z+l-e.z-j+h(g._,e._),d>0&&(He(Je(g,a,c),a,d),j+=d,k+=d),l+=g.m,j+=e.m,m+=i.m,k+=f.m;g&&!Ge(f)&&(f.t=g,f.m+=l-k),e&&!Fe(i)&&(i.t=e,i.m+=j-m,c=a)}return c}function f(a){a.x*=i[0],a.y=a.depth*i[1]}var g=hg.layout.hierarchy().sort(null).value(null),h=Ee,i=[1,1],j=null;return a.separation=function(b){return arguments.length?(h=b,a):h},a.size=function(b){return arguments.length?(j=null==(i=b)?f:null,a):j?null:i},a.nodeSize=function(b){return arguments.length?(j=null==(i=b)?null:f,a):j?i:null},de(a,g)},hg.layout.cluster=function(){function a(a,f){var g,h=b.call(this,a,f),i=h[0],j=0;fe(i,function(a){var b=a.children;b&&b.length?(a.x=Le(b),a.y=Ke(b)):(a.x=g?j+=c(a,g):0,a.y=0,g=a)});var k=Me(i),l=Ne(i),m=k.x-c(k,l)/2,n=l.x+c(l,k)/2;return fe(i,e?function(a){a.x=(a.x-i.x)*d[0],a.y=(i.y-a.y)*d[1]}:function(a){a.x=(a.x-m)/(n-m)*d[0],a.y=(1-(i.y?a.y/i.y:1))*d[1]}),h}var b=hg.layout.hierarchy().sort(null).value(null),c=Ee,d=[1,1],e=!1;return a.separation=function(b){return arguments.length?(c=b,a):c},a.size=function(b){return arguments.length?(e=null==(d=b),a):e?null:d},a.nodeSize=function(b){return arguments.length?(e=null!=(d=b),a):e?d:null},de(a,b)},hg.layout.treemap=function(){function a(a,b){for(var c,d,e=-1,f=a.length;++e<f;)d=(c=a[e]).value*(0>b?0:b),c.area=isNaN(d)||0>=d?0:d}function b(c){var f=c.children;if(f&&f.length){var g,h,i,j=l(c),k=[],m=f.slice(),o=1/0,p="slice"===n?j.dx:"dice"===n?j.dy:"slice-dice"===n?1&c.depth?j.dy:j.dx:Math.min(j.dx,j.dy);for(a(m,j.dx*j.dy/c.value),k.area=0;(i=m.length)>0;)k.push(g=m[i-1]),k.area+=g.area,"squarify"!==n||(h=d(k,p))<=o?(m.pop(),o=h):(k.area-=k.pop().area,e(k,p,j,!1),p=Math.min(j.dx,j.dy),k.length=k.area=0,o=1/0);k.length&&(e(k,p,j,!0),k.length=k.area=0),f.forEach(b)}}function c(b){var d=b.children;if(d&&d.length){var f,g=l(b),h=d.slice(),i=[];for(a(h,g.dx*g.dy/b.value),i.area=0;f=h.pop();)i.push(f),i.area+=f.area,null!=f.z&&(e(i,f.z?g.dx:g.dy,g,!h.length),i.length=i.area=0);d.forEach(c)}}function d(a,b){for(var c,d=a.area,e=0,f=1/0,g=-1,h=a.length;++g<h;)(c=a[g].area)&&(f>c&&(f=c),c>e&&(e=c));return d*=d,b*=b,d?Math.max(b*e*o/d,d/(b*f*o)):1/0}function e(a,b,c,d){var e,f=-1,g=a.length,h=c.x,j=c.y,k=b?i(a.area/b):0;
if(b==c.dx){for((d||k>c.dy)&&(k=c.dy);++f<g;)e=a[f],e.x=h,e.y=j,e.dy=k,h+=e.dx=Math.min(c.x+c.dx-h,k?i(e.area/k):0);e.z=!0,e.dx+=c.x+c.dx-h,c.y+=k,c.dy-=k}else{for((d||k>c.dx)&&(k=c.dx);++f<g;)e=a[f],e.x=h,e.y=j,e.dx=k,j+=e.dy=Math.min(c.y+c.dy-j,k?i(e.area/k):0);e.z=!1,e.dy+=c.y+c.dy-j,c.x+=k,c.dx-=k}}function f(d){var e=g||h(d),f=e[0];return f.x=f.y=0,f.value?(f.dx=j[0],f.dy=j[1]):f.dx=f.dy=0,g&&h.revalue(f),a([f],f.dx*f.dy/f.value),(g?c:b)(f),m&&(g=e),e}var g,h=hg.layout.hierarchy(),i=Math.round,j=[1,1],k=null,l=Oe,m=!1,n="squarify",o=.5*(1+Math.sqrt(5));return f.size=function(a){return arguments.length?(j=a,f):j},f.padding=function(a){function b(b){var c=a.call(f,b,b.depth);return null==c?Oe(b):Pe(b,"number"==typeof c?[c,c,c,c]:c)}function c(b){return Pe(b,a)}if(!arguments.length)return k;var d;return l=null==(k=a)?Oe:"function"==(d=typeof a)?b:"number"===d?(a=[a,a,a,a],c):c,f},f.round=function(a){return arguments.length?(i=a?Math.round:Number,f):i!=Number},f.sticky=function(a){return arguments.length?(m=a,g=null,f):m},f.ratio=function(a){return arguments.length?(o=a,f):o},f.mode=function(a){return arguments.length?(n=a+"",f):n},de(f,h)},hg.random={normal:function(a,b){var c=arguments.length;return 2>c&&(b=1),1>c&&(a=0),function(){var c,d,e;do c=2*Math.random()-1,d=2*Math.random()-1,e=c*c+d*d;while(!e||e>1);return a+b*c*Math.sqrt(-2*Math.log(e)/e)}},logNormal:function(){var a=hg.random.normal.apply(hg,arguments);return function(){return Math.exp(a())}},bates:function(a){var b=hg.random.irwinHall(a);return function(){return b()/a}},irwinHall:function(a){return function(){for(var b=0,c=0;a>c;c++)b+=Math.random();return b}}},hg.scale={};var xi={floor:s,ceil:s};hg.scale.linear=function(){return We([0,1],[0,1],sd,!1)};var yi={s:1,g:1,p:1,r:1,e:1};hg.scale.log=function(){return cf(hg.scale.linear().domain([0,1]),10,!0,[1,10])};var zi=hg.format(".0e"),Ai={floor:function(a){return-Math.ceil(-a)},ceil:function(a){return-Math.floor(-a)}};hg.scale.pow=function(){return df(hg.scale.linear(),1,[0,1])},hg.scale.sqrt=function(){return hg.scale.pow().exponent(.5)},hg.scale.ordinal=function(){return ff([],{t:"range",a:[[]]})},hg.scale.category10=function(){return hg.scale.ordinal().range(Bi)},hg.scale.category20=function(){return hg.scale.ordinal().range(Ci)},hg.scale.category20b=function(){return hg.scale.ordinal().range(Di)},hg.scale.category20c=function(){return hg.scale.ordinal().range(Ei)};var Bi=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(ta),Ci=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(ta),Di=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(ta),Ei=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(ta);hg.scale.quantile=function(){return gf([],[])},hg.scale.quantize=function(){return hf(0,1,[0,1])},hg.scale.threshold=function(){return jf([.5],[0,1])},hg.scale.identity=function(){return kf([0,1])},hg.svg={},hg.svg.arc=function(){function a(){var a=Math.max(0,+c.apply(this,arguments)),j=Math.max(0,+d.apply(this,arguments)),k=g.apply(this,arguments)-Pg,l=h.apply(this,arguments)-Pg,m=Math.abs(l-k),n=k>l?0:1;if(a>j&&(o=j,j=a,a=o),m>=Og)return b(j,n)+(a?b(a,1-n):"")+"Z";var o,p,q,r,s,t,u,v,w,x,y,z,A=0,B=0,C=[];if((r=(+i.apply(this,arguments)||0)/2)&&(q=f===Fi?Math.sqrt(a*a+j*j):+f.apply(this,arguments),n||(B*=-1),j&&(B=ba(q/j*Math.sin(r))),a&&(A=ba(q/a*Math.sin(r)))),j){s=j*Math.cos(k+B),t=j*Math.sin(k+B),u=j*Math.cos(l-B),v=j*Math.sin(l-B);var D=Math.abs(l-k-2*B)<=Mg?0:1;if(B&&rf(s,t,u,v)===n^D){var E=(k+l)/2;s=j*Math.cos(E),t=j*Math.sin(E),u=v=null}}else s=t=0;if(a){w=a*Math.cos(l-A),x=a*Math.sin(l-A),y=a*Math.cos(k+A),z=a*Math.sin(k+A);var F=Math.abs(k-l+2*A)<=Mg?0:1;if(A&&rf(w,x,y,z)===1-n^F){var G=(k+l)/2;w=a*Math.cos(G),x=a*Math.sin(G),y=z=null}}else w=x=0;if(m>Kg&&(o=Math.min(Math.abs(j-a)/2,+e.apply(this,arguments)))>.001){p=j>a^n?0:1;var H=o,I=o;if(Mg>m){var J=null==y?[w,x]:null==u?[s,t]:Hc([s,t],[y,z],[u,v],[w,x]),K=s-J[0],L=t-J[1],M=u-J[0],N=v-J[1],O=1/Math.sin(Math.acos((K*M+L*N)/(Math.sqrt(K*K+L*L)*Math.sqrt(M*M+N*N)))/2),P=Math.sqrt(J[0]*J[0]+J[1]*J[1]);I=Math.min(o,(a-P)/(O-1)),H=Math.min(o,(j-P)/(O+1))}if(null!=u){var Q=sf(null==y?[w,x]:[y,z],[s,t],j,H,n),R=sf([u,v],[w,x],j,H,n);o===H?C.push("M",Q[0],"A",H,",",H," 0 0,",p," ",Q[1],"A",j,",",j," 0 ",1-n^rf(Q[1][0],Q[1][1],R[1][0],R[1][1]),",",n," ",R[1],"A",H,",",H," 0 0,",p," ",R[0]):C.push("M",Q[0],"A",H,",",H," 0 1,",p," ",R[0])}else C.push("M",s,",",t);if(null!=y){var S=sf([s,t],[y,z],a,-I,n),T=sf([w,x],null==u?[s,t]:[u,v],a,-I,n);o===I?C.push("L",T[0],"A",I,",",I," 0 0,",p," ",T[1],"A",a,",",a," 0 ",n^rf(T[1][0],T[1][1],S[1][0],S[1][1]),",",1-n," ",S[1],"A",I,",",I," 0 0,",p," ",S[0]):C.push("L",T[0],"A",I,",",I," 0 0,",p," ",S[0])}else C.push("L",w,",",x)}else C.push("M",s,",",t),null!=u&&C.push("A",j,",",j," 0 ",D,",",n," ",u,",",v),C.push("L",w,",",x),null!=y&&C.push("A",a,",",a," 0 ",F,",",1-n," ",y,",",z);return C.push("Z"),C.join("")}function b(a,b){return"M0,"+a+"A"+a+","+a+" 0 1,"+b+" 0,"+-a+"A"+a+","+a+" 0 1,"+b+" 0,"+a}var c=mf,d=nf,e=lf,f=Fi,g=of,h=pf,i=qf;return a.innerRadius=function(b){return arguments.length?(c=Aa(b),a):c},a.outerRadius=function(b){return arguments.length?(d=Aa(b),a):d},a.cornerRadius=function(b){return arguments.length?(e=Aa(b),a):e},a.padRadius=function(b){return arguments.length?(f=b==Fi?Fi:Aa(b),a):f},a.startAngle=function(b){return arguments.length?(g=Aa(b),a):g},a.endAngle=function(b){return arguments.length?(h=Aa(b),a):h},a.padAngle=function(b){return arguments.length?(i=Aa(b),a):i},a.centroid=function(){var a=(+c.apply(this,arguments)+ +d.apply(this,arguments))/2,b=(+g.apply(this,arguments)+ +h.apply(this,arguments))/2-Pg;return[Math.cos(b)*a,Math.sin(b)*a]},a};var Fi="auto";hg.svg.line=function(){return tf(s)};var Gi=hg.map({linear:uf,"linear-closed":vf,step:wf,"step-before":xf,"step-after":yf,basis:Ef,"basis-open":Ff,"basis-closed":Gf,bundle:Hf,cardinal:Bf,"cardinal-open":zf,"cardinal-closed":Af,monotone:Nf});Gi.forEach(function(a,b){b.key=a,b.closed=/-closed$/.test(a)});var Hi=[0,2/3,1/3,0],Ii=[0,1/3,2/3,0],Ji=[0,1/6,2/3,1/6];hg.svg.line.radial=function(){var a=tf(Of);return a.radius=a.x,delete a.x,a.angle=a.y,delete a.y,a},xf.reverse=yf,yf.reverse=xf,hg.svg.area=function(){return Pf(s)},hg.svg.area.radial=function(){var a=Pf(Of);return a.radius=a.x,delete a.x,a.innerRadius=a.x0,delete a.x0,a.outerRadius=a.x1,delete a.x1,a.angle=a.y,delete a.y,a.startAngle=a.y0,delete a.y0,a.endAngle=a.y1,delete a.y1,a},hg.svg.chord=function(){function a(a,h){var i=b(this,f,a,h),j=b(this,g,a,h);return"M"+i.p0+d(i.r,i.p1,i.a1-i.a0)+(c(i,j)?e(i.r,i.p1,i.r,i.p0):e(i.r,i.p1,j.r,j.p0)+d(j.r,j.p1,j.a1-j.a0)+e(j.r,j.p1,i.r,i.p0))+"Z"}function b(a,b,c,d){var e=b.call(a,c,d),f=h.call(a,e,d),g=i.call(a,e,d)-Pg,k=j.call(a,e,d)-Pg;return{r:f,a0:g,a1:k,p0:[f*Math.cos(g),f*Math.sin(g)],p1:[f*Math.cos(k),f*Math.sin(k)]}}function c(a,b){return a.a0==b.a0&&a.a1==b.a1}function d(a,b,c){return"A"+a+","+a+" 0 "+ +(c>Mg)+",1 "+b}function e(a,b,c,d){return"Q 0,0 "+d}var f=sc,g=tc,h=Qf,i=of,j=pf;return a.radius=function(b){return arguments.length?(h=Aa(b),a):h},a.source=function(b){return arguments.length?(f=Aa(b),a):f},a.target=function(b){return arguments.length?(g=Aa(b),a):g},a.startAngle=function(b){return arguments.length?(i=Aa(b),a):i},a.endAngle=function(b){return arguments.length?(j=Aa(b),a):j},a},hg.svg.diagonal=function(){function a(a,e){var f=b.call(this,a,e),g=c.call(this,a,e),h=(f.y+g.y)/2,i=[f,{x:f.x,y:h},{x:g.x,y:h},g];return i=i.map(d),"M"+i[0]+"C"+i[1]+" "+i[2]+" "+i[3]}var b=sc,c=tc,d=Rf;return a.source=function(c){return arguments.length?(b=Aa(c),a):b},a.target=function(b){return arguments.length?(c=Aa(b),a):c},a.projection=function(b){return arguments.length?(d=b,a):d},a},hg.svg.diagonal.radial=function(){var a=hg.svg.diagonal(),b=Rf,c=a.projection;return a.projection=function(a){return arguments.length?c(Sf(b=a)):b},a},hg.svg.symbol=function(){function a(a,d){return(Ki.get(b.call(this,a,d))||Vf)(c.call(this,a,d))}var b=Uf,c=Tf;return a.type=function(c){return arguments.length?(b=Aa(c),a):b},a.size=function(b){return arguments.length?(c=Aa(b),a):c},a};var Ki=hg.map({circle:Vf,cross:function(a){var b=Math.sqrt(a/5)/2;return"M"+-3*b+","+-b+"H"+-b+"V"+-3*b+"H"+b+"V"+-b+"H"+3*b+"V"+b+"H"+b+"V"+3*b+"H"+-b+"V"+b+"H"+-3*b+"Z"},diamond:function(a){var b=Math.sqrt(a/(2*Mi)),c=b*Mi;return"M0,"+-b+"L"+c+",0 0,"+b+" "+-c+",0Z"},square:function(a){var b=Math.sqrt(a)/2;return"M"+-b+","+-b+"L"+b+","+-b+" "+b+","+b+" "+-b+","+b+"Z"},"triangle-down":function(a){var b=Math.sqrt(a/Li),c=b*Li/2;return"M0,"+c+"L"+b+","+-c+" "+-b+","+-c+"Z"},"triangle-up":function(a){var b=Math.sqrt(a/Li),c=b*Li/2;return"M0,"+-c+"L"+b+","+c+" "+-b+","+c+"Z"}});hg.svg.symbolTypes=Ki.keys();var Li=Math.sqrt(3),Mi=Math.tan(30*Qg);Cg.transition=function(a){for(var b,c,d=Ni||++Ri,e=$f(a),f=[],g=Oi||{time:Date.now(),ease:zd,delay:0,duration:250},h=-1,i=this.length;++h<i;){f.push(b=[]);for(var j=this[h],k=-1,l=j.length;++k<l;)(c=j[k])&&_f(c,k,e,d,g),b.push(c)}return Xf(f,e,d)},Cg.interrupt=function(a){return this.each(null==a?Pi:Wf($f(a)))};var Ni,Oi,Pi=Wf($f()),Qi=[],Ri=0;Qi.call=Cg.call,Qi.empty=Cg.empty,Qi.node=Cg.node,Qi.size=Cg.size,hg.transition=function(a,b){return a&&a.transition?Ni?a.transition(b):a:hg.selection().transition(a)},hg.transition.prototype=Qi,Qi.select=function(a){var b,c,d,e=this.id,f=this.namespace,g=[];a=C(a);for(var h=-1,i=this.length;++h<i;){g.push(b=[]);for(var j=this[h],k=-1,l=j.length;++k<l;)(d=j[k])&&(c=a.call(d,d.__data__,k,h))?("__data__"in d&&(c.__data__=d.__data__),_f(c,k,f,e,d[f][e]),b.push(c)):b.push(null)}return Xf(g,f,e)},Qi.selectAll=function(a){var b,c,d,e,f,g=this.id,h=this.namespace,i=[];a=D(a);for(var j=-1,k=this.length;++j<k;)for(var l=this[j],m=-1,n=l.length;++m<n;)if(d=l[m]){f=d[h][g],c=a.call(d,d.__data__,m,j),i.push(b=[]);for(var o=-1,p=c.length;++o<p;)(e=c[o])&&_f(e,o,h,g,f),b.push(e)}return Xf(i,h,g)},Qi.filter=function(a){var b,c,d,e=[];"function"!=typeof a&&(a=P(a));for(var f=0,g=this.length;g>f;f++){e.push(b=[]);for(var c=this[f],h=0,i=c.length;i>h;h++)(d=c[h])&&a.call(d,d.__data__,h,f)&&b.push(d)}return Xf(e,this.namespace,this.id)},Qi.tween=function(a,b){var c=this.id,d=this.namespace;return arguments.length<2?this.node()[d][c].tween.get(a):R(this,null==b?function(b){b[d][c].tween.remove(a)}:function(e){e[d][c].tween.set(a,b)})},Qi.attr=function(a,b){function c(){this.removeAttribute(h)}function d(){this.removeAttributeNS(h.space,h.local)}function e(a){return null==a?c:(a+="",function(){var b,c=this.getAttribute(h);return c!==a&&(b=g(c,a),function(a){this.setAttribute(h,b(a))})})}function f(a){return null==a?d:(a+="",function(){var b,c=this.getAttributeNS(h.space,h.local);return c!==a&&(b=g(c,a),function(a){this.setAttributeNS(h.space,h.local,b(a))})})}if(arguments.length<2){for(b in a)this.attr(b,a[b]);return this}var g="transform"==a?Ud:sd,h=hg.ns.qualify(a);return Yf(this,"attr."+a,b,h.local?f:e)},Qi.attrTween=function(a,b){function c(a,c){var d=b.call(this,a,c,this.getAttribute(e));return d&&function(a){this.setAttribute(e,d(a))}}function d(a,c){var d=b.call(this,a,c,this.getAttributeNS(e.space,e.local));return d&&function(a){this.setAttributeNS(e.space,e.local,d(a))}}var e=hg.ns.qualify(a);return this.tween("attr."+a,e.local?d:c)},Qi.style=function(a,c,d){function e(){this.style.removeProperty(a)}function f(c){return null==c?e:(c+="",function(){var e,f=b(this).getComputedStyle(this,null).getPropertyValue(a);return f!==c&&(e=sd(f,c),function(b){this.style.setProperty(a,e(b),d)})})}var g=arguments.length;if(3>g){if("string"!=typeof a){2>g&&(c="");for(d in a)this.style(d,a[d],c);return this}d=""}return Yf(this,"style."+a,c,f)},Qi.styleTween=function(a,c,d){function e(e,f){var g=c.call(this,e,f,b(this).getComputedStyle(this,null).getPropertyValue(a));return g&&function(b){this.style.setProperty(a,g(b),d)}}return arguments.length<3&&(d=""),this.tween("style."+a,e)},Qi.text=function(a){return Yf(this,"text",a,Zf)},Qi.remove=function(){var a=this.namespace;return this.each("end.transition",function(){var b;this[a].count<2&&(b=this.parentNode)&&b.removeChild(this)})},Qi.ease=function(a){var b=this.id,c=this.namespace;return arguments.length<1?this.node()[c][b].ease:("function"!=typeof a&&(a=hg.ease.apply(hg,arguments)),R(this,function(d){d[c][b].ease=a}))},Qi.delay=function(a){var b=this.id,c=this.namespace;return arguments.length<1?this.node()[c][b].delay:R(this,"function"==typeof a?function(d,e,f){d[c][b].delay=+a.call(d,d.__data__,e,f)}:(a=+a,function(d){d[c][b].delay=a}))},Qi.duration=function(a){var b=this.id,c=this.namespace;return arguments.length<1?this.node()[c][b].duration:R(this,"function"==typeof a?function(d,e,f){d[c][b].duration=Math.max(1,a.call(d,d.__data__,e,f))}:(a=Math.max(1,a),function(d){d[c][b].duration=a}))},Qi.each=function(a,b){var c=this.id,d=this.namespace;if(arguments.length<2){var e=Oi,f=Ni;try{Ni=c,R(this,function(b,e,f){Oi=b[d][c],a.call(b,b.__data__,e,f)})}finally{Oi=e,Ni=f}}else R(this,function(e){var f=e[d][c];(f.event||(f.event=hg.dispatch("start","end","interrupt"))).on(a,b)});return this},Qi.transition=function(){for(var a,b,c,d,e=this.id,f=++Ri,g=this.namespace,h=[],i=0,j=this.length;j>i;i++){h.push(a=[]);for(var b=this[i],k=0,l=b.length;l>k;k++)(c=b[k])&&(d=c[g][e],_f(c,k,g,f,{time:d.time,ease:d.ease,delay:d.delay+d.duration,duration:d.duration})),a.push(c)}return Xf(h,g,f)},hg.svg.axis=function(){function a(a){a.each(function(){var a,j=hg.select(this),k=this.__chart__||c,l=this.__chart__=c.copy(),m=null==i?l.ticks?l.ticks.apply(l,h):l.domain():i,n=null==b?l.tickFormat?l.tickFormat.apply(l,h):s:b,o=j.selectAll(".tick").data(m,l),p=o.enter().insert("g",".domain").attr("class","tick").style("opacity",Kg),q=hg.transition(o.exit()).style("opacity",Kg).remove(),r=hg.transition(o.order()).style("opacity",1),t=Math.max(e,0)+g,u=Re(l),v=j.selectAll(".domain").data([0]),w=(v.enter().append("path").attr("class","domain"),hg.transition(v));p.append("line"),p.append("text");var x,y,z,A,B=p.select("line"),C=r.select("line"),D=o.select("text").text(n),E=p.select("text"),F=r.select("text"),G="top"===d||"left"===d?-1:1;if("bottom"===d||"top"===d?(a=ag,x="x",z="y",y="x2",A="y2",D.attr("dy",0>G?"0em":".71em").style("text-anchor","middle"),w.attr("d","M"+u[0]+","+G*f+"V0H"+u[1]+"V"+G*f)):(a=bg,x="y",z="x",y="y2",A="x2",D.attr("dy",".32em").style("text-anchor",0>G?"end":"start"),w.attr("d","M"+G*f+","+u[0]+"H0V"+u[1]+"H"+G*f)),B.attr(A,G*e),E.attr(z,G*t),C.attr(y,0).attr(A,G*e),F.attr(x,0).attr(z,G*t),l.rangeBand){var H=l,I=H.rangeBand()/2;k=l=function(a){return H(a)+I}}else k.rangeBand?k=l:q.call(a,l,k);p.call(a,k,l),r.call(a,l,l)})}var b,c=hg.scale.linear(),d=Si,e=6,f=6,g=3,h=[10],i=null;return a.scale=function(b){return arguments.length?(c=b,a):c},a.orient=function(b){return arguments.length?(d=b in Ti?b+"":Si,a):d},a.ticks=function(){return arguments.length?(h=jg(arguments),a):h},a.tickValues=function(b){return arguments.length?(i=b,a):i},a.tickFormat=function(c){return arguments.length?(b=c,a):b},a.tickSize=function(b){var c=arguments.length;return c?(e=+b,f=+arguments[c-1],a):e},a.innerTickSize=function(b){return arguments.length?(e=+b,a):e},a.outerTickSize=function(b){return arguments.length?(f=+b,a):f},a.tickPadding=function(b){return arguments.length?(g=+b,a):g},a.tickSubdivide=function(){return arguments.length&&a},a};var Si="bottom",Ti={top:1,right:1,bottom:1,left:1};hg.svg.brush=function(){function a(b){b.each(function(){var b=hg.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",f).on("touchstart.brush",f),g=b.selectAll(".background").data([0]);g.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),b.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var h=b.selectAll(".resize").data(p,s);h.exit().remove(),h.enter().append("g").attr("class",function(a){return"resize "+a}).style("cursor",function(a){return Ui[a]}).append("rect").attr("x",function(a){return/[ew]$/.test(a)?-3:null}).attr("y",function(a){return/^[ns]/.test(a)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),h.style("display",a.empty()?"none":null);var i,l=hg.transition(b),m=hg.transition(g);j&&(i=Re(j),m.attr("x",i[0]).attr("width",i[1]-i[0]),d(l)),k&&(i=Re(k),m.attr("y",i[0]).attr("height",i[1]-i[0]),e(l)),c(l)})}function c(a){a.selectAll(".resize").attr("transform",function(a){return"translate("+l[+/e$/.test(a)]+","+m[+/^s/.test(a)]+")"})}function d(a){a.select(".extent").attr("x",l[0]),a.selectAll(".extent,.n>rect,.s>rect").attr("width",l[1]-l[0])}function e(a){a.select(".extent").attr("y",m[0]),a.selectAll(".extent,.e>rect,.w>rect").attr("height",m[1]-m[0])}function f(){function f(){32==hg.event.keyCode&&(D||(t=null,F[0]-=l[1],F[1]-=m[1],D=2),y())}function p(){32==hg.event.keyCode&&2==D&&(F[0]+=l[1],F[1]+=m[1],D=0,y())}function q(){var a=hg.mouse(v),b=!1;u&&(a[0]+=u[0],a[1]+=u[1]),D||(hg.event.altKey?(t||(t=[(l[0]+l[1])/2,(m[0]+m[1])/2]),F[0]=l[+(a[0]<t[0])],F[1]=m[+(a[1]<t[1])]):t=null),B&&r(a,j,0)&&(d(z),b=!0),C&&r(a,k,1)&&(e(z),b=!0),b&&(c(z),x({type:"brush",mode:D?"move":"resize"}))}function r(a,b,c){var d,e,f=Re(b),i=f[0],j=f[1],k=F[c],p=c?m:l,q=p[1]-p[0];return D&&(i-=k,j-=q+k),d=(c?o:n)?Math.max(i,Math.min(j,a[c])):a[c],D?e=(d+=k)+q:(t&&(k=Math.max(i,Math.min(j,2*t[c]-d))),d>k?(e=d,d=k):e=k),p[0]!=d||p[1]!=e?(c?h=null:g=null,p[0]=d,p[1]=e,!0):void 0}function s(){q(),z.style("pointer-events","all").selectAll(".resize").style("display",a.empty()?"none":null),hg.select("body").style("cursor",null),G.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),E(),x({type:"brushend"})}var t,u,v=this,w=hg.select(hg.event.target),x=i.of(v,arguments),z=hg.select(v),A=w.datum(),B=!/^(n|s)$/.test(A)&&j,C=!/^(e|w)$/.test(A)&&k,D=w.classed("extent"),E=X(v),F=hg.mouse(v),G=hg.select(b(v)).on("keydown.brush",f).on("keyup.brush",p);if(hg.event.changedTouches?G.on("touchmove.brush",q).on("touchend.brush",s):G.on("mousemove.brush",q).on("mouseup.brush",s),z.interrupt().selectAll("*").interrupt(),D)F[0]=l[0]-F[0],F[1]=m[0]-F[1];else if(A){var H=+/w$/.test(A),I=+/^n/.test(A);u=[l[1-H]-F[0],m[1-I]-F[1]],F[0]=l[H],F[1]=m[I]}else hg.event.altKey&&(t=F.slice());z.style("pointer-events","none").selectAll(".resize").style("display",null),hg.select("body").style("cursor",w.style("cursor")),x({type:"brushstart"}),q()}var g,h,i=A(a,"brushstart","brush","brushend"),j=null,k=null,l=[0,0],m=[0,0],n=!0,o=!0,p=Vi[0];return a.event=function(a){a.each(function(){var a=i.of(this,arguments),b={x:l,y:m,i:g,j:h},c=this.__chart__||b;this.__chart__=b,Ni?hg.select(this).transition().each("start.brush",function(){g=c.i,h=c.j,l=c.x,m=c.y,a({type:"brushstart"})}).tween("brush:brush",function(){var c=td(l,b.x),d=td(m,b.y);return g=h=null,function(e){l=b.x=c(e),m=b.y=d(e),a({type:"brush",mode:"resize"})}}).each("end.brush",function(){g=b.i,h=b.j,a({type:"brush",mode:"resize"}),a({type:"brushend"})}):(a({type:"brushstart"}),a({type:"brush",mode:"resize"}),a({type:"brushend"}))})},a.x=function(b){return arguments.length?(j=b,p=Vi[!j<<1|!k],a):j},a.y=function(b){return arguments.length?(k=b,p=Vi[!j<<1|!k],a):k},a.clamp=function(b){return arguments.length?(j&&k?(n=!!b[0],o=!!b[1]):j?n=!!b:k&&(o=!!b),a):j&&k?[n,o]:j?n:k?o:null},a.extent=function(b){var c,d,e,f,i;return arguments.length?(j&&(c=b[0],d=b[1],k&&(c=c[0],d=d[0]),g=[c,d],j.invert&&(c=j(c),d=j(d)),c>d&&(i=c,c=d,d=i),(c!=l[0]||d!=l[1])&&(l=[c,d])),k&&(e=b[0],f=b[1],j&&(e=e[1],f=f[1]),h=[e,f],k.invert&&(e=k(e),f=k(f)),e>f&&(i=e,e=f,f=i),(e!=m[0]||f!=m[1])&&(m=[e,f])),a):(j&&(g?(c=g[0],d=g[1]):(c=l[0],d=l[1],j.invert&&(c=j.invert(c),d=j.invert(d)),c>d&&(i=c,c=d,d=i))),k&&(h?(e=h[0],f=h[1]):(e=m[0],f=m[1],k.invert&&(e=k.invert(e),f=k.invert(f)),e>f&&(i=e,e=f,f=i))),j&&k?[[c,e],[d,f]]:j?[c,d]:k&&[e,f])},a.clear=function(){return a.empty()||(l=[0,0],m=[0,0],g=h=null),a},a.empty=function(){return!!j&&l[0]==l[1]||!!k&&m[0]==m[1]},hg.rebind(a,i,"on")};var Ui={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Vi=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Wi=nh.format=th.timeFormat,Xi=Wi.utc,Yi=Xi("%Y-%m-%dT%H:%M:%S.%LZ");Wi.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?cg:Yi,cg.parse=function(a){var b=new Date(a);return isNaN(b)?null:b},cg.toString=Yi.toString,nh.second=Oa(function(a){return new oh(1e3*Math.floor(a/1e3))},function(a,b){a.setTime(a.getTime()+1e3*Math.floor(b))},function(a){return a.getSeconds()}),nh.seconds=nh.second.range,nh.seconds.utc=nh.second.utc.range,nh.minute=Oa(function(a){return new oh(6e4*Math.floor(a/6e4))},function(a,b){a.setTime(a.getTime()+6e4*Math.floor(b))},function(a){return a.getMinutes()}),nh.minutes=nh.minute.range,nh.minutes.utc=nh.minute.utc.range,nh.hour=Oa(function(a){var b=a.getTimezoneOffset()/60;return new oh(36e5*(Math.floor(a/36e5-b)+b))},function(a,b){a.setTime(a.getTime()+36e5*Math.floor(b))},function(a){return a.getHours()}),nh.hours=nh.hour.range,nh.hours.utc=nh.hour.utc.range,nh.month=Oa(function(a){return a=nh.day(a),a.setDate(1),a},function(a,b){a.setMonth(a.getMonth()+b)},function(a){return a.getMonth()}),nh.months=nh.month.range,nh.months.utc=nh.month.utc.range;var Zi=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],$i=[[nh.second,1],[nh.second,5],[nh.second,15],[nh.second,30],[nh.minute,1],[nh.minute,5],[nh.minute,15],[nh.minute,30],[nh.hour,1],[nh.hour,3],[nh.hour,6],[nh.hour,12],[nh.day,1],[nh.day,2],[nh.week,1],[nh.month,1],[nh.month,3],[nh.year,1]],_i=Wi.multi([[".%L",function(a){return a.getMilliseconds()}],[":%S",function(a){return a.getSeconds()}],["%I:%M",function(a){return a.getMinutes()}],["%I %p",function(a){return a.getHours()}],["%a %d",function(a){return a.getDay()&&1!=a.getDate()}],["%b %d",function(a){return 1!=a.getDate()}],["%B",function(a){return a.getMonth()}],["%Y",Db]]),aj={range:function(a,b,c){return hg.range(Math.ceil(a/c)*c,+b,c).map(eg)},floor:s,ceil:s};$i.year=nh.year,nh.scale=function(){return dg(hg.scale.linear(),$i,_i)};var bj=$i.map(function(a){return[a[0].utc,a[1]]}),cj=Xi.multi([[".%L",function(a){return a.getUTCMilliseconds()}],[":%S",function(a){return a.getUTCSeconds()}],["%I:%M",function(a){return a.getUTCMinutes()}],["%I %p",function(a){return a.getUTCHours()}],["%a %d",function(a){return a.getUTCDay()&&1!=a.getUTCDate()}],["%b %d",function(a){return 1!=a.getUTCDate()}],["%B",function(a){return a.getUTCMonth()}],["%Y",Db]]);bj.year=nh.year.utc,nh.scale.utc=function(){return dg(hg.scale.linear(),bj,cj)},hg.text=Ba(function(a){return a.responseText}),hg.json=function(a,b){return Ca(a,"application/json",fg,b)},hg.html=function(a,b){return Ca(a,"text/html",gg,b)},hg.xml=Ba(function(a){return a.responseXML}),"function"==typeof define&&define.amd?(this.d3=hg,define(hg)):"object"==typeof module&&module.exports?module.exports=hg:this.d3=hg}(),function(a,b){function c(b,c){var e,f,g,h=b.nodeName.toLowerCase();return"area"===h?(e=b.parentNode,f=e.name,b.href&&f&&"map"===e.nodeName.toLowerCase()?(g=a("img[usemap=#"+f+"]")[0],!!g&&d(g)):!1):(/input|select|textarea|button|object/.test(h)?!b.disabled:"a"===h?b.href||c:c)&&d(b)}function d(b){return a.expr.filters.visible(b)&&!a(b).parents().addBack().filter(function(){return"hidden"===a.css(this,"visibility")}).length}var e=0,f=/^ui-id-\d+$/;a.ui=a.ui||{},a.extend(a.ui,{version:"1.10.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),a.fn.extend({focus:function(b){return function(c,d){return"number"==typeof c?this.each(function(){var b=this;setTimeout(function(){a(b).focus(),d&&d.call(b)},c)}):b.apply(this,arguments)}}(a.fn.focus),scrollParent:function(){var b;return b=a.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.css(this,"position"))&&/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length)for(var d,e,f=a(this[0]);f.length&&f[0]!==document;){if(d=f.css("position"),("absolute"===d||"relative"===d||"fixed"===d)&&(e=parseInt(f.css("zIndex"),10),!isNaN(e)&&0!==e))return e;f=f.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})},removeUniqueId:function(){return this.each(function(){f.test(this.id)&&a(this).removeAttr("id")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(c,d){function e(b,c,d,e){return a.each(f,function(){c-=parseFloat(a.css(b,"padding"+this))||0,d&&(c-=parseFloat(a.css(b,"border"+this+"Width"))||0),e&&(c-=parseFloat(a.css(b,"margin"+this))||0)}),c}var f="Width"===d?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),h={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?h["inner"+d].call(this):this.each(function(){a(this).css(g,e(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return"number"!=typeof b?h["outer"+d].call(this,b):this.each(function(){a(this).css(g,e(this,b,!0,c)+"px")})}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(a.fn.removeData=function(b){return function(c){return arguments.length?b.call(this,a.camelCase(c)):b.call(this)}}(a.fn.removeData)),a.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),a.support.selectstart="onselectstart"in document.createElement("div"),a.fn.extend({disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e,f=a.ui[b].prototype;for(e in d)f.plugins[e]=f.plugins[e]||[],f.plugins[e].push([c,d[e]])},call:function(a,b,c){var d,e=a.plugins[b];if(e&&a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType)for(d=0;d<e.length;d++)a.options[e[d][0]]&&e[d][1].apply(a.element,c)}},hasScroll:function(b,c){if("hidden"===a(b).css("overflow"))return!1;var d=c&&"left"===c?"scrollLeft":"scrollTop",e=!1;return b[d]>0?!0:(b[d]=1,e=b[d]>0,b[d]=0,e)}})}(jQuery),function(a,b){var c=0,d=Array.prototype.slice,e=a.cleanData;a.cleanData=function(b){for(var c,d=0;null!=(c=b[d]);d++)try{a(c).triggerHandler("remove")}catch(f){}e(b)},a.widget=function(b,c,d){var e,f,g,h,i={},j=b.split(".")[0];b=b.split(".")[1],e=j+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][e.toLowerCase()]=function(b){return!!a.data(b,e)},a[j]=a[j]||{},f=a[j][b],g=a[j][b]=function(a,b){return this._createWidget?void(arguments.length&&this._createWidget(a,b)):new g(a,b)},a.extend(g,f,{version:d.version,_proto:a.extend({},d),_childConstructors:[]}),h=new c,h.options=a.widget.extend({},h.options),a.each(d,function(b,d){return a.isFunction(d)?void(i[b]=function(){var a=function(){return c.prototype[b].apply(this,arguments)},e=function(a){return c.prototype[b].apply(this,a)};return function(){var b,c=this._super,f=this._superApply;return this._super=a,this._superApply=e,b=d.apply(this,arguments),this._super=c,this._superApply=f,b}}()):void(i[b]=d)}),g.prototype=a.widget.extend(h,{widgetEventPrefix:f?h.widgetEventPrefix||b:b},i,{constructor:g,namespace:j,widgetName:b,widgetFullName:e}),f?(a.each(f._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,g,c._proto)}),delete f._childConstructors):c._childConstructors.push(g),a.widget.bridge(b,g)},a.widget.extend=function(c){for(var e,f,g=d.call(arguments,1),h=0,i=g.length;i>h;h++)for(e in g[h])f=g[h][e],g[h].hasOwnProperty(e)&&f!==b&&(a.isPlainObject(f)?c[e]=a.isPlainObject(c[e])?a.widget.extend({},c[e],f):a.widget.extend({},f):c[e]=f);return c},a.widget.bridge=function(c,e){var f=e.prototype.widgetFullName||c;a.fn[c]=function(g){var h="string"==typeof g,i=d.call(arguments,1),j=this;return g=!h&&i.length?a.widget.extend.apply(null,[g].concat(i)):g,h?this.each(function(){var d,e=a.data(this,f);return e?a.isFunction(e[g])&&"_"!==g.charAt(0)?(d=e[g].apply(e,i),d!==e&&d!==b?(j=d&&d.jquery?j.pushStack(d.get()):d,!1):void 0):a.error("no such method '"+g+"' for "+c+" widget instance"):a.error("cannot call methods on "+c+" prior to initialization; attempted to call method '"+g+"'")}):this.each(function(){var b=a.data(this,f);b?b.option(g||{})._init():a.data(this,f,new e(g,this))}),j}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,d){d=a(d||this.defaultElement||this)[0],this.element=a(d),this.uuid=c++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this.bindings=a(),this.hoverable=a(),this.focusable=a(),d!==this&&(a.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=a(d.style?d.ownerDocument:d.document||d),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(c,d){var e,f,g,h=c;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof c)if(h={},e=c.split("."),c=e.shift(),e.length){for(f=h[c]=a.widget.extend({},this.options[c]),g=0;g<e.length-1;g++)f[e[g]]=f[e[g]]||{},f=f[e[g]];if(c=e.pop(),1===arguments.length)return f[c]===b?null:f[c];f[c]=d}else{if(1===arguments.length)return this.options[c]===b?null:this.options[c];h[c]=d}return this._setOptions(h),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),
this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(b,c,d){var e,f=this;"boolean"!=typeof b&&(d=c,c=b,b=!1),d?(c=e=a(c),this.bindings=this.bindings.add(c)):(d=c,c=this.element,e=this.widget()),a.each(d,function(d,g){function h(){return b||f.options.disabled!==!0&&!a(this).hasClass("ui-state-disabled")?("string"==typeof g?f[g]:g).apply(f,arguments):void 0}"string"!=typeof g&&(h.guid=g.guid=g.guid||h.guid||a.guid++);var i=d.match(/^(\w+)\s*(.*)$/),j=i[1]+f.eventNamespace,k=i[2];k?e.delegate(k,j,h):c.bind(j,h)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,a.unbind(b).undelegate(b)},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&g.apply(this.element[0],[c].concat(d))===!1||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"==typeof e&&(e={effect:e});var g,h=e?e===!0||"number"==typeof e?c:e.effect||c:b;e=e||{},"number"==typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&a.effects.effect[h]?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}})}(jQuery),function(a,b){var c=!1;a(document).mouseup(function(){c=!1}),a.widget("ui.mouse",{version:"1.10.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){return!0===a.data(c.target,b.widgetName+".preventClickEvent")?(a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(b){if(!c){this._mouseStarted&&this._mouseUp(b),this._mouseDownEvent=b;var d=this,e=1===b.which,f="string"==typeof this.options.cancel&&b.target.nodeName?a(b.target).closest(this.options.cancel).length:!1;return e&&!f&&this._mouseCapture(b)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(b)!==!1,!this._mouseStarted)?(b.preventDefault(),!0):(!0===a.data(b.target,this.widgetName+".preventClickEvent")&&a.removeData(b.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return d._mouseMove(a)},this._mouseUpDelegate=function(a){return d._mouseUp(a)},a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),b.preventDefault(),c=!0,!0)):!0}},_mouseMove:function(b){return a.ui.ie&&(!document.documentMode||document.documentMode<9)&&!b.button?this._mouseUp(b):this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==!1,this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted)},_mouseUp:function(b){return a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target===this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(a,b){function c(a,b,c){return[parseFloat(a[0])*(n.test(a[0])?b/100:1),parseFloat(a[1])*(n.test(a[1])?c/100:1)]}function d(b,c){return parseInt(a.css(b,c),10)||0}function e(b){var c=b[0];return 9===c.nodeType?{width:b.width(),height:b.height(),offset:{top:0,left:0}}:a.isWindow(c)?{width:b.width(),height:b.height(),offset:{top:b.scrollTop(),left:b.scrollLeft()}}:c.preventDefault?{width:0,height:0,offset:{top:c.pageY,left:c.pageX}}:{width:b.outerWidth(),height:b.outerHeight(),offset:b.offset()}}a.ui=a.ui||{};var f,g=Math.max,h=Math.abs,i=Math.round,j=/left|center|right/,k=/top|center|bottom/,l=/[\+\-]\d+(\.[\d]+)?%?/,m=/^\w+/,n=/%$/,o=a.fn.position;a.position={scrollbarWidth:function(){if(f!==b)return f;var c,d,e=a("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),g=e.children()[0];return a("body").append(e),c=g.offsetWidth,e.css("overflow","scroll"),d=g.offsetWidth,c===d&&(d=e[0].clientWidth),e.remove(),f=c-d},getScrollInfo:function(b){var c=b.isWindow||b.isDocument?"":b.element.css("overflow-x"),d=b.isWindow||b.isDocument?"":b.element.css("overflow-y"),e="scroll"===c||"auto"===c&&b.width<b.element[0].scrollWidth,f="scroll"===d||"auto"===d&&b.height<b.element[0].scrollHeight;return{width:f?a.position.scrollbarWidth():0,height:e?a.position.scrollbarWidth():0}},getWithinInfo:function(b){var c=a(b||window),d=a.isWindow(c[0]),e=!!c[0]&&9===c[0].nodeType;return{element:c,isWindow:d,isDocument:e,offset:c.offset()||{left:0,top:0},scrollLeft:c.scrollLeft(),scrollTop:c.scrollTop(),width:d?c.width():c.outerWidth(),height:d?c.height():c.outerHeight()}}},a.fn.position=function(b){if(!b||!b.of)return o.apply(this,arguments);b=a.extend({},b);var f,n,p,q,r,s,t=a(b.of),u=a.position.getWithinInfo(b.within),v=a.position.getScrollInfo(u),w=(b.collision||"flip").split(" "),x={};return s=e(t),t[0].preventDefault&&(b.at="left top"),n=s.width,p=s.height,q=s.offset,r=a.extend({},q),a.each(["my","at"],function(){var a,c,d=(b[this]||"").split(" ");1===d.length&&(d=j.test(d[0])?d.concat(["center"]):k.test(d[0])?["center"].concat(d):["center","center"]),d[0]=j.test(d[0])?d[0]:"center",d[1]=k.test(d[1])?d[1]:"center",a=l.exec(d[0]),c=l.exec(d[1]),x[this]=[a?a[0]:0,c?c[0]:0],b[this]=[m.exec(d[0])[0],m.exec(d[1])[0]]}),1===w.length&&(w[1]=w[0]),"right"===b.at[0]?r.left+=n:"center"===b.at[0]&&(r.left+=n/2),"bottom"===b.at[1]?r.top+=p:"center"===b.at[1]&&(r.top+=p/2),f=c(x.at,n,p),r.left+=f[0],r.top+=f[1],this.each(function(){var e,j,k=a(this),l=k.outerWidth(),m=k.outerHeight(),o=d(this,"marginLeft"),s=d(this,"marginTop"),y=l+o+d(this,"marginRight")+v.width,z=m+s+d(this,"marginBottom")+v.height,A=a.extend({},r),B=c(x.my,k.outerWidth(),k.outerHeight());"right"===b.my[0]?A.left-=l:"center"===b.my[0]&&(A.left-=l/2),"bottom"===b.my[1]?A.top-=m:"center"===b.my[1]&&(A.top-=m/2),A.left+=B[0],A.top+=B[1],a.support.offsetFractions||(A.left=i(A.left),A.top=i(A.top)),e={marginLeft:o,marginTop:s},a.each(["left","top"],function(c,d){a.ui.position[w[c]]&&a.ui.position[w[c]][d](A,{targetWidth:n,targetHeight:p,elemWidth:l,elemHeight:m,collisionPosition:e,collisionWidth:y,collisionHeight:z,offset:[f[0]+B[0],f[1]+B[1]],my:b.my,at:b.at,within:u,elem:k})}),b.using&&(j=function(a){var c=q.left-A.left,d=c+n-l,e=q.top-A.top,f=e+p-m,i={target:{element:t,left:q.left,top:q.top,width:n,height:p},element:{element:k,left:A.left,top:A.top,width:l,height:m},horizontal:0>d?"left":c>0?"right":"center",vertical:0>f?"top":e>0?"bottom":"middle"};l>n&&h(c+d)<n&&(i.horizontal="center"),m>p&&h(e+f)<p&&(i.vertical="middle"),g(h(c),h(d))>g(h(e),h(f))?i.important="horizontal":i.important="vertical",b.using.call(this,a,i)}),k.offset(a.extend(A,{using:j}))})},a.ui.position={fit:{left:function(a,b){var c,d=b.within,e=d.isWindow?d.scrollLeft:d.offset.left,f=d.width,h=a.left-b.collisionPosition.marginLeft,i=e-h,j=h+b.collisionWidth-f-e;b.collisionWidth>f?i>0&&0>=j?(c=a.left+i+b.collisionWidth-f-e,a.left+=i-c):j>0&&0>=i?a.left=e:i>j?a.left=e+f-b.collisionWidth:a.left=e:i>0?a.left+=i:j>0?a.left-=j:a.left=g(a.left-h,a.left)},top:function(a,b){var c,d=b.within,e=d.isWindow?d.scrollTop:d.offset.top,f=b.within.height,h=a.top-b.collisionPosition.marginTop,i=e-h,j=h+b.collisionHeight-f-e;b.collisionHeight>f?i>0&&0>=j?(c=a.top+i+b.collisionHeight-f-e,a.top+=i-c):j>0&&0>=i?a.top=e:i>j?a.top=e+f-b.collisionHeight:a.top=e:i>0?a.top+=i:j>0?a.top-=j:a.top=g(a.top-h,a.top)}},flip:{left:function(a,b){var c,d,e=b.within,f=e.offset.left+e.scrollLeft,g=e.width,i=e.isWindow?e.scrollLeft:e.offset.left,j=a.left-b.collisionPosition.marginLeft,k=j-i,l=j+b.collisionWidth-g-i,m="left"===b.my[0]?-b.elemWidth:"right"===b.my[0]?b.elemWidth:0,n="left"===b.at[0]?b.targetWidth:"right"===b.at[0]?-b.targetWidth:0,o=-2*b.offset[0];0>k?(c=a.left+m+n+o+b.collisionWidth-g-f,(0>c||c<h(k))&&(a.left+=m+n+o)):l>0&&(d=a.left-b.collisionPosition.marginLeft+m+n+o-i,(d>0||h(d)<l)&&(a.left+=m+n+o))},top:function(a,b){var c,d,e=b.within,f=e.offset.top+e.scrollTop,g=e.height,i=e.isWindow?e.scrollTop:e.offset.top,j=a.top-b.collisionPosition.marginTop,k=j-i,l=j+b.collisionHeight-g-i,m="top"===b.my[1],n=m?-b.elemHeight:"bottom"===b.my[1]?b.elemHeight:0,o="top"===b.at[1]?b.targetHeight:"bottom"===b.at[1]?-b.targetHeight:0,p=-2*b.offset[1];0>k?(d=a.top+n+o+p+b.collisionHeight-g-f,a.top+n+o+p>k&&(0>d||d<h(k))&&(a.top+=n+o+p)):l>0&&(c=a.top-b.collisionPosition.marginTop+n+o+p-i,a.top+n+o+p>l&&(c>0||h(c)<l)&&(a.top+=n+o+p))}},flipfit:{left:function(){a.ui.position.flip.left.apply(this,arguments),a.ui.position.fit.left.apply(this,arguments)},top:function(){a.ui.position.flip.top.apply(this,arguments),a.ui.position.fit.top.apply(this,arguments)}}},function(){var b,c,d,e,f,g=document.getElementsByTagName("body")[0],h=document.createElement("div");b=document.createElement(g?"div":"body"),d={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},g&&a.extend(d,{position:"absolute",left:"-1000px",top:"-1000px"});for(f in d)b.style[f]=d[f];b.appendChild(h),c=g||document.documentElement,c.insertBefore(b,c.firstChild),h.style.cssText="position: absolute; left: 10.7432222px;",e=a(h).offset().left,a.support.offsetFractions=e>10&&11>e,b.innerHTML="",c.removeChild(b)}()}(jQuery);var fluid_2_0_0=fluid_2_0_0||{},fluid=fluid||fluid_2_0_0;!function(a,b){"use strict";function c(a,b,c,d){for(var e=a[c],f=0;f<d.length-1;++f)e=d[f+1](e,c);b[c]=e}function d(a,c,d,e){for(var f=0;d>f;++f)a=e(a,c[f],f,b.makeArray(c));return a}function e(a,b,c,e){for(var f=[],g=0;g<a.length;++g){var h=d(a[g],b,c,e[g]);void 0!==h&&f.push(h)}return f}b.version="Infusion 2.0.0",b.Error=Error,b.environment={fluid:b},b.global=b.global||"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},b.invokeLater=function(a){return setTimeout(a,1)},b.defeatLogging=!0,b.activityTracing=!1,b.activityTrace=[];var f=/(%\w+)/g;b.renderOneActivity=function(a,b){for(var c=b===!0?[]:["    while "],d=a.message,e=f.lastIndex=0;;){var g=f.exec(d);if(!g)break;var h=g[1].substring(1);c.push(d.substring(e,g.index)),c.push(a.args[h]),e=f.lastIndex}return e<d.length&&c.push(d.substring(e)),c},b.renderActivity=function(a,c){return c=c||b.renderOneActivity,b.transform(a,c)},b.singleThreadLocal=function(a){var b=a();return function(a){return void 0===a?b:b=a}},b.threadLocal=b.singleThreadLocal,b.globalThreadLocal=b.threadLocal(function(){return{}}),b.getActivityStack=function(){var a=b.globalThreadLocal();return a.activityStack||(a.activityStack=[]),a.activityStack},b.describeActivity=b.getActivityStack,b.logActivity=function(a){a=a||b.describeActivity();var c=b.renderActivity(a).reverse();b.log("Current activity: "),b.each(c,function(a){b.doLog(a)})},b.pushActivity=function(a,c,d){var e={type:a,message:c,args:d,time:(new Date).getTime()};b.activityTracing&&b.activityTrace.push(e),b.passLogLevel(b.logLevel.TRACE)&&b.doLog(b.renderOneActivity(e,!0));var f=b.getActivityStack();f.push(e)},b.popActivity=function(a){a=a||1,b.activityTracing&&b.activityTrace.push({pop:a});var c=b.getActivityStack(),d=c.length-a;c.length=0>d?0:d},b.FluidError=function(){var a=Error.apply(this,arguments);this.message=a.message;try{throw a}catch(a){this.stack=a.stack}return this},b.FluidError.prototype=Object.create(Error.prototype),b.logFailure=function(a,c){b.log.apply(null,[b.logLevel.FAIL,"ASSERTION FAILED: "].concat(a)),b.logActivity(c)},b.renderLoggingArg=function(a){return b.isPrimitive(a)||!b.isPlainObject(a)?a:JSON.stringify(a)},b.builtinFail=function(a){var c=b.transform(a,b.renderLoggingArg).join("");throw new b.FluidError("Assertion failure - check console for more details: "+c)},b.fail=function(){var a=b.makeArray(arguments),c=b.makeArray(b.describeActivity());b.popActivity(c.length),b.failureEvent?b.failureEvent.fire(a,c):(b.logFailure(a,c),b.builtinFail(a,c))},b.expect=function(a,c,d){b.transform(b.makeArray(d),function(d){"undefined"==typeof c[d]&&b.fail(a+" missing required parameter "+d)})},b.isLogging=function(){return g[0].priority>b.logLevel.IMPORTANT.priority},b.isLogLevel=function(a){return b.isMarker(a)&&void 0!==a.priority},b.passLogLevel=function(a){return a.priority<=g[0].priority},b.setLogging=function(a){var c;"boolean"==typeof a?c=b.logLevel[a?"INFO":"IMPORTANT"]:b.isLogLevel(a)?c=a:b.fail("Unrecognised fluid logging level ",a),g.unshift(c),b.defeatLogging=!b.isLogging()},b.setLogLevel=b.setLogging,b.popLogging=function(){var a=1===g.length?g[0]:g.shift();return b.defeatLogging=!b.isLogging(),a},b.doLog=function(a){"undefined"!=typeof console&&(console.debug?console.debug.apply(console,a):"function"==typeof console.log&&console.log.apply(console,a))},b.log=function(){var a=b.makeArray(arguments),c=b.logLevel.INFO;if(b.isLogLevel(a[0])&&(c=a.shift()),b.passLogLevel(c)){var d=b.renderTimestamp(new Date)+":  ",e=[d].concat(a);b.doLog(e)}},b.isValue=function(a){return void 0!==a&&null!==a},b.isPrimitive=function(a){var b=typeof a;return!a||"string"===b||"boolean"===b||"number"===b||"function"===b},b.isArrayable=function(a){return a&&(a.jquery||"[object Array]"===Object.prototype.toString.call(a))},b.isPlainObject=function(a){var b=Object.prototype.toString.call(a);return"[object Array]"===b?!0:"[object Object]"!==b?!1:!a.constructor||!a.constructor.prototype||Object.prototype.hasOwnProperty.call(a.constructor.prototype,"isPrototypeOf")},b.typeCode=function(a){return b.isPrimitive(a)||!b.isPlainObject(a)?"primitive":b.isArrayable(a)?"array":"object"},b.isDOMNode=function(a){return a&&"number"==typeof a.nodeType},b.isComponent=function(a){return a&&a.constructor===b.componentConstructor},b.identity=function(a){return a},b.notImplemented=function(){b.fail("This operation is not implemented")},b.freshContainer=function(a){return b.isArrayable(a)?[]:{}},b.isUncopyable=function(a){return b.isPrimitive(a)||!b.isPlainObject(a)},b.copyRecurse=function(a,c){return c.length>b.strategyRecursionBailout&&b.fail("Runaway recursion encountered in fluid.copy - reached path depth of "+b.strategyRecursionBailout+" via path of "+c.join(".")+"this object is probably circularly connected. Either adjust your object structure to remove the circularity or increase fluid.strategyRecursionBailout"),b.isUncopyable(a)?a:b.transform(a,function(a,d){c.push(d);var e=b.copyRecurse(a,c);return c.pop(),e})},b.copy=function(a){return b.copyRecurse(a,[])},b.makeArray=function(a){var c=[];if(null!==a&&void 0!==a)if(b.isPrimitive(a)||"number"!=typeof a.length)c.push(a);else for(var d=0;d<a.length;++d)c[d]=a[d];return c},b.transform=function(a){if(b.isPrimitive(a))return a;var d=b.freshContainer(a);if(b.isArrayable(a))for(var e=0;e<a.length;++e)c(a,d,e,arguments);else for(var f in a)c(a,d,f,arguments);return d},b.each=function(a,c){if(b.isArrayable(a))for(var d=0;d<a.length;++d)c(a[d],d);else for(var e in a)c(a[e],e)},b.make_find=function(a){var c=a?!1:void 0;return function(d,e,f){var g;if(b.isArrayable(d)){for(var h=0;h<d.length;++h)if(g=e(d[h],h),g!==c)return a?d[h]:g}else for(var i in d)if(g=e(d[i],i),g!==c)return a?d[i]:g;return f}},b.find=b.make_find(!1),b.find_if=b.make_find(!0),b.accumulate=function(a,b,c){for(var d=0;d<a.length;++d)c=b(a[d],c,d);return c},b.remove_if=function(a,c,d){if(b.isArrayable(a))for(var e=a.length-1;e>=0;--e)c(a[e],e)&&(d&&d.unshift(a[e]),a.splice(e,1));else for(var f in a)c(a[f],f)&&(d&&(d[f]=a[f]),delete a[f]);return d||a},b.generate=function(a,b,c){for(var d=[],e=0;a>e;++e)d[e]=c?b(e):b;return d},b.iota=function(a,b){b=b||0;for(var c=[],d=0;a>d;++d)c[c.length]=b++;return c},b.getMembers=function(a,c){return b.transform(a,function(a){return b.get(a,c)})},b.filterKeys=function(c,d,e){return b.remove_if(a.extend({},c),function(a,b){return e^-1===d.indexOf(b)})},b.censorKeys=function(a,c){return b.filterKeys(a,c,!0)},b.makeFlatten=function(a){return function(c){var d=[];return b.each(c,function(){d.push(arguments[a])}),d}},b.keys=b.makeFlatten(1),b.values=b.makeFlatten(0),b.contains=function(a,c){return a?b.isArrayable(a)?-1!==a.indexOf(c):b.find(a,function(a){return c===a?!0:void 0}):void 0},b.keyForValue=function(a,c){return b.find(a,function(a,b){return c===a?b:void 0})},b.arrayToHash=function(a){var c={};return b.each(a,function(a){c[a]=!0}),c},b.stableSort=function(a,b){for(var c=0;c<a.length;c++){for(var d=a[c],e=c;e>0&&b(d,a[e-1])<0;e--)a[e]=a[e-1];a[e]=d}},b.hashToArray=function(c,d,e){var f=[];return b.each(c,function(b,c){var g={};g[d]=c,e?g=e(g,b,c)||g:a.extend(!0,g,b),f.push(g)}),f},b.flatten=function(a){var c=[];return b.each(a,function(a){b.isArrayable(a)?c=c.concat(a):c.push(a)}),c},b.clear=function(a){if(b.isArrayable(a))a.length=0;else for(var c in a)delete a[c]},b.compareStringLength=function(a){return a?function(a,b){return a.length-b.length}:function(a,b){return b.length-a.length}},b.parseInteger=function(a){return isFinite(a)&&a%1===0?Number(a):NaN},b.marker=function(){},b.makeMarker=function(c,d){var e=Object.create(b.marker.prototype);return e.value=c,a.extend(e,d),Object.freeze(e)},b.VALUE=b.makeMarker("VALUE"),b.NO_VALUE=b.makeMarker("NO_VALUE"),b.EXPAND=b.makeMarker("EXPAND"),b.isMarker=function(a,c){return a instanceof b.marker?c?a.value===c.value:!0:!1},b.logLevelsSpec={FATAL:0,FAIL:5,WARN:10,IMPORTANT:12,INFO:15,TRACE:20},b.logLevel=b.transform(b.logLevelsSpec,function(a,c){return b.makeMarker(c,{priority:a})});var g=[b.logLevel.IMPORTANT];b.model={},b.model.copyModel=function(c,d){b.clear(c),a.extend(!0,c,d)},b.model.parseEL=function(a){return""===a?[]:String(a).split(".")},b.model.composePath=function(a,b){return""===a?b:""===b?a:a+"."+b},b.model.composeSegments=function(){return b.makeArray(arguments).join(".")},b.lastDotIndex=function(a){return a.lastIndexOf(".")},b.model.getToTailPath=function(a){var c=b.lastDotIndex(a);return-1===c?"":a.substring(0,c)},b.model.getTailPath=function(a){var c=b.lastDotIndex(a);return a.substring(c+1)},b.path=b.model.composeSegments,b.composePath=b.model.composePath,b.requireDataBinding=function(){b.fail("Please include DataBinding.js in order to operate complex model accessor configuration")},b.model.setWithStrategy=b.model.getWithStrategy=b.requireDataBinding,b.model.resolvePathSegment=function(a,b,c,d){return!d&&a.resolvePathSegment?a.resolvePathSegment(b):c&&void 0===a[b]?a[b]={}:a[b]},b.model.parseToSegments=function(a,c,d){return"number"==typeof a||"string"==typeof a?c(a):d?b.makeArray(a):a},b.model.pathToSegments=function(a,c){var d=c&&c.parser?c.parser.parse:b.model.parseEL;return b.model.parseToSegments(a,d)},b.model.accessImpl=function(a,c,d,e,f,g,h){var i=b.model.pathToSegments(c,e),j=0;f&&(j=f.length,i=f.concat(i));var k=d===b.NO_VALUE?0:1;return a=h(a,i,j,e,k),d===b.NO_VALUE||d===b.VALUE?g?{root:a,segs:i}:a:void(a[i[i.length-1]]=d)},b.model.accessSimple=function(a,c,d,e,f,g){return b.model.accessImpl(a,c,d,e,f,g,b.model.traverseSimple)},b.model.traverseSimple=function(a,c,d,e,f){for(var g=e,h=c.length-f,i=0;h>i;++i){if(!a)return a;var j=c[i];a=e&&e[j]?e[j]:b.model.resolvePathSegment(a,j,1===f,g),e=null}return a},b.model.setSimple=function(a,c,d,e,f){b.model.accessSimple(a,c,d,e,f,!1)},b.model.getSimple=function(a,c,d,e){return null===c||void 0===c||0===c.length?a:b.model.accessSimple(a,c,b.NO_VALUE,d,e,!1)},b.getImmediate=function(a,b,c){for(var d=void 0===c?b.length:c+1,e=0;d>e;++e)a=a?a[b[e]]:void 0;return a},b.decodeAccessorArg=function(a){return a&&a!==b.model.defaultGetConfig&&a!==b.model.defaultSetConfig?"environment"===a.type?a.value:void 0:null},b.set=function(a,c,d,e,f){var g=b.decodeAccessorArg(e);void 0===g?b.model.setWithStrategy(a,c,d,e,f):b.model.setSimple(a,c,d,g,f)},b.get=function(a,c,d,e){var f=b.decodeAccessorArg(d);return void 0===f?b.model.getWithStrategy(a,c,d,e):b.model.accessImpl(a,c,b.NO_VALUE,f,null,!1,b.model.traverseSimple)},b.getGlobalValue=function(a,c){return a?(c=c||b.environment,b.get(b.global,a,{type:"environment",value:c})):void 0},b.bind=function(a,c,d){return a[c].apply(a,b.makeArray(d))},b.invokeGlobalFunction=function(a,c,d){var e=b.getGlobalValue(a,d);return e?e.apply(null,b.isArrayable(c)?c:b.makeArray(c)):void b.fail("Error invoking global function: "+a+" could not be located")},b.registerGlobalFunction=function(a,c,d){d=d||b.environment,b.set(b.global,a,c,{type:"environment",value:d})},b.setGlobalValue=b.registerGlobalFunction,b.registerNamespace=function(a,c){c=c||b.environment;var d=b.getGlobalValue(a,c);return d||(d={},b.setGlobalValue(a,d,c)),d},b.dumpEl=b.identity,b.renderTimestamp=b.identity,b.generateUniquePrefix=function(){return Math.floor(1e12*Math.random()).toString(36)+"-"};var h=b.generateUniquePrefix();b.fluidInstance=h;var i=1;b.allocateGuid=function(){return h+i++},b.registerNamespace("fluid.event"),b.extremePriority=4e9,b.priorityTypes={first:-1,last:1,before:0,after:0},b.extremalPriorities={none:0,testing:10,authoring:20},b.parsePriorityConstraint=function(a,c,d){var e=a.split(":"),f=e[0],g=b.priorityTypes[f];return void 0===g&&b.fail("Invalid constraint type in priority field "+a+": the only supported values are "+b.keys(b.priorityTypes).join(", ")+" or numeric"),c&&0===g&&b.fail("Constraint type in priority field "+a+" is not supported in a "+d+" record - you must use either a numeric value or first, last"),{type:e[0],target:e[1]}},b.parsePriority=function(a,c,d,e){a=a||0;var f={count:c||0,fixed:null,constraint:null,site:e};"number"==typeof a?f.fixed=-a:f.constraint=b.parsePriorityConstraint(a,d,e);var g=f.constraint?b.priorityTypes[f.constraint.type]:0;if(0!==g){var h=f.constraint.target||"none",i=b.extremalPriorities[h];void 0===i&&b.fail("Unrecognised extremal priority target "+h+": the currently supported values are "+b.keys(b.extremalPriorities).join(", ")+": register your value in fluid.extremalPriorities"),f.fixed=g*(b.extremePriority+i)}return null!==f.fixed&&(f.fixed+=f.count/1024),f},b.renderPriority=function(a){return a.constraint?a.constraint.target?a.constraint.type+":"+a.constraint.target:a.constraint.type:Math.floor(a.fixed)},b.compareByPriority=function(a,b){return null!==a.priority.fixed&&null!==b.priority.fixed?a.priority.fixed-b.priority.fixed:(null===a.priority.fixed)-(null===b.priority.fixed)},b.honourConstraint=function(a,c,d){var e=a[d].priority.constraint,f=b.find(a,function(a,b){return a.namespace===e.target?b:void 0},-1);if(-1===f)return!0;if(f>=c)return!1;for(var g="after"===e.type?1:0,h=f+g,i=a[d],j=d;j>=h;--j)a[j]=a[j-1];return a[h]=i,!0},b.sortByPriority=function(a){b.stableSort(a,b.compareByPriority);for(var c=b.find(a,function(a,c){return a.priority.constraint&&0===b.priorityTypes[a.priority.constraint.type]?c:void 0},a.length);;){if(c===a.length)return a;for(var d=c,e=c;e<a.length;++e){var f=b.honourConstraint(a,c,e);f&&++c}if(c===d){var g=a.slice(c);b.fail("Could not find targets for any constraints in "+g[0].priority.site+" ",g,": none of the targets ("+b.getMembers(g,"priority.constraint.target").join(", ")+") matched any namespaces of the elements in (",a.slice(0,c)+") - this is caused by either an invalid or circular reference")}}},b.event.identifyListener=function(a,c){return"string"==typeof a||a.$$fluid_guid||c||(a.$$fluid_guid=b.allocateGuid()),a.$$fluid_guid},b.event.impersonateListener=function(a,c){b.event.identifyListener(a),c.$$fluid_guid=a.$$fluid_guid},b.event.sortListeners=function(a){var c=[];return b.each(a,function(a){for(var b,d=0;d<a.length;++d){var e=a[d];e.softNamespace||b||(b=e)}b?c.push(b):c=c.concat(a)}),b.sortByPriority(c)},b.event.invokeListener=function(a,c){return"string"==typeof a&&(a=b.event.resolveListener(a)),a.apply(null,c)},b.event.resolveListener=function(a){var c=a.globalName||("string"==typeof a?a:null);if(c){var d=b.getGlobalValue(c);d?a=d:b.fail("Unable to look up name "+c+" as a global function")}return a},b.nameComponent=function(a){return a?"component with typename "+a.typeName+" and id "+a.id:"[unknown component]"},b.event.nameEvent=function(a,c){return c+" of "+b.nameComponent(a)},b.makeEventFirer=function(a){a=a||{};var c,d=a.name||"<anonymous>",e=function(){c.listeners={},c.byId={},c.sortedListeners=[],c.addListener=function(a,d,e,f,g){if(c.destroyed&&b.fail("Cannot add listener to destroyed event firer "+c.name),a){"string"==typeof a&&(a={globalName:a});var h=g||b.event.identifyListener(a);d=d||h;var i={listener:a,namespace:d,softNamespace:f,listenerId:g,priority:b.parsePriority(e,c.sortedListeners.length,!1,"listeners")};c.byId[h]=i;var j=c.listeners[d]=b.makeArray(c.listeners[d]);j[f?"push":"unshift"](i),c.sortedListeners=b.event.sortListeners(c.listeners)}},c.addListener.apply(null,arguments)};return c={eventId:b.allocateGuid(),name:d,ownerId:a.ownerId,typeName:"fluid.event.firer",destroy:function(){c.destroyed=!0},addListener:function(){e.apply(null,arguments)},removeListener:function(a){if(c.listeners){var d,e,f;"string"==typeof a?(d=a,f=c.listeners[d],f||(e=d,d=null)):"function"==typeof a&&(e=b.event.identifyListener(a,!0),e||b.fail("Cannot remove unregistered listener function ",a," from event "+c.name));var g=c.byId[e],h=g&&g.softNamespace;d=d||g&&g.namespace||e,delete c.byId[e],f=c.listeners[d],f&&(h?b.remove_if(f,function(a){return a.listener.$$fluid_guid===e||a.listenerId===e}):f.shift(),0===f.length&&delete c.listeners[d]),c.sortedListeners=b.event.sortListeners(c.listeners)}},fire:function(){var e=c.sortedListeners;if(e&&!c.destroyed){b.log(b.logLevel.TRACE,"Firing event "+d+" to list of "+e.length+" listeners");for(var f=0;f<e.length;++f){var g=e[f];g.listener=b.event.resolveListener(g.listener);var h,i=g.listener,j=i.apply(null,arguments);if((a.preventable&&j===!1||c.destroyed)&&(h=!1),void 0!==h)return h}}}}},b.event.addListenerToFirer=function(a,c,d,e){if(e=e||b.identity,b.isArrayable(c))for(var f=0;f<c.length;++f)b.event.addListenerToFirer(a,c[f],d,e);else"function"==typeof c||"string"==typeof c?e(a).addListener(c,d):c&&"object"==typeof c&&e(a).addListener(c.listener,d||c.namespace,c.priority,c.softNamespace,c.listenerId)},b.event.resolveListenerRecord=function(a){return{records:a}},b.expandImmediate=function(a){b.fail("fluid.expandImmediate could not be loaded - please include FluidIoC.js in order to operate IoC-driven event with descriptor "+a)},b.mergeListeners=function(a,c,d){b.each(d,function(d,e){var f,g;if("{"===e.charAt(0))f=b.expandImmediate(e,a),f||b.fail("Error in listener record: key "+e+' could not be looked up to an event firer - did you miss out "events." when referring to an event firer?');else{var h=e.indexOf(".");-1!==h&&(g=e.substring(h+1),e=e.substring(0,h)),c[e]||b.fail("Listener registered for event "+e+" which is not defined for this component"),f=c[e]}var i=b.event.resolveListenerRecord(d,a,e,g,!0);b.event.addListenerToFirer(f,i.records,g,i.adderWrapper)})},b.eventFromRecord=function(a,c,d){var e,f=a&&("string"!=typeof a||"{"===a.charAt(0));return f?b.event.resolveEvent?e=b.event.resolveEvent(d,c,a):b.fail("fluid.event.resolveEvent could not be loaded - please include FluidIoC.js in order to operate IoC-driven event with descriptor ",a):e=b.makeEventFirer({name:b.event.nameEvent(d,c),preventable:"preventable"===a,ownerId:d.id}),e},b.instantiateFirers=function(a,c){b.each(c.events,function(c,d){a.events[d]=b.eventFromRecord(c,d,a)})},b.mergeListenerPolicy=function(a,c,d){"string"!=typeof d&&b.fail("Error in listeners declaration - the keys in this structure must resolve to event names - got "+d+" from ",c);var e="{"!==d.charAt(0)&&-1!==d.indexOf(".");return e?c||a:b.arrayConcatPolicy(a,c)},b.makeMergeListenersPolicy=function(a){return function(c,d){return c=c||{},b.each(d,function(b,d){c[d]=a(c[d],b,d)}),c}},b.validateListenersImplemented=function(a){var c=[];return b.each(a.events,function(d,e){b.each(d.sortedListeners,function(d){d.listener!==b.notImplemented&&"fluid.notImplemented"!==d.listener.globalName||c.push({name:e,namespace:d.namespace,componentSource:b.model.getSimple(a.options.listeners,[e+"."+d.namespace,0,"componentSource"])})})}),c},b.unique=function(a){return b.remove_if(a,function(b,c){return!b||c>0&&b===a[c-1]})},b.arrayConcatPolicy=function(a,c){return b.makeArray(a).concat(b.makeArray(c))},b.failureEvent=b.makeEventFirer({name:"failure event"}),b.failureEvent.addListener(b.builtinFail,"fail"),b.failureEvent.addListener(b.logFailure,"log","before:fail"),b.pushSoftFailure=function(a){"function"==typeof a?b.failureEvent.addListener(a,"fail"):-1===a?b.failureEvent.removeListener("fail"):"boolean"==typeof a&&b.fail("pushSoftFailure with boolean value is no longer supported")},b.componentConstructor=function(){},b.typeTag=function(a){var c=Object.create(b.componentConstructor.prototype);return c.typeName=a,c.id=b.allocateGuid(),c};var j=1,k={};b.defaultsStore={};var l=function(a,c,d){var e=!0;d?e=1===c.length:c=b.makeArray(c);for(var f=c.length-1;f>=0;--f){var g=c[f];if(g&&!a.gradeHash[g]){var h="{"===g.charAt(0),i=(h?null:e?b.rawDefaults(g):b.getGradedDefaults(g))||{},m=k[g]||j-1;a.lastTick=Math.max(a.lastTick,m),a.gradeHash[g]=!0,a.gradeChain.push(g),a.optionsChain.push(i);for(var n=b.makeArray(i.gradeNames),o=n.length-1;o>=0;--o){var p=n[o];e?l(a,p):a.gradeHash[p]||(a.gradeHash[p]=!0,a.gradeChain.push(p))}}}return a};b.resolveGradeStructure=function(a,c){var d={lastTick:0,gradeChain:[],gradeHash:{},optionsChain:[]};return l(d,[a].concat(b.makeArray(c)),!0)};var m={};b.gradeNamesToKey=function(a,b){return a+"|"+b.join("|")},b.hasGrade=function(a,c){return a&&a.gradeNames?b.contains(a.gradeNames,c):!1},b.resolveGrade=function(c,d,e){for(var f=b.resolveGradeStructure(d,e),g=f.optionsChain.reverse(),h={},i=0;i<g.length;++i)g[i]&&g[i].mergePolicy&&(h=a.extend(!0,h,g[i].mergePolicy));g=[h,{}].concat(g);var j=b.merge.apply(null,g);return j.gradeNames=f.gradeChain.reverse(),{defaults:j,lastTick:f&&f.lastTick}},b.getGradedDefaults=function(a,c){c=b.makeArray(c);var d=b.gradeNamesToKey(a,c),e=m[d];if(e){for(var f=0,g=e.defaults.gradeNames||[],h=0;h<g.length;++h)f=Math.max(f,k[g[h]]||0);f>e.lastTick&&(b.log("Clearing cache for component "+a+" with gradeNames ",g),e=null)}if(!e){var i=b.rawDefaults(a);if(!i)return i;e=m[d]=b.resolveGrade(i,a,c)}return e.defaults},b.upgradePrimitiveFunc=function(a,c){if(a&&b.isPrimitive(a)){var d={};return d[c||("string"==typeof a&&"{"!==a.charAt(0)?"funcName":"func")]=a,
d.args=b.NO_VALUE,d}return a},b.annotateListeners=function(a,c){c.listeners=b.transform(c.listeners,function(c){var d=b.makeArray(c);return b.transform(d,function(c){return c=b.upgradePrimitiveFunc(c,"listener"),c.componentSource=a,c})}),c.invokers=b.transform(c.invokers,function(c){return c=b.upgradePrimitiveFunc(c),c&&(c.componentSource=a),c})},b.rawDefaults=function(a,c){if(void 0===c){var d=b.defaultsStore[a];return d&&d.options}b.pushActivity("registerDefaults","registering defaults for grade %componentName with options %options",{componentName:a,options:c});var e=b.expandCompact?b.expandCompact(c):b.copy(c);b.annotateListeners(a,e);var f=b.getCallerInfo&&b.getCallerInfo(6);b.defaultsStore[a]={options:e,callerInfo:f},k[a]=j++,b.popActivity()},b.doIndexDefaults=function(a,c,d,e){for(var f=b.makeArray(e.gradeNames),g=0;g<f.length;++g)if(!b.hasGrade(c,f[g]))return;for(var h="function"==typeof e.indexFunc?e.indexFunc:b.getGlobalValue(e.indexFunc),i=h(c)||[],j=0;j<i.length;++j)(d[i[j]]=d[i[j]]||[]).push(a)},b.indexDefaults=function(a,c){var d={};for(var e in b.defaultsStore){var f=b.getGradedDefaults(e);b.doIndexDefaults(e,f,d,c)}return d},b.defaults=function(a,c){if(void 0===c)return b.getGradedDefaults(a);c&&c.options&&b.fail("Probable error in options structure for "+a+' with option named "options" - perhaps you meant to write these options at top level in fluid.defaults? - ',c),b.rawDefaults(a,c);var d=b.getGradedDefaults(a);b.hasGrade(d,"fluid.function")||b.makeComponentCreator(a)},b.makeComponentCreator=function(c){var d=function(){var a=b.getGradedDefaults(c);if(a.gradeNames&&0!==a.gradeNames.length){if(a.initFunction)return b.initComponent(c,arguments);for(var d=[],e=0;e<a.gradeNames.length;++e){var f=a.gradeNames[e],g=b.rawDefaults(f);g||d.push(f)}0===d.length?b.fail("Cannot make component creator for type "+c+" which does not have an initFunction defined"):b.fail("The grade hierarchy of component with type "+c+" is incomplete - it inherits from the following grade(s): "+d.join(", ")+" for which the grade definitions are corrupt or missing. Please check the files which might include these grades and ensure they are readable and have been loaded by this instance of Infusion")}else b.fail("Cannot make component creator for type "+c+" which does not have any gradeNames defined")},e=b.getGlobalValue(c);e&&a.extend(d,e),b.setGlobalValue(c,d)};var n={};b.derefMergePolicy=function(a){return(a?a["*"]:n)||n},b.compileMergePolicy=function(a){var c={},d={},e={builtins:c,defaultValues:d};return a?(b.each(a,function(a,f){var g={},h=!0;if("function"==typeof a)g.func=a;else if("object"==typeof a)g=a;else if(b.isDefaultValueMergePolicy(a))b.set(d,f,"{that}.options."+a),e.hasDefaults=!0,h=!1;else for(var i=a.split(/\s*,\s*/),j=0;j<i.length;++j)g[i[j]]=!0;h&&b.set(c,b.composePath(f,"*"),g)}),e):e},b.isDefaultValueMergePolicy=function(a){return"string"==typeof a&&-1===a.indexOf(",")&&!/replace|nomerge|noexpand/.test(a)},b.mergeOneImpl=function(a,c,d,e,f,g,h){var i=a,j=b.isPrimitive(a);return void 0!==c&&(f.func||null===c||!b.isPlainObject(c)||f.nomerge?(e[d]=void 0,i=f.func?f.func.call(null,a,c,h[g-1],h,g):c):j&&(i=a=b.freshContainer(c))),i},b.fetchMergeChildren=function(a,c,d,e,f,g){for(var h=b.derefMergePolicy(f),i=e.length-1;i>=0;--i){var j=e[i];if(void 0!==j&&(b.each(j,function(h,i){i in a||(d[c]=i,b.getImmediate(g.exceptions,d,c)||g.strategy(a,i,c+1,d,e,f))}),h.replace))break}return a},b.inEvaluationMarker=Object.freeze({__CURRENTLY_IN_EVALUATION__:!0}),b.strategyRecursionBailout=50,b.makeMergeStrategy=function(a){var c=function(c,f,g,h,i,j){if(g>b.strategyRecursionBailout&&b.fail("Overflow/circularity in options merging, current path is ",h," at depth ",g,' - please protect components from merging using the "nomerge" merge policy'),!b.isPrimitive(c)){b.isTracing&&b.tracing.pathCount.push(b.path(h.slice(0,g)));var k;if(f in c){if(k=c[f],!a.evaluateFully)return k}else c!==b.inEvaluationMarker&&(c[f]=b.inEvaluationMarker);void 0===i&&(h=b.makeArray(h),i=e(a.sources,h,g-1,a.sourceStrategies),j=d(a.mergePolicy,h,g-1,b.concreteTrundler));var l,m,n,o=b.concreteTrundler(j,f),p=b.derefMergePolicy(o);p.replace?(l=1-i.length,m=0,n=-1):(l=0,m=i.length-1,n=1);for(var q,r=[],s=l;m>=s;++s){var t=n*s,u=a.sourceStrategies[t](i[t],f,g,h);if(void 0!==u&&(r[t]=u,void 0===k)){if(-1===n){q=c[f]=u;break}q=b.mergeOneImpl(q,u,s,r,p,g,h,a),c!==b.inEvaluationMarker&&(c[f]=q)}}return void 0!==k&&(q=k),r.length>0&&b.isPlainObject(q)&&b.fetchMergeChildren(q,g,h,r,o,a),void 0===k&&0===r.length&&delete c[f],q}};return a.strategy=c,c},b.driveStrategy=function(a,c,d){c=b.makeArray(c);for(var e=0;e<c.length;++e){if(!a)return;a=d(a,c[e],e+1,c)}return a},b.concreteTrundler=function(a,b){return a?a[b]:void 0},b.merge=function(a){var c=Array.prototype.slice.call(arguments,1),d=b.compileMergePolicy(a).builtins,e=b.makeMergeOptions(d,c,{});return e.initter(),e.target},b.simpleGingerBlock=function(a,c){var d={target:a,simple:!0,strategy:b.concreteTrundler,initter:b.identity,recordType:c,priority:b.mergeRecordTypes[c]};return d},b.makeMergeOptions=function(c,d,e){var f={mergePolicy:c,sources:d};return f=a.extend(f,e),f.target=f.target||b.freshContainer(f.sources[0]),f.sourceStrategies=f.sourceStrategies||b.generate(f.sources.length,b.concreteTrundler),f.initter=function(){f.evaluateFully=!0,b.fetchMergeChildren(f.target,0,[],f.sources,f.mergePolicy,f)},b.makeMergeStrategy(f),f},b.transformOptions=function(a,c){b.expect("Options transformation record",c,["transformer","config"]);var d=b.getGlobalValue(c.transformer);return d.call(null,a,c.config)},b.findMergeBlocks=function(a,c){return b.remove_if(b.makeArray(a),function(a){return a.recordType!==c})},b.transformOptionsBlocks=function(a,c,d){b.each(d,function(d){var e=b.findMergeBlocks(a,d);b.each(e,function(a){var d=a.source?"source":"target";a[a.simple||"target"===d?"target":"source"]=b.transformOptions(a[d],c)})})},b.dedupeDistributionNamespaces=function(a){var c={};b.remove_if(a,function(a){var b=a.namespace;if(b){if(c[b]&&c[b]!==a.contextThat.id)return!0;c[b]=a.contextThat.id}})},b.deliverOptionsStrategy=b.identity,b.computeComponentAccessor=b.identity,b.computeDynamicComponents=b.identity,b.mergeRecordTypes={defaults:1e3,defaultValueMerge:900,subcomponentRecord:800,user:700,distribution:100},b.model.applyChangeRequest=function(c,d){var e=d.segs;if(0===e.length)"ADD"===d.type?a.extend(!0,c,d.value):b.clear(c);else if("ADD"===d.type)b.model.setSimple(c,d.segs,d.value);else{for(var f=0;f<e.length-1;++f)if(c=c[e[f]],!c)return;var g=e[e.length-1];delete c[g]}},b.destroyValue=function(a,c){a&&b.model.applyChangeRequest(a,{type:"DELETE",segs:c})},b.mergeComponentOptions=function(c,d,e,f){function g(){s=b.driveStrategy(l,"mergePolicy",q.strategy),s=a.extend({},b.rootMergePolicy,s),r=b.compileMergePolicy(s),a.extend(!0,j,r.builtins)}var h=b.rawDefaults(d),i=b.getGradedDefaults(d,h&&h.gradeNames?null:f.gradeNames),j={},k=[];k=b.expandComponentOptions?k.concat(b.expandComponentOptions(j,i,e,c)):k.concat([b.simpleGingerBlock(i,"defaults"),b.simpleGingerBlock(e,"user")]);var l={},m=[],n=[],o={target:l,sourceStrategies:m},p=function(){b.each(k,function(a){b.isPrimitive(a.priority)&&(a.priority=b.parsePriority(a.priority,0,!1,"options distribution"))}),b.sortByPriority(k),b.dedupeDistributionNamespaces(k),m.length=0,n.length=0,b.each(k,function(a){m.push(a.strategy),n.push(a.target)})};p();var q=b.makeMergeOptions(j,n,o);q.mergeBlocks=k,q.updateBlocks=p,q.destroyValue=function(a){for(var c=0;c<k.length;++c)b.destroyValue(k[c].target,a);b.destroyValue(o.target,a)};var r,s;g(),q.computeMergePolicy=g,r.hasDefaults&&(b.generateExpandBlock?(k.push(b.generateExpandBlock({options:r.defaultValues,recordType:"defaultValueMerge",priority:b.mergeRecordTypes.defaultValueMerge},c,{})),p()):b.fail("Cannot operate mergePolicy ",s," for component ",c," without including FluidIoC.js")),c.options=l,b.driveStrategy(l,"gradeNames",q.strategy),b.deliverOptionsStrategy(c,l,q),b.computeComponentAccessor(c,e&&e.localRecord);var t=b.driveStrategy(l,"transformOptions",q.strategy);return t&&(b.transformOptionsBlocks(k,t,["user","subcomponentRecord"]),p()),o.target.mergePolicy||g(),q},b.defaults("fluid.function",{}),b.invokeGradedFunction=function(a,c){var d=b.defaults(a);d&&d.argumentMap&&b.hasGrade(d,"fluid.function")||b.fail("Cannot look up name "+a+" to a function with registered argumentMap - got defaults ",d);var e=[];return b.each(d.argumentMap,function(a,b){e[a]=c[b]}),b.invokeGlobalFunction(a,e)},b.noNamespaceDistributionPrefix="no-namespace-distribution-",b.mergeOneDistribution=function(c,d,e){var f=d.namespace||e||b.noNamespaceDistributionPrefix+b.allocateGuid();d.namespace=f,c[f]=a.extend(!0,{},c[f],d)},b.distributeOptionsPolicy=function(a,c){if(a=a||{},b.isArrayable(c))for(var d=0;d<c.length;++d)b.mergeOneDistribution(a,c[d]);else"string"==typeof c.target?b.mergeOneDistribution(a,c):b.each(c,function(c,d){b.mergeOneDistribution(a,c,d)});return a},b.mergingArray=function(){},b.mergingArray.prototype=[],b.membersMergePolicy=function(a,c){return a=a||{},b.each(c,function(c,d){a[d]||(a[d]=new b.mergingArray),c instanceof b.mergingArray?a[d].push.apply(a[d],c):void 0!==c&&a[d].push(c)}),a},b.invokerStrategies=b.arrayToHash(["func","funcName","listener","this","method"]),b.invokersMergePolicy=function(c,d){return c=c||{},b.each(d,function(d,e){if(!d)return void(c[e]=d);d=b.upgradePrimitiveFunc(d);var f=c[e];f||(f=c[e]={});for(var g in b.invokerStrategies)if(g in d)for(var h in b.invokerStrategies)f[h]=void 0;a.extend(f,d)}),c},b.rootMergePolicy={gradeNames:b.arrayConcatPolicy,distributeOptions:b.distributeOptionsPolicy,members:{noexpand:!0,func:b.membersMergePolicy},invokers:{noexpand:!0,func:b.invokersMergePolicy},transformOptions:"replace",listeners:b.makeMergeListenersPolicy(b.mergeListenerPolicy)},b.defaults("fluid.component",{initFunction:"fluid.initLittleComponent",mergePolicy:b.rootMergePolicy,argumentMap:{options:0},events:{onCreate:null,onDestroy:null,afterDestroy:null}}),b.defaults("fluid.emptySubcomponent",{gradeNames:["fluid.component"]}),b.computeNickName=function(a){var c=b.model.parseEL(a);return c[c.length-1]},b.defaults("fluid.typeFount",{gradeNames:["fluid.component"]}),b.initLittleComponent=function(a,c,d,e){var f=b.typeTag(a);f.lifecycleStatus="constructing",d=d||{gradeNames:"fluid.component"},f.destroy=b.makeRootDestroy(f);var g=b.mergeComponentOptions(f,a,c,d);g.exceptions={members:{model:!0,modelRelay:!0}};var h=f.options;f.events={},(e||b.identity)(f,h,g.strategy),b.computeDynamicComponents(f,g);for(var i=0;i<g.mergeBlocks.length;++i)g.mergeBlocks[i].initter();return g.initter(),delete h.mergePolicy,b.instantiateFirers(f,h),b.mergeListeners(f,f.events,h.listeners),f},b.diagnoseFailedView=b.identity,b.makeRootDestroy=function(a){return function(){b.doDestroy(a),a.events.afterDestroy.fire(a,"",null)}},b.isDestroyed=function(a){return"destroyed"===a.lifecycleStatus},b.doDestroy=function(a,b,c){a.events.onDestroy.fire(a,b||"",c),a.lifecycleStatus="destroyed";for(var d in a.events)"afterDestroy"!==d&&"function"==typeof a.events[d].destroy&&a.events[d].destroy();a.applier&&a.applier.destroy()},b.initComponent=function(a,c){var d=b.defaults(a);d.gradeNames||b.fail("Cannot initialise component "+a+" which has no gradeName registered");var e,f=[a].concat(b.makeArray(c));b.pushActivity("initComponent","constructing component of type %componentName with arguments %initArgs",{componentName:a,initArgs:c}),e=b.invokeGlobalFunction(d.initFunction,f),b.diagnoseFailedView(a,e,d,f),b.initDependents&&b.initDependents(e);var g=b.validateListenersImplemented(e);return g.length>0&&b.fail(b.transform(g,function(a){return" - the listener for event "+a.name+" with namespace "+a.namespace+((a.componentSource?" which was defined in grade "+a.componentSource:"")+" needs to be overridden with a concrete implementation")})).join("\n"),"constructing"===e.lifecycleStatus&&(e.lifecycleStatus="constructed"),e.events.onCreate.fire(e),b.popActivity(),e},b.initSubcomponentImpl=function(a,c,d){var e;if("function"!=typeof c){var f="string"==typeof c?c:c.type;e="fluid.emptySubcomponent"===f?null:b.invokeGlobalFunction(f,d)}else e=c.apply(null,d);return e};var o="(?:[\\w\\u00c0-\\uFFFF*_-";b.simpleCSSMatcher={regexp:new RegExp("([#.]?)("+o+"]|\\\\.)+)","g"),charToTag:{"":"tag","#":"id",".":"clazz"}},b.IoCSSMatcher={regexp:new RegExp("([&#]?)("+o+"]|\\.|\\/)+)","g"),charToTag:{"":"context","&":"context","#":"id"}};var p=new RegExp("\\s*(>)?\\s*","g");b.parseSelector=function(a,c){var d=[];a=a.trim();var e=c.regexp;e.lastIndex=0;for(var f=0;;){for(var g=[],h=!0;;){var i=e.exec(a);if(!i)break;if(i.index!==f){if(!h)break;b.fail("Error in selector string - cannot match child selector expression starting at "+a.substring(f))}var j={},k=i[2],l=c.charToTag[i[1]];l&&(j[l]=k),g[g.length]=j,f=e.lastIndex,h=!1}p.lastIndex=f;var m={predList:g},n=p.exec(a);if(n&&n.index===f||b.fail("Error in selector string - can not match child selector expression at "+a.substring(f)),">"===n[1]&&(m.child=!0),d[d.length]=m,p.lastIndex>=a.length)break;f=p.lastIndex,e.lastIndex=p.lastIndex}return d},b.stringToRegExp=function(a,b){return new RegExp(a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),b)},b.stringTemplate=function(a,c){var d=b.keys(c);d=d.sort(b.compareStringLength());for(var e=0;e<d.length;++e){var f=d[e],g=b.stringToRegExp("%"+f,"g");a=a.replace(g,c[f])}return a}}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.promise=function(){var a={onResolve:[],onReject:[]};return a.then=function(b,c){return b&&("resolve"===a.disposition?b(a.value):a.onResolve.push(b)),c&&("reject"===a.disposition?c(a.value):a.onReject.push(c)),a},a.resolve=function(c){return a.disposition?b.fail("Error: resolving promise ",a,' which has already received "'+a.disposition+'"'):a.complete("resolve",a.onResolve,c),a},a.reject=function(c){return a.disposition?b.fail("Error: rejecting promise ",a,'which has already received "'+a.disposition+'"'):a.complete("reject",a.onReject,c),a},a.complete=function(b,c,d){a.disposition=b,a.value=d;for(var e=0;e<c.length;++e)c[e](d)},a},b.isPromise=function(a){return a&&"function"==typeof a.then},b.toPromise=function(a){if(b.isPromise(a))return a;var c=b.promise();return c.resolve(a),c},b.promise.follow=function(a,b){a.then(b.resolve,b.reject)},b.promise.map=function(a,c){var d=b.toPromise(a),e=b.promise();return d.then(function(a){var b=c(a);e.resolve(b)},function(a){e.reject(a)}),e},b.promise.makeSequencer=function(a,c,d){return b.isArrayable(a)||b.fail("fluid.promise sequence algorithms must be supplied an array as source"),{sources:a,resolvedSources:[],index:0,strategy:d,options:c,returns:[],promise:b.promise()}},b.promise.progressSequence=function(a,c){a.returns.push(c),a.index++,b.promise.resumeSequence(a)},b.promise.processSequenceReject=function(a,c){for(var d=a.index-1;d>=0;--d){var e=a.resolvedSources[d],f=b.isPromise(e)&&"function"==typeof e.accumulateRejectionReason?e.accumulateRejectionReason:b.identity;c=f(c)}a.promise.reject(c)},b.promise.resumeSequence=function(a){if(a.index===a.sources.length)a.promise.resolve(a.strategy.resolveResult(a));else{var c=a.strategy.invokeNext(a);a.resolvedSources[a.index]=c,b.isPromise(c)?c.then(function(c){b.promise.progressSequence(a,c)},function(c){b.promise.processSequenceReject(a,c)}):b.promise.progressSequence(a,c)}},b.promise.makeSequenceStrategy=function(){return{invokeNext:function(a){var b=a.sources[a.index];return"function"==typeof b?b(a.options):b},resolveResult:function(a){return a.returns}}},b.promise.sequence=function(a,c){var d=b.promise.makeSequencer(a,c,b.promise.makeSequenceStrategy());return b.promise.resumeSequence(d),d.promise},b.promise.makeTransformerStrategy=function(){return{invokeNext:function(a){var c=a.sources[a.index];c.listener=b.event.resolveListener(c.listener);var d=c.listener(a.returns[a.index],a.options);return d},resolveResult:function(a){return a.returns[a.index]}}},b.promise.makeTransformer=function(a,c,d){a.unshift({listener:function(){return c}});var e=b.promise.makeSequencer(a,d,b.promise.makeTransformerStrategy());return e.returns.push(null),b.promise.resumeSequence(e),e},b.promise.filterNamespaces=function(a,c){return c?b.remove_if(b.makeArray(a),function(a){return a.namespace&&!a.softNamespace&&!b.contains(c,a.namespace)}):a},b.promise.fireTransformEvent=function(a,c,d){d=d||{};var e=d.reverse?b.makeArray(a.sortedListeners).reverse():b.makeArray(a.sortedListeners);e=b.promise.filterNamespaces(e,d.filterNamespaces);var f=b.promise.makeTransformer(e,c,d);return f.promise}}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";function c(b,c){return b=a(b),b.trigger("fluid-"+c),b.triggerHandler(c),b[c](),b}b.uaMatch=function(a){a=a.toLowerCase();var b=/(chrome)[ \/]([\w.]+)/.exec(a)||/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||a.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}};var d,e;a.browser||(navigator.userAgent.match(/Trident\/7\./)?e={msie:!0,version:11}:(d=b.uaMatch(navigator.userAgent),e={},d.browser&&(e[d.browser]=!0,e.version=d.version),e.chrome?e.webkit=!0:e.webkit&&(e.safari=!0)),a.browser=e);var f="fluid-scoped-data";b.getScopedData=function(b,c){var d=a(b).data(f);return d?d[c]:void 0},b.setScopedData=function(b,c,d){a(b).each(function(){var b=a.data(this,f)||{};b[c]=d,a.data(this,f,b)})};var g=null;a(document).bind("focusin",function(a){g=a.target}),b.getLastFocusedElement=function(){return g};var h="enablement";b.enabled=function(c,d){return c=a(c),void 0===d?b.getScopedData(c,h)!==!1:(a("*",c).add(c).each(function(){void 0!==b.getScopedData(this,h)?b.setScopedData(this,h,d):/select|textarea|input/i.test(this.nodeName)&&a(this).prop("disabled",!d)}),void b.setScopedData(c,h,d))},b.initEnablement=function(a){b.setScopedData(a,h,!0)},b.resolveEventTarget=function(a){for(;a.originalEvent&&a.originalEvent.target;)a=a.originalEvent;return a.target},a.each(["focus","blur"],function(a,d){b[d]=function(a){return c(a,d)}}),b.changeElementValue=function(b,c){b=a(b),b.val(c).change()}}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.dom=b.dom||{};var c=function(a){if(a.node.firstChild)return a.node=a.node.firstChild,a.depth+=1,a;for(;a.node;){if(a.node.nextSibling)return a.node=a.node.nextSibling,a;a.node=a.node.parentNode,a.depth-=1}return a};b.dom.iterateDom=function(a,d,e){for(var f,g={node:a,depth:0},h=a;null!==g.node&&g.depth>=0&&g.depth<b.dom.iterateDom.DOM_BAIL_DEPTH;){if(f=null,(1===g.node.nodeType||e)&&(f=d(g.node,g.depth)),f)if("delete"===f)g.node.parentNode.removeChild(g.node),g.node=h;else if("stop"===f)return g.node;h=g.node,g=c(g)}},b.dom.iterateDom.DOM_BAIL_DEPTH=256,b.dom.isContainer=function(a,b){for(;b;b=b.parentNode)if(a===b)return!0;return!1},b.dom.getElementText=function(a){for(var b=a.childNodes,c="",d=0;d<b.length;++d){var e=b[d];3===e.nodeType&&(c+=e.nodeValue)}return c}}(jQuery,fluid_2_0_0),fluid_2_0_0=fluid_2_0_0||{},function(a,b){"use strict";var c=/(\\u[\dabcdef]{4}|\\x[\dabcdef]{2})/g;b.unescapeProperties=function(a){a=a.replace(c,function(a){var b=a.substring(2),c=parseInt(b,16);return String.fromCharCode(c)});for(var b=0;;){var d=a.indexOf("\\",b);if(-1===d)break;if(d===a.length-1)return[a.substring(0,a.length-1),!0];var e=a.charAt(d+1);"n"===e&&(e="\n"),"r"===e&&(e="\r"),"t"===e&&(e="	"),a=a.substring(0,d)+e+a.substring(d+2),b=d+1}return[a,!1]};var d=/[^\\][\s:=]/;b.parseJavaProperties=function(c){var e={};c=c.replace(/\r\n/g,"\n"),c=c.replace(/\r/g,"\n");for(var f,g,h,i,j,k=c.split("\n"),l=0;l<k.length;++l){var m=a.trim(k[l]);if(m&&"#"!==m.charAt(0)&&"!"!==m.charAt(0)){if(f)j=b.unescapeProperties(m);else{h="";var n=m.search(d);-1===n?(g=m,i=""):(g=a.trim(m.substring(0,n+1)),i=a.trim(m.substring(n+2)),":"!==i.charAt(0)&&"="!==i.charAt(0)||(i=a.trim(i.substring(1)))),g=b.unescapeProperties(g)[0],j=b.unescapeProperties(i)}f=j[1],j[1]?h+=j[0]:e[g]=h+j[0]}}return e},b.formatMessage=function(a,b){if(!b)return a;"string"==typeof b&&(b=[b]);for(var c=0;c<b.length;++c)a=a.replace("{"+c+"}",b[c]);return a}}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{},fluid=fluid||fluid_2_0_0;!function(a,b){"use strict";function c(a,d,e){function f(a){e.output+=a}var g=d+e.indentChars,h="function"==typeof a;if(void 0!==e.maxRenderChars&&e.output.length>e.maxRenderChars)return!0;if(null===a)f("null");else if(void 0===a)f("undefined");else if(a===b.SYNTHETIC_PROPERTY)f("[Synthetic property]");else if(b.isPrimitive(a)&&!h)f(JSON.stringify(a));else{if(-1!==e.stack.indexOf(a))return void f("(CIRCULAR)");e.stack.push(a);var i;if(b.isArrayable(a))if(0===a.length)f("[]");else{for(f("[\n"+g),i=0;i<a.length;++i){if(c(a[i],g,e))return!0;i!==a.length-1&&f(",\n"+g)}f("\n"+d+"]")}else{f("{"+(h?" Function":"")+"\n"+g);var j=b.keys(a);for(i=0;i<j.length;++i){var k=j[i],l=b.getSafeProperty(a,k);if(f(JSON.stringify(k)+": "),c(l,g,e))return!0;i!==j.length-1&&f(",\n"+g)}f("\n"+d+"}")}e.stack.pop()}}b.renderTimestamp=function(a){var b=function(a,b){b||(b=2);var c=void 0===a?"":a.toString();return"00000".substring(5-b+c.length)+c};return b(a.getHours())+":"+b(a.getMinutes())+":"+b(a.getSeconds())+"."+b(a.getMilliseconds(),3)},b.isTracing=!1,b.registerNamespace("fluid.tracing"),b.tracing.pathCount=[],b.tracing.summarisePathCount=function(a){a=a||b.tracing.pathCount;for(var c={},d=0;d<a.length;++d){var e=a[d];c[e]?++c[e]:c[e]=1}var f=[];return b.each(c,function(a,b){f.push({path:b,count:a})}),f.sort(function(a,b){return b.count-a.count}),f},b.tracing.condensePathCount=function(a,c){a=b.makeArray(a);var d={};b.each(a,function(a){d[a]=0});var e=[];return b.each(c,function(c){var f=c.path;b.find(a,function(a){return 0===f.indexOf(a)?(d[a]+=c.count,!0):void 0})||e.push(c)}),b.each(d,function(a,b){e.unshift({path:b,count:a})}),e},b.detectStackStyle=function(a){var b="other",c={offset:0};return a.arguments?b="chrome":"undefined"!=typeof window&&window.opera&&a.stacktrace?b="opera10":a.stack?(b="firefox",c.offset=-1===a.stack.indexOf("Trace exception")?1:0):"undefined"==typeof window||!window.opera||"stacktrace"in a||(b="opera"),c.style=b,c},b.obtainException=function(){try{throw new Error("Trace exception")}catch(a){return a}};var d=b.detectStackStyle(b.obtainException());b.registerNamespace("fluid.exceptionDecoders"),b.decodeStack=function(){if("firefox"!==d.style)return null;var a=b.obtainException();return b.exceptionDecoders[d.style](a)},b.exceptionDecoders.firefox=function(a){var c="at ",d=a.stack.replace(/(?:\n@:0)?\s+$/m,"").replace(/^\(/gm,"{anonymous}(").split("\n");return b.transform(d,function(a){a=a.replace(/\)/g,"");var b=a.indexOf(c);return-1===b?[a]:[a.substring(b+c.length),a.substring(0,b)]})},b.getCallerInfo=function(a){a=(a||3)-d.offset;var c=b.decodeStack(),e=c&&c[a][0];if(e){var f=e.lastIndexOf("/");-1===f&&(f=0);var g=e.indexOf(":",f);return{path:e.substring(0,f),filename:e.substring(f+1,g),index:e.substring(g+1)}}return null},b.generatePadding=function(a,b){for(var c="",d=0;b>d;++d)c+=a;return c},b.SYNTHETIC_PROPERTY={},b.getSafeProperty=function(a,c){var d=Object.getOwnPropertyDescriptor(a,c);return d&&!d.get?a[c]:b.SYNTHETIC_PROPERTY},b.prettyPrintJSON=function(d,e){return e=a.extend({indent:4,stack:[],output:""},e),e.indentChars=b.generatePadding(" ",e.indent),c(d,"",e),e.output},b.dumpEl=function(c){var d;if(!c)return"null";if(3===c.nodeType||8===c.nodeType)return"[data: "+c.data+"]";if(9===c.nodeType)return"[document: location "+c.location+"]";if(!c.nodeType&&b.isArrayable(c)){d="[";for(var e=0;e<c.length;++e)d+=b.dumpEl(c[e]),e<c.length-1&&(d+=", ");return d+"]"}return c=a(c),d=c.get(0).tagName,c.id&&(d+="#"+c.id),c.attr("class")&&(d+="."+c.attr("class")),d}}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";function c(a,c,d,e){for(var f=0;d>f;++f)a=e(a,c[f],f,b.makeArray(c));return a}b.visitComponentChildren=function(a,c,d,e){e=e||[];for(var f in a){var g=a[f];if(!(!b.isComponent(g)||d.visited&&d.visited[g.id])){if(e.push(f),d.visited&&(d.visited[g.id]=!0),c(g,f,e,e.length-1))return!0;d.flat||b.visitComponentChildren(g,c,d,e),e.pop()}}},b.getContextHash=function(a,b){var c=a.idToShadow[b.id];return c&&c.contextHash},b.componentHasGrade=function(a,c){var d=b.getContextHash(b.globalInstantiator,a);return!(!d||!d[c])},b.visitComponentsForMatching=function(c,d,e){var f=b.getInstantiator(c);d=a.extend({visited:{},instantiator:f},d);var g=[c],h=[b.getContextHash(f,c)],i=function(a,c,d){g.length=1,h.length=1;for(var i=0;i<d.length;++i){var j=g[i][d[i]];g[i+1]=j,h[i+1]=b.getContextHash(f,j)||{}}return e(a,g,h,d,d.length)};b.visitComponentChildren(c,i,d,[])},b.getMemberNames=function(a,c){var d=a.idToPath(c[c.length-1].id),e=a.parseEL(d);return e.unshift.apply(e,b.generate(c.length-e.length,"")),e},b.visitComponentsForVisibility=function(a,c,d,e){e=e||{visited:{},flat:!0,instantiator:a};for(var f=b.getMemberNames(a,c),g=c.length-1;g>=0;--g){var h=c[g];if(e.visited[h.id]=!0,d(h,f[g],f,g))return;if(b.visitComponentChildren(h,d,e,f))return;f.pop()}},b.mountStrategy=function(a,b,c){var d=a.length;return function(b,e,f,g){if(!(f<=a.length)){for(var h=0;h<a.length;++h)if(g[h]!==a[h])return;return c(b,e,f-a.length,g.slice(d))}}},b.invokerFromRecord=function(a,c,d){b.pushActivity("makeInvoker","beginning instantiation of invoker with name %name and record %record as child of %that",{name:c,record:a,that:d});var e=a?b.makeInvoker(d,a,c):void 0;return b.popActivity(),e},b.memberFromRecord=function(c,d,e){for(var f,g=0;g<c.length;++g){var h=b.expandImmediate(c[g],e);f=b.isPlainObject(f)?a.extend(!0,f,h):h}return f},b.recordStrategy=function(a,c,d,e,f,g,h){return g=g||[],{strategy:function(g,h,i){if(1===i){var j=b.driveStrategy(c,[e,h],d);if(void 0!==j){b.set(g,[h],b.inEvaluationMarker);var k=f(j,h,a);return b.set(g,[h],k),k}}},initter:function(){var f=b.driveStrategy(c,e,d)||{};for(var i in f)h&&h[i]||b.getForComponent(a,g.concat([i]))}}},b.instantiateFirers=function(a){var c=b.shadowForComponent(a),d=b.get(c,["eventStrategyBlock","initter"])||b.identity;d()},b.makeDistributionRecord=function(c,d,e,f,g,h){h=h||"distribution",b.pushActivity("makeDistributionRecord","Making distribution record from source record %sourceRecord path %sourcePath to target path %targetSegs",{sourceRecord:d,sourcePath:e,targetSegs:f});var i=b.copy(b.get(d,e));b.each(g,function(a){b.model.applyChangeRequest(i,{segs:a,type:"DELETE"})});var j={options:{}};return b.model.applyChangeRequest(j,{segs:f,type:"ADD",value:i}),b.checkComponentRecord(j),b.popActivity(),a.extend(j,{contextThat:c,recordType:h})},b.filterBlocks=function(c,d,e,f,g,h){var i=[];return b.each(d,function(d){var j=b.get(d.source,e);if(j){i.push(b.makeDistributionRecord(c,d.source,e,f,g,d.recordType));var k=a.extend({},j);h&&b.model.applyChangeRequest(d.source,{segs:e,type:"DELETE"}),b.each(g,function(a){var c=b.get(k,a);b.set(d.source,e.concat(a),c)})}}),i},b.noteCollectedDistribution=function(a,c,d){b.model.setSimple(a,["collectedDistributions",c,d.id],!0)},b.isCollectedDistribution=function(a,c,d){return b.model.getSimple(a,["collectedDistributions",c,d.id])},b.clearCollectedDistributions=function(a,c){b.model.applyChangeRequest(a,{segs:["collectedDistributions",c],type:"DELETE"})},b.collectDistributions=function(a,c,d,e,f,g,h){var i=g[g.length-1];!b.isCollectedDistribution(c,i,d)&&b.matchIoCSelector(d.selector,e,f,g,h)&&(a.push.apply(a,d.blocks),b.noteCollectedDistribution(c,i,d))},b.registerCollectedClearer=function(a,c,d){!a.collectedClearer&&c&&(a.collectedClearer=function(){b.clearCollectedDistributions(c,d)})},b.receiveDistributions=function(a,c,d,e){var f=b.getInstantiator(a||e),g=f.getThatStack(a||e);g.unshift(b.rootComponent);var h=b.getMemberNames(f,g),i=b.transform(g,function(a){return f.idToShadow[a.id]}),j=i[i.length-(a?1:2)],k=b.getMembers(i,"contextHash");a?(h.push(d),k.push(b.gradeNamesToHash(c)),g.push(e)):b.registerCollectedClearer(i[i.length-1],j,h[h.length-1]);for(var l=[],m=0;m<g.length-1;++m)b.each(i[m].distributions,function(a){b.collectDistributions(l,j,a,g,k,h,m)});return l},b.computeTreeDistance=function(a,b){for(var c=0;c<a.length&&c<b.length&&a[c]===b[c];)++c;return a.length+b.length-2*c},b.computeDistributionPriority=function(a,c){if(!c.priority){var d=b.getInstantiator(a),e=d.getThatStack(a),f=b.getMemberNames(d,e),g=d.getThatStack(c.contextThat),h=b.getMemberNames(d,g),i=b.computeTreeDistance(f,h);c.priority=b.mergeRecordTypes.distribution-i}return c},b.applyDistributions=function(a,c,d){var e=b.transform(c,function(c){return b.generateExpandBlock(c,a,d.mergePolicy)},function(c){return b.computeDistributionPriority(a,c)}),f=d.mergeOptions;return f.mergeBlocks.push.apply(f.mergeBlocks,e),f.updateBlocks(),e},b.matchIoCSelector=function(a,b,c,d,e){for(var f=b.length-1,g=a.length-1;;){for(var h=f===b.length-1||a[g].child,i=b[f],j=a[g],k=!0,l=0;l<j.predList.length;++l){var m=j.predList[l];if(m.context&&!c[f][m.context]&&d[f]!==m.context){k=!1;break}if(m.id&&i.id!==m.id){k=!1;break}}if(0===g&&f>e&&h&&(k=!1),k){if(0===g)return!0;--f,--g}else{if(h)return!1;--f}if(e>f)return!1}},b.queryIoCSelector=function(a,c,d){var e=b.parseSelector(c,b.IoCSSMatcher),f=[];return b.visitComponentsForMatching(a,{flat:d},function(a,c,d,g,h){b.matchIoCSelector(e,c,d,g,h)&&f.push(a)}),f},b.isIoCSSSelector=function(a){return-1!==a.indexOf(" ")},b.pushDistributions=function(a,c,d,e){var f=b.shadowForComponent(a),g=b.allocateGuid(),h=f.distributions=f.distributions||[],i={id:g,target:d,selector:c,blocks:e};return Object.freeze(i),Object.freeze(i.blocks),h.push(i),g},b.clearDistribution=function(a,c){var d=b.shadowForComponent(a);b.remove_if(d.distributions,function(a){return a.id===c})},b.clearDistributions=function(a){b.each(a.outDistributions,function(a){b.clearDistribution(a.targetComponent,a.distributionId)})},b.extractSelectorHead=function(a){var b=a[0].predList,c=b[0].context;return b.length=0,c},b.parseExpectedOptionsPath=function(a,c){var d=b.model.parseEL(a);return"options"!==d[0]&&b.fail("Error in options distribution path ",a," - only "+c+' paths beginning with "options" are supported'),d.slice(1)},b.replicateProperty=function(a,c,d){void 0!==a[c]&&b.each(d,function(b){b[c]=a[c]})},b.undistributableOptions=["gradeNames","distributeOptions","argumentMap","initFunction","mergePolicy","progressiveCheckerOptions"],b.distributeOptions=function(a,c){var d=b.shadowForComponent(a),e=b.driveStrategy(a.options,"distributeOptions",c);b.each(e,function(c){b.pushActivity("distributeOptions","parsing distributeOptions block %record %that ",{that:a,record:c}),"string"!=typeof c.target&&b.fail("Error in options distribution record ",c,' a member named "target" must be supplied holding an IoC reference'),"string"==typeof c.source^void 0===c.record&&b.fail("Error in options distribution record ",c,': must supply either a member "source" holding an IoC reference or a member "record" holding a literal record');var e,f,g,h=b.parseContextReference(c.target);if(b.isIoCSSSelector(h.context)){f=b.parseSelector(h.context,b.IoCSSMatcher);var i=b.extractSelectorHead(f);"/"===i?e=b.rootComponent:g=i}else g=h.context;e=e||b.resolveContext(g,a),e||b.fail("Error in options distribution record ",c," - could not resolve context {"+g+"} to a root component");var j,k=b.model.parseEL(h.path);if(void 0!==c.record)j=[b.makeDistributionRecord(a,c.record,[],k,[])];else{var l=b.parseContextReference(c.source);"that"!==l.context&&b.fail("Error in options distribution record ",c," only a context of {that} is supported");var m=b.parseExpectedOptionsPath(l.path,"source"),n=b.makeArray(c.exclusions).concat(0===m.length?b.undistributableOptions:[]),o=b.transform(n,function(a){return b.model.parseEL(a)});j=b.filterBlocks(a,d.mergeOptions.mergeBlocks,m,k,o,c.removeSource),d.mergeOptions.updateBlocks()}if(b.replicateProperty(c,"priority",j),
b.replicateProperty(c,"namespace",j),f){var p=b.pushDistributions(e,f,c.target,j);d.outDistributions=d.outDistributions||[],d.outDistributions.push({targetComponent:e,distributionId:p})}else{var q=b.shadowForComponent(e);b.applyDistributions(a,j,q)}b.popActivity()})},b.gradeNamesToHash=function(a){var c={};return b.each(a,function(a){c[a]=!0,c[b.computeNickName(a)]=!0}),c},b.cacheShadowGrades=function(a,c){var d=b.gradeNamesToHash(a.options.gradeNames);d[c.memberName]||(d[c.memberName]="memberName"),c.contextHash=d,b.each(d,function(b,d){c.ownScope[d]=a,c.parentShadow&&"fluid.rootComponent"!==c.parentShadow.that.type&&(c.parentShadow.childrenScope[d]=a)})},b.deliverOptionsStrategy=function(a,c,d){var e=b.shadowForComponent(a,e);b.cacheShadowGrades(a,e),e.mergeOptions=d},b.collectDistributedGrades=function(a){var c=b.receiveDistributions(null,null,null,a.that);if(c.length>0){var d=b.applyDistributions(a.that,c,a.shadow),e=b.transform(b.getMembers(d,["source","gradeNames"]),b.makeArray);b.accumulateDynamicGrades(a,b.flatten(e))}},b.applyDynamicGrades=function(a){a.oldGradeNames=b.makeArray(a.gradeNames);var c=b.copy(b.getGradedDefaults(a.that.typeName,a.gradeNames));a.gradeNames.length=0,a.gradeNames.push.apply(a.gradeNames,c.gradeNames),b.each(a.gradeNames,function(b){"{"!==b.charAt(0)&&(a.seenGrades[b]=!0)});var d=a.shadow;b.cacheShadowGrades(a.that,d),d.mergeOptions.destroyValue(["mergePolicy"]),d.mergeOptions.destroyValue(["components"]),d.mergeOptions.destroyValue(["invokers"]),a.defaultsBlock.source=c,d.mergeOptions.updateBlocks(),d.mergeOptions.computeMergePolicy(),b.accumulateDynamicGrades(a,c.gradeNames)},b.accumulateDynamicGrades=function(a,c){b.each(c,function(c){a.seenGrades[c]||("{"===c.charAt(0)?(a.rawDynamic.push(c),a.seenGrades[c]=!0):b.contains(a.oldGradeNames,c)||a.plainDynamic.push(c))})},b.computeDynamicGrades=function(a,c,d){delete a.options.gradeNames;var e=b.driveStrategy(a.options,"gradeNames",d);e.length=0;var f=b.findMergeBlocks(c.mergeOptions.mergeBlocks,"defaults")[0],g={that:a,shadow:c,defaultsBlock:f,gradeNames:e,seenGrades:{},plainDynamic:[],rawDynamic:[]};for(b.each(c.mergeOptions.mergeBlocks,function(a){e.push.apply(e,b.makeArray(a.source&&a.source.gradeNames)),b.applyDynamicGrades(g)}),b.collectDistributedGrades(g);;){for(;g.plainDynamic.length>0;)e.push.apply(e,g.plainDynamic),g.plainDynamic.length=0,b.applyDynamicGrades(g),b.collectDistributedGrades(g);if(!(g.rawDynamic.length>0))break;var h=b.expandImmediate(g.rawDynamic.shift(),a,c.localDynamic);"function"==typeof h&&(h=h()),h&&(g.plainDynamic=g.plainDynamic.concat(h))}c.collectedClearer&&(c.collectedClearer(),delete c.collectedClearer)},b.computeDynamicComponentKey=function(a,b){return a+(0===b?"":"-"+b)},b.registerDynamicRecord=function(a,c,d,e,f){var g=b.computeDynamicComponentKey(c,d),h=b.copy(e);return delete h[f],b.set(a.options,["components",g],h),g},b.computeDynamicComponents=function(a,c){var d=b.shadowForComponent(a),e=d.subcomponentLocal={},f=b.driveStrategy(a.options,"dynamicComponents",c.strategy);b.each(f,function(c,f){if(c.sources||c.createOnEvent||b.fail("Cannot process dynamicComponents record ",c,' without a "sources" or "createOnEvent" entry'),c.sources){var g=b.expandOptions(c.sources,a);b.each(g,function(d,g){var h=b.registerDynamicRecord(a,f,g,c,"sources");e[h]={source:d,sourcePath:g}})}else if(c.createOnEvent){var h=b.event.expandOneEvent(a,c.createOnEvent);b.set(d,["dynamicComponentCount",f],0);var i=function(){var e=b.registerDynamicRecord(a,f,d.dynamicComponentCount[f]++,c,"createOnEvent"),g={arguments:b.makeArray(arguments)};b.initDependent(a,e,g)};h.addListener(i),b.recordListener(h,i,d)}})},b.computeComponentAccessor=function(a,c){var d=b.globalInstantiator,e=b.shadowForComponent(a);e.localDynamic=c;var f=a.options,g=e.mergeOptions.strategy,h=b.mountStrategy(["options"],f,g);e.invokerStrategy=b.recordStrategy(a,f,g,"invokers",b.invokerFromRecord),e.eventStrategyBlock=b.recordStrategy(a,f,g,"events",b.eventFromRecord,["events"]);var i=b.mountStrategy(["events"],a,e.eventStrategyBlock.strategy,["events"]);if(e.memberStrategy=b.recordStrategy(a,f,g,"members",b.memberFromRecord,null,{model:!0,modelRelay:!0}),e.getConfig={strategies:[b.model.funcResolverStrategy,b.makeGingerStrategy(a),h,e.invokerStrategy.strategy,e.memberStrategy.strategy,i]},b.computeDynamicGrades(a,e,g,e.mergeOptions.mergeBlocks),b.distributeOptions(a,g),e.contextHash["fluid.resolveRoot"]){var j;if(e.contextHash["fluid.resolveRootSingle"]){var k=b.getForComponent(a,["options","singleRootType"]);k||b.fail("Cannot register object with grades "+Object.keys(e.contextHash).join(", ")+" as fluid.resolveRootSingle since it has not defined option singleRootType"),j=b.typeNameToMemberName(k)}else j=b.computeGlobalMemberName(a);var l=b.resolveRootComponent;l[j]&&d.clearComponent(l,j),d.recordKnownComponent(l,a,j,!1)}return e.getConfig},b.shadowForComponent=function(a){var c=b.getInstantiator(a);return c&&a?c.idToShadow[a.id]:null},b.getForComponent=function(a,c){var d=b.shadowForComponent(a),e=d?d.getConfig:void 0;return b.get(a,c,e)},b.makeGingerStrategy=function(a){var c=b.getInstantiator(a);return function(a,d,e,f){var g=a[d];if(g===b.inEvaluationMarker&&e===f.length&&b.fail('Error in component configuration - a circular reference was found during evaluation of path segment "'+d+'": for more details, see the activity records following this message in the console, or issue fluid.setLogging(fluid.logLevel.TRACE) when running your application'),e>1)return g;if(void 0===g&&a.hasOwnProperty(d))return b.NO_VALUE;if(void 0===g){var h=c.idToShadow[a.id].path,i=c.composePath(h,d);g=c.pathToComponent[i]}if(void 0===g){var j=b.getForComponent(a,["options","components",d]);j&&(j.createOnEvent&&b.fail('Error resolving path segment "'+d+'" of path '+f.join(".")+" since component with record ",j,' has annotation "createOnEvent" - this very likely represents an implementation error. Either alter the reference so it does not  match this component, or alter your workflow to ensure that the component is instantiated by the time this reference resolves'),b.initDependent(a,d),g=a[d])}return g}},b.frameworkGrades=["fluid.component","fluid.modelComponent","fluid.viewComponent","fluid.rendererComponent"],b.filterBuiltinGrades=function(a){return b.remove_if(b.makeArray(a),function(a){return-1!==b.frameworkGrades.indexOf(a)})},b.dumpGradeNames=function(a){return a.options&&a.options.gradeNames?" gradeNames: "+JSON.stringify(b.filterBuiltinGrades(a.options.gradeNames)):""},b.dumpThat=function(a){return'{ typeName: "'+a.typeName+'"'+b.dumpGradeNames(a)+" id: "+a.id+"}"},b.dumpThatStack=function(a,c){var d=b.transform(a,function(a){var d=c.idToPath(a.id);return b.dumpThat(a)+(d?" - path: "+d:"")});return d.join("\n")},b.resolveContext=function(a,c,d){if("that"===a)return c;var e,f=b.globalInstantiator;if(d){var g=f.idToShadow[c.id];return g.ownScope[a]}var h=f.getFullStack(c);return b.visitComponentsForVisibility(f,h,function(c,d){var f=b.shadowForComponent(c);return a===d||f&&f.contextHash&&f.contextHash[a]||a===c.typeName?(e=c,!0):b.getForComponent(c,["options","components",a])&&!c[a]?(e=b.getForComponent(c,a),!0):void 0}),e},b.makeStackFetcher=function(a,c,d){var e=function(e){a&&"destroyed"===a.lifecycleStatus&&b.fail("Cannot resolve reference "+b.renderContextReference(e)+" from component "+b.dumpThat(a)+" which has been destroyed");var f=e.context;if(c&&f in c)return b.get(c[f],e.path);var g=b.resolveContext(f,a,d);if(!g&&""!==e.path){var h=b.renderContextReference(e);b.fail("Failed to resolve reference "+h+" - could not match context with name "+f+" from component "+b.dumpThat(a)+" at path "+b.pathForComponent(a).join(".")+" component: ",a)}return b.getForComponent(g,e.path)};return e},b.makeStackResolverOptions=function(c,d,e){return a.extend(b.copy(b.rawDefaults("fluid.makeExpandOptions")),{localRecord:d||{},fetcher:b.makeStackFetcher(c,d,e),contextThat:c,exceptions:{members:{model:!0,modelRelay:!0}}})},b.clearListeners=function(a){b.each(a.listeners,function(a){a.event.removeListener(a.listenerId||a.listener)}),delete a.listeners},b.recordListener=function(a,b,c,d){if(a.ownerId!==c.that.id){var e=c.listeners;e||(e=c.listeners=[]),e.push({event:a,listener:b,listenerId:d})}},b.constructScopeObjects=function(a,b,c,d){var e=b?a.idToShadow[b.id]:null;d.childrenScope=e?Object.create(e.ownScope):{},d.ownScope=Object.create(d.childrenScope),d.parentShadow=e},b.clearChildrenScope=function(a,c,d,e){b.each(e.contextHash,function(a,b){c.childrenScope[b]===d&&delete c.childrenScope[b]})},b.instantiator=function(){function c(a,c,e,f,g){var h;if(g)h=d.idToShadow[c.id]={},h.that=c,h.path=e,h.memberName=f,b.constructScopeObjects(d,a,c,h);else{h=d.idToShadow[c.id],h.injectedPaths=h.injectedPaths||{},h.injectedPaths[e]=!0;var i=d.idToShadow[a.id],j=b.keys(h.contextHash);b.remove_if(j,function(a){return h.contextHash&&"memberName"===h.contextHash[a]}),j.push(f),b.each(j,function(a){i.childrenScope[a]||(i.childrenScope[a]=c)})}d.pathToComponent[e]&&b.fail("Error during instantiation - path "+e+" which has just created component "+b.dumpThat(c)+" has already been used for component "+b.dumpThat(d.pathToComponent[e])+" - this is a circular instantiation or other oversight. Please clear the component using instantiator.clearComponent() before reusing the path."),d.pathToComponent[e]=c}var d=b.typeTag("instantiator");return a.extend(d,{lifecycleStatus:"constructed",pathToComponent:{},idToShadow:{},modelTransactions:{init:{}},composePath:b.model.composePath,composeSegments:b.model.composeSegments,parseEL:b.model.parseEL,events:{onComponentAttach:b.makeEventFirer({name:"instantiator's onComponentAttach event"}),onComponentClear:b.makeEventFirer({name:"instantiator's onComponentClear event"})}}),d.idToPath=function(a){var b=d.idToShadow[a];return b?b.path:""},d.getThatStack=function(a){var b=d.idToShadow[a.id];if(b){for(var c=b.path,e=d.parseEL(c),f=d.pathToComponent[""],g=[],h=0;h<e.length;++h)f=f[e[h]],g.push(f);return g}return[]},d.getFullStack=function(a){var c=a?d.getThatStack(a):[];return c.unshift(b.resolveRootComponent),c},d.recordRoot=function(a){c(null,a,"","",!0)},d.recordKnownComponent=function(a,e,f,g){if(a[f]=e,b.isComponent(e)||"instantiator"===e.type){var h=d.idToShadow[a.id].path,i=d.composePath(h,f);c(a,e,i,f,g),d.events.onComponentAttach.fire(e,i,d,g)}else b.fail("Cannot record non-component with value ",e,' at path "'+f+'" of parent ',a)},d.clearComponent=function(a,c,e,f,g,h){var i=d.idToShadow[a.id];f=f||{flat:!0,instantiator:d},e=e||a[c],h=h||i.path,void 0===h&&b.fail("Cannot clear component "+c+" from component ",a," which was not created by this instantiator");var j=d.composePath(h,c),k=d.idToShadow[e.id];if(k){var l=k.path===j;d.events.onComponentClear.fire(e,j,a,l),l?(b.each(k.injectedPaths,function(a,c){var f=b.model.getToTailPath(c),g=d.pathToComponent[f];d.clearComponent(g,b.model.getTailPath(c),e)}),b.visitComponentChildren(e,function(a,b,c,g){var h=d.composeSegments.apply(null,c.slice(0,g));d.clearComponent(e,b,null,f,!0,h)},f,d.parseEL(j)),b.doDestroy(e,c,a),b.clearDistributions(k),b.clearListeners(k),e.events.afterDestroy.fire(e,c,a),delete d.idToShadow[e.id]):b.remove_if(k.injectedPaths,function(a,b){return b===j}),b.clearChildrenScope(d,i,e,k),delete d.pathToComponent[j],g||delete a[c]}},d},b.globalInstantiator=b.instantiator(),b.getInstantiator=function(a){var c=b.globalInstantiator;return a&&c.idToShadow[a.id]?c:null},b.defaults("fluid.resolveRoot"),b.defaults("fluid.resolveRootSingle",{gradeNames:"fluid.resolveRoot"}),b.constructRootComponents=function(a){b.rootComponent=a.rootComponent=b.typeTag("fluid.rootComponent"),a.recordRoot(b.rootComponent),b.resolveRootComponent=a.resolveRootComponent=b.typeTag("fluid.resolveRootComponent"),a.recordKnownComponent(b.rootComponent,b.resolveRootComponent,"resolveRootComponent",!0);var c=a.idToShadow[b.rootComponent.id],d=a.idToShadow[b.resolveRootComponent.id];d.ownScope=c.ownScope,d.childrenScope=c.childrenScope,a.recordKnownComponent(b.resolveRootComponent,a,"instantiator",!0),d.childrenScope.instantiator=a},b.constructRootComponents(b.globalInstantiator),b.expandOptions=function(a,c,d,e,f){if(!a)return a;b.pushActivity("expandOptions","expanding options %args for component %that ",{that:c,args:a});var g=b.makeStackResolverOptions(c,e);g.mergePolicy=d;var h=f&&f.defer?b.makeExpandOptions(a,g):b.expand(a,g);return b.popActivity(),h},b.localRecordExpected=b.arrayToHash(["type","options","container","createOnEvent","priority","recordType"]),b.checkComponentRecord=function(a){b.each(a,function(c,d){b.localRecordExpected[d]||b.fail("Probable error in subcomponent record ",a,' - key "'+d+'" found, where the only legal options are '+b.keys(b.localRecordExpected).join(", "))})},b.mergeRecordsToList=function(a,c){var d=[];return b.each(c,function(c,e){if(c.recordType=e,"distributions"===e)d.push.apply(d,b.transform(c,function(c){return b.computeDistributionPriority(a,c)}));else{if(!c.options)return;c.priority=b.mergeRecordTypes[e],void 0===c.priority&&b.fail("Merge record with unrecognised type "+e+": ",c),d.push(c)}}),d};var d=function(a){return b.each(["gradeNames","mergePolicy","argumentMap","components","dynamicComponents","events","listeners","modelListeners","distributeOptions","transformOptions"],function(c){b.set(a,[c,"*","noexpand"],!0)}),a};b.generateExpandBlock=function(a,c,d,e){var f=b.expandOptions(a.options,a.contextThat||c,d,e,{defer:!0});return f.priority=a.priority,f.namespace=a.namespace,f.recordType=a.recordType,f};var e=function(c,e,f,g){var h=b.copy(e);d(c);var i=b.shadowForComponent(g);i.mergePolicy=c;var j={defaults:{options:h}};a.extend(j,f.mergeRecords),j.subcomponentRecord&&b.checkComponentRecord(j.subcomponentRecord);var k=b.mergeRecordsToList(g,j),l=b.transform(k,function(a){return b.generateExpandBlock(a,g,c,f.localRecord)});return l};b.fabricateDestroyMethod=function(a,b,c,d){return function(){c.clearComponent(a,b,d)}},b.computeGlobalMemberName=function(a){var c=b.computeNickName(a.typeName);return c+"-"+a.id},b.typeNameToMemberName=function(a){return a.replace(/\./g,"_")},b.expandComponentOptions=function(a,c,d,f){var g=d,h=d&&d.marker===b.EXPAND?d.instantiator:null;h||(h=b.globalInstantiator,g={mergeRecords:{user:{options:b.expandCompact(d,!0)}},memberName:b.computeGlobalMemberName(f),instantiator:h,parentThat:b.rootComponent}),f.destroy=b.fabricateDestroyMethod(g.parentThat,g.memberName,h,f),b.pushActivity("expandComponentOptions","expanding component options %options with record %record for component %that",{options:b.get(g.mergeRecords,"user.options"),record:g,that:f}),h.recordKnownComponent(g.parentThat,f,g.memberName,!0);var i=e(a,c,g,f);return b.popActivity(),i},b.assembleCreatorArguments=function(c,d,e){var f=b.defaults(d);f&&f.argumentMap||b.fail("Error in assembleCreatorArguments: cannot look up component type name "+d+" to a component creator grade with an argumentMap");var g={},h=c?b.receiveDistributions(c,f.gradeNames,e.memberName,g):[];b.each(h,function(a){b.computeDistributionPriority(c,a),b.isPrimitive(a.priority)&&(a.priority=b.parsePriority(a.priority,0,!1,"options distribution"))}),b.sortByPriority(h);var i=e.localDynamic,j=a.extend({},b.censorKeys(e.componentRecord,["type"]),i),k=f.argumentMap,l=Object.keys(k).concat(["type"]);b.each(l,function(a){for(var b=0;b<h.length;++b)void 0!==h[b][a]&&(j[a]=h[b][a])}),d=j.type||d,delete j.type,delete j.options;var m={distributions:h};void 0!==e.componentRecord&&(m.subcomponentRecord=a.extend({},e.componentRecord));var n=[];b.each(k,function(a,d){var f;if("options"===d)f={marker:b.EXPAND,localRecord:i,mergeRecords:m,instantiator:b.getInstantiator(c),parentThat:c,memberName:e.memberName};else{var g=j[d];f=b.expandImmediate(g,c,j)}n[a]=f});var o={args:n,funcName:d};return o},b.initDependent=function(a,c,d){if(!a[c]){var e,f=a.options.components[c],g=b.globalInstantiator,h=g.idToShadow[a.id],i=d||h.subcomponentLocal&&h.subcomponentLocal[c];if(b.pushActivity("initDependent",'instantiating dependent component at path "%path" with record %record as child of %parent',{path:h.path+"."+c,record:f,parent:a}),"string"==typeof f)a[c]=b.inEvaluationMarker,e=b.expandImmediate(f,a),e?g.recordKnownComponent(a,e,c,!1):delete a[c];else if(f.type){var j=b.expandImmediate(f.type,a,i);j||b.fail("Error in subcomponent record: ",f.type," could not be resolved to a type for component ",c," of parent ",a);var k=b.assembleCreatorArguments(a,j,{componentRecord:f,memberName:c,localDynamic:i});e=b.initSubcomponentImpl(a,{type:k.funcName},k.args)}else b.fail("Unrecognised material in place of subcomponent "+c+' - no "type" field found');return b.popActivity(),e}},b.bindDeferredComponent=function(a,c,d){var e=b.makeArray(d.createOnEvent);b.each(e,function(e){var f="{"===e.charAt(0)?b.expandOptions(e,a):a.events[e];f&&f.addListener||b.fail("Error instantiating createOnEvent component with name "+c+" of parent ",a," since event specification "+e+" could not be expanded to an event - got ",f),f.addListener(function(){b.pushActivity("initDeferred","instantiating deferred component %componentName of parent %that due to event %eventName",{componentName:c,that:a,eventName:e}),a[c]&&b.globalInstantiator.clearComponent(a,c),b.initDependent(a,c),b.popActivity()},null,d.priority)})},b.priorityForComponent=function(a){return a.priority?a.priority:"fluid.typeFount"===a.type||b.hasGrade(b.defaults(a.type),"fluid.typeFount")?"first":void 0},b.initDependents=function(a){b.pushActivity("initDependents","instantiating dependent components for component %that",{that:a});var c=b.shadowForComponent(a);c.memberStrategy.initter(),c.invokerStrategy.initter(),b.getForComponent(a,"modelRelay"),b.getForComponent(a,"model");var d=a.options,e=d.components||{},f=[];b.each(e,function(c,d){if(c.createOnEvent)b.bindDeferredComponent(a,d,c);else{var e=b.priorityForComponent(c);f.push({namespace:d,priority:b.parsePriority(e)})}}),b.sortByPriority(f),b.each(f,function(c){b.initDependent(a,c.namespace)}),c.subcomponentLocal&&b.clear(c.subcomponentLocal),a.lifecycleStatus="constructed",b.assessTreeConstruction(a,c),b.popActivity()},b.assessTreeConstruction=function(a,c){var d=b.globalInstantiator,e=d.getThatStack(a),f=b.find_if(e,function(a){return"constructing"===a.lifecycleStatus});f?a.lifecycleStatus="constructed":b.markSubtree(d,a,c.path,"treeConstructed")},b.markSubtree=function(a,c,d,e){c.lifecycleStatus=e,b.visitComponentChildren(c,function(c,f){var g=a.composePath(d,f),h=a.idToShadow[c.id],i=h&&h.path===g;i&&b.markSubtree(a,c,g,e)},{flat:!0})},b.pathForComponent=function(a,c){c=c||b.getInstantiator(a);var d=c.idToShadow[a.id];return d||b.fail("Cannot get path for ",a," which is not a component"),c.parseEL(d.path)},b.construct=function(a,c,d){var e=b.destroy(a,d);return b.set(e.parent,["options","components",e.memberName],{type:c.type,options:c}),b.initDependent(e.parent,e.memberName)},b.destroy=function(a,c){c=c||b.globalInstantiator;var d=b.model.parseToSegments(a,c.parseEL,!0);0===d.length&&b.fail("Cannot destroy the root component");var e=d.pop(),f=c.composeSegments.apply(null,d),g=c.pathToComponent[f];return g||b.fail("Cannot modify component with nonexistent parent at path ",a),g[e]&&g[e].destroy(),{parent:g,memberName:e}},b.constructSingle=function(c,d,e){e=e||b.globalInstantiator,c=c||"";var f=b.model.parseToSegments(c,e.parseEL,!0);"string"==typeof d&&(d={type:d});var g=d.type;g||b.fail("Cannot construct singleton object without a type entry"),d=a.extend({},d);var h=d.gradeNames=b.makeArray(d.gradeNames);h.unshift(g),d.type="fluid.component";var i=0===f.length;i&&h.push("fluid.resolveRoot");var j=b.typeNameToMemberName(d.singleRootType||g);f.push(j),b.construct(f,d,e)},b.destroySingle=function(a,c,d){d=d||b.globalInstantiator;var e=b.model.parseToSegments(a,d.parseEL,!0),f=b.typeNameToMemberName(c);e.push(f),b.destroy(e,d)},b.makeGradeLinkage=function(a,c,d){b.defaults(a,{gradeNames:"fluid.component",distributeOptions:{record:d,target:"{/ "+c.join("&")+"}.options.gradeNames"}}),b.constructSingle([],a)},b["debugger"]=function(){},b.defaults("fluid.debuggingProbe",{gradeNames:["fluid.component"]}),b.probeToDistribution=function(a){var c=b.globalInstantiator,d=b.parseContextReference(a.target),e=b.model.parseToSegments(d.path,c.parseEL,!0);"options"!==e[0]&&e.unshift("options");var f=b.parsePriority(a.priority);return f.constraint&&!f.constraint.target&&(f.constraint.target="authoring"),{target:"{/ "+d.context+"}."+c.composeSegments.apply(null,e),record:{func:a.func,funcName:a.funcName,args:a.args,priority:b.renderPriority(f)}}},b.registerProbes=function(a){var c=b.transform(a,b.probeToDistribution),d="fluid_debuggingProbe_"+b.allocateGuid();return b.construct([d],{type:"fluid.debuggingProbe",distributeOptions:c}),d},b.deregisterProbes=function(a){b.destroy([a])},b.thisistToApplicable=function(a,c,d){return{apply:function(e,f){var g=b.expandOptions(c,d);"string"==typeof g&&(g=b.getGlobalValue(g)),g||b.fail("Could not resolve reference "+c+" to a value");var h=g[a.method];return"function"!=typeof h&&b.fail("Object ",g," at reference "+c+" has no member named "+a.method+" which is a function "),b.log("Applying arguments ",f," to method "+a.method+" of instance ",g),h.apply(g,f)}}},b.changeToApplicable=function(a,c){return{apply:function(d,e){var f=b.parseValidModelReference(c,"changePath listener record",a.changePath),g=b.expandOptions(a.value,c,{},{arguments:e});b.fireSourcedChange(f.applier,f.path,g,a.source)}}},b.recordToApplicable=function(a,c){if(a.changePath)return b.changeToApplicable(a,c);var d=a["this"];return a.method^d&&b.fail("Record ",c,' must contain both entries "method" and "this" if it contains either'),a.method?b.thisistToApplicable(a,d,c):null},b.getGlobalValueNonComponent=function(a,c){var d=b.defaults(a);return d&&b.hasGrade(d,"fluid.component")&&b.fail("Error in function specification - cannot invoke function "+a+" in the context of "+c+": component creator functions can only be used as subcomponents"),b.getGlobalValue(a)},b.makeInvoker=function(a,c,d){c=b.upgradePrimitiveFunc(c),void 0===c.args||c.args===b.NO_VALUE||b.isArrayable(c.args)||(c.args=b.makeArray(c.args));var e=b.recordToApplicable(c,a),f=b.preExpand(c.args),g={},h=b.makeStackResolverOptions(a,g,!0);return e=e||(c.funcName?b.getGlobalValueNonComponent(c.funcName,"an invoker"):b.expandImmediate(c.func,a)),e&&e.apply?e===b.notImplemented&&b.fail("Error constructing component ",a," - the invoker named "+d+" which was defined in grade "+c.componentSource+" needs to be overridden with a concrete implementation"):b.fail("Error in invoker record: could not resolve members func, funcName or method to a function implementation - got "+e+" from ",c),function(){b.defeatLogging===!1&&b.pushActivity("invokeInvoker","invoking invoker with name %name and record %record from component %that",{name:d,record:c,that:a});var i,j;return g.arguments=arguments,void 0===c.args||c.args===b.NO_VALUE?j=arguments:(b.expandImmediateImpl(f,h),j=f.source),i=e.apply(null,j),b.defeatLogging===!1&&b.popActivity(),i}},b.event.makeTrackedListenerAdder=function(a){var c=b.shadowForComponent(a);return function(a){return{addListener:function(d,e,f,g,h){b.recordListener(a,d,c,h),a.addListener.apply(null,arguments)}}}},b.event.listenerEngine=function(a,c,d){function e(){var d=b.find(a,function(a,b){return void 0===f[b]?!0:void 0});if(!d){var e=f;f={},c(e)}}var f={};b.each(a,function(a,c){d(a).addListener(function(){f[c]=b.makeArray(arguments),e()})})},b.event.dispatchListener=function(a,c,d,e,f){void 0===e.args||e.args===b.NO_VALUE||b.isArrayable(e.args)||(e.args=b.makeArray(e.args)),c=b.event.resolveListener(c);var g=b.preExpand(e.args),h={},i=b.makeStackResolverOptions(a,h,!0),j=function(){b.defeatLogging===!1&&b.pushActivity("dispatchListener","firing to listener to event named %eventName of component %that",{eventName:d,that:a});var j,k=f?arguments[0]:arguments;h.arguments=k,void 0!==e.args&&e.args!==b.NO_VALUE?(b.expandImmediateImpl(g,i),j=g.source):j=k;var l=c.apply(null,j);return b.defeatLogging===!1&&b.popActivity(),l};return b.event.impersonateListener(c,j),j},b.event.resolveSoftNamespace=function(a){if("string"!=typeof a)return null;var b=Math.max(a.lastIndexOf("."),a.lastIndexOf("}"));return a.substring(b+1)},b.event.resolveListenerRecord=function(a,c,d,e,f){var g=function(a,c){b.fail("Error in listener record - could not resolve reference ",a,' to a listener or firer. Did you miss out "events." when referring to an event firer?'+c)};b.pushActivity("resolveListenerRecord","resolving listener record for event named %eventName for component %that",{eventName:d,that:c});var h=b.makeArray(a),i=b.transform(h,function(a){var h=b.isPrimitive(a)||a.expander?{listener:a}:b.copy(a),i=b.recordToApplicable(a,c);i?h.listener=i:h.listener=h.listener||h.func||h.funcName,h.listener||g(a,' Listener record must contain a member named "listener", "func", "funcName" or "method"');var j=a.method?b.event.resolveSoftNamespace(a["this"])+"."+a.method:b.event.resolveSoftNamespace(h.listener);h.namespace||e||!j||(h.softNamespace=!0,h.namespace=(a.componentSource?a.componentSource:c.typeName)+"."+j);var k=h.listener=b.expandOptions(h.listener,c);k||g(a,"");var l=!1;return"fluid.event.firer"===k.typeName&&(k=k.fire,l=!0),h.listener=f&&(h.args&&"fluid.notImplemented"!==k||l)?b.event.dispatchListener(c,k,d,h):k,h.listenerId=b.allocateGuid(),h}),j={records:i,adderWrapper:f?b.event.makeTrackedListenerAdder(c):null};return b.popActivity(),j},b.event.expandOneEvent=function(a,c){var d;return d="string"==typeof c&&"{"!==c.charAt(0)?b.getForComponent(a,["events",c]):b.expandOptions(c,a),d&&"fluid.event.firer"===d.typeName||b.fail("Error in event specification - could not resolve base event reference ",c," to an event firer: got ",d),d},b.event.expandEvents=function(a,c){return"string"==typeof c?b.event.expandOneEvent(a,c):b.transform(c,function(c){return b.event.expandOneEvent(a,c)})},b.event.resolveEvent=function(a,c,d){b.pushActivity("resolveEvent","resolving event with name %eventName attached to component %that",{eventName:c,that:a});var e=b.event.makeTrackedListenerAdder(a);"string"==typeof d&&(d={event:d});var f="fluid.event.firer"===d.typeName?d:d.event||d.events;f||b.fail("Event specification for event with name "+c+" does not include a base event specification: ",d);var g,h="fluid.event.firer"===f.typeName?f:b.event.expandEvents(a,f),i="fluid.event.firer"!==h.typeName,j=d.args||i;if(j){g=b.makeEventFirer({name:" [composite] "+b.event.nameEvent(a,c)});var k=b.event.dispatchListener(a,g.fire,c,d,i);i?b.event.listenerEngine(h,k,e):e(h).addListener(k)}else g={typeName:"fluid.event.firer"},g.fire=function(){var a=b.makeArray(arguments);b.pushActivity("fireSynthetic","firing synthetic event %eventName ",{eventName:c});var d=h.fire.apply(null,a);return b.popActivity(),d},g.addListener=function(f,g,i,j,k){var l=b.event.dispatchListener(a,f,c,d);e(h).addListener(l,g,i,j,k)},g.removeListener=function(a){h.removeListener(a)};return b.popActivity(),g},b.withEnvironment=function(c,d,e){e=e||b.globalThreadLocal();try{for(var f in c)e[f]=c[f];return a.extend(e,c),d()}finally{for(var f in c)delete e[f]}},b.fetchContextReference=function(a,c,d,e,f){e&&(a=e(a,d));var g=a.context?d[a.context]:c;if(!g){var h=f&&f(a);return h||g}return a.noDereference?a.path:b.get(g,a.path)},b.makeEnvironmentFetcher=function(a,c,d,e){return d=d||b.globalThreadLocal,function(f){var g=d();return b.fetchContextReference(f,a,g,c,e)}},b.coerceToPrimitive=function(a){return"false"===a?!1:"true"===a?!0:isFinite(a)?Number(a):a},b.compactStringToRec=function(c,d){var e=c.indexOf("("),f=c.indexOf(")");if((-1===e^-1===f||e>f)&&b.fail("Badly-formed compact "+d+" record without matching parentheses: ",c),-1!==e&&-1!==f){var g=c.substring(f+1);""!==a.trim(g)&&b.fail("Badly-formed compact "+d+" - unexpected material following close parenthesis: "+g);var h=c.substring(0,e),i=c.substring(e+1,f),j=b.transform(i.split(","),a.trim,b.coerceToPrimitive),k=b.upgradePrimitiveFunc(h,null);return k.args=j,k}return"expander"===d&&b.fail("Badly-formed compact expander record without parentheses: ",c),c},b.expandPrefix="@expand:",b.expandCompactString=function(a,c){var d=a;if(0===a.indexOf(b.expandPrefix)){var e=a.substring(b.expandPrefix.length);d={expander:b.compactStringToRec(e,"expander")}}else c&&(d=b.compactStringToRec(a,c));return d};var f={listeners:"listener",modelListeners:"modelListener"},g=a.extend({invokers:"invoker"},f);b.expandCompactRec=function(a,c,d){b.guardCircularExpansion(a,a.length);var e=a.length>0?a[a.length-1]:"",h=g[e];!h&&a.length>1&&(h=f[a[a.length-2]]),b.each(d,function(d,e){return b.isPlainObject(d)?(c[e]=b.freshContainer(d),a.push(e),b.expandCompactRec(a,c[e],d),void a.pop()):("string"==typeof d&&(d=b.expandCompactString(d,h)),void(c[e]=d))})},b.expandCompact=function(a){var c={};return b.expandCompactRec([],c,a),c},b.isIoCReference=function(a){return"string"==typeof a&&"{"===a.charAt(0)&&a.indexOf("}")>0},b.extractEL=function(a,b){if("ALL"===b.ELstyle)return a;if(1===b.ELstyle.length){if(a.charAt(0)===b.ELstyle)return a.substring(1)}else if("${}"===b.ELstyle){var c=a.indexOf("${"),d=a.lastIndexOf("}");if(0===c&&-1!==d)return a.substring(2,d)}},b.extractELWithContext=function(a,c){var d=b.extractEL(a,c);return b.isIoCReference(d)?b.parseContextReference(d):d?{path:d}:d},b.parseContextReference=function(a,c,d){c=c||0;var e=a.indexOf("}",c+1);-1===e&&b.fail('Cannot parse context reference "'+a+'": Malformed context reference without }');var f=a.substring(c+1,e),g=d?a.indexOf(d,e+1):a.length,h=a.substring(e+1,g);return"."===h.charAt(0)&&(h=h.substring(1)),{context:f,path:h,endpos:g}},b.renderContextReference=function(a){return"{"+a.context+"}"+(a.path?"."+a.path:"")},b.resolveContextValue=function(a,c){function d(d){b.pushActivity("resolveContextValue","resolving context value %string",{string:a});var e=c.fetcher(d);return b.pushActivity("resolvedContextValue","resolved value %string to value %value",{string:a,value:e}),b.popActivity(2),e}var e;if(c.bareContextRefs&&b.isIoCReference(a))return e=b.parseContextReference(a),d(e);if(c.ELstyle&&"${}"!==c.ELstyle&&(e=b.extractELWithContext(a,c)))return d(e);for(;"string"==typeof a;){var f=a.indexOf("${"),g=a.indexOf("}",f+2);if(-1===f||-1===g)break;"{"===a.charAt(f+2)?(e=b.parseContextReference(a,f+2,"}"),g=e.endpos):e={path:a.substring(f+2,g)};var h=d(e),i=0===f&&g===a.length-1;if(void 0===h||null===h)return h;a=i?h:a.substring(0,f)+h+a.substring(g+1)}return a},b.fetchExpandChildren=function(c,d,e,f,g,h){if(f.expander){var i=b.expandExpander(c,f,h);if(b.isPrimitive(i)||!b.isPlainObject(i)||b.isArrayable(i)^b.isArrayable(c))return i;a.extend(!0,c,i)}return b.each(f,function(a,i){void 0===a?c[i]=void 0:"expander"!==i&&(e[d]=i,b.getImmediate(h.exceptions,e,d)!==!0&&h.strategy(c,i,d+1,e,f,g))}),c},b.isUnexpandable=function(a){return b.isPrimitive(a)||!b.isPlainObject(a)},b.expandSource=function(a,c,d,e,f,g,h,i){var j,k,l=b.derefMergePolicy(h);return"string"!=typeof g||l.noexpand?l.noexpand||b.isUnexpandable(g)?j=g:g.expander?j=b.expandExpander(f,g,a):(j=b.freshContainer(g),k=!0):a.defaultEL&&"{"!==g.charAt(0)?j=g:(b.pushActivity("expandContextValue","expanding context value %source held at path %path",{source:g,path:b.path.apply(null,e.slice(0,d))}),j=b.resolveContextValue(g,a),b.popActivity(1)),j!==b.NO_VALUE&&f(j),k&&i(j,g,d,e,h),j},b.guardCircularExpansion=function(a,c){c>b.strategyRecursionBailout&&b.fail("Overflow/circularity in options expansion, current path is ",a," at depth ",c,' - please ensure options are not circularly connected, or protect from expansion using the "noexpand" policy or expander')},b.makeExpandStrategy=function(a){var d=function(c,d,e,f,g){return b.fetchExpandChildren(c,e||0,f||[],d,g,a)},e=function(e,f,g,h,i,j){function k(a){e[f]=a}if(b.guardCircularExpansion(h,g),e){if(e.hasOwnProperty(f))return e[f];
void 0===i&&(i=c(a.source,h,g-1,a.sourceStrategy),j=c(a.mergePolicy,h,g-1,b.concreteTrundler));var l=a.sourceStrategy(i,f,g,h),m=b.concreteTrundler(j,f);return b.expandSource(a,e,g,h,k,l,m,d)}};return a.recurse=d,a.strategy=e,e},b.defaults("fluid.makeExpandOptions",{ELstyle:"${}",bareContextRefs:!0,target:b.inCreationMarker}),b.makeExpandOptions=function(c,d){return d=a.extend({},b.rawDefaults("fluid.makeExpandOptions"),d),d.defaultEL="${}"===d.ELStyle&&d.bareContextRefs,d.expandSource=function(a){return b.expandSource(d,null,0,[],b.identity,a,d.mergePolicy,!1)},b.isUnexpandable(c)?(d.strategy=b.concreteTrundler,d.initter=b.identity,"string"==typeof c?d.target=d.expandSource(c):d.target=c):(d.source=c,d.target=b.freshContainer(c),d.sourceStrategy=d.sourceStrategy||b.concreteTrundler,b.makeExpandStrategy(d),d.initter=function(){d.target=b.fetchExpandChildren(d.target,0,[],d.source,d.mergePolicy,d)}),d},b.expand=function(a,c){var d=b.makeExpandOptions(a,c);return d.initter(),d.target},b.preExpandRecurse=function(a,c,d,e,f){function g(b){a.expanders.push({expander:b,holder:d,member:e}),delete d[e]}if(b.guardCircularExpansion(f,f.length),b.isIoCReference(c)){var h=b.parseContextReference(c),i=b.model.parseEL(h.path);g({typeFunc:b.expander.fetch,context:h.context,segs:i})}else b.isPlainObject(c)&&(c.expander?(c.expander.typeFunc=b.getGlobalValue(c.expander.type||"fluid.invokeFunc"),g(c.expander)):b.each(c,function(d,e){f.push(e),b.preExpandRecurse(a,d,c,e,f),f.pop()}))},b.preExpand=function(a){var c={expanders:[],source:b.isUnexpandable(a)?a:b.copy(a)};return b.preExpandRecurse(c,c.source,c,"source",[]),c},b.expandImmediate=function(a,c,d){var e=b.makeStackResolverOptions(c,d,!0),f=b.preExpand(a);return b.expandImmediateImpl(f,e),f.source},b.expandImmediateImpl=function(a,b){for(var c=a.expanders,d=0;d<c.length;++d){var e=c[d];e.holder[e.member]=e.expander.typeFunc(null,e,b)}},b.expandExpander=function(a,c,d){var e=b.getGlobalValue(c.expander.type||"fluid.invokeFunc");return e||b.fail("Unknown expander with type "+c.expander.type),e(a,c,d)},b.registerNamespace("fluid.expander"),b.expander.fetch=function(a,c,d){var e=d.localRecord,f=c.expander.context,g=c.expander.segs,h=void 0!==e[f],i=h?e[f]:b.resolveContext(f,d.contextThat,"treeConstructed"===d.contextThat.lifecycleStatus);if(i){var j=i;if(h||"constructed"===i.lifecycleStatus||"treeConstructed"===i.lifecycleStatus)for(var k=0;k<g.length;++k)j=j?j[g[k]]:void 0;else"destroyed"!==i.lifecycleStatus?j=b.getForComponent(i,g):b.fail("Cannot resolve path "+g.join(".")+" into component ",i," which has been destroyed");return void 0!==j||h||(j=b.getForComponent(i,g)),j}},b.invokeFunc=function(a,c,d){var e=c.expander,f=b.makeArray(e.args);e.args=f,d.recurse?f=d.recurse([],f):(e=b.expandImmediate(e,d.contextThat,d.localRecord),f=e.args);var g=e.func||e.funcName,h=(d.expandSource?d.expandSource(g):g)||b.recordToApplicable(e,d.contextThat);return h||b.fail("Error in expander record - "+g+" could not be resolved to a function for component ",d.contextThat),h.apply?h.apply(null,f):b.invokeGlobalFunction(h,f)},b.noexpand=function(a,b){return b.expander.value?b.expander.value:b.expander.tree}}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.model.makeEnvironmentStrategy=function(a){return function(b,c,d){return 0===d&&a[c]?a[c]:void 0}},b.model.defaultCreatorStrategy=function(a,b){return void 0===a[b]?(a[b]={},a[b]):void 0},b.model.defaultFetchStrategy=function(a,b){return a[b]},b.model.funcResolverStrategy=function(a,b){return a.resolvePathSegment?a.resolvePathSegment(b):void 0},b.model.traverseWithStrategy=function(a,c,d,e,f){for(var g=e.strategies,h=c.length-f,i=d;h>i;++i){if(!a)return a;for(var j,k=0;k<g.length&&(j=g[k](a,c[i],i+1,c),void 0===j);++k);j===b.NO_VALUE&&(j=void 0),a=j}return a},b.model.getValueAndSegments=function(a,c,d,e){return b.model.accessWithStrategy(a,c,b.NO_VALUE,d,e,!0)},b.model.makeTrundler=function(a){return function(c,d){return b.model.getValueAndSegments(c.root,d,a,c.segs)}},b.model.getWithStrategy=function(a,c,d,e){return b.model.accessWithStrategy(a,c,b.NO_VALUE,d,e)},b.model.setWithStrategy=function(a,c,d,e,f){b.model.accessWithStrategy(a,c,d,e,f)},b.model.accessWithStrategy=function(a,c,d,e,f,g){if(b.isPrimitive(c)||b.isArrayable(c))return b.model.accessImpl(a,c,d,e,f,g,b.model.traverseWithStrategy);var h=c.type||"default",i=e.resolvers[h];i||b.fail("Unable to find resolver of type "+h);var j=b.model.makeTrundler(e),k={root:a,segs:f};return k=i(k,c,j),c.path&&k&&(k=j(k,c.path)),g?k:k?k.root:void 0},b.registerNamespace("fluid.pathUtil"),b.pathUtil.getPathSegmentImpl=function(a,b,c){var d=null;a&&(d="");for(var e=!1,f=b.length;f>c;++c){var g=b.charAt(c);if(e)e=!1,null!==d&&(d+=g);else{if("."===g)break;"\\"===g?e=!0:null!==d&&(d+=g)}}return null!==d&&(a[0]=d),c};var c=[];b.pathUtil.parseEL=function(a){for(var d=[],e=0,f=a.length;f>e;){var g=b.pathUtil.getPathSegmentImpl(c,a,e);d.push(c[0]),e=g+1}return d},b.pathUtil.composeSegment=function(a,b){b=b.toString();for(var c=0;c<b.length;++c){var d=b.charAt(c);"."!==d&&"\\"!==d&&"}"!==d||(a+="\\"),a+=d}return a},b.pathUtil.escapeSegment=function(a){return b.pathUtil.composeSegment("",a)},b.pathUtil.composePath=function(a,c){return 0!==a.length&&(a+="."),b.pathUtil.composeSegment(a,c)},b.pathUtil.composeSegments=function(){for(var a="",c=0;c<arguments.length;++c)a=b.pathUtil.composePath(a,arguments[c]);return a},b.pathUtil.matchSegments=function(a,b,c,d){if(d-c!==a.length)return!1;for(var e=c;d>e;++e)if(b[e]!==a[e-c])return!1;return!0},b.model.unescapedParser={parse:b.model.parseEL,compose:b.model.composeSegments},b.model.defaultGetConfig={parser:b.model.unescapedParser,strategies:[b.model.funcResolverStrategy,b.model.defaultFetchStrategy]},b.model.defaultSetConfig={parser:b.model.unescapedParser,strategies:[b.model.funcResolverStrategy,b.model.defaultFetchStrategy,b.model.defaultCreatorStrategy]},b.model.escapedParser={parse:b.pathUtil.parseEL,compose:b.pathUtil.composeSegments},b.model.escapedGetConfig={parser:b.model.escapedParser,strategies:[b.model.defaultFetchStrategy]},b.model.escapedSetConfig={parser:b.model.escapedParser,strategies:[b.model.defaultFetchStrategy,b.model.defaultCreatorStrategy]},b.initRelayModel=function(a){return b.deenlistModelComponent(a),a.model},b.isModelComplete=function(a){return"model"in a&&a.model!==b.inEvaluationMarker},b.enlistModelComponent=function(a){var c=b.getInstantiator(a),d=c.modelTransactions.init[a.id];return d||(d={that:a,applier:b.getForComponent(a,"applier"),complete:b.isModelComplete(a)},c.modelTransactions.init[a.id]=d),d},b.clearTransactions=function(){var a=b.globalInstantiator;b.clear(a.modelTransactions),a.modelTransactions.init={}},b.failureEvent.addListener(b.clearTransactions,"clearTransactions","before:fail"),b.clearLinkCounts=function(a,c){b.each(a,function(b,d){"number"==typeof b?a[d]=0:c&&b.options&&"number"==typeof b.relayCount&&(b.relayCount=0)})},b.sortCompleteLast=function(a,b){return(a.completeOnInit?1:0)-(b.completeOnInit?1:0)},b.operateInitialTransaction=function(a,c){var d,e=b.allocateGuid(),f=b.getModelTransactionRec(a,e),g=b.transform(c,function(a){return d=a.that.applier.initiate("init",e),f[a.that.applier.applierId]={transaction:d},d}),h=b.values(c).sort(b.sortCompleteLast);b.each(h,function(a){var c=a.that,d=g[c.id];a.completeOnInit?b.initModelEvent(c,c.applier,d,c.applier.changeListeners.listeners):b.each(a.initModels,function(a){d.fireChangeRequest({type:"ADD",segs:[],value:a}),b.clearLinkCounts(f,!0)});var e=b.shadowForComponent(c);e.modelComplete=!0}),d.commit()},b.deenlistModelComponent=function(a){var c=b.getInstantiator(a),d=c.modelTransactions.init;if(d[a.id]){a.model=void 0,d[a.id].complete=!0;var e=b.find_if(d,function(a){return a.complete!==!0});e||(b.operateInitialTransaction(c,d),c.modelTransactions.init={})}},b.transformToAdapter=function(a,c){var d={};return d[c]=a,function(a,c){b.model.transformWithRules(c,d,{finalApplier:a})}},b.parseModelReference=function(a,c){var d=b.parseContextReference(c);return d.segs=a.applier.parseEL(d.path),d},b.parseValidModelReference=function(a,c,d){var e,f,g=function(a){b.fail("Error in "+c+": "+d+a)};return"{"===d.charAt(0)?(e=b.parseModelReference(a,d),"model"!==e.segs[0]?g(' must be a reference into a component model beginning with "model"'):(e.modelSegs=e.segs.slice(1),delete e.path),f=b.resolveContext(e.context,a),f||g(" must be a reference to an existing component")):(f=a,e={path:d,modelSegs:a.applier.parseEL(d)}),f.applier||b.getForComponent(f,["applier"]),f.applier||g(" must be a reference to a component with a ChangeApplier (descended from fluid.modelComponent)"),e.that=f,e.applier=f.applier,e.path||(e.path=f.applier.composeSegments.apply(null,e.modelSegs)),e},b.getModelTransactionRec=function(a,c){if(c||b.fail("Cannot get transaction record without transaction id"),!a)return null;var d=a.modelTransactions[c];return d||(d=a.modelTransactions[c]={externalChanges:{}}),d},b.recordChangeListener=function(a,c,d){var e=b.shadowForComponent(a);b.recordListener(c.modelChanged,d,e)},b.relayRecursionBailout=100,b.registerDirectChangeRelay=function(a,c,d,e,f,g,h){var i=b.getInstantiator(a),j=h.targetApplier||a.applier,k=h.sourceApplier||d.applier,l=j.applierId;c=b.makeArray(c),e=e?b.makeArray(e):e;var m=function(d,k,m,n,o,p){var q=o.id,r=b.getModelTransactionRec(i,q);p&&o&&!r[p.applierId]&&(r[p.applierId]={transaction:o});var s=r[l];r[f]=r[f]||0;var t=!0;if(t){if(++r[f],r[f]>b.relayRecursionBailout&&b.fail("Error in model relay specification at component ",a," - operated more than "+b.relayRecursionBailout+" relays without model value settling - current model contents are ",o.newHolder.model),!s){var u=j.initiate("relay",q);s=r[l]={transaction:u,relayCount:0,options:h}}g&&!h.targetApplier?g(s.transaction,h.sourceApplier?void 0:d,e,c):void 0!==d&&s.transaction.fireChangeRequest({type:"ADD",segs:c,value:d})}};m.relayListenerId=b.allocateGuid(),e&&(b.log(b.logLevel.TRACE,"Adding relay listener with id "+m.relayListenerId+" to source applier with id "+k.applierId+" from target applier with id "+l+" for target component with id "+a.id),k.modelChanged.addListener({isRelay:!0,segs:e,transactional:h.transactional},m)),d&&(b.recordChangeListener(d,k,m),a!==d&&b.recordChangeListener(a,k,m))},b.connectModelRelay=function(a,c,d,e,f){function g(a){var c=b.enlistModelComponent(a);if(c.complete){var d=b.shadowForComponent(a);d.modelComplete&&(c.completeOnInit=!0)}}var h=b.allocateGuid();g(d),g(a),f.update?f.targetApplier?b.registerDirectChangeRelay(a,c,d,e,h,null,{transactional:!1,targetApplier:f.targetApplier,update:f.update}):b.registerDirectChangeRelay(d,e,a,[],h+"-transform",f.forwardAdapter,{transactional:!0,sourceApplier:f.forwardApplier}):(b.registerDirectChangeRelay(d,e,a,c,h,f.forwardAdapter,{transactional:!1}),c&&b.registerDirectChangeRelay(a,c,d,e,h,f.backwardAdapter,{transactional:!1}))},b.model.guardedAdapter=function(a,c,d,e){var f=b.getInstantiator(a),g=f.modelTransactions.init[a.id],h=c[g?"init":"live"];h&&d.apply(null,e)},b.makeTransformPackage=function(a,c,d,e,f,g){var h={forwardHolder:{model:c},backwardHolder:{model:null}};h.generateAdapters=function(a){h.forwardAdapterImpl=b.transformToAdapter(a?a.newHolder.model:h.forwardHolder.model,e),null!==d&&(h.backwardHolder.model=b.model.transform.invertConfiguration(c),h.backwardAdapterImpl=b.transformToAdapter(h.backwardHolder.model,d))},h.forwardAdapter=function(c,d){void 0===d&&h.generateAdapters(),b.model.guardedAdapter(a,f,h.forwardAdapterImpl,arguments)},h.runTransform=function(a){a.commit(),a.reset()},h.forwardApplier=b.makeHolderChangeApplier(h.forwardHolder),h.forwardApplier.isRelayApplier=!0,h.invalidator=b.makeEventFirer({name:"Invalidator for model relay with applier "+h.forwardApplier.applierId}),null!==d&&(h.backwardApplier=b.makeHolderChangeApplier(h.backwardHolder),h.backwardAdapter=function(){b.model.guardedAdapter(a,g,h.backwardAdapterImpl,arguments)}),h.update=h.invalidator.fire;var i={targetApplier:h.forwardApplier,update:h.update,refCount:0};return h.forwardHolder.model=b.parseImplicitRelay(a,c,[],i),h.refCount=i.refCount,h.generateAdapters(),h.invalidator.addListener(h.generateAdapters),h.invalidator.addListener(h.runTransform),h},b.singleTransformToFull=function(b){var c=a.extend(!0,{valuePath:""},b);return{"":{transform:c}}},b.model.relayConditions={initOnly:{init:!0,live:!1},liveOnly:{init:!1,live:!0},never:{init:!1,live:!1},always:{init:!0,live:!0}},b.model.parseRelayCondition=function(a){return b.model.relayConditions[a||"always"]},b.parseModelRelay=function(a,c){var d=c.source?b.parseValidModelReference(a,'modelRelay record member "source"',c.source):{path:null,modelSegs:null},e=b.parseValidModelReference(a,'modelRelay record member "target"',c.target),f=c.singleTransform?b.singleTransformToFull(c.singleTransform):c.transform;f||b.fail('Cannot parse modelRelay record without element "singleTransform" or "transform":',c);var g=b.model.parseRelayCondition(c.forward),h=b.model.parseRelayCondition(c.backward),i=b.makeTransformPackage(a,f,d.path,e.path,g,h);0===i.refCount?b.connectModelRelay(d.that||a,d.modelSegs,e.that,e.modelSegs,{forwardAdapter:i.forwardAdapter,backwardAdapter:i.backwardAdapter}):b.connectModelRelay(d.that||a,d.modelSegs,e.that,e.modelSegs,i)},b.parseImplicitRelay=function(a,c,d,e){var f;if("string"==typeof c&&"{"===c.charAt(0)){var g=b.parseModelReference(a,c),h=b.resolveContext(g.context,a);if("model"===g.segs[0]){var i=g.segs.slice(1);++e.refCount,b.connectModelRelay(a,d,h,i,e)}else f=b.getForComponent(h,g.segs)}else b.isPrimitive(c)||!b.isPlainObject(c)?f=c:c.expander&&b.isPlainObject(c.expander)?f=b.expandOptions(c,a):(f=b.freshContainer(c),b.each(c,function(c,g){d.push(g);var h=b.parseImplicitRelay(a,c,d,e);void 0!==h&&(f[g]=h),d.pop()}));return f},b.model.notifyExternal=function(a){var c=a?b.values(a.externalChanges):[];b.sortByPriority(c);for(var d=0;d<c.length;++d){var e=c[d],f=e.args[5];f.destroyed||e.listener.apply(null,e.args)}b.clearLinkCounts(a,!0)},b.model.commitRelays=function(a,c){var d=a.modelTransactions[c];b.each(d,function(a){a.transaction&&(a.transaction.commit("relay"),a.transaction.reset())})},b.model.updateRelays=function(a,c){var d=a.modelTransactions[c],e=0;return b.each(d,function(a){a.options&&a.transaction&&a.transaction.changeRecord.changes>0&&a.relayCount<2&&a.options.update&&(a.relayCount++,b.clearLinkCounts(d),a.options.update(a.transaction,d),++e)}),e},b.establishModelRelay=function(a,c,d,e,f){function g(a){for(;b.model.updateRelays(l,a.id)>0;);}function h(a,c,d){"relay"!==d&&b.model.commitRelays(l,a.id)}function i(a,c,d){"relay"!==d&&(b.model.notifyExternal(l.modelTransactions[a.id]),delete l.modelTransactions[a.id])}b.mergeModelListeners(a,d);var j=b.enlistModelComponent(a);b.each(e,function(c){b.parseModelRelay(a,c)});var k=b.transform(c,function(c){return b.parseImplicitRelay(a,c,[],{refCount:0})});j.initModels=k;var l=b.getInstantiator(a);return f.preCommit.addListener(g),f.preCommit.addListener(h),f.postCommit.addListener(i),null},b.defaults("fluid.modelComponent",{gradeNames:["fluid.component"],changeApplierOptions:{relayStyle:!0,cullUnchanged:!0},members:{model:"@expand:fluid.initRelayModel({that}, {that}.modelRelay)",applier:"@expand:fluid.makeHolderChangeApplier({that}, {that}.options.changeApplierOptions)",modelRelay:"@expand:fluid.establishModelRelay({that}, {that}.options.model, {that}.options.modelListeners, {that}.options.modelRelay, {that}.applier)"},mergePolicy:{model:{noexpand:!0,func:b.arrayConcatPolicy},modelListeners:b.makeMergeListenersPolicy(b.arrayConcatPolicy),modelRelay:{noexpand:!0,func:b.arrayConcatPolicy}}}),b.modelChangedToChange=function(a){return{value:a[0],oldValue:a[1],path:a[2]}},b.resolveModelListener=function(a,c){var d=function(){if(!b.isDestroyed(a)){var d=b.modelChangedToChange(arguments),e=[d],f={change:d,arguments:e};c.args&&(e=b.expandOptions(c.args,a,{},f)),b.event.invokeListener(c.listener,b.makeArray(e))}};return b.event.impersonateListener(c.listener,d),d},b.mergeModelListeners=function(a,c){var d=0;b.each(c,function(c,e){"string"==typeof c&&(c={funcName:c});var f=b.event.resolveListenerRecord(c,a,"modelListeners",null,!1),g=b.parseValidModelReference(a,"modelListeners entry",e);b.each(f.records,function(c){function e(){if(b.isModelComplete(g.that)){var c=g.applier.initiate("init");b.initModelEvent(a,g.applier,c,[h]),c.commit()}}var f=b.resolveModelListener(a,c),h={listener:f,listenerIndex:d,segs:g.modelSegs,path:g.path,includeSource:c.includeSource,excludeSource:c.excludeSource,priority:c.priority,transactional:!0};if(++d,h=g.applier.modelChanged.addListener(h,f,c.namespace,c.softNamespace),b.recordChangeListener(a,g.applier,f),a!==g.that&&!b.isModelComplete(a)){var i=b.getForComponent(a,["events","onCreate"]);i.addListener(e)}})})},b.addSourceGuardedListener=function(a,c,d,e,f,g,h){f=f||"modelChanged";var i=function(b,c,f,g){return a.hasChangeSource(d,g)?void 0:e.apply(null,arguments)};return b.event.impersonateListener(e,i),a[f].addListener(c,i,g,h)},b.fireSourcedChange=function(a,b,c,d){a.fireChangeRequest({path:b,value:c,source:d})},b.requestChanges=function(a,b){for(var c=0;c<b.length;++c)a.fireChangeRequest(b[c])},b.bindRequestChange=function(a){a.requestChange=a.change=function(b,c,d){var e={path:b,value:c,type:d};a.fireChangeRequest(e)}},b.identifyChangeListener=function(a){return b.event.identifyListener(a)||a},b.model.isChangedPath=function(a,b){for(var c=0;c<=b.length;++c){if("string"==typeof a)return!0;c<b.length&&a&&(a=a[b[c]])}return!1},b.model.setChangedPath=function(a,c,d){var e=function(e){c.unshift(e),b.model.setSimple(a,c,d),c.shift()};b.model.isChangedPath(a.changeMap,c)||(++a.changes,e("changeMap")),b.model.isChangedPath(a.deltaMap,c)||(++a.deltas,e("deltaMap"))},b.model.fetchChangeChildren=function(a,c,d,e,f){b.each(e,function(e,g){d[c]=g,b.model.applyChangeStrategy(a,g,c,d,e,f),d.length=c})},b.model.isSameValue=function(a,b){if("number"!=typeof a||"number"!=typeof b)return a===b;if(a===b||a!==a&&b!==b)return!0;var c=Math.abs((a-b)/b);return 1e-12>c},b.model.applyChangeStrategy=function(a,c,d,e,f,g){var h=a[c],i=b.typeCode(f),j=b.typeCode(h),k=b.NO_VALUE;"primitive"===i?b.model.isSameValue(h,f)||(k=f,++g.unchanged):(j!==i||"array"===i&&f.length!==h.length)&&(k=b.freshContainer(f)),k!==b.NO_VALUE&&(a[c]=k,g.changeMap&&b.model.setChangedPath(g,e,g.inverse?"DELETE":"ADD")),"primitive"!==i&&b.model.fetchChangeChildren(a[c],d+1,e,f,g)},b.model.stepTargetAccess=function(a,c,d,e,f,g){for(var h=e;f>h;++h)if(a){var i=a[d[h]];a=b.model.traverseWithStrategy(a,d,h,g["ADD"===c?"resolverSetConfig":"resolverGetConfig"],d.length-h-1),i!==a&&g.changeMap&&b.model.setChangedPath(g,d.slice(0,h+1),"ADD")}return{root:a,last:d[f]}},b.model.defaultAccessorConfig=function(a){return a=a||{},a.resolverSetConfig=a.resolverSetConfig||b.model.escapedSetConfig,a.resolverGetConfig=a.resolverGetConfig||b.model.escapedGetConfig,a},b.model.applyHolderChangeRequest=function(a,c,d){d=b.model.defaultAccessorConfig(d),d.deltaMap=d.changeMap?{}:null,d.deltas=0;var e,f=c.segs.length,g=0===f;if(g?e={root:a,last:"model"}:(a.model||(a.model={},b.model.setChangedPath(d,[],d.inverse?"DELETE":"ADD")),e=b.model.stepTargetAccess(a.model,c.type,c.segs,0,f-1,d)),"ADD"===c.type){var h=c.value,i=b.makeArray(c.segs);b.model.applyChangeStrategy(e.root,e.last,f-1,i,h,d,g)}else"DELETE"===c.type?e.root&&void 0!==e.root[e.last]&&(delete e.root[e.last],d.changeMap&&b.model.setChangedPath(d,c.segs,"DELETE")):b.fail("Unrecognised change type of "+c.type);return d.deltas?d.deltaMap:null},b.model.diff=function(a,c,d){d=d||{changes:0,unchanged:0,changeMap:{}};var e,f=b.typeCode(a),g=b.typeCode(c);if("primitive"===f&&"primitive"===g)e=b.model.isSameValue(a,c);else if("primitive"===f^"primitive"===g)e=!1;else{var h={model:b.copy(a)};b.model.applyHolderChangeRequest(h,{value:c,segs:[],type:"ADD"},d);var i={model:b.copy(c)};d.inverse=!0,b.model.applyHolderChangeRequest(i,{value:a,segs:[],type:"ADD"},d),e=0===d.changes}return e===!1&&0===d.changes?(d.changes=1,d.changeMap=void 0===c?"DELETE":"ADD"):e===!0&&0===d.unchanged&&(d.unchanged=1),e},b.matchChanges=function(a,c,d){for(var e=d.model,f=a,g=["model"],h=!1,i=[],j=0;j<c.length;++j){var k=c[j];"*"===k?j===c.length-1?h=!0:b.fail("Wildcard specification in modelChanged listener is only supported for the final path segment: "+c.join(".")):(g.push(k),f=b.isPrimitive(f)?f:f[k],e=e?e[k]:void 0)}return f&&(h?b.each(e,function(a,b){i.push(g.concat(b))}):i.push(g)),i},b.storeExternalChange=function(a,c,d,e,f){var g=c.composeSegments.apply(null,d),h=[c.applierId,b.event.identifyListener(e.listener),e.listenerIndex,g],i=h.join("|");a.externalChanges[i]={listener:e.listener,priority:e.priority,args:f}},b.isExcludedChangeSource=function(a,b){if(!b.excludeSource)return!1;var c=b.excludeSource["*"];for(var d in a.sources)b.excludeSource[d]&&(c=!0),b.includeSource[d]&&(c=!1);return c},b.notifyModelChanges=function(a,c,d,e,f,g,h,i){for(var j=b.getInstantiator&&b.getInstantiator(i),k=g&&b.getModelTransactionRec(j,g.id),l=0;l<a.length;++l)for(var m=a[l],n=b.matchChanges(c,m.segs,d),o=0;o<n.length;++o){if(h.destroyed)return;var p=n[o];m.listener=b.event.resolveListener(m.listener);var q=[b.model.getSimple(d,p),b.model.getSimple(e,p),p.slice(1),f,g,h];if(!m.isRelay){var r=b.model.diff(q[0],q[1]);if(r)continue;var s=b.isExcludedChangeSource(g,m);if(s)continue}k&&!m.isRelay&&m.transactional?b.storeExternalChange(k,h,p,m,q):m.listener.apply(null,q)}},b.bindELMethods=function(a){a.parseEL=function(c){return b.model.pathToSegments(c,a.options.resolverSetConfig)},a.composeSegments=function(){return a.options.resolverSetConfig.parser.compose.apply(null,arguments)}},b.initModelEvent=function(a,c,d,e){b.notifyModelChanges(e,"ADD",d.oldHolder,b.emptyHolder,null,d,c,a)},b.emptyHolder={model:void 0},b.preFireChangeRequest=function(a,b){b.type||(b.type="ADD"),b.segs=b.segs||a.parseEL(b.path)},b.ChangeApplier=function(){},b.makeHolderChangeApplier=function(c,d){d=b.model.defaultAccessorConfig(d);var e=b.allocateGuid(),f=new b.ChangeApplier;return a.extend(f,{applierId:e,holder:c,changeListeners:{listeners:[],transListeners:[]},options:d,modelChanged:{},preCommit:b.makeEventFirer({name:"preCommit event for ChangeApplier "}),postCommit:b.makeEventFirer({name:"postCommit event for ChangeApplier "})}),f.destroy=function(){f.preCommit.destroy(),f.postCommit.destroy(),f.destroyed=!0},f.modelChanged.addListener=function(a,c,d,e){a="string"==typeof a?{path:a}:b.copy(a),a.id=b.event.identifyListener(c),a.namespace=d,a.softNamespace=e,"string"==typeof c&&(c={globalName:c}),a.listener=c,a.transactional!==!1&&(a.transactional=!0),a.segs=a.segs||f.parseEL(a.path);var g=f.changeListeners[a.transactional?"transListeners":"listeners"];return a.excludeSource=b.arrayToHash(b.makeArray(a.excludeSource||(a.includeSource?"*":void 0))),a.includeSource=b.arrayToHash(b.makeArray(a.includeSource)),a.priority=b.parsePriority(a.priority,g.length,!0,"model listener"),g.push(a),a},f.modelChanged.removeListener=function(a){var c=b.event.identifyListener(a),d="string"==typeof a?a:null,e=function(a){return a.id===c||a.namespace===d};b.remove_if(f.changeListeners.listeners,e),b.remove_if(f.changeListeners.transListeners,e)},f.fireChangeRequest=function(a){var b=f.initiate();b.fireChangeRequest(a),b.commit()},f.initiate=function(a,e){a=a||"local";var g="relay"===a,h={instanceId:b.allocateGuid(),id:e||b.allocateGuid(),sources:{},changeRecord:{resolverSetConfig:d.resolverSetConfig,resolverGetConfig:d.resolverGetConfig},reset:function(){h.oldHolder=c,h.newHolder={model:b.copy(c.model)},h.changeRecord.changes=0,h.changeRecord.unchanged=0,h.changeRecord.changeMap={}},commit:function(a){if(f.preCommit.fire(h,f,a),h.changeRecord.changes>0){var d={model:c.model};c.model=h.newHolder.model,b.notifyModelChanges(f.changeListeners.transListeners,h.changeRecord.changeMap,c,d,null,h,f,c)}g||f.postCommit.fire(h,f,a)},fireChangeRequest:function(a){b.preFireChangeRequest(f,a),a.transactionId=h.id;var d=b.model.applyHolderChangeRequest(h.newHolder,a,h.changeRecord);b.notifyModelChanges(f.changeListeners.listeners,d,h.newHolder,c,a,h,f,c)}};return h.sources[a]=!0,h.reset(),b.bindRequestChange(h),h},f.hasChangeSource=function(a,b){return b?b[a]:!1},b.bindRequestChange(f),b.bindELMethods(f),f}}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{},fluid=fluid||fluid_2_0_0;!function(a,b){"use strict";b.registerNamespace("fluid.model.transform"),b.defaults("fluid.transformFunction",{gradeNames:"fluid.function"}),b.defaults("fluid.standardInputTransformFunction",{gradeNames:"fluid.transformFunction"}),b.defaults("fluid.standardOutputTransformFunction",{gradeNames:"fluid.transformFunction"}),b.defaults("fluid.multiInputTransformFunction",{gradeNames:"fluid.transformFunction"}),b.defaults("fluid.standardTransformFunction",{gradeNames:["fluid.standardInputTransformFunction","fluid.standardOutputTransformFunction"]}),b.defaults("fluid.lens",{gradeNames:"fluid.transformFunction",invertConfiguration:null}),b.model.transform.pathToRule=function(a){return{transform:{type:"fluid.transforms.value",inputPath:a}}},b.model.transform.literalValueToRule=function(a){return{transform:{type:"fluid.transforms.literalValue",value:a}}},b.model.composePaths=function(a,b){return a=0===a?"0":a||"",b=0===b?"0":b||"",a?b?a+"."+b:a:b},b.model.transform.accumulateInputPath=function(a,c,d){void 0!==a&&d.push(b.model.composePaths(c.inputPrefix,a))},b.model.transform.accumulateStandardInputPath=function(a,c,d,e){b.model.transform.getValue(void 0,c[a],d),b.model.transform.accumulateInputPath(c[a+"Path"],d,e)},b.model.transform.accumulateMultiInputPaths=function(a,c,d,e){b.each(a,function(a,f){b.model.transform.accumulateStandardInputPath(f,c,d,e)})},b.model.transform.getValue=function(a,c,d){var e;return void 0!==a&&(e=b.get(d.source,b.model.composePaths(d.inputPrefix,a),d.resolverGetConfig)),void 0===e&&(e=b.isPrimitive(c)?c:d.expand(c)),e},b.model.transform.NONDEFAULT_OUTPUT_PATH_RETURN={},b.model.transform.setValue=function(a,c,d){var e=b.copy(c),f=b.model.composePaths(d.outputPrefix,a);return void 0!==e&&d.applier.requestChange(f,e),a?b.model.transform.NONDEFAULT_OUTPUT_PATH_RETURN:e},b.model.transform.resolveParam=function(a,c,d,e){var f=b.model.transform.getValue(a[d+"Path"],a[d],c);return void 0!==f?f:e},b.model.transform.matchValue=function(a,c,d){var e={changes:0,unchanged:0,changeMap:{}};return b.model.diff(a,c,e),0===e.unchanged?0:d?0xffffff000000-16777216*e.changes+e.unchanged:e.changes?0:0xffffff000000+e.unchanged},b.firstDefined=function(a,b){return void 0===a?b:a},b.model.transform.prefixApplier=function(a,b){a.inputPrefix&&b.inputPrefixOp.push(a.inputPrefix),a.outputPrefix&&b.outputPrefixOp.push(a.outputPrefix),b.expand(a.value),a.inputPrefix&&b.inputPrefixOp.pop(),a.outputPrefix&&b.outputPrefixOp.pop()},b.defaults("fluid.model.transform.prefixApplier",{gradeNames:["fluid.transformFunction"]}),b.model.makePathStack=function(a,c){var d=a[c+"Stack"]=[];return a[c]="",{push:function(e){var f=b.model.composePaths(a[c],e);d.push(a[c]),a[c]=f},pop:function(){a[c]=d.pop()}}},b.model.transform.aliasStandardInput=function(a){return{value:void 0===a.value?a.input:a.value,valuePath:void 0===a.valuePath?a.inputPath:a.valuePath}},b.model.transform.doTransform=function(a,c,d){var e=d.defaults,f=b.getGlobalValue(d.typeName);"function"!=typeof f&&b.fail("Transformation record specifies transformation function with name "+a.type+" which is not a function - ",f),b.hasGrade(e,"fluid.transformFunction")||(e=b.defaults("fluid.standardTransformFunction"));var g=[a,c];if(b.hasGrade(e,"fluid.standardInputTransformFunction")){var h=b.model.transform.aliasStandardInput(a),i=b.model.transform.getValue(h.valuePath,h.value,c);if(g.unshift(i),void 0===i)return}else if(b.hasGrade(e,"fluid.multiInputTransformFunction")){var j={};b.each(e.inputVariables,function(d,e){j[e]=function(){var f=b.model.transform.getValue(a[e+"Path"],a[e],c);return f=void 0===f&&null!==d?d:f}}),g.unshift(j)}var k=f.apply(null,g);if(b.hasGrade(e,"fluid.standardOutputTransformFunction")){var l=void 0!==a.outputPath?a.outputPath:d.doOutput?"":void 0;void 0!==l&&void 0!==k&&(b.model.transform.setValue(a.outputPath,k,c),k=void 0)}return k};var c=[];b.registerNamespace("fluid.pathUtil"),b.pathUtil.getPathSegment=function(a,d){return b.pathUtil.getPathSegmentImpl(c,a,d),c[0]},b.pathUtil.getHeadPath=function(a){return b.pathUtil.getPathSegment(a,0)},b.pathUtil.getFromHeadPath=function(a){var c=b.pathUtil.getPathSegmentImpl(null,a,0);return c===a.length?"":a.substring(c+1)},b.pathUtil.matchPath=function(a,c,d){for(var e=[];;){if(""===c^""===a&&d)return null;if(!a||!c)break;var f=b.pathUtil.getHeadPath(a),g=b.pathUtil.getHeadPath(c);if("*"!==f&&f!==g)return null;e.push(g),a=b.pathUtil.getFromHeadPath(a),c=b.pathUtil.getFromHeadPath(c)}return e},b.model.transform.expandWildcards=function(a,c){b.each(c,function(c,d){var e=a.queuedTransforms;a.pathOp.push(b.pathUtil.escapeSegment(d.toString()));for(var f=0;f<e.length;++f)if(b.pathUtil.matchPath(e[f].matchPath,a.path,!0)){var g=b.copy(e[f].transformSpec);(void 0===g.inputPath||b.model.transform.hasWildcard(g.inputPath))&&(g.inputPath=""),a.inputPrefixOp.push(a.path),a.outputPrefixOp.push(a.path);var h=b.model.transform.lookupType(g.type),i=b.model.transform.doTransform(g,a,h);void 0!==i&&b.model.transform.setValue(null,i,a),a.outputPrefixOp.pop(),a.inputPrefixOp.pop()}b.isPrimitive(c)||b.model.transform.expandWildcards(a,c),a.pathOp.pop()})},b.model.transform.hasWildcard=function(a){return"string"==typeof a&&-1!==a.indexOf("*")},b.model.transform.maybePushWildcard=function(a,c){var d,e=b.model.transform.hasWildcard;return e(a.inputPath)?d=b.model.composePaths(c.inputPrefix,a.inputPath):(e(c.outputPrefix)||e(a.outputPath))&&(d=b.model.composePaths(c.outputPrefix,a.outputPath)),d?(c.queuedTransforms.push({transformSpec:a,outputPrefix:c.outputPrefix,inputPrefix:c.inputPrefix,matchPath:d}),!0):!1},b.model.sortByKeyLength=function(a){var c=b.keys(a);return c.sort(b.compareStringLength(!0))},b.model.transform.handleTransformStrategy=function(a,c,d){return b.model.transform.maybePushWildcard(a,c)?void 0:b.model.transform.doTransform(a,c,d)},b.model.transform.handleInvertStrategy=function(a,c,d){var e=d.defaults&&d.defaults.invertConfiguration;if(e){var f=b.invokeGlobalFunction(e,[a,c]);c.inverted.push(f)}},b.model.transform.handleCollectStrategy=function(a,c,d){var e=d.defaults,f=b.hasGrade(e,"fluid.standardInputTransformFunction"),g=b.hasGrade(e,"fluid.multiInputTransformFunction");if(f)b.model.transform.accumulateStandardInputPath("input",a,c,c.inputPaths);else if(g)b.model.transform.accumulateMultiInputPaths(e.inputVariables,a,c,c.inputPaths);else{var h=e.collectInputPaths;if(h){var i=b.makeArray(b.invokeGlobalFunction(h,[a,c]));c.inputPaths=c.inputPaths.concat(i)}}},b.model.transform.lookupType=function(a,c){a||b.fail("Transformation record is missing a type name: ",c),-1===a.indexOf(".")&&(a="fluid.transforms."+a);var d=b.defaults(a);return{defaults:d,typeName:a}},b.model.transform.literaliseValue=function(a){return b.isPrimitive(a)?a:{literalValue:a}},b.model.transform.processRule=function(a,c){"string"==typeof a?a=b.model.transform.pathToRule(a):void 0!==a.literalValue&&(a=b.model.transform.literalValueToRule(a.literalValue));var d;if(a.transform){var e,f;if(b.isArrayable(a.transform)){var g=a.transform;d=void 0;for(var h=0;h<g.length;++h)e=g[h],f=b.model.transform.lookupType(e.type),c.transformHandler(e,c,f)}else e=a.transform,f=b.model.transform.lookupType(e.type),d=c.transformHandler(e,c,f)}return b.isArrayable(a)&&(c.collectedFlatSchemaOpts=c.collectedFlatSchemaOpts||{},c.collectedFlatSchemaOpts[c.outputPrefix]="array"),b.each(a,function(a,d){if("transform"!==d){c.outputPrefixOp.push(d);var e=c.expand(a,c);void 0!==e&&(b.model.transform.setValue(null,e,c),e=void 0),c.outputPrefixOp.pop();
}}),d},b.model.transform.makeStrategy=function(a,c,d){d=d||b.model.transform.processRule,a.expand=function(b){return d(b,a)},a.outputPrefixOp=b.model.makePathStack(a,"outputPrefix"),a.inputPrefixOp=b.model.makePathStack(a,"inputPrefix"),a.transformHandler=c},b.model.transform.invertConfiguration=function(a){var c={inverted:[]};return b.model.transform.makeStrategy(c,b.model.transform.handleInvertStrategy),c.expand(a),{transform:c.inverted}},b.model.transform.collectInputPaths=function(a){var c={inputPaths:[]};return b.model.transform.makeStrategy(c,b.model.transform.handleCollectStrategy),c.expand(a),c.inputPaths},b.model.transform.flatSchemaStrategy=function(a,c){var d=b.model.sortByKeyLength(a);return function(e,f,g,h){for(var i=c.parser.compose.apply(null,h.slice(0,g)),j=0;j<d.length;++j){var k=d[j];if(null!==b.pathUtil.matchPath(k,i,!0))return a[k]}}},b.model.transform.defaultSchemaValue=function(a){var c=b.isPrimitive(a)?a:a.type;return"array"===c?[]:{}},b.model.transform.isomorphicSchemaStrategy=function(a,c){return function(d,e,f,g){var h=b.get(a,g.slice(0,f),c);return b.isArrayable(h)?"array":"object"}},b.model.transform.decodeStrategy=function(a,c,d){return c.isomorphic?b.model.transform.isomorphicSchemaStrategy(a,d):c.flatSchema?b.model.transform.flatSchemaStrategy(c.flatSchema,d):void 0},b.model.transform.schemaToCreatorStrategy=function(a){return function(c,d,e,f){if(void 0===c[d]){var g=a(c,d,e,f);return c[d]=b.model.transform.defaultSchemaValue(g),c[d]}}},b.model.transform.sequence=function(a,c,d){for(var e=0;e<c.length;++e)a=b.model.transform(a,c[e],d);return a},b.model.compareByPathLength=function(a,b){var c=a.path.length-b.path.length;return 0===c?a.sequence-b.sequence:c},b.model.fireSortedChanges=function(a,c){a.sort(b.model.compareByPathLength),b.requestChanges(c,a)},b.model.transformWithRules=function(c,d,e){e=e||{};var f=b.model.escapedGetConfig,g=b.model.transform.decodeStrategy(c,e,f),h={source:c,target:{model:g?b.model.transform.defaultSchemaValue(g(null,"",0,[""])):{}},resolverGetConfig:f,collectedFlatSchemaOpts:void 0,queuedChanges:[],queuedTransforms:[]};b.model.transform.makeStrategy(h,b.model.transform.handleTransformStrategy),h.applier={fireChangeRequest:function(a){a.sequence=h.queuedChanges.length,h.queuedChanges.push(a)}},b.bindRequestChange(h.applier),h.expand(d);var i=b.copy(b.model.escapedSetConfig);return void 0!==h.collectedFlatSchemaOpts&&(a.extend(h.collectedFlatSchemaOpts,e.flatSchema),g=b.model.transform.flatSchemaStrategy(h.collectedFlatSchemaOpts,f)),i.strategies=[b.model.defaultFetchStrategy,g?b.model.transform.schemaToCreatorStrategy(g):b.model.defaultCreatorStrategy],h.finalApplier=e.finalApplier||b.makeHolderChangeApplier(h.target,{resolverSetConfig:i}),h.queuedTransforms.length>0&&(h.typeStack=[],h.pathOp=b.model.makePathStack(h,"path"),b.model.transform.expandWildcards(h,c)),b.model.fireSortedChanges(h.queuedChanges,h.finalApplier),h.target.model},a.extend(b.model.transformWithRules,b.model.transform),b.model.transform=b.model.transformWithRules,b.transformOne=function(a){return{transformOptions:{transformer:"fluid.model.transformWithRules",config:a}}},b.transformMany=function(a){return{transformOptions:{transformer:"fluid.model.transform.sequence",config:a}}}}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{},fluid=fluid||fluid_2_0_0;!function(a,b){"use strict";b.registerNamespace("fluid.model.transform"),b.registerNamespace("fluid.transforms"),b.defaults("fluid.transforms.value",{gradeNames:"fluid.standardTransformFunction",invertConfiguration:"fluid.transforms.value.invert"}),b.transforms.value=b.identity,b.transforms.value.invert=function(a,c){var d=b.copy(a);return d.inputPath=b.model.composePaths(c.outputPrefix,a.outputPath),d.outputPath=b.model.composePaths(c.inputPrefix,a.inputPath),d},b.transforms.identity=b.transforms.value,b.defaults("fluid.transforms.identity",{gradeNames:"fluid.transforms.value"}),b.defaults("fluid.transforms.literalValue",{gradeNames:"fluid.standardOutputTransformFunction"}),b.transforms.literalValue=function(a){return a.value},b.defaults("fluid.transforms.arrayValue",{gradeNames:"fluid.standardTransformFunction"}),b.transforms.arrayValue=b.makeArray,b.defaults("fluid.transforms.stringToNumber",{gradeNames:["fluid.standardTransformFunction"]}),b.transforms.stringToNumber=function(a){var b=Number(a);return isNaN(b)?void 0:b},b.defaults("fluid.transforms.count",{gradeNames:"fluid.standardTransformFunction"}),b.transforms.count=function(a){return b.makeArray(a).length},b.defaults("fluid.transforms.round",{gradeNames:"fluid.standardTransformFunction"}),b.transforms.round=function(a){return Math.round(a)},b.defaults("fluid.transforms.delete",{gradeNames:"fluid.transformFunction"}),b.transforms["delete"]=function(a,c){var d=b.model.composePaths(c.outputPrefix,a.outputPath);c.applier.requestChange(d,null,"DELETE")},b.defaults("fluid.transforms.firstValue",{gradeNames:"fluid.transformFunction"}),b.transforms.firstValue=function(a,c){a.values&&a.values.length||b.fail('firstValue transformer requires an array of values at path named "values", supplied',a);for(var d=0;d<a.values.length;d++){var e=a.values[d],f=c.expand(e);if(void 0!==f)return f}},b.defaults("fluid.transforms.linearScale",{gradeNames:["fluid.multiInputTransformFunction","fluid.standardOutputTransformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.linearScale.invert",inputVariables:{value:null,factor:1,offset:0}}),b.transforms.linearScale=function(a){var b=a.value(),c=a.factor(),d=a.offset();return"number"==typeof b&&"number"==typeof c&&"number"==typeof d?b*c+d:void 0},b.transforms.linearScale.invert=function(a,c){var d=b.copy(a);return d.factor&&(d.factor=0===d.factor?0:1/d.factor),d.offset&&(d.offset=-d.offset*(void 0!==d.factor?d.factor:1)),d.valuePath=b.model.composePaths(c.outputPrefix,a.outputPath),d.outputPath=b.model.composePaths(c.inputPrefix,a.valuePath),d},b.defaults("fluid.transforms.binaryOp",{gradeNames:["fluid.multiInputTransformFunction","fluid.standardOutputTransformFunction"],inputVariables:{left:null,right:null}}),b.transforms.binaryLookup={"===":function(a,b){return a===b},"!==":function(a,b){return a!==b},"<=":function(a,b){return b>=a},"<":function(a,b){return b>a},">=":function(a,b){return a>=b},">":function(a,b){return a>b},"+":function(a,b){return a+b},"-":function(a,b){return a-b},"*":function(a,b){return a*b},"/":function(a,b){return a/b},"%":function(a,b){return a%b},"&&":function(a,b){return a&&b},"||":function(a,b){return a||b}},b.transforms.binaryOp=function(a,c,d){var e=a.left(),f=a.right(),g=b.model.transform.getValue(void 0,c.operator,d),h=b.transforms.binaryLookup[g];return void 0===h||void 0===e||void 0===f?void 0:h(e,f)},b.defaults("fluid.transforms.condition",{gradeNames:["fluid.multiInputTransformFunction","fluid.standardOutputTransformFunction"],inputVariables:{"true":null,"false":null,condition:null}}),b.transforms.condition=function(a){var b=a.condition();if(null!==b)return a[b?"true":"false"]()},b.defaults("fluid.transforms.valueMapper",{gradeNames:["fluid.transformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.valueMapper.invert",collectInputPaths:"fluid.transforms.valueMapper.collect"}),b.model.transform.compareMatches=function(a,b){return b.matchValue-a.matchValue},b.model.transform.matchValueMapperFull=function(a,c,d){var e=c.options;0===e.length&&b.fail("valueMapper supplied empty list of options: ",c);for(var f=[],g=0;g<e.length;++g){var h=e[g],i=b.firstDefined(b.model.transform.getValue(h.inputPath,void 0,d),a),j=b.model.transform.matchValue(h.undefinedInputValue?void 0:void 0===h.inputValue?c.defaultInputValue:h.inputValue,i,c.partialMatches||h.partialMatches);f[g]={index:g,matchValue:j}}return f.sort(b.model.transform.compareMatches),f[0].matchValue<=0||e.length>1&&f[0].matchValue===f[1].matchValue?-1:f[0].index},b.transforms.valueMapper=function(a,c){a.options||b.fail('valueMapper requires a list or hash of options at path named "options", supplied ',a);var d=b.model.transform.getValue(a.inputPath,void 0,c),e=b.isArrayable(a.options)?function(d){var e=b.model.transform.matchValueMapperFull(d,a,c);return-1===e?null:a.options[e]}:function(b){return a.options[b]},f=e(d);if(f||(f=e(a.defaultInputValue)),f){var g=void 0===f.outputPath?a.defaultOutputPath:f.outputPath;c.outputPrefixOp.push(g);var h;return b.isPrimitive(f)?h=f:f.undefinedOutputValue?h=void 0:(h=b.model.transform.resolveParam(f,c,"outputValue",void 0),h=void 0===h?a.defaultOutputValue:h),"string"==typeof g&&void 0!==h&&(b.model.transform.setValue(void 0,h,c,a.merge),h=void 0),c.outputPrefixOp.pop(),h}},b.transforms.valueMapper.invert=function(a,c){var d=[],e={type:"fluid.transforms.valueMapper",options:d},f=b.isArrayable(a.options),g=function(c){return b.find(a.options,function(a){return a[c]?!0:void 0})},h=g("outputPath"),i=g("inputPath");h||(e.inputPath=b.model.composePaths(c.outputPrefix,a.defaultOutputPath)),i||(e.defaultOutputPath=b.model.composePaths(c.inputPrefix,a.inputPath));var j=b.firstDefined;return b.each(a.options,function(e,g){var k={},l=j(f?e.inputValue:g,a.defaultInputValue);void 0===l&&b.fail("Failure inverting configuration for valueMapper - inputValue could not be resolved for record "+g+": ",a),k.outputValue=b.model.transform.literaliseValue(l);var m=j(e.outputValue,a.defaultOutputValue);k.inputValue=b.model.transform.getValue(e.outputValuePath,m,c),h&&(k.inputPath=b.model.composePaths(c.outputPrefix,j(e.outputPath,a.outputPath))),i&&(k.outputPath=b.model.composePaths(c.inputPrefix,j(e.inputPath,a.inputPath))),e.outputValuePath&&(k.inputValuePath=e.outputValuePath),d.push(k)}),e},b.transforms.valueMapper.collect=function(a,c){var d=[];return b.model.transform.accumulateInputPath(a.inputPath,c,d),b.each(a.options,function(a){b.model.transform.accumulateInputPath(a.inputPath,c,d)}),d},b.defaults("fluid.transforms.arrayToSetMembership",{gradeNames:["fluid.standardInputTransformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.arrayToSetMembership.invert"}),b.transforms.arrayToSetMembership=function(a,c,d){var e=c.options;a&&b.isArrayable(a)||b.fail("arrayToSetMembership didn't find array at inputPath nor passed as value.",c),e||b.fail("arrayToSetMembership requires an options block set"),void 0===c.presentValue&&(c.presentValue=!0),void 0===c.missingValue&&(c.missingValue=!1),b.each(e,function(e,f){var g=-1!==a.indexOf(f)?c.presentValue:c.missingValue;b.model.transform.setValue(e,g,d)})},b.transforms.arrayToSetMembership.invert=function(a,c){var d=b.copy(a);delete d.inputPath,d.type="fluid.transforms.setMembershipToArray",d.outputPath=b.model.composePaths(c.inputPrefix,a.inputPath);var e={};return b.each(a.options,function(a,d){var f=b.model.composePaths(c.outputPrefix,a);e[f]=d}),d.options=e,d},b.defaults("fluid.transforms.setMembershipToArray",{gradeNames:["fluid.standardOutputTransformFunction"]}),b.transforms.setMembershipToArray=function(a,c){var d=a.options;d||b.fail("setMembershipToArray requires an options block specified"),void 0===a.presentValue&&(a.presentValue=!0),void 0===a.missingValue&&(a.missingValue=!1);var e=[];return b.each(d,function(d,f){var g=b.model.transform.getValue(f,void 0,c);g===a.presentValue&&e.push(d)}),e},b.model.transform.applyPaths=function(a,b,c){for(var d=0;d<c.length;++d)"push"===a?b.push(c[d]):b.pop()},b.model.transform.expandInnerValues=function(c,d,e,f){var g=e.inputPrefixOp,h=e.outputPrefixOp,i=b.model.transform.applyPaths;i("push",g,c),i("push",h,d);var j={};return b.each(f,function(c){var d=e.expand(c);b.isPrimitive(d)?j=d:a.extend(!0,j,d)}),i("pop",h,d),i("pop",g,c),j},b.defaults("fluid.transforms.arrayToObject",{gradeNames:["fluid.standardTransformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.arrayToObject.invert"}),b.transforms.arrayToObject=function(a,c,d){void 0===c.key&&b.fail("arrayToObject requires a 'key' option.",c),b.isArrayable(a)||b.fail("arrayToObject didn't find array at inputPath.",c);var e={},f=c.key;return b.each(a,function(a,g){var h=a[f],i=typeof h;"string"!==i&&"boolean"!==i&&"number"!==i&&b.fail("arrayToObject encountered untransformable array due to missing or invalid key",a);var j=b.copy(a);delete j[f],c.innerValue&&(j=b.model.transform.expandInnerValues([d.inputPrefix,c.inputPath,g.toString()],[h],d,c.innerValue)),e[h]=j}),e},b.transforms.arrayToObject.invert=function(a,c){var d=b.copy(a);if(d.type="fluid.transforms.objectToArray",d.inputPath=b.model.composePaths(c.outputPrefix,a.outputPath),d.outputPath=b.model.composePaths(c.inputPrefix,a.inputPath),d.innerValue)for(var e=d.innerValue,f=0;f<e.length;++f)e[f]=b.model.transform.invertConfiguration(e[f]);return d},b.defaults("fluid.transforms.objectToArray",{gradeNames:"fluid.standardTransformFunction"}),b.transforms.objectToArray=function(c,d,e){void 0===d.key&&b.fail('objectToArray requires a "key" option.',d);var f=[],g=d.key;return b.each(c,function(c,h){var i={};i[g]=h,d.innerValue&&(c=b.model.transform.expandInnerValues([d.inputPath,h],[d.outputPath,f.length.toString()],e,d.innerValue)),a.extend(!0,i,c),f.push(i)}),f},b.defaults("fluid.transforms.limitRange",{gradeNames:"fluid.standardTransformFunction"}),b.transforms.limitRange=function(a,b){var c=b.min;if(void 0!==c){var d=b.excludeMin||0;c+=d,c>a&&(a=c)}var e=b.max;if(void 0!==e){var f=b.excludeMax||0;e-=f,a>e&&(a=e)}return a},b.defaults("fluid.transforms.indexOf",{gradeNames:["fluid.standardTransformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.indexOf.invert"}),b.transforms.indexOf=function(a,c){var d=b.transforms.parseIndexationOffset(c.offset,"indexOf"),e=b.makeArray(c.array),f=e.indexOf(a);return-1===f&&c.notFound?c.notFound:f+d},b.transforms.indexOf.invert=function(a,c){var d=b.transforms.invertArrayIndexation(a,c);return d.type="fluid.transforms.dereference",d},b.defaults("fluid.transforms.dereference",{gradeNames:["fluid.standardTransformFunction","fluid.lens"],invertConfiguration:"fluid.transforms.dereference.invert"}),b.transforms.dereference=function(a,c){"number"!=typeof a&&b.fail('dereference requires "value" to be a number. '+a+" is invalid.");var d=b.transforms.parseIndexationOffset(c.offset,"dereference"),e=b.makeArray(c.array),f=a+d;return-1===f&&c.notFound?c.notFound:e[f]},b.transforms.dereference.invert=function(a,c){var d=b.transforms.invertArrayIndexation(a,c);return d.type="fluid.transforms.indexOf",d},b.transforms.parseIndexationOffset=function(a,c){var d=0;return void 0!==a&&(d=b.parseInteger(a),isNaN(d)&&b.fail(c+' requires the value of "offset" to be an integer or a string that can be converted to an integer. '+a+" is invalid.")),d},b.transforms.invertArrayIndexation=function(a,c){var d=b.copy(a);return d.inputPath=b.model.composePaths(c.outputPrefix,a.outputPath),d.outputPath=b.model.composePaths(c.inputPrefix,a.inputPath),isNaN(Number(d.offset))||(d.offset=-1*Number(d.offset)),d},b.defaults("fluid.transforms.stringTemplate",{gradeNames:"fluid.standardOutputTransformFunction"}),b.transforms.stringTemplate=function(a){return b.stringTemplate(a.template,a.terms)},b.defaults("fluid.transforms.free",{gradeNames:"fluid.transformFunction"}),b.transforms.free=function(a){var c=b.makeArray(a.args);return b.invokeGlobalFunction(a.func,c)}}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{},fluid=fluid||fluid_2_0_0;!function(a,b){"use strict";b.thatistBridge=function(b,c){var d=function(b){for(var d=b.split("."),e=c,f=0;f<d.length;++f)e=e[d[f]];var g=[this];2===arguments.length&&(g=g.concat(a.makeArray(arguments[1])));var h=e.apply(null,g);this.that=function(){return h};var i=typeof h;return!h||"string"===i||"number"===i||"boolean"===i||h&&void 0!==h.length?h:this};return a.fn[b]=d,d},b.thatistBridge("fluid",b),b.thatistBridge("fluid_2_0_0",fluid_2_0_0);var c=function(){return a.browser.msie?"tabIndex":"tabindex"},d=function(b){return b.length<=0?!1:a(b[0]).is("a, input, button, select, area, textarea, object")},e=function(a){if(!(a.length<=0)){if(!b.tabindex.hasAttr(a))return d(a)?Number(0):void 0;var e=a.attr(c());return Number(e)}},f=function(b,d){return b.each(function(b,e){a(e).attr(c(),d)})};b.tabindex=function(b,c){return b=a(b),null!==c&&void 0!==c?f(b,c):e(b)},b.tabindex.remove=function(b){return b=a(b),b.each(function(b,d){a(d).removeAttr(c())})},b.tabindex.hasAttr=function(b){if(b=a(b),b.length<=0)return!1;var d=b.map(function(){var a=this.getAttributeNode(c());return a?a.specified:!1});return 1===d.length?d[0]:d},b.tabindex.has=function(c){return c=a(c),b.tabindex.hasAttr(c)||d(c)},b.a11y=a.a11y||{},b.a11y.orientation={HORIZONTAL:0,VERTICAL:1,BOTH:2};var g={next:a.ui.keyCode.DOWN,previous:a.ui.keyCode.UP},h={next:a.ui.keyCode.RIGHT,previous:a.ui.keyCode.LEFT},i=function(a){return a.jquery?a[0]:a},j=function(b){b.each(function(b,c){c=a(c),(!c.fluid("tabindex.has")||c.fluid("tabindex")<0)&&c.fluid("tabindex",0)})};b.tabbable=function(b){b=a(b),j(b)};var k="selectionContext",l=-32768,m=function(a){a.activeItemIndex!==l&&(a.options.onLeaveContainer?a.options.onLeaveContainer(a.selectables[a.activeItemIndex]):a.options.onUnselect&&a.options.onUnselect(a.selectables[a.activeItemIndex])),a.options.rememberSelectionState||(a.activeItemIndex=l)},n=function(a,b){b&&b(a)},o=function(a,b){b&&a&&b(a)},p=function(a,b){o(a,b.options.onUnselect)},q=function(a,b){p(b.selectedElement(),b),a=i(a);var c=b.selectables.index(a);-1!==c&&(b.activeItemIndex=c,n(a,b.options.onSelect))},r=function(b){return function(c){return a(c.target).fluid("tabindex",0),q(c.target,b),c.stopPropagation()}},s=function(b){return function(c){return a(c.target).fluid("tabindex",b.options.selectablesTabindex),p(c.target,b),c.stopPropagation()}},t=function(a){var c=a.selectables;a.activeItemIndex>=c.length&&(a.activeItemIndex=a.options.noWrap?c.length-1:0),a.activeItemIndex<0&&a.activeItemIndex!==l&&(a.activeItemIndex=a.options.noWrap?0:c.length-1),a.activeItemIndex>=0&&b.focus(c[a.activeItemIndex])},u=function(a){var c=a.selectedElement();c&&b.blur(c),p(a.selectedElement(),a),a.activeItemIndex===l&&(a.activeItemIndex=-1)},v=function(a){u(a),++a.activeItemIndex,t(a)},w=function(a){u(a),--a.activeItemIndex,t(a)},x=function(a,b){return function(c){c.which===b.next?(v(a),c.preventDefault()):c.which===b.previous&&(w(a),c.preventDefault())}},y=function(a){var c;return a===b.a11y.orientation.HORIZONTAL?c=h:a===b.a11y.orientation.VERTICAL&&(c=g),c},z=function(b){return function(c){c.which===a.ui.keyCode.TAB&&(m(b),c.shiftKey&&(b.focusIsLeavingContainer=!0))}},A=function(a){return function(c){var d=a.options.autoSelectFirstItem,e="function"==typeof d?d():d;return a.focusIsLeavingContainer&&(e=!1),e&&c.target===a.container.get(0)&&(a.activeItemIndex===l&&(a.activeItemIndex=0),b.focus(a.selectables[a.activeItemIndex])),c.stopPropagation()}},B=function(a){return function(b){return a.focusIsLeavingContainer=!1,b.stopPropagation()}},C=function(c,d,e){var f=a.extend(!0,{},d,e),g=y(f.direction),h=f.selectableElements?f.selectableElements:c.find(f.selectableSelector),i={container:c,activeItemIndex:l,selectables:h,focusIsLeavingContainer:!1,options:f};return i.selectablesUpdated=function(a){"number"==typeof i.options.selectablesTabindex&&i.selectables.fluid("tabindex",i.options.selectablesTabindex),i.selectables.unbind("focus."+k),i.selectables.unbind("blur."+k),i.selectables.bind("focus."+k,r(i)),i.selectables.bind("blur."+k,s(i)),g&&i.options.noBubbleListeners&&(i.selectables.unbind("keydown."+k),i.selectables.bind("keydown."+k,x(i,g))),a?q(a,i):t(i)},i.refresh=function(){i.options.selectableSelector||b.fail("Cannot refresh selectable context which was not initialised by a selector"),i.selectables=c.find(f.selectableSelector),i.selectablesUpdated()},i.selectedElement=function(){return i.activeItemIndex<0?null:i.selectables[i.activeItemIndex]},g&&!i.options.noBubbleListeners&&c.keydown(x(i,g)),c.keydown(z(i)),c.focus(A(i)),c.blur(B(i)),i.selectablesUpdated(),i};b.selectable=function(c,d){c=a(c);var e=C(c,b.selectable.defaults,d);return b.setScopedData(c,k,e),e},b.selectable.select=function(a,c){b.focus(c)},b.selectable.selectNext=function(c){c=a(c),v(b.getScopedData(c,k))},b.selectable.selectPrevious=function(c){c=a(c),w(b.getScopedData(c,k))},b.selectable.currentSelection=function(c){c=a(c);var d=b.getScopedData(c,k);return a(d.selectedElement())},b.selectable.defaults={direction:b.a11y.orientation.VERTICAL,selectablesTabindex:-1,autoSelectFirstItem:!0,rememberSelectionState:!0,selectableSelector:".selectable",selectableElements:null,onSelect:null,onUnselect:null,onLeaveContainer:null,noWrap:!1};var D=function(a,b){if(!a.modifier)return!0;var c=a.modifier,d=c&&b.ctrlKey,e=c&&b.altKey,f=c&&b.shiftKey;return d||e||f},E=function(c){return function(d){var e=d.target;if(b.enabled(e)){var f=d.which?d.which:d.keyCode;if(f===c.key&&c.activateHandler&&D(c,d)){var g=a.Event("fluid-activate");a(e).trigger(g,[c.activateHandler]),g.isDefaultPrevented()&&d.preventDefault()}}}},F=function(c,d,e,f){var g=[];a(e).each(function(a,b){g.push({modifier:null,key:b,activateHandler:d})}),f&&f.additionalBindings&&(g=g.concat(f.additionalBindings)),b.initEnablement(c);for(var h=0;h<g.length;++h){var i=g[h];c.keydown(E(i))}c.bind("fluid-activate",function(a,b){return b=b||d,b?b(a):null})};b.activatable=function(c,d,e){c=a(c),F(c,d,b.activatable.defaults.keys,e)},b.activate=function(b){a(b).trigger("fluid-activate")},b.activatable.defaults={keys:[a.ui.keyCode.ENTER,a.ui.keyCode.SPACE]}}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.defaults("fluid.viewComponent",{gradeNames:["fluid.modelComponent"],initFunction:"fluid.initView",argumentMap:{container:0,options:1},members:{dom:"@expand:fluid.initDomBinder({that}, {that}.options.selectors)"}}),b.dumpSelector=function(a){return"string"==typeof a?a:a.selector?a.selector:""},b.diagnoseFailedView=function(a,c,d,e){if(!c&&b.hasGrade(d,"fluid.viewComponent")){var f=b.wrap(e[1]),g="Instantiation of view component with type "+a+" failed, since ";f?0===f.length?b.fail(g+'selector "',b.dumpSelector(e[1]),'" did not match any markup in the document'):b.fail(g+" component creator function did not return a value"):b.fail(g+" container argument is empty")}},b.checkTryCatchParameter=function(){var a=window.location||{search:"",protocol:"file:"},c=a.search.slice(1).split("&");return b.find(c,function(a){return 0===a.indexOf("notrycatch")?!0:void 0})===!0},b.notrycatch=b.checkTryCatchParameter(),b.wrap=function(b,c){return c=c||a,!b||b.jquery?b:c(b)},b.unwrap=function(a){return a&&a.jquery?a[0]:a},b.container=function(a,c,d){d&&(a=b.unwrap(a));var e=b.wrap(a,d);if(c&&(!e||0===e.length))return null;if(!e||!e.jquery||1!==e.length){"string"!=typeof a&&(a=e.selector);var f=void 0!==e.length?e.length:0;b.fail((f>1?"More than one ("+f+") container elements were":"No container element was")+" found for selector "+a)}return b.isDOMNode(e[0])||b.fail("fluid.container was supplied a non-jQueryable element"),e},b.createDomBinder=function(a,c){function d(a,c){return b.allocateSimpleId(c)+"-"+a}function e(a,b,c){f.cache[d(a,b)]=c}var f={id:b.allocateGuid(),cache:{}},g=a.constructor;return f.locate=function(d,f){var h,i,j;return h=c[d],i=f?f:a,i||b.fail("DOM binder invoked for selector "+d+" without container"),h?(j="function"==typeof h?g(h.call(null,b.unwrap(i))):g(h,i),j.get(0)===document&&(j=[]),j.selector||(j.selector=h,j.context=i),j.selectorName=d,e(d,i,j),j):i},f.fastLocate=function(b,c){var e=c?c:a,g=d(b,e),h=f.cache[g];return h?h:f.locate(b,c)},f.clear=function(){f.cache={}},f.refresh=function(b,c){var d=c?c:a;"string"==typeof b&&(b=[b]),void 0===d.length&&(d=[d]);for(var e=0;e<b.length;++e)for(var g=0;g<d.length;++g)f.locate(b[e],d[g])},f.resolvePathSegment=f.locate,f},b.expectFilledSelector=function(a,c){a&&0===a.length&&a.jquery&&b.fail(c+': selector "'+a.selector+'" with name '+a.selectorName+" returned no results in context "+b.dumpEl(a.context))},b.initView=function(c,d,e,f){var g=b.container(d,!0);if(b.expectFilledSelector(g,'Error instantiating component with name "'+c),!g)return null;var h=function(a){a.container=g},i=b.initLittleComponent(c,e,f||{gradeNames:["fluid.viewComponent"]},h);i.dom||b.initDomBinder(i);var j=i.options.jQuery;return b.log("Constructing view component "+c+" with container "+g.constructor.expando+(j?" user jQuery "+j.expando:"")+" env: "+a.expando),i},b.initDomBinder=function(a,c){return a.container||b.fail("fluid.initDomBinder called for component with typeName "+a.typeName+' without an initialised container - this has probably resulted from placing "fluid.viewComponent" in incorrect position in grade merging order.  Make sure to place it to the right of any non-view grades in the gradeNames list to ensure that it overrides properly: resolved gradeNames is ',a.options.gradeNames," for component ",a),a.dom=b.createDomBinder(a.container,c||a.options.selectors||{}),a.locate=a.dom.locate,a.dom},b.findAncestor=function(a,c){for(a=b.unwrap(a);a;){if(c(a))return a;a=a.parentNode}},b.findForm=function(a){return b.findAncestor(a,function(a){return"form"===a.nodeName.toLowerCase()})},b.each(["text","html"],function(c){b[c]=function(b,d){return b=a(b),void 0===d?b[c]():b[c](d)}}),b.value=function(c,d){var e=b.unwrap(c),f=!1;if(void 0===e.nodeType&&e.length>1&&(e=e[0],f=!0),"input"!==e.nodeName.toLowerCase()||!/radio|checkbox/.test(e.type))return void 0===d?a(e).val():a(e).val(d);var g=e.name;void 0===g&&b.fail("Cannot acquire value from node "+b.dumpEl(e)+" which does not have name attribute set");var h;if(f)h=c;else{h=e.ownerDocument.getElementsByName(g);var i=b.findForm(e);h=a.grep(h,function(a){return a.name!==g?!1:!i||b.dom.isContainer(i,a)})}if(void 0===d){var j=a.map(h,function(a){return a.checked?a.value:null});return"radio"===e.type?j[0]:j}"boolean"==typeof d&&(d=d?"true":"false"),a.each(h,function(){this.checked=d instanceof Array?-1!==d.indexOf(this.value):d===this.value})},b.BINDING_ROOT_KEY="fluid-binding-root",b.findData=function(b,c){for(;b;){var d=a.data(b,c);if(d)return d;b=b.parentNode}},b.bindFossils=function(c,d,e){a.data(c,b.BINDING_ROOT_KEY,{data:d,fossils:e})},b.boundPathForNode=function(a,c){a=b.unwrap(a);var d=a.name||a.id,e=c[d];return e?e.EL:null},b.applyBoundChange=function(a,c,d){a=b.unwrap(a),void 0===c&&(c=b.value(a)),void 0===a.nodeType&&a.length>0&&(a=a[0]);var e=b.findData(a,b.BINDING_ROOT_KEY);e||b.fail("Bound data could not be discovered in any node above "+b.dumpEl(a));var f=a.name,g=e.fossils[f];g||b.fail("No fossil discovered for name "+f+" in fossil record above "+b.dumpEl(a)),"boolean"==typeof g.oldvalue&&(c=!!c[0]);var h=e.fossils[f].EL;d?d.fireChangeRequest({path:h,value:c,source:"DOM:"+a.id}):b.set(e.data,h,c)},b.jById=function(c,d){d=d&&9===d.nodeType?d:document;var e=b.byId(c,d),f=e?a(e):[];return f.selector="#"+c,f.context=d,f},b.byId=function(a,c){c=c&&9===c.nodeType?c:document;var d=c.getElementById(a);return d?(d.id!==a&&b.fail("Problem in document structure - picked up element "+b.dumpEl(d)+" for id "+a+" without this id - most likely the element has a name which conflicts with this id"),d):null},b.getId=function(a){return b.unwrap(a).id},b.allocateSimpleId=function(a){if(a=b.unwrap(a),!a||b.isPrimitive(a))return null;if(!a.id){var c="fluid-id-"+b.allocateGuid();a.id=c}return a.id},b.defaults("fluid.ariaLabeller",{gradeNames:["fluid.viewComponent"],labelAttribute:"aria-label",liveRegionMarkup:'<div class="liveRegion fl-hidden-accessible" aria-live="polite"></div>',liveRegionId:"fluid-ariaLabeller-liveRegion",invokers:{generateLiveElement:{funcName:"fluid.ariaLabeller.generateLiveElement",args:"{that}"},update:{funcName:"fluid.ariaLabeller.update",args:["{that}","{arguments}.0"]}},listeners:{onCreate:{func:"{that}.update",args:[null]}}}),b.ariaLabeller.update=function(a,c){if(c=c||a.options,a.container.attr(a.options.labelAttribute,c.text),c.dynamicLabel){var d=b.jById(a.options.liveRegionId);0===d.length&&(d=a.generateLiveElement()),d.text(c.text)}},b.ariaLabeller.generateLiveElement=function(b){var c=a(b.options.liveRegionMarkup);return c.prop("id",b.options.liveRegionId),a("body").append(c),c};var c="aria-labelling";b.getAriaLabeller=function(d){d=a(d);var e=b.getScopedData(d,c);return e},b.updateAriaLabel=function(d,e,f){f=a.extend({},f||{},{text:e});var g=b.getAriaLabeller(d);return g?g.update(f):(g=b.ariaLabeller(d,f),b.setScopedData(d,c,g)),g};var d={};a(document).click(function(a){for(var c=b.resolveEventTarget(a);c;){if(d[c.id])return;c=c.parentNode}b.each(d,function(b,c){b(a),delete d[c]})}),b.globalDismissal=function(a,c){b.each(a,function(a){var e=b.unwrap(a).ownerDocument===document?b.allocateSimpleId(a):b.allocateGuid();c?d[e]=c:delete d[e]})},b.now=function(){return Date.now?Date.now():(new Date).getTime()},b.deadMansBlur=function(c,d){var e={options:a.extend(!0,{},b.defaults("fluid.deadMansBlur"),d)};return e.blurPending=!1,e.lastCancel=0,e.canceller=function(a){b.log("Cancellation through "+a.type+" on "+b.dumpEl(a.target)),e.lastCancel=b.now(),e.blurPending=!1},e.noteProceeded=function(){b.globalDismissal(e.options.exclusions)},e.reArm=function(){b.globalDismissal(e.options.exclusions,e.proceed)},e.addExclusion=function(a){b.globalDismissal(a,e.proceed)},e.proceed=function(a){b.log("Direct proceed through "+a.type+" on "+b.dumpEl(a.target)),e.blurPending=!1,e.options.handler(c)},b.each(e.options.exclusions,function(c){c=a(c),b.each(c,function(b){a(b).bind("focusin",e.canceller).bind("fluid-focus",e.canceller).click(e.canceller).mousedown(e.canceller)})}),e.options.cancelByDefault?e.reArm():a(c).bind("focusout",function(a){b.log("Starting blur timer for element "+b.dumpEl(a.target));var d=b.now();b.log("back delay: "+(d-e.lastCancel)),d-e.lastCancel>e.options.backDelay&&(e.blurPending=!0),setTimeout(function(){e.blurPending&&e.options.handler(c)},e.options.delay)}),e},b.defaults("fluid.deadMansBlur",{gradeNames:"fluid.function",delay:150,backDelay:100})}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";function c(a){return a}b.explodeLocalisedName=function(a,c,d){var e=a.lastIndexOf(".");-1!==e&&0!==e||(e=a.length);var f=a.substring(0,e),g=a.substring(e),h=c.split("_"),i=b.transform(h,function(a,b){var c=h.slice(0,b+1);return f+"_"+c.join("_")+g});return d&&i.unshift(f+"_"+d+g),i};var d={},e={};b.fetchResources=function(a,c,d){var e={options:b.copy(d||{})};return e.resourceSpecs=a,e.callback=c,e.operate=function(){b.fetchResources.fetchResourcesImpl(e)},b.each(a,function(a,c){a.recurseFirer=b.makeEventFirer({name:'I/O completion for resource "'+c+'"'}),a.recurseFirer.addListener(e.operate),a.url&&!a.href&&(a.href=a.url),e.options.defaultLocale&&(a.defaultLocale=e.options.defaultLocale,void 0===a.locale&&(a.locale=e.options.defaultLocale))}),e.options.amalgamateClasses&&b.fetchResources.amalgamateClasses(a,e.options.amalgamateClasses,e.operate),b.fetchResources.explodeForLocales(a),e.operate(),e},b.fetchResources.explodeForLocales=function(c){return b.each(c,function(d,e){if(d.locale){for(var f=b.explodeLocalisedName(d.href,d.locale,d.defaultLocale),g=0;g<f.length;++g){var h=e+"$localised-"+g,i=a.extend(!0,{},d,{href:f[g],localeExploded:!0});c[h]=i}d.localeExploded=f.length}}),c},b.fetchResources.condenseOneResource=function(a,c,d,e){for(var f=[c],g=0;e>g;++g){var h=d+"$localised-"+g;f.unshift(a[h]),delete a[h]}var i=b.find_if(f,function(a){return!a.fetchError});i&&(a[d]=i)},b.fetchResources.condenseForLocales=function(a){b.each(a,function(c,d){"number"==typeof c.localeExploded&&b.fetchResources.condenseOneResource(a,c,d,c.localeExploded)})},b.fetchResources.notifyResources=function(a,c,d){b.fetchResources.condenseForLocales(c),d(c)},b.fetchResources.amalgamateClasses=function(a,c,d){b.each(c,function(c){var f=e[c];b.each(f,function(b,e){a[c+"!"+e]=b,b.recurseFirer.addListener(d)})})},b.fetchResources.timeSuccessCallback=function(a){if(a.timeSuccess&&a.options&&a.options.success){var c=a.options.success;a.options.success=function(){var d=new Date,e=c.apply(null,arguments);
return b.log("External callback for URL "+a.href+" completed - callback time: "+((new Date).getTime()-d.getTime())+"ms"),e}}},b.fetchResources.clearResourceCache=function(a){a?delete d[c(a)]:b.clear(d)},b.fetchResources.handleCachedRequest=function(a,f,g){var h=c(a.href),i=d[h];if(i.$$firer$$){b.log("Handling request for "+h+" from cache");var j=a.fetchClass;j&&e[j]&&(b.log("Clearing pendingClass entry for class "+j),delete e[j][h]);var k={response:f,fetchError:g};d[h]=k,i.fire(f,g)}},b.fetchResources.completeRequest=function(a){a.queued=!1,a.completeTime=new Date,b.log("Request to URL "+a.href+" completed - total elapsed time: "+(a.completeTime.getTime()-a.initTime.getTime())+"ms"),a.recurseFirer.fire()},b.fetchResources.makeResourceCallback=function(a){return{success:function(c){a.resourceText=c,a.resourceKey=a.href,a.forceCache&&b.fetchResources.handleCachedRequest(a,c),b.fetchResources.completeRequest(a)},error:function(c,d,e){a.fetchError={status:c.status,textStatus:c.textStatus,errorThrown:e},a.forceCache&&b.fetchResources.handleCachedRequest(a,null,a.fetchError),b.fetchResources.completeRequest(a)}}},b.fetchResources.issueCachedRequest=function(f,g){var h=c(f.href),i=d[h];if(i)i.$$firer$$?(b.log("Request for cached resource which is in flight: url "+h),i.addListener(function(a,b){a?g.success(a):g.error(b)})):i.response?g.success(i.response):g.error(i.fetchError);else{b.log("First request for cached resource with url "+h),i=b.makeEventFirer({name:"cache notifier for resource URL "+h}),i.$$firer$$=!0,d[h]=i;var j=f.fetchClass;j&&(e[j]||(e[j]={}),e[j][h]=f),g.cache=!1,a.ajax(g)}},b.fetchResources.composeCallbacks=function(a,c){return c?a?function(){try{c.apply(null,arguments)}catch(d){b.log("Exception applying external fetchResources callback: "+d)}a.apply(null,arguments)}:c:a},b.fetchResources.composePolicy=function(a,c){return b.fetchResources.composeCallbacks(a,c)},b.defaults("fluid.fetchResources.issueRequest",{mergePolicy:{success:b.fetchResources.composePolicy,error:b.fetchResources.composePolicy,url:"reverse"}}),b.fetchResources.issueRequest=function(c,d){var e=b.fetchResources.makeResourceCallback(c),f={url:c.href,success:e.success,error:e.error,dataType:c.dataType||"text"};b.fetchResources.timeSuccessCallback(c),f=b.merge(b.defaults("fluid.fetchResources.issueRequest").mergePolicy,f,c.options),c.queued=!0,c.initTime=new Date,b.log("Request with key "+d+" queued for "+c.href),c.forceCache?b.fetchResources.issueCachedRequest(c,f):a.ajax(f)},b.fetchResources.fetchResourcesImpl=function(c){var d=!0,e=!0,f=c.resourceSpecs;for(var g in f){var h=f[g];if(h.options&&!h.options.async||(e=!1),h.href&&!h.completeTime)h.queued||b.fetchResources.issueRequest(h,g),h.queued&&(d=!1);else if(h.nodeId&&!h.resourceText){var i=document.getElementById(h.nodeId);h.resourceText=b.dom.getElementText(i),h.resourceKey=h.nodeId}}d&&c.callback&&!c.callbackCalled&&(c.callbackCalled=!0,a.browser.mozilla&&!e?setTimeout(function(){b.fetchResources.notifyResources(c,f,c.callback)},1):b.fetchResources.notifyResources(c,f,c.callback))},b.fetchResources.primeCacheFromResources=function(a){var c=b.defaults(a).resources,d=(b.expandOptions?b.expandOptions:b.identity)(b.copy(c));b.fetchResources(d)},b.registerNamespace("fluid.expander"),b.expander.makeDefaultFetchOptions=function(c,d,e){return a.extend(!0,{dataType:"text"},e,{success:function(a,b){var d=JSON.parse(a);b(c(d))},error:function(a,c){b.log("Error fetching "+d+": "+c)}})},b.expander.makeFetchExpander=function(a){return{expander:{type:"fluid.expander.deferredFetcher",href:a.url,options:b.expander.makeDefaultFetchOptions(a.disposer,a.url,a.options),resourceSpecCollector:"{resourceSpecCollector}",fetchKey:a.fetchKey}}},b.expander.deferredFetcher=function(a,c,d){var e=c.expander,f=b.copy(e),g=b.expand(e.resourceSpecCollector,d);delete f.type,delete f.resourceSpecCollector,delete f.fetchKey;var h=function(b){a(b)};f.options.success=function(a){e.options.success(a,h)};var i=e.fetchKey||b.allocateGuid();return g[i]=f,b.NO_VALUE}}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.registerNamespace("fluid.contextAware"),b.defaults("fluid.contextAware.marker",{gradeNames:["fluid.component"]}),b.contextAware.makeCheckMarkers=function(a,c,d){b.each(a,function(a,e){b.constructSingle(c,{type:e,gradeNames:"fluid.contextAware.marker",value:a},d)})},b.contextAware.performChecks=function(a){return b.transform(a,function(a){return"function"==typeof a?a={func:a}:"string"==typeof a&&(a={funcName:a}),b.isPrimitive(a)?a:"value"in a?a.value:"func"in a?a.func():"funcName"in a?b.invokeGlobalFunction(a.funcName):void b.fail("Error in contextAwareness check record ",a," - must contain an entry with name value, func, or funcName")})},b.contextAware.makeChecks=function(a,c,d){var e=b.contextAware.performChecks(a);b.contextAware.makeCheckMarkers(e,c,d)},b.contextAware.forgetChecks=function(a,c,d){d=d||b.globalInstantiator,c=c||[];var e=b.makeArray(a);b.each(e,function(a){var e=b.typeNameToMemberName(a),f=b.model.parseToSegments(c,d.parseEL,!0);f.push(e),b.destroy(f,d)})},b.defaults("fluid.contextAware",{gradeNames:["{that}.check"],mergePolicy:{contextAwareness:"noexpand"},contextAwareness:{},invokers:{check:{funcName:"fluid.contextAware.check",args:["{that}","{that}.options.contextAwareness"]}}}),b.contextAware.getCheckValue=function(a,c){var d=b.parseContextReference(c),e=b.resolveContext(d.context,a),f=d.path||["options","value"],g=b.getForComponent(e,f);return g},b.contextAware.checkOne=function(c,d){d.checks&&d.checks.contextValue&&b.fail("Nesting error in contextAwareness record ",d,' - the "checks" entry must contain a hash and not a contextValue/gradeNames record at top level');var e=b.hashToArray(d.checks,"namespace",function(c,d,e){a.extend(c,d),c.priority=b.parsePriority(d.priority,e)});return b.sortByPriority(e),b.find(e,function(a){a.contextValue||b.fail("Cannot perform check for contextAwareness record ",a,' without a valid field named "contextValue"');var d=b.contextAware.getCheckValue(c,a.contextValue);return(void 0===a.equals?d:d===a.equals)?a.gradeNames:void 0},d.defaultGradeNames)},b.contextAware.check=function(c,d){var e=[],f=b.hashToArray(d,"namespace",function(c,d,e){a.extend(c,d),c.priority=b.parsePriority(d.priority,e,!1,"context awareness records")});return b.sortByPriority(f),b.each(f,function(a){var d=b.contextAware.checkOne(c,a);e=e.concat(b.makeArray(d))}),e},b.contextAware.makeAdaptation=function(a){b.expect("fluid.contextAware.makeAdaptation",a,["distributionName","targetName","adaptationName","checkName","record"]),b.defaults(a.distributionName,{gradeNames:["fluid.component"],distributeOptions:{target:"{/ "+a.targetName+"}.options.contextAwareness."+a.adaptationName+".checks."+a.checkName,record:a.record}}),b.constructSingle([],a.distributionName)},b.contextAware.isBrowser=function(){return"undefined"!=typeof window&&window.document},b.contextAware.makeChecks({"fluid.browser":{funcName:"fluid.contextAware.isBrowser"}})}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.registerNamespace("fluid.enhance"),b.contextAware.isBrowser()&&a.fn&&a("head").append("<style type='text/css'>.fl-progEnhance-basic, .fl-ProgEnhance-basic { display: none; } .fl-progEnhance-enhanced, .fl-ProgEnhance-enhanced { display: block; }</style>")}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.XMLP=function(a){return b.XMLP.XMLPImpl(a)},b.XMLP.closedTags={abbr:!0,br:!0,col:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,hr:!0,area:!0,embed:!0},b.XMLP._NONE=0,b.XMLP._ELM_B=1,b.XMLP._ELM_E=2,b.XMLP._ELM_EMP=3,b.XMLP._ATT=4,b.XMLP._TEXT=5,b.XMLP._ENTITY=6,b.XMLP._PI=7,b.XMLP._CDATA=8,b.XMLP._COMMENT=9,b.XMLP._DTD=10,b.XMLP._ERROR=11,b.XMLP._CONT_XML=0,b.XMLP._CONT_ALT=1,b.XMLP._ATT_NAME=0,b.XMLP._ATT_VAL=1,b.XMLP._STATE_PROLOG=1,b.XMLP._STATE_DOCUMENT=2,b.XMLP._STATE_MISC=3,b.XMLP._errs=[],b.XMLP._errs[b.XMLP.ERR_CLOSE_PI=0]="PI: missing closing sequence",b.XMLP._errs[b.XMLP.ERR_CLOSE_DTD=1]="DTD: missing closing sequence",b.XMLP._errs[b.XMLP.ERR_CLOSE_COMMENT=2]="Comment: missing closing sequence",b.XMLP._errs[b.XMLP.ERR_CLOSE_CDATA=3]="CDATA: missing closing sequence",b.XMLP._errs[b.XMLP.ERR_CLOSE_ELM=4]="Element: missing closing sequence",b.XMLP._errs[b.XMLP.ERR_CLOSE_ENTITY=5]="Entity: missing closing sequence",b.XMLP._errs[b.XMLP.ERR_PI_TARGET=6]="PI: target is required",b.XMLP._errs[b.XMLP.ERR_ELM_EMPTY=7]="Element: cannot be both empty and closing",b.XMLP._errs[b.XMLP.ERR_ELM_NAME=8]='Element: name must immediately follow "<"',b.XMLP._errs[b.XMLP.ERR_ELM_LT_NAME=9]='Element: "<" not allowed in element names',b.XMLP._errs[b.XMLP.ERR_ATT_VALUES=10]="Attribute: values are required and must be in quotes",b.XMLP._errs[b.XMLP.ERR_ATT_LT_NAME=11]='Element: "<" not allowed in attribute names',b.XMLP._errs[b.XMLP.ERR_ATT_LT_VALUE=12]='Attribute: "<" not allowed in attribute values',b.XMLP._errs[b.XMLP.ERR_ATT_DUP=13]="Attribute: duplicate attributes not allowed",b.XMLP._errs[b.XMLP.ERR_ENTITY_UNKNOWN=14]="Entity: unknown entity",b.XMLP._errs[b.XMLP.ERR_INFINITELOOP=15]="Infinite loop",b.XMLP._errs[b.XMLP.ERR_DOC_STRUCTURE=16]="Document: only comments, processing instructions, or whitespace allowed outside of document element",b.XMLP._errs[b.XMLP.ERR_ELM_NESTING=17]="Element: must be nested correctly",b.XMLP._checkStructure=function(a,c){var d=a.m_stack;if(b.XMLP._STATE_PROLOG==a.m_iState&&(a.m_iState=b.XMLP._STATE_DOCUMENT),b.XMLP._STATE_DOCUMENT===a.m_iState&&(b.XMLP._ELM_B!=c&&b.XMLP._ELM_EMP!=c||(a.m_stack[d.length]=a.getName()),b.XMLP._ELM_E==c||b.XMLP._ELM_EMP==c)){if(0===d.length)return b.XMLP._NONE;var e=d[d.length-1];if(a.m_stack.length--,null===e||e!==a.getName())return b.XMLP._setErr(a,b.XMLP.ERR_ELM_NESTING)}return c},b.XMLP._parseCDATA=function(a,c){var d=a.m_xml.indexOf("]]>",c);return-1==d?b.XMLP._setErr(a,b.XMLP.ERR_CLOSE_CDATA):(b.XMLP._setContent(a,b.XMLP._CONT_XML,c,d),a.m_iP=d+3,b.XMLP._CDATA)},b.XMLP._parseComment=function(a,c){var d=a.m_xml.indexOf("-->",c);return-1==d?b.XMLP._setErr(a,b.XMLP.ERR_CLOSE_COMMENT):(b.XMLP._setContent(a,b.XMLP._CONT_XML,c-4,d+3),a.m_iP=d+3,b.XMLP._COMMENT)},b.XMLP._parseDTD=function(a,c){var d,e,f,g;if(d=a.m_xml.indexOf(">",c),-1==d)return b.XMLP._setErr(a,b.XMLP.ERR_CLOSE_DTD);for(f=a.m_xml.indexOf("[",c),e=-1!=f&&d>f?"]>":">";;){if(d==g)return b.XMLP._setErr(a,b.XMLP.ERR_INFINITELOOP);if(g=d,d=a.m_xml.indexOf(e,c),-1==d)return b.XMLP._setErr(a,b.XMLP.ERR_CLOSE_DTD);if("]]>"!=a.m_xml.substring(d-1,d+2))break}return a.m_iP=d+e.length,b.XMLP._DTD},b.XMLP._parsePI=function(a,c){var d,e,f,g,h;return d=a.m_xml.indexOf("?>",c),-1==d?b.XMLP._setErr(a,b.XMLP.ERR_CLOSE_PI):(e=b.SAXStrings.indexOfNonWhitespace(a.m_xml,c,d),-1==e?b.XMLP._setErr(a,b.XMLP.ERR_PI_TARGET):(f=b.SAXStrings.indexOfWhitespace(a.m_xml,e,d),-1==f&&(f=d),g=b.SAXStrings.indexOfNonWhitespace(a.m_xml,f,d),-1==g&&(g=d),h=b.SAXStrings.lastIndexOfNonWhitespace(a.m_xml,g,d),-1==h&&(h=d-1),a.m_name=a.m_xml.substring(e,f),b.XMLP._setContent(a,b.XMLP._CONT_XML,g,h+1),a.m_iP=d+2,b.XMLP._PI))},b.XMLP._parseText=function(a,c){var d=a.m_xml.indexOf("<",c);return-1==d&&(d=a.m_xml.length),b.XMLP._setContent(a,b.XMLP._CONT_XML,c,d),a.m_iP=d,b.XMLP._TEXT},b.XMLP._setContent=function(a,c){var d=arguments;b.XMLP._CONT_XML==c?(a.m_cAlt=null,a.m_cB=d[2],a.m_cE=d[3]):(a.m_cAlt=d[2],a.m_cB=0,a.m_cE=d[2].length),a.m_cSrc=c},b.XMLP._setErr=function(a,c){var d=b.XMLP._errs[c];return a.m_cAlt=d,a.m_cB=0,a.m_cE=d.length,a.m_cSrc=b.XMLP._CONT_ALT,b.XMLP._ERROR},b.XMLP._parseElement=function(a,c){var d,e,f,g;if(e=d=a.m_xml.indexOf(">",c),-1==d)return b.XMLP._setErr(a,b.XMLP.ERR_CLOSE_ELM);if("/"==a.m_xml.charAt(c)?(f=b.XMLP._ELM_E,c++):f=b.XMLP._ELM_B,"/"==a.m_xml.charAt(d-1)){if(f==b.XMLP._ELM_E)return b.XMLP._setErr(a,b.XMLP.ERR_ELM_EMPTY);f=b.XMLP._ELM_EMP,e--}a.nameRegex.lastIndex=c;var h=a.nameRegex.exec(a.m_xml);if(!h)return b.XMLP._setErr(a,b.XMLP.ERR_ELM_NAME);if(g=h[1].toLowerCase(),"li"===g&&f!==b.XMLP._ELM_E&&a.m_stack.length>0&&"li"===a.m_stack[a.m_stack.length-1]&&!a.m_emitSynthetic)return a.m_name="li",a.m_emitSynthetic=!0,b.XMLP._ELM_E;if(a.m_attributes={},a.m_cAlt="",a.nameRegex.lastIndex<e)for(a.m_iP=a.nameRegex.lastIndex;a.m_iP<e;){a.attrStartRegex.lastIndex=a.m_iP;var i=a.attrStartRegex.exec(a.m_xml);if(!i)return b.XMLP._setErr(a,b.XMLP.ERR_ATT_VALUES);var j,k=i[1].toLowerCase();if(61===a.m_xml.charCodeAt(a.attrStartRegex.lastIndex)){var l=34===a.m_xml.charCodeAt(a.attrStartRegex.lastIndex+1)?a.attrValRegex:a.attrValIERegex;if(l.lastIndex=a.attrStartRegex.lastIndex+1,i=l.exec(a.m_xml),!i)return b.XMLP._setErr(a,b.XMLP.ERR_ATT_VALUES);j=i[1]}else j=k,l=a.attrStartRegex;if(a.m_attributes[k]&&a.m_attributes[k]!==j)return b.XMLP._setErr(a,b.XMLP.ERR_ATT_DUP);a.m_attributes[k]=j,a.m_iP=l.lastIndex}if(-1!=g.indexOf("<"))return b.XMLP._setErr(a,b.XMLP.ERR_ELM_LT_NAME);if(a.m_name=g,a.m_iP=d+1,b.XMLP.closedTags[g]){a.closeRegex.lastIndex=d+1;var m=a.closeRegex.exec;if(m){var n=a.m_xml.indexOf(g,m.lastIndex);return n===m.lastIndex?f:b.XMLP._ELM_EMP}}return a.m_emitSynthetic=!1,f},b.XMLP._parse=function(a){var c=a.m_iP,d=a.m_xml;if(c===d.length)return b.XMLP._NONE;var e=d.charAt(c);if("<"!==e)return b.XMLP._parseText(a,c);var f=d.charAt(c+1);return"?"===f?b.XMLP._parsePI(a,c+2):"!"!==f?b.XMLP._parseElement(a,c+1):c===d.indexOf("<!DOCTYPE",c)?b.XMLP._parseDTD(a,c+9):c===d.indexOf("<!--",c)?b.XMLP._parseComment(a,c+4):c===d.indexOf("<![CDATA[",c)?b.XMLP._parseCDATA(a,c+9):void 0},b.XMLP.XMLPImpl=function(a){var c={};return c.m_xml=a,c.m_iP=0,c.m_iState=b.XMLP._STATE_PROLOG,c.m_stack=[],c.m_attributes={},c.m_emitSynthetic=!1,c.getColumnNumber=function(){return b.SAXStrings.getColumnNumber(c.m_xml,c.m_iP)},c.getContent=function(){return c.m_cSrc==b.XMLP._CONT_XML?c.m_xml:c.m_cAlt},c.getContentBegin=function(){return c.m_cB},c.getContentEnd=function(){return c.m_cE},c.getLineNumber=function(){return b.SAXStrings.getLineNumber(c.m_xml,c.m_iP)},c.getName=function(){return c.m_name},c.next=function(){return b.XMLP._checkStructure(c,b.XMLP._parse(c))},c.nameRegex=/([^\s\/>]+)/g,c.attrStartRegex=/\s*([\w:_][\w:_\-\.]*)/gm,c.attrValRegex=/\"([^\"]*)\"\s*/gm,c.attrValIERegex=/([^\>\s]+)\s*/gm,c.closeRegex=/\s*<\//g,c},b.SAXStrings={},b.SAXStrings.WHITESPACE=" 	\n\r",b.SAXStrings.QUOTES="\"'",b.SAXStrings.getColumnNumber=function(a,b){if(!a)return-1;b=b||a.length;var c=a.substring(0,b).split("\n");c.length--;var d=c.join("\n").length;return b-d},b.SAXStrings.getLineNumber=function(a,b){return a?(b=b||a.length,a.substring(0,b).split("\n").length):-1},b.SAXStrings.indexOfNonWhitespace=function(a,b,c){if(!a)return-1;b=b||0,c=c||a.length;for(var d=b;c>d;++d){var e=a.charAt(d);if(" "!==e&&"	"!==e&&"\n"!==e&&"\r"!==e)return d}return-1},b.SAXStrings.indexOfWhitespace=function(a,c,d){if(!a)return-1;c=c||0,d=d||a.length;for(var e=c;d>e;e++)if(-1!=b.SAXStrings.WHITESPACE.indexOf(a.charAt(e)))return e;return-1},b.SAXStrings.lastIndexOfNonWhitespace=function(a,c,d){if(!a)return-1;c=c||0,d=d||a.length;for(var e=d-1;e>=c;e--)if(-1==b.SAXStrings.WHITESPACE.indexOf(a.charAt(e)))return e;return-1},b.SAXStrings.replace=function(a,b,c,d,e){return a?(b=b||0,c=c||a.length,a.substring(b,c).split(d).join(e)):""}}(jQuery,fluid_2_0_0),fluid_2_0_0=fluid_2_0_0||{},function(a,b){"use strict";b.parseTemplate=function(c,d,e,f,g){function h(a){return 1===a.length&&1===a[0].predList.length&&a[0].predList[0].clazz}function i(c,e,f){if(v.rootlump=H(0,-1),x=[v.rootlump],y=0,z=0,A=!1,B=-1,C=-1,d=c,D=e,f)for(var g=0;g<f.length;++g){var i=b.parseSelector(f[g].selector,b.simpleCSSMatcher),j=h(i);j?F[j]=f[g].id:(G.push([]),E.push(a.extend({},f[g],{tree:i})))}}function j(){for(var a=x.length-1;a>=0;--a){var b=x[a];if(void 0!==b.rsfID)return b}return v.rootlump}function k(){var a=H(y,z);return D&&(a.line=w.getLineNumber(),a.column=w.getColumnNumber()),v.lumps[y]=a,++y,a}function l(a,b,c){var d=a[b];d||(d=[],a[b]=d),d[d.length]=c}function m(a,b){if(-1!==a.indexOf("scr=contribute-")){var c=a.substring("scr=contribute-".length);l(v.collectmap,c,b)}}function n(a){return"<"+a.tagname+">"}function o(a,b){return b?-1!==(" "+b+" ").indexOf(" "+a+" "):!1}function p(a,b,c){if(a.predList){for(var d=0;d<a.predList.length;++d){var e=a.predList[d];if(e.id&&b.attributemap.id!==e.id)return!1;if(e.clazz&&!o(e.clazz,c))return!1;if(e.tag&&b.tagname!==e.tag)return!1}return!0}}function q(c){var d,e,f=c.attributemap["class"];if(f){var g=f.split(" ");for(e=0;e<g.length;++e){var h=F[a.trim(g[e])];if(h)return h}}for(e=0;e<E.length;++e){var i=E[e],j=G[e],k=j.length;if(k<i.tree.length){var l=i.tree[k];if(k>0&&i.tree[k-1].child&&j[k-1]!==c.nestingdepth-1)continue;var m=p(l,c,f);m&&(j[j.length]=c.nestingdepth,j.length===i.tree.length&&(void 0!==d&&b.fail("Cutpoint specification error - node "+n(c)+" has already matched with rsf:id of "+d),void 0!==i.id&&null!==i.id||b.fail("Error in cutpoints list - entry at position "+e+" does not have an id set"),d=i.id))}}return d}function r(){if(E)for(var a=0;a<E.length;++a){var b=G[a];b.length>0&&b[b.length-1]===z&&b.length--}}function s(){r();var a=k();--z,a.text="</"+w.getName()+">";var b=x[x.length-1];b.close_tag=v.lumps[y-1],x.length--,A=!0}function t(a){if(++z,A){A=!1;var c=k();c.nestingdepth--}-1===v.firstdocumentindex&&(v.firstdocumentindex=y);var d=k(),e=x[x.length-1];d.uplump=e;var f=w.getName();d.tagname=f;var g=d.attributemap=w.m_attributes,h=g[b.ID_ATTRIBUTE];void 0===h&&(h=q(d));for(var i in g)void 0===h&&(/href|src|codebase|action/.test(i)?h="scr=rewrite-url":void 0===h&&/for|headers/.test(i)&&(h="scr=null"));if(h){126===h.charCodeAt(0)&&(h=h.substring(1),d.elide=!0),m(h,d),d.rsfID=h;var n=j();for(n.downmap||(n.downmap={});n;)n.downmap&&l(n.downmap,h,d),n=n.uplump;l(v.globalmap,h,d);var o=h.indexOf(":");if(-1!==o){var p=h.substring(0,o);e.finallump||(e.finallump={}),e.finallump[p]=d}}d.text="<"+f+b.dumpAttributes(g)+(a&&!h?"/>":">"),x[x.length]=d,a&&(h?s():(--z,x.length--))}function u(){if(-1!==B){-1===v.firstdocumentindex&&(v.firstdocumentindex=y);var a=w.getContent().substr(B,C-B);A=!1;var b=k();b.text=a,B=-1}}g=g||{},c||b.fail("empty template supplied to fluid.parseTemplate");var v,w,x,y=0,z=0,A=!1,B=-1,C=-1,D=!1,E=[],F={},G=[],H=function(a,b){return{nestingdepth:b,lumpindex:a,parent:v}};v=b.XMLViewTemplate(),i(d,g.debugMode,f);var I=c.indexOf(b.ID_ATTRIBUTE);if(e){var J=c.indexOf(">",I);w=b.XMLP(c.substring(J+1))}else w=b.XMLP(c);a:for(;;){var K=w.next();switch(K){case b.XMLP._ELM_B:u(),t(!1,"");break;case b.XMLP._ELM_E:u(),s();break;case b.XMLP._ELM_EMP:u(),t(!0,"");break;case b.XMLP._PI:case b.XMLP._DTD:B=-1;continue;case b.XMLP._TEXT:case b.XMLP._ENTITY:case b.XMLP._CDATA:case b.XMLP._COMMENT:-1===B&&(B=w.m_cB),C=w.m_cE;break;case b.XMLP._ERROR:b.setLogging(!0);var L="Error parsing template: "+w.m_cAlt+" at line "+w.getLineNumber();b.log(L),b.log("Just read: "+w.m_xml.substring(w.m_iP-30,w.m_iP)),b.log("Still to read: "+w.m_xml.substring(w.m_iP,w.m_iP+30)),b.fail(L);break a;case b.XMLP._NONE:break a}}u();var M=x.length-1;return M&&b.fail("Error parsing template - unclosed tag(s) of depth "+M+": "+b.transform(x.splice(1,M),function(a){return n(a)}).join(", ")),v},b.debugLump=function(a){var b=a.text;return b+=" at ",b+="lump line "+a.line+" column "+a.column+" index "+a.lumpindex,b+=null===a.parent.href?"":" in file "+a.parent.href},b.ID_ATTRIBUTE="rsf:id",b.getPrefix=function(a){var b=a.indexOf(":");return-1===b?a:a.substring(0,b)},b.SplitID=function(a){var b={},c=a.indexOf(":");return-1===c?b.prefix=a:(b.prefix=a.substring(0,c),b.suffix=a.substring(c+1)),b},b.XMLViewTemplate=function(){return{globalmap:{},collectmap:{},lumps:[],firstdocumentindex:-1}},b.XMLEncode=function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;")},b.dumpAttributes=function(a){var b="";for(var c in a){var d=a[c];null!==d&&void 0!==d&&(b+=" "+c+'="'+d+'"')}return b},b.aggregateMMap=function(a,b){for(var c in b){var d=a[c];d||(a[c]=[]),a[c]=a[c].concat(b[c])}},b.parseTemplates=function(a,c,d){var e=[];d=d||{},e.globalmap={};for(var f=0;f<c.length;++f){var g=a[c[f]],h=g.href.lastIndexOf("/"),i=-1===h?"":g.href.substring(0,h+1),j=b.parseTemplate(g.resourceText,i,d.scanStart&&0===f,g.cutpoints,d);0===f&&b.aggregateMMap(e.globalmap,j.globalmap),j.href=g.href,j.baseURL=i,j.resourceKey=g.resourceKey,e[f]=j,b.aggregateMMap(e.globalmap,j.rootlump.downmap)}return e}}(jQuery,fluid_2_0_0),fluid_2_0_0=fluid_2_0_0||{},function(a,b){"use strict";function c(a){return"as child of "+(a.parent.fullID?"component with full ID "+a.parent.fullID:"root")}function d(a){var d="",e=a;for(void 0===a.children&&(d=a.ID+(void 0!==a.localID?a.localID:""),e=a.parent);e.parent;){var f=e.parent;if(void 0!==e.fullID)return d=e.fullID+d;if(void 0===e.noID){var g=e.ID;void 0===g&&b.fail("Error in component tree - component found with no ID "+c(f)+": please check structure");var h=g.indexOf(":"),i=-1===h?g:g.substring(0,h);d=i+":"+(void 0===e.localID?"":e.localID)+":"+d}e=f}return d}function e(a,b){if(k.isBoundPrimitive(a))return{componentType:"UIBound",value:a,ID:b};var c=l(a);return c.ID?{ID:b,componentType:"UIContainer",children:[c]}:(c.ID=b,c)}function f(a){if(b.isArrayable(a))return a;var c=[];for(var d in a){var f=a[d];if(b.isArrayable(f))for(var g=0;g<f.length;++g){var h=e(f[g],d);c[c.length]=h}else c[c.length]=e(f,d)}return c}function g(a,c,d){void 0===a.value&&void 0!==a.valuebinding&&(a.value=b.get(c,a.valuebinding,d))}function h(a,b,c,d){void 0!==a[b]?k.isBoundPrimitive(a[b])?a[b]={value:a[b]}:a[b].messagekey&&(a[b].componentType="UIMessage"):a[b]={value:null},g(a[b],c,d)}function i(a,e,f){if(void 0===a.componentType&&(a=l(a,e,f)),"UIContainer"===a.componentType||a.parent||(a={children:[a]}),a.children){a.childmap={};for(var h=0;h<a.children.length;++h){var j=a.children[h];void 0===j.componentType&&(j=l(j,e,f),a.children[h]=j),j.parent=a,void 0===j.ID&&b.fail("Error in component tree: component found with no ID "+c(j)),a.childmap[j.ID]=j;var k=j.ID.indexOf(":");if(-1===k);else{var m=j.ID.substring(0,k),n=a.childmap[m];n||(n=[],a.childmap[m]=n),void 0===j.localID&&0!==n.length&&(j.localID=n.length),n[n.length]=j}j.fullID=d(j);var o=j.componentType;if("UISelect"===o)j.selection.fullID=j.fullID;else if("UIInitBlock"===o){for(var p=j.functionname+"(",q=j.arguments,r=0;r<q.length;++r)q[r]instanceof b.ComponentReference&&(q[r]=j.parent.fullID+q[r].reference),p+=JSON.stringify(q[r]),r<q.length-1&&(p+=", ");j.markup={value:p+")\n"},j.componentType="UIVerbatim"}else"UIBound"===o&&g(j,e,f);i(j,e,f)}}return a}function j(a){var c=b.dom.iterateDom(a,function(a){return 8===a.nodeType||4===a.nodeType?"stop":null},!0),d=c.nodeValue;return 0===d.indexOf("[CDATA[")?d.substring(6,d.length-2):d}b.defaults("fluid.messageResolver",{gradeNames:["fluid.component"],mergePolicy:{messageBase:"nomerge",parents:"nomerge"},resolveFunc:b.stringTemplate,parseFunc:b.identity,messageBase:{},members:{messageBase:"@expand:{that}.options.parseFunc({that}.options.messageBase)"},invokers:{lookup:"fluid.messageResolver.lookup({that}, {arguments}.0)",resolve:"fluid.messageResolver.resolve({that}, {arguments}.0, {arguments}.1)"},parents:[]}),b.messageResolver.lookup=function(a,c){var d=b.messageResolver.resolveOne(a.messageBase,c);return void 0===d?b.find(a.options.parents,function(a){return a?a.lookup(c):void 0}):{template:d,resolveFunc:a.options.resolveFunc}},b.messageResolver.resolve=function(a,c,d){if(!c)return"[No messagecodes provided]";c=b.makeArray(c);var e=a.lookup(c);return e?e.resolveFunc(e.template,d):"[Message string for key "+c[0]+" not found]"},b.messageResolver.resolveOne=function(a,b){for(var c=0;c<b.length;++c){var d=b[c],e=a[d];if(void 0!==e)return e}},b.messageLocator=function(a,c){var d=b.messageResolver({messageBase:a,resolveFunc:c});return function(a,b){return d.resolve(a,b)}};var k={};k.isBoundPrimitive=function(a){return b.isPrimitive(a)||b.isArrayable(a)&&(0===a.length||"string"==typeof a[0])};var l;k.duckMap={children:"UIContainer",value:"UIBound",valuebinding:"UIBound",messagekey:"UIMessage",markup:"UIVerbatim",selection:"UISelect",target:"UILink",choiceindex:"UISelectChoice",functionname:"UIInitBlock"};var m={UISelect:["selection","optionlist","optionnames"],UILink:["target","linktext"],UIVerbatim:["markup"],UIMessage:["messagekey"]};k.boundMap=b.transform(m,b.arrayToHash),k.inferComponentType=function(a){for(var b in k.duckMap)if(void 0!==a[b])return k.duckMap[b]},k.applyComponentType=function(a){a.componentType=k.inferComponentType(a),void 0===a.componentType&&void 0!==a.ID&&(a.componentType="UIBound")},l=function(a,c,d){if(a&&k.applyComponentType(a),!a||void 0===a.componentType){var e=a.decorators;e&&delete a.decorators,a={componentType:"UIContainer",children:a},a.decorators=e}var g=a.componentType;if("UIContainer"===g)a.children=f(a.children);else{var i=k.boundMap[g];i&&b.each(i,function(b,e){h(a,e,c,d)})}return a},b.NULL_STRING="▩null▩";var n={a:"href",link:"href",img:"src",frame:"src",script:"src",style:"src",input:"src",embed:"src",form:"action",applet:"codebase",object:"codebase"};k.decoratorComponentPrefix="**-renderer-",k.IDtoComponentName=function(a,b){return k.decoratorComponentPrefix+a.replace(/\./g,"")+"-"+b},k.invokeFluidDecorator=function(a,c,d,e,f){var g;if(f.parentComponent){var h=f.parentComponent,i=k.IDtoComponentName(d,e);b.set(h,["options","components",i],{type:a,container:c[0],options:c[1]}),g=b.initDependent(f.parentComponent,i)}else g=b.invokeGlobalFunction(a,c);return g},b.renderer=function(c,d,e,f){function g(a,b,c){return a.resourceKey+b.fullID+c}function j(a,b,c){var d,e=c?c[a]:null;if(e)for(var f=0;f<e.length;++f){var g=e[f];if(d||g.rsfID!==b||(d=g),g.rsfID===a)return g}return d}function l(a,c){var d=c.jointID?c.jointID:c.ID,e=b.SplitID(d),f=e.prefix+":",g=j(d,f,a.downmap,c);return g?g:c.children&&(g=j(d,f,ga,c))?g:null}function m(a){ja[a.href]||(b.aggregateMMap(ka,a.collectmap),ja[a.href]=!0)}function o(a,b){var c,d,e;for(c=0;c<a.children.length;++c){var f=a.children[c];f.children&&(e=l(b,f),e&&(ha[f.fullID]=e,d=e.attributemap.id,void 0!==d&&(ia[g(b.parent,a,d)]=f.fullID),m(e.parent),o(f,e)))}if(b.downmap)for(d in b.downmap){var h=b.downmap[d];for(c=0;c<h.length;++c){var i=h[c],j=i.attributemap.id;if(void 0!==j&&void 0!==i.rsfID&&(e=ea(a,i.rsfID),null!==e)){var k=e.fullID;ia[g(b.parent,a,j)]=k}}}}function p(a,b,c){ha={},ia={},ja={},ka={},ga=a,ha[b.fullID]=c,o(b,c)}function q(a,b,c){for(;c>b;++b){var d=a[b].text;d&&(la+=a[b].text)}}function r(a,c,d,e,f){for(var g=c;;){if(c===a.length)break;var h=a[c];if(h.nestingdepth<d)break;if(void 0!==h.rsfID){if(!f)break;if(!(f&&h.nestingdepth>d+(e?0:1)))break;b.log("Error in component tree - leaf component found to contain further components - at "+h.toString())}++c}return e||c!==a.length&&a[c].rsfID||--c,q(a,g,c),c}function s(){return!1}function t(a){return null!==a&&void 0!==a&&!s(a)}function u(){ra.iselide||(la+="<"+ra.uselump.tagname)}function v(){ra.iselide||(la+="</"+ra.uselump.tagname+">")}function w(){q(ra.uselump.parent.lumps,ra.uselump.lumpindex+1,ra.close.lumpindex+(ra.iselide?0:1))}function x(){return ra.endopen.lumpindex===ra.close.lumpindex&&b.XMLP.closedTags[ra.uselump.tagname]}function y(){x()?ra.iselide||(la+="/>"):(ra.iselide||(la+=">"),q(ra.uselump.parent.lumps,ra.endopen.lumpindex,ra.close.lumpindex+(ra.iselide?0:1)))}function z(){ra.iselide||(la+=b.dumpAttributes(ra.attrcopy)),y()}function A(){if(ra.iselide)z();else{la+=b.dumpAttributes(ra.attrcopy);var a=x();la+=a?"/>":">",ra.nextpos=a?ra.close.lumpindex+1:ra.endopen.lumpindex}}function B(a){la+=b.dumpAttributes(ra.attrcopy),ra.iselide||(la+=">"),la+=b.XMLEncode(a.toString()),v()}function C(a){t(a)?B(a):z()}function D(a){ra.iselide?C(ra.value):t(a)?B(a):A()}function E(a,b){if(ma.urlRewriter){var c=ma.urlRewriter(b);if(c)return c}if(!ma.rebaseURLs)return b;var d=b.indexOf(":/");return"/"===b.charAt(0)||-1!==d&&7>d?b:ma.baseURL+b}function F(a){la+='<input type="hidden" ';var c=a.virtual,d={};d[c?"id":"name"]=a.name,d.value=a.value,la+=b.dumpAttributes(d),la+=" />\n"}function G(c,d){function e(){b.applyBoundChange(b.byId(d,ma.document),void 0,g)}if(d){var f=ra.uselump.tagname,g=ma.applier;if(ma.autoBind&&/input|select|textarea/.test(f)&&!oa[d]){var h=[{jQuery:["change",e]}];a.browser.msie&&"input"===f&&/radio|checkbox/.test(ra.attrcopy.type)&&h.push({jQuery:["click",e]}),a.browser.safari&&"input"===f&&"radio"===ra.attrcopy.type&&h.push({jQuery:["keyup",e]}),fa(c,h,ra.attrcopy,d)}}}function H(a,b){if(a){var c=b?b:a;if(ma.fossils&&void 0!==c.valuebinding){var d=c.submittingname||a.finalID;ma.fossils[d]={name:d,EL:c.valuebinding,oldvalue:c.value},G(a,a.finalID)}a.fossilizedbinding&&F(a.fossilizedbinding),a.fossilizedshaper&&F(a.fossilizedshaper)}}function I(a){oa[a.selection.fullID]||(oa[a.selection.fullID]=!0,H(a.selection),H(a.optionlist),H(a.optionnames))}function J(a,c){var d=a.selection;return b.isArrayable(d.value)?-1!==d.value.indexOf(c):d.value===c}function K(a,b){for(a=a.parent;0===b.indexOf("..::");)b=b.substring(4),a=a.parent;return a.childmap[b]}function L(a,c){b.each(ia,function(b,d){b===a&&(ia[d]=c)})}function M(a,b,c,d){c||delete a["rsf:id"],void 0!==b.finalID?a.id=b.finalID:void 0!==d?a.id=d:(a.id||c)&&(a.id=b.fullID);for(var e=1,f=a.id;ma.document.getElementById(a.id)||pa[a.id];)a.id=f+"-"+e++;return 1!==e&&L(f,a.id),b.finalID=a.id,a.id}function N(a,b,c){var d=c||b;return M(a,b,!0,b.fullID),void 0===d.submittingname&&d.willinput!==!1&&(d.submittingname=d.finalID||d.fullID),d.submittingname}function O(a){var b=[];if(a.type)b[0]=a;else for(var c in a){"$"===c&&(c="jQuery");var d=a[c],e={type:c};"jQuery"===c?(e.func=d[0],e.args=d.slice(1)):"addClass"===c||"removeClass"===c?e.classes=d:"attrs"===c?e.attributes=d:"identify"===c&&(e.key=d),b[b.length]=e}return b}function P(a,b){a.decorators&&(void 0===a.decorators.length&&(a.decorators=O(a.decorators)),fa(a,a.decorators,b))}function Q(c,d){if(!d.elide){var e={};a.extend(!0,e,d.attributemap),M(e,c),P(c,e),la+="<"+d.tagname+" ",la+=b.dumpAttributes(e),la+=">"}}function R(a){return a?(a=b.copy(a),b.transform(a,function(b,c){return h(a,c,ma.model,ma.resolverGetConfig),a[c].value})):a}function S(a){if("UIMessage"===a.componentType)if(a.componentType="UIBound",ma.messageLocator){h(a,"messagekey",ma.model,ma.resolverGetConfig);var b=R(a.args);a.value=ma.messageLocator(a.messagekey.value,b)}else a.value="[No messageLocator is configured in options - please consult documentation on options.messageSource]"}function T(a){function c(a,c){b.fail("Error in component tree - UISelectChoice with id "+a.fullID+c)}var d,e=ra.attrcopy;S(a);var f=a.componentType,g=ra.uselump.tagname;if(P(a,e),"UIBound"===f||"UISelectChoice"===f){var h;void 0!==a.choiceindex&&(void 0!==a.parentRelativeID?(h=K(a,a.parentRelativeID),h||c(a," has parentRelativeID of "+a.parentRelativeID+" which cannot be resolved")):c(a," does not have parentRelativeID set"),N(e,a,h.selection),I(h));var i=h?h.selection.submittingname:a.submittingname;if(!h&&a.valuebinding&&(i=N(e,a)),"input"!==g&&"textarea"!==g||void 0!==i&&(e.name=i),H(a,h?h.selection:null),"boolean"==typeof a.value||"radio"===e.type||"checkbox"===e.type){var j,k=a.value;void 0!==a.choiceindex&&(h.optionlist.value||b.fail("Error in component tree - selection control with full ID "+h.fullID+" has no values"),j=h.optionlist.value[a.choiceindex],k=J(h,j)),t(k)&&(k?e.checked="checked":delete e.checked),e.value=b.XMLEncode(j?j:"true"),C(null)}else b.isArrayable(a.value)?w():(d=h?h["textarea"===g||"input"===g?"optionlist":"optionnames"].value[a.choiceindex]:a.value,"textarea"===g?(s(d)&&a.willinput&&(d=""),C(d)):"input"===g?((a.willinput||t(d))&&(e.value=b.XMLEncode(String(d))),C(null)):(delete e.name,D(d)))}else if("UISelect"===f){var l="select"===g,m=!1;if(b.isArrayable(a.selection.value)&&(m=!0,l&&(e.multiple="multiple")),N(e,a.selection),l&&(a.selection.willinput!==!1&&(e.name=a.selection.submittingname),G(a,e.id)),la+=b.dumpAttributes(e),
l){la+=">";var o=a.optionlist.value,p=null!==a.optionnames&&void 0!==a.optionnames&&a.optionnames.value?a.optionnames.value:o;p&&p.length||b.fail("Error in component tree - UISelect component with fullID "+a.fullID+" does not have optionnames set");for(var q=0;q<p.length;++q)la+='<option value="',d=o[q],null===d&&(d=b.NULL_STRING),la+=b.XMLEncode(d),J(a,d)&&(la+='" selected="selected'),la+='">',la+=b.XMLEncode(p[q]),la+="</option>\n";v()}else y();I(a)}else if("UILink"===f){var r=n[g];if(r){S(a.target);var u=a.target.value;t(u)||(u=e[r]),u=E(ra.uselump.parent,u),e[r]=b.XMLEncode(u)}d=void 0,a.linktext&&(S(a.linktext),d=a.linktext.value),t(d)?C(d):A()}else if(void 0!==a.markup){S(a.markup);var x=a.markup.value;null===x?(la+=b.dumpAttributes(e),la+=">",w()):(ra.iselide||(la+=b.dumpAttributes(e),la+=">"),la+=x,v())}void 0!==e.id&&(pa[e.id]=!0)}function U(a){var b,c=ra.attrcopy["for"];if(void 0!==c?b="for":(c=ra.attrcopy.headers,void 0!==c&&(b="headers")),b){var d=ra.uselump.tagname;if(!("for"===b&&"label"!==d||"headers"===b&&"td"!==d&&"th"!==d)){var e=ia[g(ra.uselump.parent,a,c)];void 0!==e&&(ra.attrcopy[b]=e)}}}function V(a){la+="<!-- "+b.XMLEncode(a)+"-->"}function W(a){la+='<span style="background-color:#FF466B;color:white;padding:1px;">',la+=a,la+="</span><br/>"}function X(a){var b=a.fullID;return b?"full path "+b:"component tree root"}function Y(b,c,d){var e=d.lumpindex,f=d.parent.lumps,g=-1,h=f[e+1],i=d.close_tag;g=i.lumpindex+1;var j=d.downmap?d.downmap["payload-component"]:null,k=j?j[0]:null,l=126===d.rsfID.charCodeAt(0),m=h,n=i,o=d,p={};if(a.extend(!0,p,(null===k?d:k).attributemap),ra.attrcopy=p,ra.uselump=o,ra.endopen=m,ra.close=n,ra.nextpos=g,ra.iselide=l,U(b),null===c&&d.rsfID.indexOf("scr=")===(l?1:0)){var r=d.rsfID.substring(4+(l?1:0));"ignore"===r?g=ra.close.lumpindex+1:"rewrite-url"===r?c={componentType:"UILink",target:{}}:(u(),A(),g=ra.endopen.lumpindex)}return null!==c&&(k&&(ra.endopen=f[k.lumpindex+1],ra.close=k.close_tag,ra.uselump=k,q(f,e,k.lumpindex),e=k.lumpindex),M(p,c),u(),T(c),null!==k&&ra.nextpos===g&&q(f,ra.close.lumpindex+1,i.lumpindex+1),g=ra.nextpos),g}function Z(a,b){var c=b.parent,d=c.lumps[b.lumpindex+1];void 0!==a.children?Q(a,b):Y(a.parent,a,b),sa(a,b,d)}function $(a,b){for(var c;a&&!(c=a.childmap[b]);)a=a.parent;return c}function _(a,c){var d=b.SplitID(c.ID),e=a.downmap[c.ID];return e||(e=a.downmap[d.prefix+":"]),e?e[0]:null}function aa(a){q(a.parent.lumps,a.lumpindex,a.close_tag.lumpindex+1)}function ba(){for(var a in ka)for(var b=ka[a],c=0;c<b.length;++c)aa(b[c])}function ca(){for(var a=0;a<na.length;++a)for(var c=na[a],d=0;d<c.ids.length;++d){var f=c.ids[d],g=b.byId(f,ma.document);if(g||b.fail("Error during rendering - component with id "+f+" which has a queued decorator was not found in the output markup"),"jQuery"===c.type){var h=ma.jQuery(g);h[c.func].apply(h,b.makeArray(c.args))}else if("fluid"===c.type){var i=c.args;if(!i){var j=ma.jQuery(g);c.container?c.container.push(g):c.container=j,i=[j,c.options]}var l=k.invokeFluidDecorator(c.func,i,f,a,e);c.that=l}else"event"===c.type&&(g[c.event]=c.handler)}}e=e||{},d=d||{};var da=e.debugMode;!e.messageLocator&&e.messageSource&&(e.messageLocator=b.resolveMessageSource(e.messageSource)),e.document=e.document||document,e.jQuery=e.jQuery||a,e.fossils=e.fossils||f||{};var ea,fa,ga={},ha={},ia={},ja={},ka={},la="",ma=e,na=[],oa={},pa={},qa={options:e},ra={};fa=function(a,c,d,e){var f,g=function(a,c){null===a||void 0===a?delete d[c]:d[c]=b.XMLEncode(a)};ma.idMap=ma.idMap||{};for(var h=0;h<c.length;++h){var i=c[h],j=i.type;if(j)if("$"===j&&(j=i.type="jQuery"),"jQuery"===j||"event"===j||"fluid"===j)f=M(d,a,!0,e),void 0===i.ids&&(i.ids=[],na[na.length]=i),i.ids.push(f);else if("attrs"===j)b.each(i.attributes,g);else if("addClass"===j||"removeClass"===j){var k={nodeType:1,className:d["class"]||""};ma.jQuery(k)[j](i.classes),d["class"]=k.className}else"identify"===j?(f=M(d,a,!0,e),ma.idMap[i.key]=f):"null"!==j&&b.log("Unrecognised decorator of type "+j+" found at component of ID "+e);else{var l=O(i);fa(a,l,d,e)}}};var sa;return ea=function(a,b){if(0===b.indexOf("msg=")){var c=b.substring(4);return{componentType:"UIMessage",messagekey:c}}for(;a;){var d=a.childmap[b];if(d)return d;a=a.parent}return null},sa=function(a,c,d){var e,f,g,h,i=d.lumpindex,j=c.nestingdepth,k=c.parent;for(da&&(h={});;){if(i=r(k.lumps,i,j,!c.elide,!1),i===k.lumps.length)break;var l=k.lumps[i],m=l.rsfID;if(l.nestingdepth<j||void 0===m)break;if(126===m.charCodeAt(0)&&(m=m.substring(1)),-1!==m.indexOf(":")){var n=b.getPrefix(m);e=$(a,n);var o=l.uplump.finallump[n],p=o.close_tag;if(e)for(var q=0;q<e.length;++q)if(g=e[q],g.children)da&&(h[g.fullID]=!0),f=ha[g.fullID],f?(da&&V("Branching for "+g.fullID+" from "+b.debugLump(l)+" to "+b.debugLump(f)),Z(g,f),da&&V("Branch returned for "+g.fullID+b.debugLump(l)+" to "+b.debugLump(f))):da&&W("No matching template branch found for branch container with full ID "+g.fullID+" rendering from parent template branch "+b.debugLump(d));else{if(f=_(c,g),!f){da&&W("Repetitive leaf with full ID "+g.fullID+" could not be rendered from parent template branch "+b.debugLump(d));continue}var s=Y(a,g,f),t=s<k.lumps.lengtn&&k.lumps[s].nestingdepth>=f.nestingdepth,u=g.children?g:a;t&&(sa(u,f,k.lumps[s]),s=f.close_tag.lumpindex+1),q!==e.length-1?s<p.lumpindex&&r(k.lumps,s,f.nestingdepth-1,!1,!1):r(k.lumps,s,f.nestingdepth,!0,!1)}else da&&W("No branch container with prefix "+n+": found in container "+X(a)+" rendering at template position "+b.debugLump(d)+", skipping");i=p.lumpindex+1,da&&V("Stack returned from branch for ID "+m+" to "+b.debugLump(d)+": skipping from "+b.debugLump(l)+" to "+b.debugLump(p))}else{var v;m&&(v=ea(a,m,l),da&&v&&(h[v.fullID]=!0)),v&&void 0!==v.children?(Z(v),i=l.close_tag.lumpindex+1):i=Y(a,v,l)}if(i===k.lumps.length)break}if(da){e=a.children;for(var w=0;w<e.length;++w)g=e[w],h[g.fullID]||W("Component "+g.componentType+" with full ID "+g.fullID+" could not be found within template "+b.debugLump(d))}},qa.renderTemplates=function(){d=i(d,e.model,e.resolverGetConfig);var a=c[0];return p(c.globalmap,d,a.rootlump),oa={},ba(),sa(d,a.rootlump,a.lumps[a.firstdocumentindex]),la},qa.processDecoratorQueue=function(){ca()},qa},jQuery.extend(!0,b.renderer,k),b.ComponentReference=function(a){this.reference=a},b.explode=function(a,b){var c=[];for(var d in a){var e=void 0===b?d:b+"."+d;c[c.length]={ID:d,value:a[d],valuebinding:e}}return c},b.explodeSelectionToInputs=function(a,c){return b.transform(a,function(a,b){return{ID:c.rowID,children:[{ID:c.inputID,parentRelativeID:"..::"+c.selectID,choiceindex:b},{ID:c.labelID,parentRelativeID:"..::"+c.selectID,choiceindex:b}]}})},b.resolveMessageSource=function(a){if("data"===a.type){if(void 0===a.url)return b.messageLocator(a.messages,a.resolveFunc)}else if("resolver"===a.type)return a.resolver.resolve},b.renderTemplates=function(a,c,d,e){var f=b.renderer(a,c,d,e),g=f.renderTemplates();return g},b.reRender=function(c,d,e,f){f=f||{};var g=b.renderer(c,e,f,f.fossils);f=g.options,d=b.unwrap(d);var h,i=b.getLastFocusedElement?b.getLastFocusedElement():null;i&&b.dom.isContainer(d,i)&&(h=i.id),a.browser.msie?f.jQuery(d).empty():d.innerHTML="";var j=g.renderTemplates();if(f.renderRaw&&(j=b.XMLEncode(j),j=j.replace(/\n/g,"<br/>")),f.model&&b.bindFossils(d,f.model,f.fossils),a.browser.msie?f.jQuery(d).html(j):d.innerHTML=j,g.processDecoratorQueue(),h){var k=b.byId(h,f.document);k&&f.jQuery(k).focus()}return c},b.extractTemplate=function(a,b){return b?j(a):a.innerHTML},b.render=function(a,c,d,e){e=e||{};var f=a;"object"==typeof a&&(f=b.extractTemplate(b.unwrap(a.node),a.armouring)),c=b.unwrap(c);var g={base:{resourceText:f,href:".",resourceKey:".",cutpoints:e.cutpoints}},h=b.parseTemplates(g,["base"],e);return b.reRender(h,c,d,e)},b.selfRender=function(a,c,d){return d=d||{},b.render({node:a,armouring:d.armouring},a,c,d)}}(jQuery,fluid_2_0_0),fluid_2_0_0=fluid_2_0_0||{},function(a,b){"use strict";b.renderer||b.fail("fluidRenderer.js is a necessary dependency of RendererUtilities"),b.renderer.visitDecorators=function(a,c){b.visitComponentChildren(a,function(a,d){0===d.indexOf(b.renderer.decoratorComponentPrefix)&&c(a,d)},{flat:!0},[])},b.renderer.clearDecorators=function(a){var c=b.getInstantiator(a);b.renderer.visitDecorators(a,function(b,d){c.clearComponent(a,d)})},b.renderer.getDecoratorComponents=function(a){var c={};return b.renderer.visitDecorators(a,function(a,b){c[b]=a}),c},b.renderer.modeliseOptions=function(c,d,e){return a.extend({},d,b.filterKeys(e,["model","applier"]),c)},b.renderer.reverseMerge=function(a,c,d){d=b.makeArray(d),b.each(d,function(b){void 0===a[b]&&void 0!==c[b]&&(a[b]=c[b])})},b.renderer.createRendererSubcomponent=function(c,d,e,f,g){e=e||{};var h=e.templateSource?e.templateSource:{node:a(c)},i=void 0===e.rendererOptions.model,j=b.renderer.modeliseOptions(e.rendererOptions,null,f);if(j.fossils=g||{},j.parentComponent=f,c.jquery){var k={document:c[0].ownerDocument,jQuery:c.constructor};b.renderer.reverseMerge(j,k,b.keys(k))}var l={},m=null;return l.render=function(g){var k=e.cutpointGenerator||"fluid.renderer.selectorsToCutpoints";j.cutpoints=j.cutpoints||b.invokeGlobalFunction(k,[d,e]),i&&(j.model=f.model);var l=a(e.renderTarget?e.renderTarget:c);m?(b.clear(j.fossils),b.reRender(m,l,g,j)):("function"==typeof h&&(h=h()),m=b.render(h,l,g,j))},l},b.defaults("fluid.rendererComponent",{gradeNames:["fluid.viewComponent"],initFunction:"fluid.initRendererComponent",mergePolicy:{"rendererOptions.idMap":"nomerge",protoTree:"noexpand, replace",parentBundle:"nomerge","changeApplierOptions.resolverSetConfig":"resolverSetConfig"},invokers:{refreshView:{funcName:"fluid.rendererComponent.refreshView",args:"{that}"},produceTree:{funcName:"fluid.rendererComponent.produceTree",args:"{that}"}},rendererOptions:{autoBind:!0},events:{prepareModelForRender:null,onRenderTree:null,afterRender:null},listeners:{onCreate:{funcName:"fluid.rendererComponent.renderOnInit",args:["{that}.options.renderOnInit","{that}"],priority:"last"}}}),b.rendererComponent.renderOnInit=function(a,b){(a||b.renderOnInit)&&b.refreshView()},b.protoExpanderForComponent=function(a,c){var d=b.renderer.modeliseOptions(c.expanderOptions,{ELstyle:"${}"},a);b.renderer.reverseMerge(d,c,["resolverGetConfig","resolverSetConfig"]);var e=b.renderer.makeProtoExpander(d,a);return e},b.rendererComponent.refreshView=function(a){if(!a.renderer)return void(a.renderOnInit=!0);b.renderer.clearDecorators(a),a.events.prepareModelForRender.fire(a.model,a.applier,a);var c=a.produceTree(a),d=a.renderer.rendererFnOptions;if(!d.noexpand){var e=b.protoExpanderForComponent(a,d);c=e(c)}a.events.onRenderTree.fire(a,c),a.renderer.render(c),a.events.afterRender.fire(a)},b.rendererComponent.produceTree=function(a){var c=a.options.produceTree;return c?("string"==typeof c?b.getGlobalValue(c):c)(a):a.options.protoTree},b.initRendererComponent=function(c,d,e){var f=b.initView(c,d,e,{gradeNames:["fluid.rendererComponent"]});b.getForComponent(f,"model"),b.getForComponent(f,"applier"),b.diagnoseFailedView(c,f,b.defaults(c),arguments),b.fetchResources(f.options.resources);var g,h=b.renderer.modeliseOptions(f.options.rendererOptions,null,f);!h.messageSource&&f.options.strings&&(g=b.messageResolver({messageBase:f.options.strings,resolveFunc:f.options.messageResolverFunction,parents:b.makeArray(f.options.parentBundle)}),h.messageSource={type:"resolver",resolver:g}),b.renderer.reverseMerge(h,f.options,["resolverGetConfig","resolverSetConfig"]),f.rendererOptions=h;var i=a.extend({},f.options.rendererFnOptions,{rendererOptions:h,repeatingSelectors:f.options.repeatingSelectors,selectorsToIgnore:f.options.selectorsToIgnore,expanderOptions:{envAdd:{styles:f.options.styles}}});f.options.resources&&f.options.resources.template&&(i.templateSource=function(){return f.options.resources.template.resourceText}),b.renderer.reverseMerge(i,f.options,["resolverGetConfig","resolverSetConfig"]),i.rendererTargetSelector&&(d=function(){return f.dom.locate(i.rendererTargetSelector)});var j={fossils:{},rendererFnOptions:i,boundPathForNode:function(a){return b.boundPathForNode(a,j.fossils)}},k=b.renderer.createRendererSubcomponent(d,f.options.selectors,i,f,j.fossils);return f.renderer=a.extend(j,k),g&&(f.messageResolver=g),j.refreshView=b.getForComponent(f,"refreshView"),f};var c=function(a,c){return b.each(b.makeArray(c),function(b){delete a[b]}),a},d=function(a,c){return c&&b.each(c,function(b){a===b&&(a+=":")}),a};b.renderer.selectorsToCutpoints=function(a,e){var f=[];e=e||{},a=b.copy(a),e.selectorsToIgnore&&(a=c(a,e.selectorsToIgnore));for(var g in a)f.push({id:d(g,e.repeatingSelectors),selector:a[g]});return f},b.renderer.NO_COMPONENT={},b.renderer.mergeComponents=function(a,b){for(var c in b)a[c]=b[c];return a},b.registerNamespace("fluid.renderer.selection"),b.renderer.selection.inputs=function(a,c,d,e){b.expect("Selection to inputs expander",a,["selectID","inputID","labelID","rowID"]);var f=e.expander(a.tree),g=b.transform(f.optionlist.value,function(c,d){var e={},f={parentRelativeID:"..::"+a.selectID,choiceindex:d};return e[a.inputID]=f,e[a.labelID]=b.copy(f),e}),h={};return h[a.selectID]=f,h[a.rowID]={children:g},h=e.expander(h)},b.renderer.repeat=function(a,c,d,e){b.expect("Repetition expander",a,["controlledBy","tree"]);var f=e.threadLocal(),g=b.extractContextualPath(a.controlledBy,{ELstyle:"ALL"},f),h=b.get(e.model,g,e.resolverGetConfig),i={};if(!h||0===h.length)return a.ifEmpty?e.expander(a.ifEmpty):i;var j=[];b.each(h,function(c,d){var h=b.model.composePath(g,d),i={};a.pathAs&&(i[a.pathAs]="${"+h+"}"),a.valueAs&&(i[a.valueAs]=b.get(e.model,h,e.resolverGetConfig));var k=b.withEnvironment(i,function(){return e.expander(a.tree)},f);b.isArrayable(k)?k.length>0&&j.push({children:k}):k!==b.renderer.NO_COMPONENT&&j.push(k)});var k=a.repeatID;return-1===k.indexOf(":")&&(k+=":"),b.each(j,function(a){a.ID=k}),j},b.renderer.condition=function(a,c,d,e){b.expect("Selection to condition expander",a,["condition"]);var f;if(a.condition.funcName){var g=e.expandLight(a.condition.args);f=b.invokeGlobalFunction(a.condition.funcName,g)}else f=a.condition.expander?e.expander(a.condition):e.expandLight(a.condition);var h=f?a.trueTree:a.falseTree;return h||(h=b.renderer.NO_COMPONENT),e.expander(h)},b.extractContextualPath=function(a,c,d,e){var f=b.extractELWithContext(a,c);return f?f.context?d[f.context]?b.transformContextPath(f,d).path:{value:e(f)}:f.path:void 0},b.transformContextPath=function(a,c){if(a.context){var d,e=c[a.context];if("string"==typeof e&&(d=b.extractEL(e,{ELstyle:"${}"})),d)return{noDereference:""===a.path,path:b.model.composePath(d,a.path)}}return a},b.renderer.makeExternalFetcher=function(a){return function(c){var d=b.resolveContext(c.context,a);return d?b.getForComponent(d,c.path):void 0}},b.renderer.makeProtoExpander=function(c,d){function e(a){var c=h();return b.extractContextualPath(a,g,c,g.externalFetcher)}function f(a){return b.find(a,function(a,b){return"decorators"===b})!==!1}var g=a.extend({ELstyle:"${}"},c);d&&(g.externalFetcher=b.renderer.makeExternalFetcher(d));var h,i=g.IDescape||"\\",j=function(a){return b.expand(a,g)},k=function(c,d){if(void 0!==c.messagekey)return{componentType:"UIMessage",messagekey:k(c.messagekey),args:j(c.args)};var f;b.isPrimitive(c)||b.isArrayable(c)?f={}:(f=a.extend({},c),f.decorators&&(f.decorators=j(f.decorators)),c=f.value,delete f.value);var h;if("string"==typeof c){var i=e(c);h="string"==typeof i?i:null,c=b.get(i,"value")||c}return h?f.valuebinding=h:void 0!==c&&(f.value=c),g.model&&f.valuebinding&&void 0===f.value&&(f.value=b.get(g.model,f.valuebinding,g.resolverGetConfig)),d&&(f.componentType="UIBound"),f};g.filter=b.expander.lightFilter;var l,m,n=function(a){var b=[];return l(a,b),{children:b}},o=function(a){if(a===b.renderer.NO_COMPONENT)return a;var c,d=[],e=function(a){c=a};return m(a,d,e),c||d},p={model:g.model,resolverGetConfig:g.resolverGetConfig,resolverSetConfig:g.resolverSetConfig,expander:o,expandLight:j},q=function(a,c){var d={componentType:c},e=b.renderer.boundMap[c]||{};for(var f in a)/decorators|args/.test(f)?d[f]=j(a[f]):e[f]?d[f]=k(a[f]):d[f]=a[f];return d},r=function(a,b){for(var c=a.children,d=0;d<c.length;++d){var e=[],f={children:e},g=c[d],h=function(a){e[e.length]=a};m(g,e,h),1!==f.children.length||f.children[0].ID||(f=f.children[0]),b(f)}};return m=function(a,c,d){var e=b.renderer.inferComponentType(a);e||!b.isPrimitive(a)&&!f(a)||(e="UIBound"),e?d("UIBound"===e?k(a,!0):q(a,e)):(c||b.fail("Illegal cond->cond transition"),l(a,c))},l=function(a,c){var d=function(d){var e=b.invokeGlobalFunction(d.type,[d,a,f,p]);e!==b.renderer.NO_COMPONENT&&b.each(e,function(a){c[c.length]=a})},e=function(a){a.ID=f,c[c.length]=a};for(var f in a){var g=a[f];if(f.charAt(0)===i&&(f=f.substring(1)),"expander"===f){var h=b.makeArray(g);b.each(h,d)}else g&&(g.children?(-1===f.indexOf(":")&&(f+=":"),r(g,e)):b.renderer.isBoundPrimitive(g)?e(k(g,!0)):m(g,null,e))}},function(c){return h=b.threadLocal(function(){return a.extend({},g.envAdd)}),g.fetcher=b.makeEnvironmentFetcher(g.model,b.transformContextPath,h,g.externalFetcher),p.threadLocal=h,n(c)}}}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.defaults("fluid.slidingPanel",{gradeNames:["fluid.viewComponent"],selectors:{panel:".flc-slidingPanel-panel",toggleButton:".flc-slidingPanel-toggleButton",toggleButtonLabel:".flc-slidingPanel-toggleButton"},strings:{showText:"show",hideText:"hide"},events:{onPanelHide:null,onPanelShow:null,afterPanelHide:null,afterPanelShow:null},listeners:{"onCreate.bindClick":{"this":"{that}.dom.toggleButton",method:"click",args:["{that}.togglePanel"]},"onCreate.bindModelChange":{listener:"{that}.applier.modelChanged.addListener",args:["isShowing","{that}.refreshView"]},"onCreate.setInitialState":{listener:"{that}.refreshView"},"onPanelHide.setText":{"this":"{that}.dom.toggleButtonLabel",method:"text",args:["{that}.options.strings.showText"],priority:"first"},"onPanelShow.setText":{"this":"{that}.dom.toggleButtonLabel",method:"text",args:["{that}.options.strings.hideText"],priority:"first"},"onPanelHide.operate":{listener:"{that}.operateHide"},"onPanelShow.operate":{listener:"{that}.operateShow"}},invokers:{operateHide:{"this":"{that}.dom.panel",method:"slideUp",args:["{that}.options.animationDurations.hide","{that}.events.afterPanelHide.fire"]},operateShow:{"this":"{that}.dom.panel",method:"slideDown",args:["{that}.options.animationDurations.show","{that}.events.afterPanelShow.fire"]},hidePanel:{func:"{that}.applier.requestChange",args:["isShowing",!1]},showPanel:{func:"{that}.applier.requestChange",args:["isShowing",!0]},togglePanel:{funcName:"fluid.slidingPanel.togglePanel",args:["{that}"]},refreshView:{funcName:"fluid.slidingPanel.refreshView",args:["{that}"]}},model:{isShowing:!1},animationDurations:{hide:400,show:400}}),b.slidingPanel.togglePanel=function(a){a.applier.requestChange("isShowing",!a.model.isShowing)},b.slidingPanel.refreshView=function(a){a.events[a.model.isShowing?"onPanelShow":"onPanelHide"].fire()}}(jQuery,fluid_2_0_0),function(a,b){a.widget("ui.draggable",a.ui.mouse,{version:"1.10.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(b){var c=this.options;return this.helper||c.disabled||a(b.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(b),this.handle?(a(c.iframeFix===!0?"iframe":c.iframeFix).each(function(){a("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(a(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(b){var c=this.options;return this.helper=this._createHelper(b),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),this._setContainment(),this._trigger("start",b)===!1?(this._clear(),!1):(this._cacheHelperProportions(),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this._mouseDrag(b,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,b),!0)},_mouseDrag:function(b,c){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),!c){var d=this._uiHash();if(this._trigger("drag",b,d)===!1)return this._mouseUp({}),!1;this.position=d.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),!1},_mouseStop:function(b){var c=this,d=!1;return a.ui.ddmanager&&!this.options.dropBehaviour&&(d=a.ui.ddmanager.drop(this,b)),this.dropped&&(d=this.dropped,this.dropped=!1),"original"!==this.options.helper||a.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!d||"valid"===this.options.revert&&d||this.options.revert===!0||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,d)?a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){c._trigger("stop",b)!==!1&&c._clear()}):this._trigger("stop",b)!==!1&&this._clear(),!1):!1},_mouseUp:function(b){return a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b),a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(b){return this.options.handle?!!a(b.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b])):"clone"===c.helper?this.element.clone().removeAttr("id"):this.element;return d.parents("body").length||d.appendTo("parent"===c.appendTo?this.element[0].parentNode:c.appendTo),d[0]===this.element[0]||/(fixed|absolute)/.test(d.css("position"))||d.css("position","absolute"),d},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){var b=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options;return e.containment?"window"===e.containment?void(this.containment=[a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,a(window).scrollLeft()+a(window).width()-this.helperProportions.width-this.margins.left,a(window).scrollTop()+(a(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===e.containment?void(this.containment=[0,0,a(document).width()-this.helperProportions.width-this.margins.left,(a(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):e.containment.constructor===Array?void(this.containment=e.containment):("parent"===e.containment&&(e.containment=this.helper[0].parentNode),c=a(e.containment),d=c[0],void(d&&(b="hidden"!==c.css("overflow"),this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),(b?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(c.css("borderRightWidth"),10)||0)-(parseInt(c.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(b?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(c.css("borderBottomWidth"),10)||0)-(parseInt(c.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=c))):void(this.containment=null)},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"===b?1:-1,e="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:e.scrollTop(),left:e.scrollLeft()}),{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*d,left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*d}},_generatePosition:function(b){var c,d,e,f,g=this.options,h="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=b.pageX,j=b.pageY;return this.offset.scroll||(this.offset.scroll={top:h.scrollTop(),left:h.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(d=this.relative_container.offset(),c=[this.containment[0]+d.left,this.containment[1]+d.top,this.containment[2]+d.left,this.containment[3]+d.top]):c=this.containment,b.pageX-this.offset.click.left<c[0]&&(i=c[0]+this.offset.click.left),b.pageY-this.offset.click.top<c[1]&&(j=c[1]+this.offset.click.top),b.pageX-this.offset.click.left>c[2]&&(i=c[2]+this.offset.click.left),b.pageY-this.offset.click.top>c[3]&&(j=c[3]+this.offset.click.top)),g.grid&&(e=g.grid[1]?this.originalPageY+Math.round((j-this.originalPageY)/g.grid[1])*g.grid[1]:this.originalPageY,j=c?e-this.offset.click.top>=c[1]||e-this.offset.click.top>c[3]?e:e-this.offset.click.top>=c[1]?e-g.grid[1]:e+g.grid[1]:e,f=g.grid[0]?this.originalPageX+Math.round((i-this.originalPageX)/g.grid[0])*g.grid[0]:this.originalPageX,i=c?f-this.offset.click.left>=c[0]||f-this.offset.click.left>c[2]?f:f-this.offset.click.left>=c[0]?f-g.grid[0]:f+g.grid[0]:f)),{top:j-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:i-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(b,c,d){return d=d||this._uiHash(),a.ui.plugin.call(this,b,[c,d]),"drag"===b&&(this.positionAbs=this._convertPositionTo("absolute")),a.Widget.prototype._trigger.call(this,b,c,d)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),a.ui.plugin.add("draggable","connectToSortable",{start:function(b,c){var d=a(this).data("ui-draggable"),e=d.options,f=a.extend({},c,{item:d.element});d.sortables=[],a(e.connectToSortable).each(function(){var c=a.data(this,"ui-sortable");c&&!c.options.disabled&&(d.sortables.push({instance:c,shouldRevert:c.options.revert}),c.refreshPositions(),c._trigger("activate",b,f))})},stop:function(b,c){var d=a(this).data("ui-draggable"),e=a.extend({},c,{item:d.element});a.each(d.sortables,function(){this.instance.isOver?(this.instance.isOver=0,d.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(b),this.instance.options.helper=this.instance.options._helper,"original"===d.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",b,e))})},drag:function(b,c){var d=a(this).data("ui-draggable"),e=this;a.each(d.sortables,function(){var f=!1,g=this;this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(f=!0,a.each(d.sortables,function(){return this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this!==g&&this.instance._intersectsWith(this.instance.containerCache)&&a.contains(g.instance.element[0],this.instance.element[0])&&(f=!1),f})),f?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(e).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return c.helper[0]},b.target=this.instance.currentItem[0],this.instance._mouseCapture(b,!0),this.instance._mouseStart(b,!0,!0),this.instance.offset.click.top=d.offset.click.top,this.instance.offset.click.left=d.offset.click.left,this.instance.offset.parent.left-=d.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=d.offset.parent.top-this.instance.offset.parent.top,d._trigger("toSortable",b),d.dropped=this.instance.element,d.currentItem=d.element,this.instance.fromOutside=d),this.instance.currentItem&&this.instance._mouseDrag(b)):this.instance.isOver&&(this.instance.isOver=0,
this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",b,this.instance._uiHash(this.instance)),this.instance._mouseStop(b,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),d._trigger("fromSortable",b),d.dropped=!1)})}}),a.ui.plugin.add("draggable","cursor",{start:function(){var b=a("body"),c=a(this).data("ui-draggable").options;b.css("cursor")&&(c._cursor=b.css("cursor")),b.css("cursor",c.cursor)},stop:function(){var b=a(this).data("ui-draggable").options;b._cursor&&a("body").css("cursor",b._cursor)}}),a.ui.plugin.add("draggable","opacity",{start:function(b,c){var d=a(c.helper),e=a(this).data("ui-draggable").options;d.css("opacity")&&(e._opacity=d.css("opacity")),d.css("opacity",e.opacity)},stop:function(b,c){var d=a(this).data("ui-draggable").options;d._opacity&&a(c.helper).css("opacity",d._opacity)}}),a.ui.plugin.add("draggable","scroll",{start:function(){var b=a(this).data("ui-draggable");b.scrollParent[0]!==document&&"HTML"!==b.scrollParent[0].tagName&&(b.overflowOffset=b.scrollParent.offset())},drag:function(b){var c=a(this).data("ui-draggable"),d=c.options,e=!1;c.scrollParent[0]!==document&&"HTML"!==c.scrollParent[0].tagName?(d.axis&&"x"===d.axis||(c.overflowOffset.top+c.scrollParent[0].offsetHeight-b.pageY<d.scrollSensitivity?c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop+d.scrollSpeed:b.pageY-c.overflowOffset.top<d.scrollSensitivity&&(c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop-d.scrollSpeed)),d.axis&&"y"===d.axis||(c.overflowOffset.left+c.scrollParent[0].offsetWidth-b.pageX<d.scrollSensitivity?c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft+d.scrollSpeed:b.pageX-c.overflowOffset.left<d.scrollSensitivity&&(c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft-d.scrollSpeed))):(d.axis&&"x"===d.axis||(b.pageY-a(document).scrollTop()<d.scrollSensitivity?e=a(document).scrollTop(a(document).scrollTop()-d.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<d.scrollSensitivity&&(e=a(document).scrollTop(a(document).scrollTop()+d.scrollSpeed))),d.axis&&"y"===d.axis||(b.pageX-a(document).scrollLeft()<d.scrollSensitivity?e=a(document).scrollLeft(a(document).scrollLeft()-d.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<d.scrollSensitivity&&(e=a(document).scrollLeft(a(document).scrollLeft()+d.scrollSpeed)))),e!==!1&&a.ui.ddmanager&&!d.dropBehaviour&&a.ui.ddmanager.prepareOffsets(c,b)}}),a.ui.plugin.add("draggable","snap",{start:function(){var b=a(this).data("ui-draggable"),c=b.options;b.snapElements=[],a(c.snap.constructor!==String?c.snap.items||":data(ui-draggable)":c.snap).each(function(){var c=a(this),d=c.offset();this!==b.element[0]&&b.snapElements.push({item:this,width:c.outerWidth(),height:c.outerHeight(),top:d.top,left:d.left})})},drag:function(b,c){var d,e,f,g,h,i,j,k,l,m,n=a(this).data("ui-draggable"),o=n.options,p=o.snapTolerance,q=c.offset.left,r=q+n.helperProportions.width,s=c.offset.top,t=s+n.helperProportions.height;for(l=n.snapElements.length-1;l>=0;l--)h=n.snapElements[l].left,i=h+n.snapElements[l].width,j=n.snapElements[l].top,k=j+n.snapElements[l].height,h-p>r||q>i+p||j-p>t||s>k+p||!a.contains(n.snapElements[l].item.ownerDocument,n.snapElements[l].item)?(n.snapElements[l].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,b,a.extend(n._uiHash(),{snapItem:n.snapElements[l].item})),n.snapElements[l].snapping=!1):("inner"!==o.snapMode&&(d=Math.abs(j-t)<=p,e=Math.abs(k-s)<=p,f=Math.abs(h-r)<=p,g=Math.abs(i-q)<=p,d&&(c.position.top=n._convertPositionTo("relative",{top:j-n.helperProportions.height,left:0}).top-n.margins.top),e&&(c.position.top=n._convertPositionTo("relative",{top:k,left:0}).top-n.margins.top),f&&(c.position.left=n._convertPositionTo("relative",{top:0,left:h-n.helperProportions.width}).left-n.margins.left),g&&(c.position.left=n._convertPositionTo("relative",{top:0,left:i}).left-n.margins.left)),m=d||e||f||g,"outer"!==o.snapMode&&(d=Math.abs(j-s)<=p,e=Math.abs(k-t)<=p,f=Math.abs(h-q)<=p,g=Math.abs(i-r)<=p,d&&(c.position.top=n._convertPositionTo("relative",{top:j,left:0}).top-n.margins.top),e&&(c.position.top=n._convertPositionTo("relative",{top:k-n.helperProportions.height,left:0}).top-n.margins.top),f&&(c.position.left=n._convertPositionTo("relative",{top:0,left:h}).left-n.margins.left),g&&(c.position.left=n._convertPositionTo("relative",{top:0,left:i-n.helperProportions.width}).left-n.margins.left)),!n.snapElements[l].snapping&&(d||e||f||g||m)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,b,a.extend(n._uiHash(),{snapItem:n.snapElements[l].item})),n.snapElements[l].snapping=d||e||f||g||m)}}),a.ui.plugin.add("draggable","stack",{start:function(){var b,c=this.data("ui-draggable").options,d=a.makeArray(a(c.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});d.length&&(b=parseInt(a(d[0]).css("zIndex"),10)||0,a(d).each(function(c){a(this).css("zIndex",b+c)}),this.css("zIndex",b+d.length))}}),a.ui.plugin.add("draggable","zIndex",{start:function(b,c){var d=a(c.helper),e=a(this).data("ui-draggable").options;d.css("zIndex")&&(e._zIndex=d.css("zIndex")),d.css("zIndex",e.zIndex)},stop:function(b,c){var d=a(this).data("ui-draggable").options;d._zIndex&&a(c.helper).css("zIndex",d._zIndex)}})}(jQuery),function(a,b){function c(a){return parseInt(a,10)||0}function d(a){return!isNaN(parseInt(a,10))}a.widget("ui.resizable",a.ui.mouse,{version:"1.10.4",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var b,c,d,e,f,g=this,h=this.options;if(this.element.addClass("ui-resizable"),a.extend(this,{_aspectRatio:!!h.aspectRatio,aspectRatio:h.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:h.helper||h.ghost||h.animate?h.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(a("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=h.handles||(a(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),b=this.handles.split(","),this.handles={},c=0;c<b.length;c++)d=a.trim(b[c]),f="ui-resizable-"+d,e=a("<div class='ui-resizable-handle "+f+"'></div>"),e.css({zIndex:h.zIndex}),"se"===d&&e.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[d]=".ui-resizable-"+d,this.element.append(e);this._renderAxis=function(b){var c,d,e,f;b=b||this.element;for(c in this.handles)this.handles[c].constructor===String&&(this.handles[c]=a(this.handles[c],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(d=a(this.handles[c],this.element),f=/sw|ne|nw|se|n|s/.test(c)?d.outerHeight():d.outerWidth(),e=["padding",/ne|nw|n/.test(c)?"Top":/se|sw|s/.test(c)?"Bottom":/^e$/.test(c)?"Right":"Left"].join(""),b.css(e,f),this._proportionallyResize()),a(this.handles[c]).length},this._renderAxis(this.element),this._handles=a(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){g.resizing||(this.className&&(e=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),g.axis=e&&e[1]?e[1]:"se")}),h.autoHide&&(this._handles.hide(),a(this.element).addClass("ui-resizable-autohide").mouseenter(function(){h.disabled||(a(this).removeClass("ui-resizable-autohide"),g._handles.show())}).mouseleave(function(){h.disabled||g.resizing||(a(this).addClass("ui-resizable-autohide"),g._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var b,c=function(b){a(b).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(c(this.element),b=this.element,this.originalElement.css({position:b.css("position"),width:b.outerWidth(),height:b.outerHeight(),top:b.css("top"),left:b.css("left")}).insertAfter(b),b.remove()),this.originalElement.css("resize",this.originalResizeStyle),c(this.originalElement),this},_mouseCapture:function(b){var c,d,e=!1;for(c in this.handles)d=a(this.handles[c])[0],(d===b.target||a.contains(d,b.target))&&(e=!0);return!this.options.disabled&&e},_mouseStart:function(b){var d,e,f,g=this.options,h=this.element.position(),i=this.element;return this.resizing=!0,/absolute/.test(i.css("position"))?i.css({position:"absolute",top:i.css("top"),left:i.css("left")}):i.is(".ui-draggable")&&i.css({position:"absolute",top:h.top,left:h.left}),this._renderProxy(),d=c(this.helper.css("left")),e=c(this.helper.css("top")),g.containment&&(d+=a(g.containment).scrollLeft()||0,e+=a(g.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:d,top:e},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:i.width(),height:i.height()},this.originalSize=this._helper?{width:i.outerWidth(),height:i.outerHeight()}:{width:i.width(),height:i.height()},this.originalPosition={left:d,top:e},this.sizeDiff={width:i.outerWidth()-i.width(),height:i.outerHeight()-i.height()},this.originalMousePosition={left:b.pageX,top:b.pageY},this.aspectRatio="number"==typeof g.aspectRatio?g.aspectRatio:this.originalSize.width/this.originalSize.height||1,f=a(".ui-resizable-"+this.axis).css("cursor"),a("body").css("cursor","auto"===f?this.axis+"-resize":f),i.addClass("ui-resizable-resizing"),this._propagate("start",b),!0},_mouseDrag:function(b){var c,d=this.helper,e={},f=this.originalMousePosition,g=this.axis,h=this.position.top,i=this.position.left,j=this.size.width,k=this.size.height,l=b.pageX-f.left||0,m=b.pageY-f.top||0,n=this._change[g];return n?(c=n.apply(this,[b,l,m]),this._updateVirtualBoundaries(b.shiftKey),(this._aspectRatio||b.shiftKey)&&(c=this._updateRatio(c,b)),c=this._respectSize(c,b),this._updateCache(c),this._propagate("resize",b),this.position.top!==h&&(e.top=this.position.top+"px"),this.position.left!==i&&(e.left=this.position.left+"px"),this.size.width!==j&&(e.width=this.size.width+"px"),this.size.height!==k&&(e.height=this.size.height+"px"),d.css(e),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),a.isEmptyObject(e)||this._trigger("resize",b,this.ui()),!1):!1},_mouseStop:function(b){this.resizing=!1;var c,d,e,f,g,h,i,j=this.options,k=this;return this._helper&&(c=this._proportionallyResizeElements,d=c.length&&/textarea/i.test(c[0].nodeName),e=d&&a.ui.hasScroll(c[0],"left")?0:k.sizeDiff.height,f=d?0:k.sizeDiff.width,g={width:k.helper.width()-f,height:k.helper.height()-e},h=parseInt(k.element.css("left"),10)+(k.position.left-k.originalPosition.left)||null,i=parseInt(k.element.css("top"),10)+(k.position.top-k.originalPosition.top)||null,j.animate||this.element.css(a.extend(g,{top:i,left:h})),k.helper.height(k.size.height),k.helper.width(k.size.width),this._helper&&!j.animate&&this._proportionallyResize()),a("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",b),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(a){var b,c,e,f,g,h=this.options;g={minWidth:d(h.minWidth)?h.minWidth:0,maxWidth:d(h.maxWidth)?h.maxWidth:1/0,minHeight:d(h.minHeight)?h.minHeight:0,maxHeight:d(h.maxHeight)?h.maxHeight:1/0},(this._aspectRatio||a)&&(b=g.minHeight*this.aspectRatio,e=g.minWidth/this.aspectRatio,c=g.maxHeight*this.aspectRatio,f=g.maxWidth/this.aspectRatio,b>g.minWidth&&(g.minWidth=b),e>g.minHeight&&(g.minHeight=e),c<g.maxWidth&&(g.maxWidth=c),f<g.maxHeight&&(g.maxHeight=f)),this._vBoundaries=g},_updateCache:function(a){this.offset=this.helper.offset(),d(a.left)&&(this.position.left=a.left),d(a.top)&&(this.position.top=a.top),d(a.height)&&(this.size.height=a.height),d(a.width)&&(this.size.width=a.width)},_updateRatio:function(a){var b=this.position,c=this.size,e=this.axis;return d(a.height)?a.width=a.height*this.aspectRatio:d(a.width)&&(a.height=a.width/this.aspectRatio),"sw"===e&&(a.left=b.left+(c.width-a.width),a.top=null),"nw"===e&&(a.top=b.top+(c.height-a.height),a.left=b.left+(c.width-a.width)),a},_respectSize:function(a){var b=this._vBoundaries,c=this.axis,e=d(a.width)&&b.maxWidth&&b.maxWidth<a.width,f=d(a.height)&&b.maxHeight&&b.maxHeight<a.height,g=d(a.width)&&b.minWidth&&b.minWidth>a.width,h=d(a.height)&&b.minHeight&&b.minHeight>a.height,i=this.originalPosition.left+this.originalSize.width,j=this.position.top+this.size.height,k=/sw|nw|w/.test(c),l=/nw|ne|n/.test(c);return g&&(a.width=b.minWidth),h&&(a.height=b.minHeight),e&&(a.width=b.maxWidth),f&&(a.height=b.maxHeight),g&&k&&(a.left=i-b.minWidth),e&&k&&(a.left=i-b.maxWidth),h&&l&&(a.top=j-b.minHeight),f&&l&&(a.top=j-b.maxHeight),a.width||a.height||a.left||!a.top?a.width||a.height||a.top||!a.left||(a.left=null):a.top=null,a},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var a,b,c,d,e,f=this.helper||this.element;for(a=0;a<this._proportionallyResizeElements.length;a++){if(e=this._proportionallyResizeElements[a],!this.borderDif)for(this.borderDif=[],c=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],d=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")],b=0;b<c.length;b++)this.borderDif[b]=(parseInt(c[b],10)||0)+(parseInt(d[b],10)||0);e.css({height:f.height()-this.borderDif[0]-this.borderDif[2]||0,width:f.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var b=this.element,c=this.options;this.elementOffset=b.offset(),this._helper?(this.helper=this.helper||a("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++c.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(a,b){return{width:this.originalSize.width+b}},w:function(a,b){var c=this.originalSize,d=this.originalPosition;return{left:d.left+b,width:c.width-b}},n:function(a,b,c){var d=this.originalSize,e=this.originalPosition;return{top:e.top+c,height:d.height-c}},s:function(a,b,c){return{height:this.originalSize.height+c}},se:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},sw:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[b,c,d]))},ne:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},nw:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[b,c,d]))}},_propagate:function(b,c){a.ui.plugin.call(this,b,[c,this.ui()]),"resize"!==b&&this._trigger(b,c,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),a.ui.plugin.add("resizable","animate",{stop:function(b){var c=a(this).data("ui-resizable"),d=c.options,e=c._proportionallyResizeElements,f=e.length&&/textarea/i.test(e[0].nodeName),g=f&&a.ui.hasScroll(e[0],"left")?0:c.sizeDiff.height,h=f?0:c.sizeDiff.width,i={width:c.size.width-h,height:c.size.height-g},j=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null,k=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null;c.element.animate(a.extend(i,k&&j?{top:k,left:j}:{}),{duration:d.animateDuration,easing:d.animateEasing,step:function(){var d={width:parseInt(c.element.css("width"),10),height:parseInt(c.element.css("height"),10),top:parseInt(c.element.css("top"),10),left:parseInt(c.element.css("left"),10)};e&&e.length&&a(e[0]).css({width:d.width,height:d.height}),c._updateCache(d),c._propagate("resize",b)}})}}),a.ui.plugin.add("resizable","containment",{start:function(){var b,d,e,f,g,h,i,j=a(this).data("ui-resizable"),k=j.options,l=j.element,m=k.containment,n=m instanceof a?m.get(0):/parent/.test(m)?l.parent().get(0):m;n&&(j.containerElement=a(n),/document/.test(m)||m===document?(j.containerOffset={left:0,top:0},j.containerPosition={left:0,top:0},j.parentData={element:a(document),left:0,top:0,width:a(document).width(),height:a(document).height()||document.body.parentNode.scrollHeight}):(b=a(n),d=[],a(["Top","Right","Left","Bottom"]).each(function(a,e){d[a]=c(b.css("padding"+e))}),j.containerOffset=b.offset(),j.containerPosition=b.position(),j.containerSize={height:b.innerHeight()-d[3],width:b.innerWidth()-d[1]},e=j.containerOffset,f=j.containerSize.height,g=j.containerSize.width,h=a.ui.hasScroll(n,"left")?n.scrollWidth:g,i=a.ui.hasScroll(n)?n.scrollHeight:f,j.parentData={element:n,left:e.left,top:e.top,width:h,height:i}))},resize:function(b){var c,d,e,f,g=a(this).data("ui-resizable"),h=g.options,i=g.containerOffset,j=g.position,k=g._aspectRatio||b.shiftKey,l={top:0,left:0},m=g.containerElement;m[0]!==document&&/static/.test(m.css("position"))&&(l=i),j.left<(g._helper?i.left:0)&&(g.size.width=g.size.width+(g._helper?g.position.left-i.left:g.position.left-l.left),k&&(g.size.height=g.size.width/g.aspectRatio),g.position.left=h.helper?i.left:0),j.top<(g._helper?i.top:0)&&(g.size.height=g.size.height+(g._helper?g.position.top-i.top:g.position.top),k&&(g.size.width=g.size.height*g.aspectRatio),g.position.top=g._helper?i.top:0),g.offset.left=g.parentData.left+g.position.left,g.offset.top=g.parentData.top+g.position.top,c=Math.abs((g._helper?g.offset.left-l.left:g.offset.left-l.left)+g.sizeDiff.width),d=Math.abs((g._helper?g.offset.top-l.top:g.offset.top-i.top)+g.sizeDiff.height),e=g.containerElement.get(0)===g.element.parent().get(0),f=/relative|absolute/.test(g.containerElement.css("position")),e&&f&&(c-=Math.abs(g.parentData.left)),c+g.size.width>=g.parentData.width&&(g.size.width=g.parentData.width-c,k&&(g.size.height=g.size.width/g.aspectRatio)),d+g.size.height>=g.parentData.height&&(g.size.height=g.parentData.height-d,k&&(g.size.width=g.size.height*g.aspectRatio))},stop:function(){var b=a(this).data("ui-resizable"),c=b.options,d=b.containerOffset,e=b.containerPosition,f=b.containerElement,g=a(b.helper),h=g.offset(),i=g.outerWidth()-b.sizeDiff.width,j=g.outerHeight()-b.sizeDiff.height;b._helper&&!c.animate&&/relative/.test(f.css("position"))&&a(this).css({left:h.left-e.left-d.left,width:i,height:j}),b._helper&&!c.animate&&/static/.test(f.css("position"))&&a(this).css({left:h.left-e.left-d.left,width:i,height:j})}}),a.ui.plugin.add("resizable","alsoResize",{start:function(){var b=a(this).data("ui-resizable"),c=b.options,d=function(b){a(b).each(function(){var b=a(this);b.data("ui-resizable-alsoresize",{width:parseInt(b.width(),10),height:parseInt(b.height(),10),left:parseInt(b.css("left"),10),top:parseInt(b.css("top"),10)})})};"object"!=typeof c.alsoResize||c.alsoResize.parentNode?d(c.alsoResize):c.alsoResize.length?(c.alsoResize=c.alsoResize[0],d(c.alsoResize)):a.each(c.alsoResize,function(a){d(a)})},resize:function(b,c){var d=a(this).data("ui-resizable"),e=d.options,f=d.originalSize,g=d.originalPosition,h={height:d.size.height-f.height||0,width:d.size.width-f.width||0,top:d.position.top-g.top||0,left:d.position.left-g.left||0},i=function(b,d){a(b).each(function(){var b=a(this),e=a(this).data("ui-resizable-alsoresize"),f={},g=d&&d.length?d:b.parents(c.originalElement[0]).length?["width","height"]:["width","height","top","left"];a.each(g,function(a,b){var c=(e[b]||0)+(h[b]||0);c&&c>=0&&(f[b]=c||null)}),b.css(f)})};"object"!=typeof e.alsoResize||e.alsoResize.nodeType?i(e.alsoResize):a.each(e.alsoResize,function(a,b){i(a,b)})},stop:function(){a(this).removeData("resizable-alsoresize")}}),a.ui.plugin.add("resizable","ghost",{start:function(){var b=a(this).data("ui-resizable"),c=b.options,d=b.size;b.ghost=b.originalElement.clone(),b.ghost.css({opacity:.25,display:"block",position:"relative",height:d.height,width:d.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof c.ghost?c.ghost:""),b.ghost.appendTo(b.helper)},resize:function(){var b=a(this).data("ui-resizable");b.ghost&&b.ghost.css({position:"relative",height:b.size.height,width:b.size.width})},stop:function(){var b=a(this).data("ui-resizable");b.ghost&&b.helper&&b.helper.get(0).removeChild(b.ghost.get(0))}}),a.ui.plugin.add("resizable","grid",{resize:function(){var b=a(this).data("ui-resizable"),c=b.options,d=b.size,e=b.originalSize,f=b.originalPosition,g=b.axis,h="number"==typeof c.grid?[c.grid,c.grid]:c.grid,i=h[0]||1,j=h[1]||1,k=Math.round((d.width-e.width)/i)*i,l=Math.round((d.height-e.height)/j)*j,m=e.width+k,n=e.height+l,o=c.maxWidth&&c.maxWidth<m,p=c.maxHeight&&c.maxHeight<n,q=c.minWidth&&c.minWidth>m,r=c.minHeight&&c.minHeight>n;c.grid=h,q&&(m+=i),r&&(n+=j),o&&(m-=i),p&&(n-=j),/^(se|s|e)$/.test(g)?(b.size.width=m,b.size.height=n):/^(ne)$/.test(g)?(b.size.width=m,b.size.height=n,b.position.top=f.top-l):/^(sw)$/.test(g)?(b.size.width=m,b.size.height=n,b.position.left=f.left-k):(n-j>0?(b.size.height=n,b.position.top=f.top-l):(b.size.height=j,b.position.top=f.top+e.height-j),m-i>0?(b.size.width=m,b.position.left=f.left-k):(b.size.width=i,b.position.left=f.left+e.width-i))}})}(jQuery),function(a,b){var c,d="ui-button ui-widget ui-state-default ui-corner-all",e="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",f=function(){var b=a(this);setTimeout(function(){b.find(":ui-button").button("refresh")},1)},g=function(b){var c=b.name,d=b.form,e=a([]);return c&&(c=c.replace(/'/g,"\\'"),e=d?a(d).find("[name='"+c+"']"):a("[name='"+c+"']",b.ownerDocument).filter(function(){return!this.form})),e};a.widget("ui.button",{version:"1.10.4",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,f),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var b=this,e=this.options,h="checkbox"===this.type||"radio"===this.type,i=h?"":"ui-state-active";null===e.label&&(e.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(d).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){e.disabled||this===c&&a(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){e.disabled||a(this).removeClass(i)}).bind("click"+this.eventNamespace,function(a){e.disabled&&(a.preventDefault(),a.stopImmediatePropagation())}),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),h&&this.element.bind("change"+this.eventNamespace,function(){b.refresh()}),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return e.disabled?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(e.disabled)return!1;a(this).addClass("ui-state-active"),b.buttonElement.attr("aria-pressed","true");var c=b.element[0];g(c).not(c).map(function(){return a(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return e.disabled?!1:(a(this).addClass("ui-state-active"),c=this,void b.document.one("mouseup",function(){c=null}))}).bind("mouseup"+this.eventNamespace,function(){return e.disabled?!1:void a(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(b){return e.disabled?!1:void(b.keyCode!==a.ui.keyCode.SPACE&&b.keyCode!==a.ui.keyCode.ENTER||a(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){a(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(b){b.keyCode===a.ui.keyCode.SPACE&&a(this).click()})),this._setOption("disabled",e.disabled),this._resetButton()},_determineButtonType:function(){var a,b,c;this.element.is("[type=checkbox]")?this.type="checkbox":this.element.is("[type=radio]")?this.type="radio":this.element.is("input")?this.type="input":this.type="button","checkbox"===this.type||"radio"===this.type?(a=this.element.parents().last(),b="label[for='"+this.element.attr("id")+"']",this.buttonElement=a.find(b),this.buttonElement.length||(a=a.length?a.siblings():this.element.siblings(),this.buttonElement=a.filter(b),this.buttonElement.length||(this.buttonElement=a.find(b))),this.element.addClass("ui-helper-hidden-accessible"),c=this.element.is(":checked"),c&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",c)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(d+" ui-state-active "+e).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(a,b){return this._super(a,b),"disabled"===a?(this.element.prop("disabled",!!b),void(b&&this.buttonElement.removeClass("ui-state-focus"))):void this._resetButton()},refresh:function(){var b=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");b!==this.options.disabled&&this._setOption("disabled",b),"radio"===this.type?g(this.element[0]).each(function(){a(this).is(":checked")?a(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):a(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return void(this.options.label&&this.element.val(this.options.label));var b=this.buttonElement.removeClass(e),c=a("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(b.empty()).text(),d=this.options.icons,f=d.primary&&d.secondary,g=[];d.primary||d.secondary?(this.options.text&&g.push("ui-button-text-icon"+(f?"s":d.primary?"-primary":"-secondary")),d.primary&&b.prepend("<span class='ui-button-icon-primary ui-icon "+d.primary+"'></span>"),d.secondary&&b.append("<span class='ui-button-icon-secondary ui-icon "+d.secondary+"'></span>"),this.options.text||(g.push(f?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||b.attr("title",a.trim(c)))):g.push("ui-button-text-only"),b.addClass(g.join(" "))}}),a.widget("ui.buttonset",{version:"1.10.4",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(a,b){"disabled"===a&&this.buttons.button("option",a,b),this._super(a,b)},refresh:function(){var b="rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(b?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(b?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery),function(a,b){var c={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},d={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};a.widget("ui.dialog",{version:"1.10.4",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(b){var c=a(this).css(b).offset().top;0>c&&a(this).css("top",b.top-c)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&a.fn.draggable&&this._makeDraggable(),this.options.resizable&&a.fn.resizable&&this._makeResizable(),this._isOpen=!1},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var b=this.options.appendTo;return b&&(b.jquery||b.nodeType)?a(b):this.document.find(b||"body").eq(0)},_destroy:function(){var a,b=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),a=b.parent.children().eq(b.index),a.length&&a[0]!==this.element[0]?a.before(this.element):b.parent.append(this.element)},widget:function(){return this.uiDialog},disable:a.noop,enable:a.noop,close:function(b){var c,d=this;if(this._isOpen&&this._trigger("beforeClose",b)!==!1){if(this._isOpen=!1,this._destroyOverlay(),!this.opener.filter(":focusable").focus().length)try{c=this.document[0].activeElement,c&&"body"!==c.nodeName.toLowerCase()&&a(c).blur()}catch(e){}this._hide(this.uiDialog,this.options.hide,function(){d._trigger("close",b)})}},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop();
},_moveToTop:function(a,b){var c=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;return c&&!b&&this._trigger("focus",a),c},open:function(){var b=this;return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this._isOpen=!0,this.opener=a(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this._show(this.uiDialog,this.options.show,function(){b._focusTabbable(),b._trigger("focus")}),void this._trigger("open"))},_focusTabbable:function(){var a=this.element.find("[autofocus]");a.length||(a=this.element.find(":tabbable")),a.length||(a=this.uiDialogButtonPane.find(":tabbable")),a.length||(a=this.uiDialogTitlebarClose.filter(":tabbable")),a.length||(a=this.uiDialog),a.eq(0).focus()},_keepFocus:function(b){function c(){var b=this.document[0].activeElement,c=this.uiDialog[0]===b||a.contains(this.uiDialog[0],b);c||this._focusTabbable()}b.preventDefault(),c.call(this),this._delay(c)},_createWrapper:function(){this.uiDialog=a("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(b){if(this.options.closeOnEscape&&!b.isDefaultPrevented()&&b.keyCode&&b.keyCode===a.ui.keyCode.ESCAPE)return b.preventDefault(),void this.close(b);if(b.keyCode===a.ui.keyCode.TAB){var c=this.uiDialog.find(":tabbable"),d=c.filter(":first"),e=c.filter(":last");b.target!==e[0]&&b.target!==this.uiDialog[0]||b.shiftKey?b.target!==d[0]&&b.target!==this.uiDialog[0]||!b.shiftKey||(e.focus(1),b.preventDefault()):(d.focus(1),b.preventDefault())}},mousedown:function(a){this._moveToTop(a)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var b;this.uiDialogTitlebar=a("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(b){a(b.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=a("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(a){a.preventDefault(),this.close(a)}}),b=a("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(b),this.uiDialog.attr({"aria-labelledby":b.attr("id")})},_title:function(a){this.options.title||a.html("&#160;"),a.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=a("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=a("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var b=this,c=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),a.isEmptyObject(c)||a.isArray(c)&&!c.length?void this.uiDialog.removeClass("ui-dialog-buttons"):(a.each(c,function(c,d){var e,f;d=a.isFunction(d)?{click:d,text:c}:d,d=a.extend({type:"button"},d),e=d.click,d.click=function(){e.apply(b.element[0],arguments)},f={icons:d.icons,text:d.showText},delete d.icons,delete d.showText,a("<button></button>",d).button(f).appendTo(b.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),void this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function b(a){return{position:a.position,offset:a.offset}}var c=this,d=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(d,e){a(this).addClass("ui-dialog-dragging"),c._blockFrames(),c._trigger("dragStart",d,b(e))},drag:function(a,d){c._trigger("drag",a,b(d))},stop:function(e,f){d.position=[f.position.left-c.document.scrollLeft(),f.position.top-c.document.scrollTop()],a(this).removeClass("ui-dialog-dragging"),c._unblockFrames(),c._trigger("dragStop",e,b(f))}})},_makeResizable:function(){function b(a){return{originalPosition:a.originalPosition,originalSize:a.originalSize,position:a.position,size:a.size}}var c=this,d=this.options,e=d.resizable,f=this.uiDialog.css("position"),g="string"==typeof e?e:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:d.maxWidth,maxHeight:d.maxHeight,minWidth:d.minWidth,minHeight:this._minHeight(),handles:g,start:function(d,e){a(this).addClass("ui-dialog-resizing"),c._blockFrames(),c._trigger("resizeStart",d,b(e))},resize:function(a,d){c._trigger("resize",a,b(d))},stop:function(e,f){d.height=a(this).height(),d.width=a(this).width(),a(this).removeClass("ui-dialog-resizing"),c._unblockFrames(),c._trigger("resizeStop",e,b(f))}}).css("position",f)},_minHeight:function(){var a=this.options;return"auto"===a.height?a.minHeight:Math.min(a.minHeight,a.height)},_position:function(){var a=this.uiDialog.is(":visible");a||this.uiDialog.show(),this.uiDialog.position(this.options.position),a||this.uiDialog.hide()},_setOptions:function(b){var e=this,f=!1,g={};a.each(b,function(a,b){e._setOption(a,b),a in c&&(f=!0),a in d&&(g[a]=b)}),f&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",g)},_setOption:function(a,b){var c,d,e=this.uiDialog;"dialogClass"===a&&e.removeClass(this.options.dialogClass).addClass(b),"disabled"!==a&&(this._super(a,b),"appendTo"===a&&this.uiDialog.appendTo(this._appendTo()),"buttons"===a&&this._createButtons(),"closeText"===a&&this.uiDialogTitlebarClose.button({label:""+b}),"draggable"===a&&(c=e.is(":data(ui-draggable)"),c&&!b&&e.draggable("destroy"),!c&&b&&this._makeDraggable()),"position"===a&&this._position(),"resizable"===a&&(d=e.is(":data(ui-resizable)"),d&&!b&&e.resizable("destroy"),d&&"string"==typeof b&&e.resizable("option","handles",b),d||b===!1||this._makeResizable()),"title"===a&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var a,b,c,d=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),d.minWidth>d.width&&(d.width=d.minWidth),a=this.uiDialog.css({height:"auto",width:d.width}).outerHeight(),b=Math.max(0,d.minHeight-a),c="number"==typeof d.maxHeight?Math.max(0,d.maxHeight-a):"none","auto"===d.height?this.element.css({minHeight:b,maxHeight:c,height:"auto"}):this.element.height(Math.max(0,d.height-a)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var b=a(this);return a("<div>").css({position:"absolute",width:b.outerWidth(),height:b.outerHeight()}).appendTo(b.parent()).offset(b.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(b){return a(b.target).closest(".ui-dialog").length?!0:!!a(b.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var b=this,c=this.widgetFullName;a.ui.dialog.overlayInstances||this._delay(function(){a.ui.dialog.overlayInstances&&this.document.bind("focusin.dialog",function(d){b._allowInteraction(d)||(d.preventDefault(),a(".ui-dialog:visible:last .ui-dialog-content").data(c)._focusTabbable())})}),this.overlay=a("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),a.ui.dialog.overlayInstances++}},_destroyOverlay:function(){this.options.modal&&this.overlay&&(a.ui.dialog.overlayInstances--,a.ui.dialog.overlayInstances||this.document.unbind("focusin.dialog"),this.overlay.remove(),this.overlay=null)}}),a.ui.dialog.overlayInstances=0,a.uiBackCompat!==!1&&a.widget("ui.dialog",a.ui.dialog,{_position:function(){var b,c=this.options.position,d=[],e=[0,0];c?(("string"==typeof c||"object"==typeof c&&"0"in c)&&(d=c.split?c.split(" "):[c[0],c[1]],1===d.length&&(d[1]=d[0]),a.each(["left","top"],function(a,b){+d[a]===d[a]&&(e[a]=d[a],d[a]=b)}),c={my:d[0]+(e[0]<0?e[0]:"+"+e[0])+" "+d[1]+(e[1]<0?e[1]:"+"+e[1]),at:d.join(" ")}),c=a.extend({},a.ui.dialog.prototype.options.position,c)):c=a.ui.dialog.prototype.options.position,b=this.uiDialog.is(":visible"),b||this.uiDialog.show(),this.uiDialog.position(c),b||this.uiDialog.hide()}})}(jQuery),function(a,b){var c=5;a.widget("ui.slider",a.ui.mouse,{version:"1.10.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var b,c,d=this.options,e=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),f="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",g=[];for(c=d.values&&d.values.length||1,e.length>c&&(e.slice(c).remove(),e=e.slice(0,c)),b=e.length;c>b;b++)g.push(f);this.handles=e.add(a(g.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(b){a(this).data("ui-slider-handle-index",b)})},_createRange:function(){var b=this.options,c="";b.range?(b.range===!0&&(b.values?b.values.length&&2!==b.values.length?b.values=[b.values[0],b.values[0]]:a.isArray(b.values)&&(b.values=b.values.slice(0)):b.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=a("<div></div>").appendTo(this.element),c="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(c+("min"===b.range||"max"===b.range?" ui-slider-range-"+b.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){var a=this.handles.add(this.range).filter("a");this._off(a),this._on(a,this._handleEvents),this._hoverable(a),this._focusable(a)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(b){var c,d,e,f,g,h,i,j,k=this,l=this.options;return l.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),c={x:b.pageX,y:b.pageY},d=this._normValueFromMouse(c),e=this._valueMax()-this._valueMin()+1,this.handles.each(function(b){var c=Math.abs(d-k.values(b));(e>c||e===c&&(b===k._lastChangedValue||k.values(b)===l.min))&&(e=c,f=a(this),g=b)}),h=this._start(b,g),h===!1?!1:(this._mouseSliding=!0,this._handleIndex=g,f.addClass("ui-state-active").focus(),i=f.offset(),j=!a(b.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=j?{left:0,top:0}:{left:b.pageX-i.left-f.width()/2,top:b.pageY-i.top-f.height()/2-(parseInt(f.css("borderTopWidth"),10)||0)-(parseInt(f.css("borderBottomWidth"),10)||0)+(parseInt(f.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(b,g,d),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(a){var b={x:a.pageX,y:a.pageY},c=this._normValueFromMouse(b);return this._slide(a,this._handleIndex,c),!1},_mouseStop:function(a){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(a,this._handleIndex),this._change(a,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(a){var b,c,d,e,f;return"horizontal"===this.orientation?(b=this.elementSize.width,c=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(b=this.elementSize.height,c=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),d=c/b,d>1&&(d=1),0>d&&(d=0),"vertical"===this.orientation&&(d=1-d),e=this._valueMax()-this._valueMin(),f=this._valueMin()+d*e,this._trimAlignValue(f)},_start:function(a,b){var c={handle:this.handles[b],value:this.value()};return this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("start",a,c)},_slide:function(a,b,c){var d,e,f;this.options.values&&this.options.values.length?(d=this.values(b?0:1),2===this.options.values.length&&this.options.range===!0&&(0===b&&c>d||1===b&&d>c)&&(c=d),c!==this.values(b)&&(e=this.values(),e[b]=c,f=this._trigger("slide",a,{handle:this.handles[b],value:c,values:e}),d=this.values(b?0:1),f!==!1&&this.values(b,c))):c!==this.value()&&(f=this._trigger("slide",a,{handle:this.handles[b],value:c}),f!==!1&&this.value(c))},_stop:function(a,b){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("stop",a,c)},_change:function(a,b){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._lastChangedValue=b,this._trigger("change",a,c)}},value:function(a){return arguments.length?(this.options.value=this._trimAlignValue(a),this._refreshValue(),void this._change(null,0)):this._value()},values:function(b,c){var d,e,f;if(arguments.length>1)return this.options.values[b]=this._trimAlignValue(c),this._refreshValue(),void this._change(null,b);if(!arguments.length)return this._values();if(!a.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(b):this.value();for(d=this.options.values,e=arguments[0],f=0;f<d.length;f+=1)d[f]=this._trimAlignValue(e[f]),this._change(null,f);this._refreshValue()},_setOption:function(b,c){var d,e=0;switch("range"===b&&this.options.range===!0&&("min"===c?(this.options.value=this._values(0),this.options.values=null):"max"===c&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),a.isArray(this.options.values)&&(e=this.options.values.length),a.Widget.prototype._setOption.apply(this,arguments),b){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),d=0;e>d;d+=1)this._change(null,d);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a)},_values:function(a){var b,c,d;if(arguments.length)return b=this.options.values[a],b=this._trimAlignValue(b);if(this.options.values&&this.options.values.length){for(c=this.options.values.slice(),d=0;d<c.length;d+=1)c[d]=this._trimAlignValue(c[d]);return c}return[]},_trimAlignValue:function(a){if(a<=this._valueMin())return this._valueMin();if(a>=this._valueMax())return this._valueMax();var b=this.options.step>0?this.options.step:1,c=(a-this._valueMin())%b,d=a-c;return 2*Math.abs(c)>=b&&(d+=c>0?b:-b),parseFloat(d.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var b,c,d,e,f,g=this.options.range,h=this.options,i=this,j=this._animateOff?!1:h.animate,k={};this.options.values&&this.options.values.length?this.handles.each(function(d){c=(i.values(d)-i._valueMin())/(i._valueMax()-i._valueMin())*100,k["horizontal"===i.orientation?"left":"bottom"]=c+"%",a(this).stop(1,1)[j?"animate":"css"](k,h.animate),i.options.range===!0&&("horizontal"===i.orientation?(0===d&&i.range.stop(1,1)[j?"animate":"css"]({left:c+"%"},h.animate),1===d&&i.range[j?"animate":"css"]({width:c-b+"%"},{queue:!1,duration:h.animate})):(0===d&&i.range.stop(1,1)[j?"animate":"css"]({bottom:c+"%"},h.animate),1===d&&i.range[j?"animate":"css"]({height:c-b+"%"},{queue:!1,duration:h.animate}))),b=c}):(d=this.value(),e=this._valueMin(),f=this._valueMax(),c=f!==e?(d-e)/(f-e)*100:0,k["horizontal"===this.orientation?"left":"bottom"]=c+"%",this.handle.stop(1,1)[j?"animate":"css"](k,h.animate),"min"===g&&"horizontal"===this.orientation&&this.range.stop(1,1)[j?"animate":"css"]({width:c+"%"},h.animate),"max"===g&&"horizontal"===this.orientation&&this.range[j?"animate":"css"]({width:100-c+"%"},{queue:!1,duration:h.animate}),"min"===g&&"vertical"===this.orientation&&this.range.stop(1,1)[j?"animate":"css"]({height:c+"%"},h.animate),"max"===g&&"vertical"===this.orientation&&this.range[j?"animate":"css"]({height:100-c+"%"},{queue:!1,duration:h.animate}))},_handleEvents:{keydown:function(b){var d,e,f,g,h=a(b.target).data("ui-slider-handle-index");switch(b.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(b.preventDefault(),!this._keySliding&&(this._keySliding=!0,a(b.target).addClass("ui-state-active"),d=this._start(b,h),d===!1))return}switch(g=this.options.step,e=f=this.options.values&&this.options.values.length?this.values(h):this.value(),b.keyCode){case a.ui.keyCode.HOME:f=this._valueMin();break;case a.ui.keyCode.END:f=this._valueMax();break;case a.ui.keyCode.PAGE_UP:f=this._trimAlignValue(e+(this._valueMax()-this._valueMin())/c);break;case a.ui.keyCode.PAGE_DOWN:f=this._trimAlignValue(e-(this._valueMax()-this._valueMin())/c);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(e===this._valueMax())return;f=this._trimAlignValue(e+g);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(e===this._valueMin())return;f=this._trimAlignValue(e-g)}this._slide(b,h,f)},click:function(a){a.preventDefault()},keyup:function(b){var c=a(b.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(b,c),this._change(b,c),a(b.target).removeClass("ui-state-active"))}}})}(jQuery),function(a,b){function c(){return++e}function d(a){return a=a.cloneNode(!1),a.hash.length>1&&decodeURIComponent(a.href.replace(f,""))===decodeURIComponent(location.href.replace(f,""))}var e=0,f=/#.*$/;a.widget("ui.tabs",{version:"1.10.4",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var b=this,c=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",c.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(b){a(this).is(".ui-state-disabled")&&b.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){a(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs(),c.active=this._initialActive(),a.isArray(c.disabled)&&(c.disabled=a.unique(c.disabled.concat(a.map(this.tabs.filter(".ui-state-disabled"),function(a){return b.tabs.index(a)}))).sort()),this.options.active!==!1&&this.anchors.length?this.active=this._findActive(c.active):this.active=a(),this._refresh(),this.active.length&&this.load(c.active)},_initialActive:function(){var b=this.options.active,c=this.options.collapsible,d=location.hash.substring(1);return null===b&&(d&&this.tabs.each(function(c,e){return a(e).attr("aria-controls")===d?(b=c,!1):void 0}),null===b&&(b=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),null!==b&&-1!==b||(b=this.tabs.length?0:!1)),b!==!1&&(b=this.tabs.index(this.tabs.eq(b)),-1===b&&(b=c?!1:0)),!c&&b===!1&&this.anchors.length&&(b=0),b},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):a()}},_tabKeydown:function(b){var c=a(this.document[0].activeElement).closest("li"),d=this.tabs.index(c),e=!0;if(!this._handlePageNav(b)){switch(b.keyCode){case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:d++;break;case a.ui.keyCode.UP:case a.ui.keyCode.LEFT:e=!1,d--;break;case a.ui.keyCode.END:d=this.anchors.length-1;break;case a.ui.keyCode.HOME:d=0;break;case a.ui.keyCode.SPACE:return b.preventDefault(),clearTimeout(this.activating),void this._activate(d);case a.ui.keyCode.ENTER:return b.preventDefault(),clearTimeout(this.activating),void this._activate(d===this.options.active?!1:d);default:return}b.preventDefault(),clearTimeout(this.activating),d=this._focusNextTab(d,e),b.ctrlKey||(c.attr("aria-selected","false"),this.tabs.eq(d).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",d)},this.delay))}},_panelKeydown:function(b){this._handlePageNav(b)||b.ctrlKey&&b.keyCode===a.ui.keyCode.UP&&(b.preventDefault(),this.active.focus())},_handlePageNav:function(b){return b.altKey&&b.keyCode===a.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):b.altKey&&b.keyCode===a.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(b,c){function d(){return b>e&&(b=0),0>b&&(b=e),b}for(var e=this.tabs.length-1;-1!==a.inArray(d(),this.options.disabled);)b=c?b+1:b-1;return b},_focusNextTab:function(a,b){return a=this._findNextTab(a,b),this.tabs.eq(a).focus(),a},_setOption:function(a,b){return"active"===a?void this._activate(b):"disabled"===a?void this._setupDisabled(b):(this._super(a,b),"collapsible"===a&&(this.element.toggleClass("ui-tabs-collapsible",b),b||this.options.active!==!1||this._activate(0)),"event"===a&&this._setupEvents(b),void("heightStyle"===a&&this._setupHeightStyle(b)))},_tabId:function(a){return a.attr("aria-controls")||"ui-tabs-"+c()},_sanitizeSelector:function(a){return a?a.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var b=this.options,c=this.tablist.children(":has(a[href])");b.disabled=a.map(c.filter(".ui-state-disabled"),function(a){return c.index(a)}),this._processTabs(),b.active!==!1&&this.anchors.length?this.active.length&&!a.contains(this.tablist[0],this.active[0])?this.tabs.length===b.disabled.length?(b.active=!1,this.active=a()):this._activate(this._findNextTab(Math.max(0,b.active-1),!1)):b.active=this.tabs.index(this.active):(b.active=!1,this.active=a()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var b=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return a("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=a(),this.anchors.each(function(c,e){var f,g,h,i=a(e).uniqueId().attr("id"),j=a(e).closest("li"),k=j.attr("aria-controls");d(e)?(f=e.hash,g=b.element.find(b._sanitizeSelector(f))):(h=b._tabId(j),f="#"+h,g=b.element.find(f),g.length||(g=b._createPanel(h),g.insertAfter(b.panels[c-1]||b.tablist)),g.attr("aria-live","polite")),g.length&&(b.panels=b.panels.add(g)),k&&j.data("ui-tabs-aria-controls",k),j.attr({"aria-controls":f.substring(1),"aria-labelledby":i}),g.attr("aria-labelledby",i)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(b){return a("<div>").attr("id",b).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(b){a.isArray(b)&&(b.length?b.length===this.anchors.length&&(b=!0):b=!1);for(var c,d=0;c=this.tabs[d];d++)b===!0||-1!==a.inArray(d,b)?a(c).addClass("ui-state-disabled").attr("aria-disabled","true"):a(c).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=b},_setupEvents:function(b){var c={click:function(a){a.preventDefault()}};b&&a.each(b.split(" "),function(a,b){c[b]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,c),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(b){var c,d=this.element.parent();"fill"===b?(c=d.height(),c-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var b=a(this),d=b.css("position");"absolute"!==d&&"fixed"!==d&&(c-=b.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){c-=a(this).outerHeight(!0)}),this.panels.each(function(){a(this).height(Math.max(0,c-a(this).innerHeight()+a(this).height()))}).css("overflow","auto")):"auto"===b&&(c=0,this.panels.each(function(){c=Math.max(c,a(this).height("").height())}).height(c))},_eventHandler:function(b){var c=this.options,d=this.active,e=a(b.currentTarget),f=e.closest("li"),g=f[0]===d[0],h=g&&c.collapsible,i=h?a():this._getPanelForTab(f),j=d.length?this._getPanelForTab(d):a(),k={oldTab:d,oldPanel:j,newTab:h?a():f,newPanel:i};b.preventDefault(),f.hasClass("ui-state-disabled")||f.hasClass("ui-tabs-loading")||this.running||g&&!c.collapsible||this._trigger("beforeActivate",b,k)===!1||(c.active=h?!1:this.tabs.index(f),this.active=g?a():f,this.xhr&&this.xhr.abort(),j.length||i.length||a.error("jQuery UI Tabs: Mismatching fragment identifier."),i.length&&this.load(this.tabs.index(f),b),this._toggle(b,k))},_toggle:function(b,c){function d(){f.running=!1,f._trigger("activate",b,c)}function e(){c.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),g.length&&f.options.show?f._show(g,f.options.show,d):(g.show(),d())}var f=this,g=c.newPanel,h=c.oldPanel;this.running=!0,h.length&&this.options.hide?this._hide(h,this.options.hide,function(){c.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),e()}):(c.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),h.hide(),e()),h.attr({"aria-expanded":"false","aria-hidden":"true"}),c.oldTab.attr("aria-selected","false"),g.length&&h.length?c.oldTab.attr("tabIndex",-1):g.length&&this.tabs.filter(function(){return 0===a(this).attr("tabIndex")}).attr("tabIndex",-1),g.attr({"aria-expanded":"true","aria-hidden":"false"}),c.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(b){var c,d=this._findActive(b);d[0]!==this.active[0]&&(d.length||(d=this.active),c=d.find(".ui-tabs-anchor")[0],this._eventHandler({target:c,currentTarget:c,preventDefault:a.noop}))},_findActive:function(b){return b===!1?a():this.tabs.eq(b)},_getIndex:function(a){return"string"==typeof a&&(a=this.anchors.index(this.anchors.filter("[href$='"+a+"']"))),a},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){a.data(this,"ui-tabs-destroy")?a(this).remove():a(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var b=a(this),c=b.data("ui-tabs-aria-controls");c?b.attr("aria-controls",c).removeData("ui-tabs-aria-controls"):b.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(c){var d=this.options.disabled;d!==!1&&(c===b?d=!1:(c=this._getIndex(c),d=a.isArray(d)?a.map(d,function(a){return a!==c?a:null}):a.map(this.tabs,function(a,b){return b!==c?b:null})),this._setupDisabled(d))},disable:function(c){var d=this.options.disabled;if(d!==!0){if(c===b)d=!0;else{if(c=this._getIndex(c),-1!==a.inArray(c,d))return;d=a.isArray(d)?a.merge([c],d).sort():[c]}this._setupDisabled(d)}},load:function(b,c){b=this._getIndex(b);var e=this,f=this.tabs.eq(b),g=f.find(".ui-tabs-anchor"),h=this._getPanelForTab(f),i={tab:f,panel:h};d(g[0])||(this.xhr=a.ajax(this._ajaxSettings(g,c,i)),this.xhr&&"canceled"!==this.xhr.statusText&&(f.addClass("ui-tabs-loading"),h.attr("aria-busy","true"),this.xhr.success(function(a){setTimeout(function(){h.html(a),e._trigger("load",c,i)},1)}).complete(function(a,b){setTimeout(function(){"abort"===b&&e.panels.stop(!1,!0),f.removeClass("ui-tabs-loading"),h.removeAttr("aria-busy"),a===e.xhr&&delete e.xhr},1)})))},_ajaxSettings:function(b,c,d){var e=this;return{url:b.attr("href"),beforeSend:function(b,f){return e._trigger("beforeLoad",c,a.extend({jqXHR:b,ajaxSettings:f},d))}}},_getPanelForTab:function(b){var c=a(b).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+c))}})}(jQuery),function(a){function b(b,c){var d=(b.attr("aria-describedby")||"").split(/\s+/);d.push(c),b.data("ui-tooltip-id",c).attr("aria-describedby",a.trim(d.join(" ")))}function c(b){var c=b.data("ui-tooltip-id"),d=(b.attr("aria-describedby")||"").split(/\s+/),e=a.inArray(c,d);-1!==e&&d.splice(e,1),b.removeData("ui-tooltip-id"),d=a.trim(d.join(" ")),d?b.attr("aria-describedby",d):b.removeAttr("aria-describedby")}var d=0;a.widget("ui.tooltip",{version:"1.10.4",options:{content:function(){var b=a(this).attr("title")||"";return a("<a>").text(b).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable()},_setOption:function(b,c){var d=this;return"disabled"===b?(this[c?"_disable":"_enable"](),void(this.options[b]=c)):(this._super(b,c),void("content"===b&&a.each(this.tooltips,function(a,b){d._updateContent(b)})))},_disable:function(){var b=this;a.each(this.tooltips,function(c,d){var e=a.Event("blur");e.target=e.currentTarget=d[0],b.close(e,!0)}),this.element.find(this.options.items).addBack().each(function(){var b=a(this);b.is("[title]")&&b.data("ui-tooltip-title",b.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var b=a(this);b.data("ui-tooltip-title")&&b.attr("title",b.data("ui-tooltip-title"))})},open:function(b){var c=this,d=a(b?b.target:this.element).closest(this.options.items);d.length&&!d.data("ui-tooltip-id")&&(d.attr("title")&&d.data("ui-tooltip-title",d.attr("title")),d.data("ui-tooltip-open",!0),b&&"mouseover"===b.type&&d.parents().each(function(){var b,d=a(this);d.data("ui-tooltip-open")&&(b=a.Event("blur"),b.target=b.currentTarget=this,
c.close(b,!0)),d.attr("title")&&(d.uniqueId(),c.parents[this.id]={element:this,title:d.attr("title")},d.attr("title",""))}),this._updateContent(d,b))},_updateContent:function(a,b){var c,d=this.options.content,e=this,f=b?b.type:null;return"string"==typeof d?this._open(b,a,d):(c=d.call(a[0],function(c){a.data("ui-tooltip-open")&&e._delay(function(){b&&(b.type=f),this._open(b,a,c)})}),void(c&&this._open(b,a,c)))},_open:function(c,d,e){function f(a){j.of=a,g.is(":hidden")||g.position(j)}var g,h,i,j=a.extend({},this.options.position);if(e){if(g=this._find(d),g.length)return void g.find(".ui-tooltip-content").html(e);d.is("[title]")&&(c&&"mouseover"===c.type?d.attr("title",""):d.removeAttr("title")),g=this._tooltip(d),b(d,g.attr("id")),g.find(".ui-tooltip-content").html(e),this.options.track&&c&&/^mouse/.test(c.type)?(this._on(this.document,{mousemove:f}),f(c)):g.position(a.extend({of:d},this.options.position)),g.hide(),this._show(g,this.options.show),this.options.show&&this.options.show.delay&&(i=this.delayedShow=setInterval(function(){g.is(":visible")&&(f(j.of),clearInterval(i))},a.fx.interval)),this._trigger("open",c,{tooltip:g}),h={keyup:function(b){if(b.keyCode===a.ui.keyCode.ESCAPE){var c=a.Event(b);c.currentTarget=d[0],this.close(c,!0)}},remove:function(){this._removeTooltip(g)}},c&&"mouseover"!==c.type||(h.mouseleave="close"),c&&"focusin"!==c.type||(h.focusout="close"),this._on(!0,d,h)}},close:function(b){var d=this,e=a(b?b.currentTarget:this.element),f=this._find(e);this.closing||(clearInterval(this.delayedShow),e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title")),c(e),f.stop(!0),this._hide(f,this.options.hide,function(){d._removeTooltip(a(this))}),e.removeData("ui-tooltip-open"),this._off(e,"mouseleave focusout keyup"),e[0]!==this.element[0]&&this._off(e,"remove"),this._off(this.document,"mousemove"),b&&"mouseleave"===b.type&&a.each(this.parents,function(b,c){a(c.element).attr("title",c.title),delete d.parents[b]}),this.closing=!0,this._trigger("close",b,{tooltip:f}),this.closing=!1)},_tooltip:function(b){var c="ui-tooltip-"+d++,e=a("<div>").attr({id:c,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return a("<div>").addClass("ui-tooltip-content").appendTo(e),e.appendTo(this.document[0].body),this.tooltips[c]=b,e},_find:function(b){var c=b.data("ui-tooltip-id");return c?a("#"+c):a()},_removeTooltip:function(a){a.remove(),delete this.tooltips[a.attr("id")]},_destroy:function(){var b=this;a.each(this.tooltips,function(c,d){var e=a.Event("blur");e.target=e.currentTarget=d[0],b.close(e,!0),a("#"+c).remove(),d.data("ui-tooltip-title")&&(d.attr("title",d.data("ui-tooltip-title")),d.removeData("ui-tooltip-title"))})}})}(jQuery),function(a){function b(a,b){if(!(a.originalEvent.touches.length>1)){a.preventDefault();var c=a.originalEvent.changedTouches[0],d=document.createEvent("MouseEvents");d.initMouseEvent(b,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null),a.target.dispatchEvent(d)}}if(a.support.touch="ontouchend"in document,a.support.touch){var c,d=a.ui.mouse.prototype,e=d._mouseInit;d._touchStart=function(a){var d=this;!c&&d._mouseCapture(a.originalEvent.changedTouches[0])&&(c=!0,d._touchMoved=!1,b(a,"mouseover"),b(a,"mousemove"),b(a,"mousedown"))},d._touchMove=function(a){c&&(this._touchMoved=!0,b(a,"mousemove"))},d._touchEnd=function(a){c&&(b(a,"mouseup"),b(a,"mouseout"),this._touchMoved||b(a,"click"),c=!1)},d._mouseInit=function(){var b=this;b.element.bind("touchstart",a.proxy(b,"_touchStart")).bind("touchmove",a.proxy(b,"_touchMove")).bind("touchend",a.proxy(b,"_touchEnd")),e.call(b)}}}(jQuery);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.defaults("fluid.textfieldSlider",{gradeNames:["fluid.viewComponent"],components:{textfield:{type:"fluid.textfieldSlider.textfield",container:"{textfieldSlider}.dom.textfield",options:{model:"{textfieldSlider}.model",range:"{textfieldSlider}.options.range"}},slider:{type:"fluid.slider",container:"{textfieldSlider}.dom.slider",options:{model:"{fluid.textfieldSlider}.model",range:"{fluid.textfieldSlider}.options.range",sliderOptions:"{fluid.textfieldSlider}.options.sliderOptions"}}},selectors:{textfield:".flc-textfieldSlider-field",slider:".flc-textfieldSlider-slider"},model:{value:null},modelRelay:{target:"value",singleTransform:{type:"fluid.transforms.limitRange",input:"{that}.model.value",min:"{that}.options.range.min",max:"{that}.options.range.max"}},range:{min:0,max:100},sliderOptions:{orientation:"horizontal",step:1}}),b.defaults("fluid.textfieldSlider.textfield",{gradeNames:["fluid.viewComponent"],range:{},modelRelay:{target:"value",singleTransform:{type:"fluid.transforms.stringToNumber",input:"{that}.model.stringValue"}},modelListeners:{value:{"this":"{that}.container",method:"val",args:["{change}.value"]},stringValue:{"this":"{that}.container",method:"val",args:["{that}.model.value"]}},listeners:{"onCreate.bindChangeEvt":{"this":"{that}.container",method:"change",args:["{that}.setModel"]}},invokers:{setModel:{changePath:"stringValue",value:"{arguments}.0.target.value"}}}),b.defaults("fluid.slider",{gradeNames:["fluid.viewComponent"],range:{},selectors:{thumb:".ui-slider-handle"},members:{combinedSliderOptions:{expander:{funcName:"fluid.slider.combineSliderOptions",args:["{that}.options.sliderOptions","{that}.options.range"]}},slider:{expander:{"this":"{that}.container",method:"slider",args:["{that}.combinedSliderOptions"]}}},invokers:{setSliderValue:{"this":"{that}.slider",method:"slider",args:["value","{arguments}.0"]},setSliderAria:{"this":"{that}.dom.thumb",method:"attr",args:["aria-valuenow","{arguments}.0"]},setModel:{changePath:"value",value:"{arguments}.1.value"}},listeners:{"onCreate.initSliderAria":{"this":"{that}.dom.thumb",method:"attr",args:[{role:"slider","aria-valuenow":"{that}.combinedSliderOptions.value","aria-valuemin":"{that}.combinedSliderOptions.min","aria-valuemax":"{that}.combinedSliderOptions.max"}]},"onCreate.bindSlideEvt":{"this":"{that}.slider",method:"bind",args:["slide","{that}.setModel"]}},modelListeners:{value:[{listener:"{that}.setSliderValue",args:["{change}.value"]},{listener:"{that}.setSliderAria",args:["{change}.value"]}]}}),b.slider.combineSliderOptions=function(b,c,d){return a.extend(!0,{},b,c,d)}}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.registerNamespace("fluid.tableOfContents"),b.tableOfContents.insertAnchor=function(b,c,d){var e=a("<a></a>",c.ownerDocument);e.prop({"class":d,name:b,id:b}),e.insertBefore(c)},b.tableOfContents.headingTextToAnchorInfo=function(a,b){var c=b(),d={id:c,url:"#"+c};return d},b.tableOfContents.locateHeadings=function(a){var c=a.locate("headings");return b.each(a.options.ignoreForToC,function(a){c=c.not(a).not(a+" :header")}),c},b.tableOfContents.refreshView=function(a){var c=a.locateHeadings();a.locate("tocAnchors").remove(),a.anchorInfo=b.transform(c,function(b){var c=a.headingTextToAnchorInfo(b);return a.insertAnchor(c.id,b,a.options.anchorClass),c});var d=a.modelBuilder.assembleModel(c,a.anchorInfo);a.applier.requestChange("",d),a.events.onRefresh.fire()},b.defaults("fluid.tableOfContents",{gradeNames:["fluid.viewComponent"],components:{levels:{type:"fluid.tableOfContents.levels",createOnEvent:"onCreate",container:"{tableOfContents}.dom.tocContainer",options:{model:{headings:"{tableOfContents}.model"},events:{afterRender:"{tableOfContents}.events.afterRender"},listeners:{"{tableOfContents}.events.onRefresh":"{that}.refreshView"},strings:"{tableOfContents}.options.strings"}},modelBuilder:{type:"fluid.tableOfContents.modelBuilder"}},model:[],invokers:{headingTextToAnchorInfo:{funcName:"fluid.tableOfContents.headingTextToAnchorInfo",args:["{arguments}.0","{that}.generateGUID"]},insertAnchor:"fluid.tableOfContents.insertAnchor",generateGUID:"fluid.allocateGuid",locateHeadings:{funcName:"fluid.tableOfContents.locateHeadings",args:["{that}"]},refreshView:{funcName:"fluid.tableOfContents.refreshView",args:["{that}"]},hide:{"this":"{that}.dom.tocContainer",method:"hide"},show:{"this":"{that}.dom.tocContainer",method:"show"}},strings:{tocHeader:"Table of Contents"},selectors:{headings:":header:visible",tocContainer:".flc-toc-tocContainer",tocAnchors:".flc-toc-anchors"},ignoreForToC:{tocContainer:"{that}.options.selectors.tocContainer"},anchorClass:"flc-toc-anchors",events:{onRefresh:null,afterRender:null,onReady:{events:{onCreate:"onCreate",afterRender:"afterRender"},args:["{that}"]}},listeners:{"onCreate.refreshView":"{that}.refreshView"}}),b.registerNamespace("fluid.tableOfContents.modelBuilder"),b.tableOfContents.modelBuilder.toModel=function(a,c){var d=b.copy(a),e=function(a,b){for(var d=[];a.length>0;){var f=a[0];if(f.level<b)break;if(f.level>b){var g=e(a,b+1);d.length>0?d[d.length-1].headings=g:d=c(d,g)}f.level===b&&(d.push(f),a.shift())}return d};return e(d,1)},b.tableOfContents.modelBuilder.gradualModelLevelFn=function(a,c){var d=b.copy(c);return d[0].level--,d},b.tableOfContents.modelBuilder.skippedModelLevelFn=function(a,b){return a.push({headings:b}),a},b.tableOfContents.modelBuilder.convertToHeadingObjects=function(c,d,e){return d=a(d),b.transform(d,function(b,d){return{level:c.headingCalculator.getHeadingLevel(b),text:a(b).text(),url:e[d].url}})},b.tableOfContents.modelBuilder.assembleModel=function(a,b,c){var d=a.convertToHeadingObjects(b,c);return a.toModel(d)},b.defaults("fluid.tableOfContents.modelBuilder",{gradeNames:["fluid.component"],components:{headingCalculator:{type:"fluid.tableOfContents.modelBuilder.headingCalculator"}},invokers:{toModel:{funcName:"fluid.tableOfContents.modelBuilder.toModel",args:["{arguments}.0","{modelBuilder}.modelLevelFn"]},modelLevelFn:"fluid.tableOfContents.modelBuilder.gradualModelLevelFn",convertToHeadingObjects:"fluid.tableOfContents.modelBuilder.convertToHeadingObjects({that}, {arguments}.0, {arguments}.1)",assembleModel:"fluid.tableOfContents.modelBuilder.assembleModel({that}, {arguments}.0, {arguments}.1)"}}),b.registerNamespace("fluid.tableOfContents.modelBuilder.headingCalculator"),b.tableOfContents.modelBuilder.headingCalculator.getHeadingLevel=function(a,b){return a.options.levels.indexOf(b.tagName)+1},b.defaults("fluid.tableOfContents.modelBuilder.headingCalculator",{gradeNames:["fluid.component"],invokers:{getHeadingLevel:"fluid.tableOfContents.modelBuilder.headingCalculator.getHeadingLevel({that}, {arguments}.0)"},levels:["H1","H2","H3","H4","H5","H6"]}),b.registerNamespace("fluid.tableOfContents.levels"),b.tableOfContents.levels.objModel=function(a,b){var c={ID:a+b+":",children:[]};return c},b.tableOfContents.levels.handleEmptyItemObj=function(a){a.decorators=[{type:"addClass",classes:"fl-tableOfContents-hide-bullet"}]},b.tableOfContents.levels.generateTree=function(c,d){d=d||0;var e=b.tableOfContents.levels.objModel("level",d);if(0===c.headings.length)return d?[]:{children:[]};if(0===d){var f={children:[b.tableOfContents.levels.generateTree(c,d+1)]};return f}return a.each(c.headings,function(a,c){var f=b.tableOfContents.levels.objModel("items",d),g={ID:"link"+d,target:c.url,linktext:c.text};c.level?f.children.push(g):b.tableOfContents.levels.handleEmptyItemObj(f),c.headings&&f.children.push(b.tableOfContents.levels.generateTree(c,d+1)),e.children.push(f)}),e},b.tableOfContents.levels.produceTree=function(a){var c=b.tableOfContents.levels.generateTree(a.model);return c.children.push({ID:"tocHeader",messagekey:"tocHeader"}),c},b.tableOfContents.levels.fetchResources=function(a){b.fetchResources(a.options.resources,function(){a.container.append(a.options.resources.template.resourceText),a.refreshView()})},b.defaults("fluid.tableOfContents.levels",{gradeNames:["fluid.rendererComponent"],produceTree:"fluid.tableOfContents.levels.produceTree",strings:{tocHeader:"Table of Contents"},selectors:{tocHeader:".flc-toc-header",level1:".flc-toc-levels-level1",level2:".flc-toc-levels-level2",level3:".flc-toc-levels-level3",level4:".flc-toc-levels-level4",level5:".flc-toc-levels-level5",level6:".flc-toc-levels-level6",items1:".flc-toc-levels-items1",items2:".flc-toc-levels-items2",items3:".flc-toc-levels-items3",items4:".flc-toc-levels-items4",items5:".flc-toc-levels-items5",items6:".flc-toc-levels-items6",link1:".flc-toc-levels-link1",link2:".flc-toc-levels-link2",link3:".flc-toc-levels-link3",link4:".flc-toc-levels-link4",link5:".flc-toc-levels-link5",link6:".flc-toc-levels-link6"},repeatingSelectors:["level1","level2","level3","level4","level5","level6","items1","items2","items3","items4","items5","items6"],model:{headings:[]},listeners:{"onCreate.fetchResources":"fluid.tableOfContents.levels.fetchResources"},resources:{template:{forceCache:!0,url:"../html/TableOfContents.html"}},rendererFnOptions:{noexpand:!0},rendererOptions:{debugMode:!1}})}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.registerNamespace("fluid.textToSpeech"),b.textToSpeech.isSupported=function(){return!(!window||!window.speechSynthesis)},b.textToSpeech.checkTTSSupport=function(a){var c=b.promise();if(b.textToSpeech.isSupported()){var d=new SpeechSynthesisUtterance(" ");d.volume=0;var e=setTimeout(function(){speechSynthesis.cancel(),c.reject()},a||1e3);d.onstop=function(){clearTimeout(e),speechSynthesis.cancel(),c.resolve()},speechSynthesis.speak(d)}else setTimeout(c.reject,0);return c},b.defaults("fluid.textToSpeech",{gradeNames:["fluid.modelComponent"],events:{onStart:null,onStop:null,onPause:null,onResume:null,onError:null,onSpeechQueued:null},members:{queue:[]},model:{utteranceOpts:{}},modelListeners:{speaking:{listener:"fluid.textToSpeech.speak",args:["{that}","{change}.value"]},paused:{listener:"fluid.textToSpeech.pause",args:["{that}","{change}.value"]}},invokers:{queueSpeech:{funcName:"fluid.textToSpeech.queueSpeech",args:["{that}","{arguments}.0","{arguments}.1","{arguments}.2"]},cancel:{funcName:"fluid.textToSpeech.cancel",args:["{that}"]},pause:{"this":"speechSynthesis",method:"pause"},resume:{"this":"speechSynthesis",method:"resume"},getVoices:{"this":"speechSynthesis",method:"getVoices"},handleStart:{funcName:"fluid.textToSpeech.handleStart",args:["{that}"]},handleEnd:{funcName:"fluid.textToSpeech.handleEnd",args:["{that}"]},handleError:"{that}.events.onError.fire",handlePause:{changePath:"paused",value:!0},handleResume:{changePath:"paused",value:!1}}}),b.textToSpeech.speak=function(a,b){a.events[b?"onStart":"onStop"].fire()},b.textToSpeech.pause=function(a,b){b?a.events.onPause.fire():a.model.speaking&&a.events.onResume.fire()},b.textToSpeech.handleStart=function(a){a.queue.shift(),a.applier.change("speaking",!0),a.queue.length&&a.applier.change("pending",!0)},b.textToSpeech.handleEnd=function(b){var c={speaking:!1,pending:!1,paused:!1};if(!b.queue.length){var d=a.extend({},b.model,c);b.applier.change("",d)}},b.textToSpeech.queueSpeech=function(b,c,d,e){d&&b.cancel();var f=function(){b.handleError(c)},g=new SpeechSynthesisUtterance(c),h={onstart:b.handleStart,onend:b.handleEnd,onerror:f,onpause:b.handlePause,onresume:b.handleResume};a.extend(g,b.model.utteranceOpts,e,h),b.queue.push(c),b.events.onSpeechQueued.fire(c),speechSynthesis.speak(g)},b.textToSpeech.cancel=function(a){a.queue=[],speechSynthesis.cancel()}}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.registerNamespace("fluid.url"),b.url.generateDepth=function(a){return b.generate(a,"../").join("")},b.url.parsePathInfo=function(a){var b={},c=a.split("/");if(c.length>0){var d=c.length-1,e=c[d].indexOf(".");-1!==e&&(b.extension=c[d].substring(e+1),c[d]=c[d].substring(0,e))}return b.pathInfo=c,b},b.url.parsePathInfoTrim=function(a){var c=b.url.parsePathInfo(a);return""===c.pathInfo[c.pathInfo.length-1]&&c.pathInfo.length--,c},b.url.collapseSegs=function(a,b,c){var d="";void 0===b&&(b=0),void 0===c&&(c=a.length);for(var e=b;c-1>e;++e)d+=a[e]+"/";return c>b&&(d+=a[c-1]),d},b.url.makeRelPath=function(a,c){var d=b.kettle.collapseSegs(a.pathInfo,c);return a.extension&&(d+="."+a.extension),d},b.url.cononocolosePath=function(a){for(var b=0,c=0;c<a.length;++c)".."===a[c]?++b:0!==b&&(a.splice(c-2*b,2*b),c-=2*b,b=0);return a},b.url.parseUri=function(a){for(var c=b.url.parseUri.options,d=c.parser[c.strictMode?"strict":"loose"].exec(a),e={},f=14;f--;)e[c.key[f]]=d[f]||"";return e[c.q.name]={},e[c.key[12]].replace(c.q.parser,function(a,b,d){b&&(e[c.q.name][b]=d)}),e},b.url.parseUri.options={strictMode:!0,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},b.url.parseSegs=function(a){var c=b.url.parseUri(a),d=b.url.parsePathInfoTrim(c.directory);return d.pathInfo},b.url.isAbsoluteUrl=function(a){var c=b.url.parseUri(a);return c.host||c.protocol||"/"===c.directory.charAt(0)},b.url.computeRelativePrefix=function(a,c,d){if(b.url.isAbsoluteUrl(d))return d;var e=b.url.parsePathInfo(d).pathInfo,f=b.url.parseSegs(a),g=f.concat(e);b.url.cononocolosePath(g);for(var h=b.url.parseSegs(c),i=0;i<g.length&&g[i]===h[i];++i);var j=h.length-i,k=b.url.generateDepth(j),l=b.url.collapseSegs(g,i);return k+l}}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.defaults("fluid.prefs.dataSource",{gradeNames:["fluid.component"],invokers:{get:"fluid.notImplemented",set:"fluid.notImplemented"}}),b.defaults("fluid.prefs.store",{gradeNames:["fluid.prefs.dataSource","fluid.contextAware"],contextAwareness:{strategy:{defaultGradeNames:"fluid.prefs.cookieStore"}}}),b.defaults("fluid.prefs.cookieStore",{gradeNames:["fluid.prefs.store"],cookie:{name:"fluid-ui-settings",path:"/",expires:""},invokers:{get:{funcName:"fluid.prefs.cookieStore.get",args:"{that}.options.cookie.name"},set:{funcName:"fluid.prefs.cookieStore.set",args:["{arguments}.0","{that}.options.cookie"]}}}),b.prefs.cookieStore.get=function(a){var c=document.cookie;if(!(c.length<=0)){var d=a+"=",e=c.indexOf(d);if(!(0>e)){e+=d.length;var f=c.indexOf(";",e);e>f&&(f=c.length);var g,h=c.substring(e,f);try{g=JSON.parse(decodeURIComponent(h))}catch(i){b.log("Error parsing cookie "+h+" as JSON - clearing"),document.cookie=""}return g}}},b.prefs.cookieStore.assembleCookie=function(a){var b=a.name+"="+a.data;return a.expires&&(b+="; expires="+a.expires),a.path&&(b+="; path="+a.path),b},b.prefs.cookieStore.set=function(a,c){c.data=encodeURIComponent(JSON.stringify(a)),document.cookie=b.prefs.cookieStore.assembleCookie(c)},b.defaults("fluid.prefs.tempStore",{gradeNames:["fluid.prefs.store","fluid.modelComponent"],invokers:{get:{funcName:"fluid.identity",args:"{that}.model"},set:{funcName:"fluid.prefs.tempStore.set",args:["{arguments}.0","{that}.applier"]}}}),b.prefs.tempStore.set=function(a,b){b.fireChangeRequest({path:"",type:"DELETE"}),b.change("",a)},b.defaults("fluid.prefs.globalSettingsStore",{gradeNames:["fluid.component"],components:{settingsStore:{type:"fluid.prefs.store",options:{gradeNames:["fluid.resolveRootSingle"],singleRootType:"fluid.prefs.store"}}}})}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.defaults("fluid.prefs.initialModel",{gradeNames:["fluid.component"],members:{initialModel:{preferences:{}}}}),b.defaults("fluid.uiEnhancer",{gradeNames:["fluid.viewComponent"],invokers:{updateModel:{func:"{that}.applier.change",args:["","{arguments}.0"]}},userGrades:"@expand:fluid.prefs.filterEnhancerGrades({that}.options.gradeNames)"}),b.defaults("fluid.uiEnhancer.root",{gradeNames:["fluid.uiEnhancer","fluid.resolveRootSingle"],singleRootType:"fluid.uiEnhancer"}),b.uiEnhancer.ignorableGrades=["fluid.uiEnhancer","fluid.uiEnhancer.root","fluid.resolveRoot","fluid.resolveRootSingle"],b.prefs.filterEnhancerGrades=function(a){return b.remove_if(b.makeArray(a),function(a){return-1!==b.frameworkGrades.indexOf(a)||-1!==b.uiEnhancer.ignorableGrades.indexOf(a)})},b.prefs.filterEnhancerOptions=function(a){return b.filterKeys(a,["classnameMap","fontSizeMap","tocTemplate","components"])},b.defaults("fluid.pageEnhancer",{gradeNames:["fluid.component","fluid.originalEnhancerOptions","fluid.prefs.initialModel","fluid.prefs.settingsGetter","fluid.resolveRootSingle"],distributeOptions:{source:"{that}.options.uiEnhancer",target:"{that > uiEnhancer}.options"},singleRootType:"fluid.pageEnhancer",components:{uiEnhancer:{type:"fluid.uiEnhancer.root",container:"body"}},originalUserOptions:"@expand:fluid.prefs.filterEnhancerOptions({uiEnhancer}.options)",listeners:{"onCreate.initModel":"fluid.pageEnhancer.init"}}),b.pageEnhancer.init=function(a){a.uiEnhancer.updateModel(b.get(a.getSettings(),"preferences"))}}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.defaults("fluid.prefs.prefsEditorLoader",{gradeNames:["fluid.prefs.settingsGetter","fluid.prefs.initialModel","fluid.viewComponent"],defaultLocale:"en",members:{settings:{expander:{funcName:"fluid.prefs.prefsEditorLoader.getCompleteSettings",args:["{that}.initialModel","{that}.getSettings"]}}},components:{prefsEditor:{priority:"last",type:"fluid.prefs.prefsEditor",createOnEvent:"onCreatePrefsEditorReady",options:{members:{initialModel:"{prefsEditorLoader}.initialModel"},invokers:{getSettings:"{prefsEditorLoader}.getSettings"}}},templateLoader:{type:"fluid.prefs.resourceLoader",options:{events:{onResourcesLoaded:"{prefsEditorLoader}.events.onPrefsEditorTemplatesLoaded"}}},messageLoader:{type:"fluid.prefs.resourceLoader",options:{defaultLocale:"{prefsEditorLoader}.options.defaultLocale",locale:"{prefsEditorLoader}.settings.locale",resourceOptions:{dataType:"json"},events:{onResourcesLoaded:"{prefsEditorLoader}.events.onPrefsEditorMessagesLoaded"}}}},events:{onPrefsEditorTemplatesLoaded:null,onPrefsEditorMessagesLoaded:null,onCreatePrefsEditorReady:{events:{templateLoaded:"onPrefsEditorTemplatesLoaded",prefsEditorMessagesLoaded:"onPrefsEditorMessagesLoaded"}}},distributeOptions:[{source:"{that}.options.templateLoader",removeSource:!0,target:"{that > templateLoader}.options"},{source:"{that}.options.messageLoader",removeSource:!0,target:"{that > messageLoader}.options"},{source:"{that}.options.terms",target:"{that > templateLoader}.options.terms"},{source:"{that}.options.terms",target:"{that > messageLoader}.options.terms"},{source:"{that}.options.prefsEditor",removeSource:!0,target:"{that > prefsEditor}.options"}]}),b.prefs.prefsEditorLoader.getCompleteSettings=function(b,c){var d=c();return a.extend(!0,{},b,d)},b.defaults("fluid.prefs.transformDefaultPanelsOptions",{gradeNames:["fluid.viewComponent"],distributeOptions:[{source:"{that}.options.textSize",removeSource:!0,target:"{that textSize}.options"},{source:"{that}.options.lineSpace",removeSource:!0,target:"{that lineSpace}.options"},{source:"{that}.options.textFont",removeSource:!0,target:"{that textFont}.options"},{source:"{that}.options.contrast",removeSource:!0,target:"{that contrast}.options"},{source:"{that}.options.layoutControls",removeSource:!0,target:"{that layoutControls}.options"},{source:"{that}.options.linksControls",removeSource:!0,target:"{that linksControls}.options"}]}),b.defaults("fluid.prefs.resourceLoader",{gradeNames:["fluid.component"],listeners:{"onCreate.loadResources":{listener:"fluid.prefs.resourceLoader.loadResources",args:["{that}",{expander:{func:"{that}.resolveResources"}}]}},defaultLocale:null,locale:null,terms:{},resources:{},resourceOptions:{},invokers:{transformURL:{funcName:"fluid.stringTemplate",args:["{arguments}.0","{that}.options.terms"]},resolveResources:{funcName:"fluid.prefs.resourceLoader.resolveResources",args:"{that}"}},events:{onResourcesLoaded:null}}),b.prefs.resourceLoader.resolveResources=function(c){var d=b.transform(c.options.resources,c.transformURL);return b.transform(d,function(d){var e={url:d,forceCache:!0,options:c.options.resourceOptions};return a.extend(e,b.filterKeys(c.options,["defaultLocale","locale"]))})},b.prefs.resourceLoader.loadResources=function(a,c){b.fetchResources(c,function(){a.resources=c,a.events.onResourcesLoaded.fire(c)})},b.defaults("fluid.prefs.settingsGetter",{gradeNames:["fluid.component"],members:{getSettings:"{fluid.prefs.store}.get"}}),b.defaults("fluid.prefs.settingsSetter",{gradeNames:["fluid.component"],invokers:{setSettings:{funcName:"fluid.prefs.settingsSetter.setSettings",args:["{arguments}.0","{fluid.prefs.store}.set"]}}}),b.prefs.settingsSetter.setSettings=function(a,c){var d=b.copy(a);c(d)},b.defaults("fluid.prefs.uiEnhancerRelay",{gradeNames:["fluid.modelComponent"],listeners:{"onCreate.addListener":"{that}.addListener","onDestroy.removeListener":"{that}.removeListener"},events:{updateEnhancerModel:"{fluid.prefs.prefsEditor}.events.onUpdateEnhancerModel"},invokers:{addListener:{funcName:"fluid.prefs.uiEnhancerRelay.addListener",args:["{that}.events.updateEnhancerModel","{that}.updateEnhancerModel"]},removeListener:{funcName:"fluid.prefs.uiEnhancerRelay.removeListener",args:["{that}.events.updateEnhancerModel","{that}.updateEnhancerModel"]},updateEnhancerModel:{funcName:"fluid.prefs.uiEnhancerRelay.updateEnhancerModel",args:["{uiEnhancer}","{fluid.prefs.prefsEditor}.model.preferences"]}}}),b.prefs.uiEnhancerRelay.addListener=function(a,b){a.addListener(b)},b.prefs.uiEnhancerRelay.removeListener=function(a,b){a.removeListener(b)},b.prefs.uiEnhancerRelay.updateEnhancerModel=function(a,b){a.updateModel(b)},b.defaults("fluid.prefs.prefsEditor",{gradeNames:["fluid.prefs.settingsGetter","fluid.prefs.settingsSetter","fluid.prefs.initialModel","fluid.viewComponent"],invokers:{fetch:{funcName:"fluid.prefs.prefsEditor.fetch",args:["{that}","{arguments}.0"]},applyChanges:{funcName:"fluid.prefs.prefsEditor.applyChanges",args:["{that}"]},save:{funcName:"fluid.prefs.prefsEditor.save",args:["{that}"]},saveAndApply:{funcName:"fluid.prefs.prefsEditor.saveAndApply",args:["{that}"]},reset:{funcName:"fluid.prefs.prefsEditor.reset",args:["{that}"]},cancel:{funcName:"fluid.prefs.prefsEditor.cancel",args:["{that}"]}},selectors:{cancel:".flc-prefsEditor-cancel",reset:".flc-prefsEditor-reset",save:".flc-prefsEditor-save",previewFrame:".flc-prefsEditor-preview-frame"},events:{onSave:null,onCancel:null,beforeReset:null,afterReset:null,onAutoSave:null,modelChanged:null,onPrefsEditorRefresh:null,onUpdateEnhancerModel:null,onPrefsEditorMarkupReady:null,onReady:null},listeners:{"onCreate.init":"fluid.prefs.prefsEditor.init","onAutoSave.save":"{that}.save"},modelListeners:{"":[{listener:"fluid.prefs.prefsEditor.handleAutoSave",args:["{that}"]},{listener:"{that}.events.modelChanged.fire",args:["{change}.value"]}]},resources:{template:"{templateLoader}.resources.prefsEditor"},autoSave:!1}),b.prefs.prefsEditor.applyChanges=function(a){a.events.onUpdateEnhancerModel.fire()},b.prefs.prefsEditor.fetch=function(b,c){var d=b.getSettings();d=a.extend(!0,{},b.initialModel,d),b.applier.change("",d),c&&b.events[c].fire(b),b.events.onPrefsEditorRefresh.fire(),b.applyChanges()},b.prefs.prefsEditor.save=function(a){if(a.model){var c=b.copy(a.model),d=a.initialModel,e={changes:0,unchanged:0,changeMap:{}},f={};return b.model.diff(c.preferences,b.get(d,["preferences"]),e),0===e.changes?delete c.preferences:(b.each(e.changeMap,function(a,d){b.set(f,d,c.preferences[d])}),c.preferences=f),a.events.onSave.fire(c),a.setSettings(c),c}},b.prefs.prefsEditor.saveAndApply=function(a){var c=a.getSettings(),d=a.save();b.model.diff(b.get(d,"preferences"),b.get(c,"preferences"))||(a.events.onPrefsEditorRefresh.fire(),a.applyChanges())},b.prefs.prefsEditor.reset=function(a){a.events.beforeReset.fire(a),a.applier.fireChangeRequest({path:"",type:"DELETE"}),a.applier.change("",b.copy(a.initialModel)),a.events.onPrefsEditorRefresh.fire(),a.events.afterReset.fire(a)},b.prefs.prefsEditor.cancel=function(a){a.events.onCancel.fire(),a.fetch()},b.prefs.prefsEditor.finishInit=function(c){var d=function(c){var d=c.locate("save");if(d.length>0){d.click(c.saveAndApply);var e=b.findForm(d);a(e).submit(function(){c.saveAndApply()})}c.locate("reset").click(c.reset),c.locate("cancel").click(c.cancel)};c.container.append(c.options.resources.template.resourceText),d(c),c.fetch("onPrefsEditorMarkupReady"),c.events.onReady.fire(c)},b.prefs.prefsEditor.handleAutoSave=function(a){a.options.autoSave&&a.events.onAutoSave.fire()},b.prefs.prefsEditor.init=function(a){setTimeout(function(){b.isDestroyed(a)||b.prefs.prefsEditor.finishInit(a)},1)},b.defaults("fluid.prefs.preview",{gradeNames:["fluid.viewComponent"],components:{enhancer:{type:"fluid.uiEnhancer",container:"{preview}.enhancerContainer",createOnEvent:"onReady"},templateLoader:"{templateLoader}"},invokers:{updateModel:{funcName:"fluid.prefs.preview.updateModel",args:["{preview}","{prefsEditor}.model.preferences"]}},events:{onReady:null},listeners:{"onCreate.startLoadingContainer":"fluid.prefs.preview.startLoadingContainer","{prefsEditor}.events.modelChanged":"{that}.updateModel","onReady.updateModel":"{that}.updateModel"},templateUrl:"%prefix/PrefsEditorPreview.html"}),b.prefs.preview.updateModel=function(a,b){setTimeout(function(){a.enhancer&&a.enhancer.updateModel(b)},0)},b.prefs.preview.startLoadingContainer=function(b){var c=b.templateLoader.transformURL(b.options.templateUrl);b.container.load(function(){b.enhancerContainer=a("body",b.container.contents()),b.events.onReady.fire()}),b.container.attr("src",c)}}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.defaults("fluid.prefs.msgLookup",{gradeNames:["fluid.component"],members:{msgLookup:{expander:{funcName:"fluid.prefs.stringLookup",args:["{msgResolver}","{that}.options.stringArrayIndex"]}}},stringArrayIndex:{}}),b.prefs.stringLookup=function(a,c){var d={id:b.allocateGuid()};return d.singleLookup=function(c){var d=a.lookup([c]);return b.get(d,"template")},d.multiLookup=function(a){return b.transform(a,function(a){return d.singleLookup(a)})},d.lookup=function(a){var e=b.get(c,a)||a,f=b.isArrayable(e)?"multiLookup":"singleLookup";return d[f](e)},d.resolvePathSegment=d.lookup,d},b.defaults("fluid.prefs.panel",{gradeNames:["fluid.prefs.msgLookup","fluid.rendererComponent"],events:{onDomBind:null},listeners:{"onCreate.onDomBind":"{that}.events.onDomBind"},components:{msgResolver:{type:"fluid.messageResolver"}},rendererOptions:{messageLocator:"{msgResolver}.resolve"},distributeOptions:{source:"{that}.options.messageBase",target:"{that > msgResolver}.options.messageBase"}}),b.defaults("fluid.prefs.subPanel",{gradeNames:["fluid.prefs.panel","{that}.getDomBindGrade"],listeners:{"{compositePanel}.events.afterRender":{listener:"{that}.events.afterRender",args:["{that}"]},"onCreate.onDomBind":null,"afterRender.onDomBind":"{that}.resetDomBinder"},rules:{expander:{func:"fluid.prefs.subPanel.generateRules",args:["{that}.options.preferenceMap"]}},invokers:{refreshView:"{compositePanel}.refreshView",resetDomBinder:{funcName:"fluid.prefs.subPanel.resetDomBinder",args:["{that}"]},getDomBindGrade:{funcName:"fluid.prefs.subPanel.getDomBindGrade",args:["{prefsEditor}"]}},strings:{},parentBundle:"{compositePanel}.messageResolver",renderOnInit:!1}),b.defaults("fluid.prefs.subPanel.domBind",{gradeNames:["fluid.component"],listeners:{"onDomBind.domChange":{listener:"{prefsEditor}.events.onSignificantDOMChange"}}}),b.prefs.subPanel.getDomBindGrade=function(a){var c=void 0!==b.get(a,"options.events.onSignificantDOMChange");return c?"fluid.prefs.subPanel.domBind":void 0},b.prefs.subPanel.resetDomBinder=function(a){var c=a.container.constructor;a.container=c(a.container.selector),b.initDomBinder(a,a.options.selectors),a.events.onDomBind.fire(a)},b.prefs.subPanel.safePrefKey=function(a){return a.replace(/[.]/g,"_")},b.prefs.subPanel.generateRules=function(a){var c={};
return b.each(a,function(a,d){b.each(a,function(a,e){0===e.indexOf("model.")&&(c[b.prefs.subPanel.safePrefKey(d)]=e.slice("model.".length))})}),c},b.registerNamespace("fluid.prefs.compositePanel"),b.prefs.compositePanel.arrayMergePolicy=function(a,c){return a=b.makeArray(a),c=b.makeArray(c),b.each(c,function(b){a.indexOf(b)<0&&a.push(b)}),a},b.defaults("fluid.prefs.compositePanel",{gradeNames:["fluid.prefs.panel","{that}.getDistributeOptionsGrade","{that}.getSubPanelLifecycleBindings"],mergePolicy:{subPanelOverrides:"noexpand",selectorsToIgnore:b.prefs.compositePanel.arrayMergePolicy},selectors:{},selectorsToIgnore:[],repeatingSelectors:[],events:{initSubPanels:null},listeners:{"onCreate.combineResources":"{that}.combineResources","onCreate.appendTemplate":{"this":"{that}.container",method:"append",args:["{that}.options.resources.template.resourceText"]},"onCreate.initSubPanels":"{that}.events.initSubPanels","onCreate.hideInactive":"{that}.hideInactive","onCreate.surfaceSubpanelRendererSelectors":"{that}.surfaceSubpanelRendererSelectors","afterRender.hideInactive":"{that}.hideInactive"},invokers:{getDistributeOptionsGrade:{funcName:"fluid.prefs.compositePanel.assembleDistributeOptions",args:["{that}.options.components"]},getSubPanelLifecycleBindings:{funcName:"fluid.prefs.compositePanel.subPanelLifecycleBindings",args:["{that}.options.components"]},combineResources:{funcName:"fluid.prefs.compositePanel.combineTemplates",args:["{that}.options.resources","{that}.options.selectors"]},surfaceSubpanelRendererSelectors:{funcName:"fluid.prefs.compositePanel.surfaceSubpanelRendererSelectors",args:["{that}","{that}.options.components","{that}.options.selectors"]},produceSubPanelTrees:{funcName:"fluid.prefs.compositePanel.produceSubPanelTrees",args:["{that}"]},expandProtoTree:{funcName:"fluid.prefs.compositePanel.expandProtoTree",args:["{that}"]},produceTree:{funcName:"fluid.prefs.compositePanel.produceTree",args:["{that}"]},hideInactive:{funcName:"fluid.prefs.compositePanel.hideInactive",args:["{that}"]},handleRenderOnPreference:{funcName:"fluid.prefs.compositePanel.handleRenderOnPreference",args:["{that}","{that}.refreshView","{that}.conditionalCreateEvent","{arguments}.0","{arguments}.1","{arguments}.2"]},conditionalCreateEvent:{funcName:"fluid.prefs.compositePanel.conditionalCreateEvent"}},subPanelOverrides:{gradeNames:["fluid.prefs.subPanel"]},rendererFnOptions:{noexpand:!0,cutpointGenerator:"fluid.prefs.compositePanel.cutpointGenerator",subPanelRepeatingSelectors:{expander:{funcName:"fluid.prefs.compositePanel.surfaceRepeatingSelectors",args:["{that}.options.components"]}}},components:{},resources:{}}),b.prefs.compositePanel.prefetchComponentOptions=function(a,c){var d=b.getGradedDefaults(a,b.get(c,"gradeNames"));return b.merge(d.mergePolicy,d,c)},b.prefs.compositePanel.isPanel=function(a,c){var d=b.prefs.compositePanel.prefetchComponentOptions(a,c);return b.hasGrade(d,"fluid.prefs.panel")},b.prefs.compositePanel.isActivePanel=function(a){return a&&b.hasGrade(a.options,"fluid.prefs.panel")},b.prefs.compositePanel.assembleDistributeOptions=function(a){var c="fluid.prefs.compositePanel.distributeOptions_"+b.allocateGuid(),d=[],e={};return b.each(a,function(a,c){b.prefs.compositePanel.isPanel(a.type,a.options)&&d.push({source:"{that}.options.subPanelOverrides",target:"{that > "+c+"}.options"});var f={},g=b.prefs.compositePanel.prefetchComponentOptions(a.type,a.options),h=b.get(g,["preferenceMap"]);b.each(h,function(a,c){b.each(a,function(a,d){0===d.indexOf("model.")&&b.set(f,d.slice("model.".length),"{compositePanel}.model."+b.prefs.subPanel.safePrefKey(c))})}),e[c]=f,d.push({source:"{that}.options.relayOption."+c,target:"{that > "+c+"}.options.model"})}),b.defaults(c,{gradeNames:["fluid.component"],relayOption:e,distributeOptions:d}),c},b.prefs.compositePanel.conditionalCreateEvent=function(a,b){a&&b()},b.prefs.compositePanel.handleRenderOnPreference=function(a,c,d,e,f,g){g=b.makeArray(g),d(e,f),b.each(g,function(b){var c=a[b];!e&&c&&c.destroy()}),c()},b.prefs.compositePanel.creationEventName=function(a){return"initOn_"+a},b.prefs.compositePanel.generateModelListeners=function(a){return b.transform(a,function(a,c){var d=b.prefs.compositePanel.creationEventName(c);return{func:"{that}.handleRenderOnPreference",args:["{change}.value","{that}.events."+d+".fire",a]}})},b.prefs.compositePanel.subPanelLifecycleBindings=function(a){var c="fluid.prefs.compositePanel.subPanelCreationTimingDistibution_"+b.allocateGuid(),d=[],e={"default":"initSubPanels"},f={},g={},h={};return b.each(a,function(a,c){if(b.prefs.compositePanel.isPanel(a.type,a.options)){var i="default",j=b.get(a,"options.renderOnPreference");if(j){var k=b.prefs.subPanel.safePrefKey(j),l="onCreate."+k;i=b.prefs.compositePanel.creationEventName(k),e[i]=i,h[i]=null,f[k]=f[k]||[],f[k].push(c),g[l]={listener:"{that}.conditionalCreateEvent",args:["{that}.model."+k,"{that}.events."+i+".fire"]}}d.push({source:"{that}.options.subPanelCreationOpts."+i,target:"{that}.options.components."+c+".createOnEvent"})}}),b.defaults(c,{gradeNames:["fluid.component"],events:h,listeners:g,modelListeners:b.prefs.compositePanel.generateModelListeners(f),subPanelCreationOpts:e,distributeOptions:d}),c},b.prefs.compositePanel.hideInactive=function(a){b.each(a.options.components,function(c,d){b.prefs.compositePanel.isPanel(c.type,c.options)&&!b.prefs.compositePanel.isActivePanel(a[d])&&a.locate(d).hide()})},b.prefs.compositePanel.combineTemplates=function(a,c){var d=[],e={children:[]};b.each(a,function(a,b){"template"!==b&&(e.children.push({ID:b,markup:a.resourceText}),d.push({id:b,selector:c[b]}))});var f={base:{resourceText:a.template.resourceText,href:".",resourceKey:".",cutpoints:d}},g=b.parseTemplates(f,["base"]),h=b.renderer(g,e,{cutpoints:d,debugMode:!0});a.template.resourceText=h.renderTemplates()},b.prefs.compositePanel.rebaseSelectorName=function(a,b){return a+"_"+b},b.prefs.compositePanel.surfaceSubpanelRendererSelectors=function(a,c,d){b.each(c,function(a,c){if(b.prefs.compositePanel.isPanel(a.type,a.options)){var e=b.prefs.compositePanel.prefetchComponentOptions(a.type,a.options);b.each(e.selectors,function(a,f){(!e.selectorsToIgnore||e.selectorsToIgnore.indexOf(f)<0)&&b.set(d,b.prefs.compositePanel.rebaseSelectorName(c,f),d[c]+" "+a)})}})},b.prefs.compositePanel.surfaceRepeatingSelectors=function(a){var c=[];return b.each(a,function(a,d){if(b.prefs.compositePanel.isPanel(a.type,a.options)){var e=b.prefs.compositePanel.prefetchComponentOptions(a.type,a.options),f=b.transform(e.repeatingSelectors,function(a){return b.prefs.compositePanel.rebaseSelectorName(d,a)});c=c.concat(f)}}),c},b.prefs.compositePanel.cutpointGenerator=function(a,c){var d={selectorsToIgnore:c.selectorsToIgnore,repeatingSelectors:c.repeatingSelectors.concat(c.subPanelRepeatingSelectors)};return b.renderer.selectorsToCutpoints(a,d)},b.prefs.compositePanel.rebaseID=function(a,b){return b+"_"+a},b.prefs.compositePanel.rebaseParentRelativeID=function(a,c){var d="..::".length;return a.slice(0,d)+b.prefs.compositePanel.rebaseID(a.slice(d),c)},b.prefs.compositePanel.rebaseValueBinding=function(a,c){return b.find(c,function(b,c){return a===b?c:0===a.indexOf(b)?a.replace(b,c):void 0})||a},b.prefs.compositePanel.rebaseTreeComp=function(a,c,d,e,f){var g=b.copy(d);if(g.ID&&(g.ID=b.prefs.compositePanel.rebaseID(g.ID,e)),g.children)g.children=b.prefs.compositePanel.rebaseTree(a,c,g.children,e,f);else if(g.selection)g.selection=b.prefs.compositePanel.rebaseTreeComp(a,c,g.selection,e,f);else if(g.messagekey)g.componentType="UIBound",g.value=a.resolve(g.messagekey.value,g.messagekey.args),delete g.messagekey;else if(g.parentRelativeID)g.parentRelativeID=b.prefs.compositePanel.rebaseParentRelativeID(g.parentRelativeID,e);else if(g.valuebinding&&(g.valuebinding=b.prefs.compositePanel.rebaseValueBinding(g.valuebinding,f),g.value)){var h=b.get(c,g.valuebinding);g.value=void 0!==h?h:g.value}return g},b.prefs.compositePanel.rebaseTree=function(a,c,d,e,f){var g;return g=b.isArrayable(d)?b.transform(d,function(d){return b.prefs.compositePanel.rebaseTreeComp(a,c,d,e,f)}):b.prefs.compositePanel.rebaseTreeComp(a,c,d,e,f)},b.prefs.compositePanel.produceTree=function(a){var c=a.options.produceTree,d=c?("string"==typeof c?b.getGlobalValue(c):c)(a):a.expandProtoTree(),e=a.produceSubPanelTrees(),f={children:d.children.concat(e.children)};return f},b.prefs.compositePanel.expandProtoTree=function(a){var c=b.renderer.modeliseOptions(a.options.expanderOptions,{ELstyle:"${}"},a),d=b.renderer.makeProtoExpander(c,a);return d(a.options.protoTree||{})},b.prefs.compositePanel.produceSubPanelTrees=function(a){var c={children:[]};return b.each(a.options.components,function(d,e){var f=a[e];if(b.prefs.compositePanel.isActivePanel(f)){var g=b.renderer.modeliseOptions(f.options.expanderOptions,{ELstyle:"${}"},f),h=b.renderer.makeProtoExpander(g,f),i=f.produceTree();i=b.get(f.options,"rendererFnOptions.noexpand")?i:h(i);var j=b.prefs.compositePanel.rebaseTree(f.msgResolver,a.model,i,e,f.options.rules);c.children=c.children.concat(j.children)}}),c},b.defaults("fluid.prefs.prefsEditorConnections",{gradeNames:["fluid.component"],listeners:{"{fluid.prefs.prefsEditor}.events.onPrefsEditorRefresh":"{fluid.prefs.panel}.refreshView"},strings:{},parentBundle:"{fluid.prefs.prefsEditorLoader}.msgResolver"}),b.defaults("fluid.prefs.panel.textSize",{gradeNames:["fluid.prefs.panel"],preferenceMap:{"fluid.prefs.textSize":{"model.textSize":"default","range.min":"minimum","range.max":"maximum"}},range:{min:1,max:2},selectors:{textSize:".flc-prefsEditor-min-text-size",label:".flc-prefsEditor-min-text-size-label",smallIcon:".flc-prefsEditor-min-text-size-smallIcon",largeIcon:".flc-prefsEditor-min-text-size-largeIcon",multiplier:".flc-prefsEditor-multiplier",textSizeDescr:".flc-prefsEditor-text-size-descr"},selectorsToIgnore:["textSize"],components:{textfieldSlider:{type:"fluid.textfieldSlider",container:"{that}.dom.textSize",createOnEvent:"afterRender",options:{model:{value:"{fluid.prefs.panel.textSize}.model.textSize"},range:"{fluid.prefs.panel.textSize}.options.range",sliderOptions:"{fluid.prefs.panel.textSize}.options.sliderOptions"}}},protoTree:{label:{messagekey:"textSizeLabel"},smallIcon:{messagekey:"textSizeSmallIcon"},largeIcon:{messagekey:"textSizeLargeIcon"},multiplier:{messagekey:"multiplier"},textSizeDescr:{messagekey:"textSizeDescr"}},sliderOptions:{orientation:"horizontal",step:.1,range:"min"}}),b.defaults("fluid.prefs.panel.textFont",{gradeNames:["fluid.prefs.panel"],preferenceMap:{"fluid.prefs.textFont":{"model.value":"default","controlValues.textFont":"enum"}},selectors:{textFont:".flc-prefsEditor-text-font",label:".flc-prefsEditor-text-font-label",textFontDescr:".flc-prefsEditor-text-font-descr"},stringArrayIndex:{textFont:["textFont-default","textFont-times","textFont-comic","textFont-arial","textFont-verdana"]},protoTree:{label:{messagekey:"textFontLabel"},textFontDescr:{messagekey:"textFontDescr"},textFont:{optionnames:"${{that}.msgLookup.textFont}",optionlist:"${{that}.options.controlValues.textFont}",selection:"${value}",decorators:{type:"fluid",func:"fluid.prefs.selectDecorator",options:{styles:"{that}.options.classnameMap.textFont"}}}},classnameMap:null,controlValues:{textFont:["default","times","comic","arial","verdana"]}}),b.defaults("fluid.prefs.panel.lineSpace",{gradeNames:["fluid.prefs.panel"],preferenceMap:{"fluid.prefs.lineSpace":{"model.lineSpace":"default","range.min":"minimum","range.max":"maximum"}},range:{min:1,max:2},selectors:{lineSpace:".flc-prefsEditor-line-space",label:".flc-prefsEditor-line-space-label",narrowIcon:".flc-prefsEditor-line-space-narrowIcon",wideIcon:".flc-prefsEditor-line-space-wideIcon",multiplier:".flc-prefsEditor-multiplier",lineSpaceDescr:".flc-prefsEditor-line-space-descr"},selectorsToIgnore:["lineSpace"],components:{textfieldSlider:{type:"fluid.textfieldSlider",container:"{that}.dom.lineSpace",createOnEvent:"afterRender",options:{model:{value:"{fluid.prefs.panel.lineSpace}.model.lineSpace"},range:"{fluid.prefs.panel.lineSpace}.options.range",sliderOptions:"{fluid.prefs.panel.lineSpace}.options.sliderOptions"}}},protoTree:{label:{messagekey:"lineSpaceLabel"},narrowIcon:{messagekey:"lineSpaceNarrowIcon"},wideIcon:{messagekey:"lineSpaceWideIcon"},multiplier:{messagekey:"multiplier"},lineSpaceDescr:{messagekey:"lineSpaceDescr"}},sliderOptions:{orientation:"horizontal",step:.1,range:"min"}}),b.defaults("fluid.prefs.panel.contrast",{gradeNames:["fluid.prefs.panel"],preferenceMap:{"fluid.prefs.contrast":{"model.value":"default","controlValues.theme":"enum"}},listeners:{afterRender:"{that}.style"},selectors:{themeRow:".flc-prefsEditor-themeRow",themeLabel:".flc-prefsEditor-theme-label",themeInput:".flc-prefsEditor-themeInput",label:".flc-prefsEditor-contrast-label",contrastDescr:".flc-prefsEditor-contrast-descr"},styles:{defaultThemeLabel:"fl-prefsEditor-contrast-defaultThemeLabel"},stringArrayIndex:{theme:["contrast-default","contrast-bw","contrast-wb","contrast-by","contrast-yb","contrast-lgdg"]},repeatingSelectors:["themeRow"],protoTree:{label:{messagekey:"contrastLabel"},contrastDescr:{messagekey:"contrastDescr"},expander:{type:"fluid.renderer.selection.inputs",rowID:"themeRow",labelID:"themeLabel",inputID:"themeInput",selectID:"theme-radio",tree:{optionnames:"${{that}.msgLookup.theme}",optionlist:"${{that}.options.controlValues.theme}",selection:"${value}"}}},controlValues:{theme:["default","bw","wb","by","yb","lgdg"]},markup:{label:'<span class="fl-preview-A" aria-hidden="true"></span><span class="fl-hidden-accessible">%theme</span><div class="fl-crossout" aria-hidden="true"></div>'},invokers:{style:{funcName:"fluid.prefs.panel.contrast.style",args:["{that}.dom.themeLabel","{that}.msgLookup.theme","{that}.options.markup.label","{that}.options.controlValues.theme","default","{that}.options.classnameMap.theme","{that}.options.styles.defaultThemeLabel"]}}}),b.prefs.panel.contrast.style=function(c,d,e,f,g,h,i){b.each(c,function(c,j){c=a(c);var k=d[j];c.html(b.stringTemplate(e,{theme:k})),c.attr("aria-label",k);var l=f[j];l===g&&c.addClass(i),c.addClass(h[l])})},b.defaults("fluid.prefs.panel.layoutControls",{gradeNames:["fluid.prefs.panel"],preferenceMap:{"fluid.prefs.tableOfContents":{"model.toc":"default"}},selectors:{toc:".flc-prefsEditor-toc",label:".flc-prefsEditor-toc-label",tocDescr:".flc-prefsEditor-toc-descr"},protoTree:{label:{messagekey:"tocLabel"},tocDescr:{messagekey:"tocDescr"},toc:"${toc}"}}),b.defaults("fluid.prefs.panel.emphasizeLinks",{gradeNames:["fluid.prefs.panel"],preferenceMap:{"fluid.prefs.emphasizeLinks":{"model.links":"default"}},selectors:{links:".flc-prefsEditor-links",linksChoiceLabel:".flc-prefsEditor-links-choice-label"},protoTree:{linksChoiceLabel:{messagekey:"linksChoiceLabel"},links:"${links}"}}),b.defaults("fluid.prefs.panel.inputsLarger",{gradeNames:["fluid.prefs.panel"],preferenceMap:{"fluid.prefs.inputsLarger":{"model.inputsLarger":"default"}},selectors:{inputsLarger:".flc-prefsEditor-inputs-larger",inputsChoiceLabel:".flc-prefsEditor-links-inputs-choice-label"},protoTree:{inputsChoiceLabel:{messagekey:"inputsChoiceLabel"},inputsLarger:"${inputsLarger}"}}),b.defaults("fluid.prefs.panel.linksControls",{gradeNames:["fluid.prefs.compositePanel"],selectors:{label:".flc-prefsEditor-linksControls-label"},protoTree:{label:{messagekey:"linksControlsLabel"}}}),b.defaults("fluid.prefs.selectDecorator",{gradeNames:["fluid.viewComponent"],listeners:{onCreate:"fluid.prefs.selectDecorator.decorateOptions"},styles:{preview:"fl-preview-theme"}}),b.prefs.selectDecorator.decorateOptions=function(c){b.each(a("option",c.container),function(d){var e=c.options.styles;a(d).addClass(e.preview+" "+e[b.value(d)])})}}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.defaults("fluid.prefs.panel.speak",{gradeNames:["fluid.prefs.panel"],preferenceMap:{"fluid.prefs.speak":{"model.speak":"default"}},selectors:{speak:".flc-prefsEditor-speak",label:".flc-prefsEditor-speak-label",speakDescr:".flc-prefsEditor-speak-descr"},protoTree:{label:{messagekey:"speakLabel"},speakDescr:{messagekey:"speakDescr"},speak:"${speak}"}})}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.defaults("fluid.prefs.enactor",{gradeNames:["fluid.modelComponent"]}),b.defaults("fluid.prefs.enactor.styleElements",{gradeNames:["fluid.prefs.enactor"],cssClass:null,elementsToStyle:null,invokers:{applyStyle:{funcName:"fluid.prefs.enactor.styleElements.applyStyle",args:["{arguments}.0","{arguments}.1"]},resetStyle:{funcName:"fluid.prefs.enactor.styleElements.resetStyle",args:["{arguments}.0","{arguments}.1"]},handleStyle:{funcName:"fluid.prefs.enactor.styleElements.handleStyle",args:["{arguments}.0","{that}.options.elementsToStyle","{that}.options.cssClass","{that}.applyStyle","{that}.resetStyle"]}},modelListeners:{value:{listener:"{that}.handleStyle",args:["{change}.value"]}}}),b.prefs.enactor.styleElements.applyStyle=function(a,b){a.addClass(b)},b.prefs.enactor.styleElements.resetStyle=function(b,c){a(b,"."+c).andSelf().removeClass(c)},b.prefs.enactor.styleElements.handleStyle=function(a,b,c,d,e){var f=a?d:e;f(b,c)},b.defaults("fluid.prefs.enactor.classSwapper",{gradeNames:["fluid.prefs.enactor","fluid.viewComponent"],classes:{},invokers:{clearClasses:{funcName:"fluid.prefs.enactor.classSwapper.clearClasses",args:["{that}.container","{that}.classStr"]},swap:{funcName:"fluid.prefs.enactor.classSwapper.swap",args:["{arguments}.0","{that}","{that}.clearClasses"]}},modelListeners:{value:{listener:"{that}.swap",args:["{change}.value"]}},members:{classStr:{expander:{func:"fluid.prefs.enactor.classSwapper.joinClassStr",args:"{that}.options.classes"}}}}),b.prefs.enactor.classSwapper.clearClasses=function(a,b){a.removeClass(b)},b.prefs.enactor.classSwapper.swap=function(a,b,c){c(),b.container.addClass(b.options.classes[a])},b.prefs.enactor.classSwapper.joinClassStr=function(a){var c="";return b.each(a,function(a){a&&(c+=c?" "+a:a)}),c},b.defaults("fluid.prefs.enactor.emphasizeLinks",{gradeNames:["fluid.prefs.enactor.styleElements","fluid.viewComponent"],preferenceMap:{"fluid.prefs.emphasizeLinks":{"model.value":"default"}},cssClass:null,elementsToStyle:"{that}.container"}),b.defaults("fluid.prefs.enactor.inputsLarger",{gradeNames:["fluid.prefs.enactor.styleElements","fluid.viewComponent"],preferenceMap:{"fluid.prefs.inputsLarger":{"model.value":"default"}},cssClass:null,elementsToStyle:"{that}.container"}),b.defaults("fluid.prefs.enactor.textFont",{gradeNames:["fluid.prefs.enactor.classSwapper"],preferenceMap:{"fluid.prefs.textFont":{"model.value":"default"}}}),b.defaults("fluid.prefs.enactor.contrast",{gradeNames:["fluid.prefs.enactor.classSwapper"],preferenceMap:{"fluid.prefs.contrast":{"model.value":"default"}}}),b.prefs.enactor.getTextSizeInPx=function(a,b){var c=a.css("font-size");return b[c]&&(c=b[c]),parseFloat(c)},b.defaults("fluid.prefs.enactor.textSize",{gradeNames:["fluid.prefs.enactor","fluid.viewComponent"],preferenceMap:{"fluid.prefs.textSize":{"model.value":"default"}},members:{root:{expander:{"this":"{that}.container",method:"closest",args:["html"]}}},fontSizeMap:{},invokers:{set:{funcName:"fluid.prefs.enactor.textSize.set",args:["{arguments}.0","{that}","{that}.getTextSizeInPx"]},getTextSizeInPx:{funcName:"fluid.prefs.enactor.getTextSizeInPx",args:["{that}.root","{that}.options.fontSizeMap"]}},modelListeners:{value:{listener:"{that}.set",args:["{change}.value"]}}}),b.prefs.enactor.textSize.set=function(a,b,c){if(a=a||1,b.initialSize||(b.initialSize=c()),b.initialSize){var d=a*b.initialSize;b.root.css("font-size",d+"px")}},b.defaults("fluid.prefs.enactor.lineSpace",{gradeNames:["fluid.prefs.enactor","fluid.viewComponent"],preferenceMap:{"fluid.prefs.lineSpace":{"model.value":"default"}},fontSizeMap:{},invokers:{set:{funcName:"fluid.prefs.enactor.lineSpace.set",args:["{arguments}.0","{that}","{that}.getLineHeightMultiplier"]},getTextSizeInPx:{funcName:"fluid.prefs.enactor.getTextSizeInPx",args:["{that}.container","{that}.options.fontSizeMap"]},getLineHeight:{funcName:"fluid.prefs.enactor.lineSpace.getLineHeight",args:"{that}.container"},getLineHeightMultiplier:{funcName:"fluid.prefs.enactor.lineSpace.getLineHeightMultiplier",args:[{expander:{func:"{that}.getLineHeight"}},{expander:{func:"{that}.getTextSizeInPx"}}]}},modelListeners:{value:{listener:"{that}.set",args:["{change}.value"]}}}),b.prefs.enactor.lineSpace.getLineHeight=function(a){return a.css("line-height")},b.prefs.enactor.lineSpace.getLineHeightMultiplier=function(a,b){return a?"normal"===a?1.2:a.match(/[0-9]$/)?Number(a):Math.round(parseFloat(a)/b*100)/100:0},b.prefs.enactor.lineSpace.set=function(a,b,c){if(b.initialSize||(b.initialSize=c()),b.initialSize){var d=a*b.initialSize;b.container.css("line-height",d)}},b.defaults("fluid.prefs.enactor.tableOfContents",{gradeNames:["fluid.prefs.enactor","fluid.viewComponent"],preferenceMap:{"fluid.prefs.tableOfContents":{"model.toc":"default"}},tocTemplate:null,components:{tableOfContents:{type:"fluid.tableOfContents",container:"{fluid.prefs.enactor.tableOfContents}.container",createOnEvent:"onCreateTOCReady",options:{components:{levels:{type:"fluid.tableOfContents.levels",options:{resources:{template:{forceCache:!0,url:"{fluid.prefs.enactor.tableOfContents}.options.tocTemplate"}}}}},listeners:{afterRender:"{fluid.prefs.enactor.tableOfContents}.events.afterTocRender"}}}},invokers:{applyToc:{funcName:"fluid.prefs.enactor.tableOfContents.applyToc",args:["{arguments}.0","{that}"]}},events:{onCreateTOCReady:null,afterTocRender:null,onLateRefreshRelay:null},modelListeners:{toc:{listener:"{that}.applyToc",args:["{change}.value"]}},distributeOptions:{source:"{that}.options.ignoreForToC",target:"{that tableOfContents}.options.ignoreForToC"}}),b.prefs.enactor.tableOfContents.applyToc=function(a,b){a?b.tableOfContents?b.tableOfContents.show():b.events.onCreateTOCReady.fire():b.tableOfContents&&b.tableOfContents.hide()}}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.defaults("fluid.prefs.enactor.speak",{gradeNames:"fluid.prefs.enactor",preferenceMap:{"fluid.prefs.speak":{"model.enabled":"default"}},components:{tts:{type:"fluid.textToSpeech",options:{model:"{speak}.model",invokers:{queueSpeech:{funcName:"fluid.prefs.enactor.speak.queueSpeech",args:["{that}","fluid.textToSpeech.queueSpeech","{arguments}.0","{arguments}.1","{arguments}.2"]}}}}}}),b.prefs.enactor.speak.queueSpeech=function(a,c,d,e,f){var g=d.toString();g=g.trim(),g.replace(/\s{2,}/gi," "),a.model.enabled&&g&&("string"==typeof c?b.invokeGlobalFunction(c,[a,g,e,f]):c(a,g,e,f))},b.defaults("fluid.prefs.enactor.selfVoicing",{gradeNames:["fluid.prefs.enactor.speak","fluid.viewComponent"],modelListeners:{enabled:{listener:"{that}.handleSelfVoicing",args:["{change}.value"]}},invokers:{handleSelfVoicing:{funcName:"fluid.prefs.enactor.selfVoicing.handleSelfVoicing",args:["{that}.options.strings.welcomeMsg","{tts}.queueSpeech","{that}.readFromDOM","{tts}.cancel","{arguments}.0"]},readFromDOM:{funcName:"fluid.prefs.enactor.selfVoicing.readFromDOM",args:["{that}","{that}.container"]}},strings:{welcomeMsg:"text to speech enabled"}}),b.prefs.enactor.selfVoicing.handleSelfVoicing=function(a,b,c,d,e){e?(b(a,!0),c()):d()},b.prefs.enactor.selfVoicing.nodeType={ELEMENT_NODE:1,TEXT_NODE:3},b.prefs.enactor.selfVoicing.readFromDOM=function(c,d){d=a(d);var e=d.contents();b.each(e,function(a){if(a.nodeType===b.prefs.enactor.selfVoicing.nodeType.TEXT_NODE&&a.nodeValue&&c.tts.queueSpeech(a.nodeValue),a.nodeType===b.prefs.enactor.selfVoicing.nodeType.ELEMENT_NODE&&"none"!==window.getComputedStyle(a).display)if("IMG"===a.nodeName){var d=a.getAttribute("alt");d&&c.tts.queueSpeech(d)}else b.prefs.enactor.selfVoicing.readFromDOM(c,a)})}}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.defaults("fluid.prefs.initialModel.starter",{gradeNames:["fluid.prefs.initialModel"],members:{initialModel:{preferences:{textFont:"default",theme:"default",textSize:1,lineSpace:1,toc:!1,links:!1,inputsLarger:!1}}}}),b.defaults("fluid.uiEnhancer.cssClassEnhancerBase",{gradeNames:["fluid.component"],classnameMap:{textFont:{"default":"",times:"fl-font-times",comic:"fl-font-comic-sans",arial:"fl-font-arial",verdana:"fl-font-verdana"},theme:{"default":"fl-theme-prefsEditor-default",bw:"fl-theme-prefsEditor-bw fl-theme-bw",wb:"fl-theme-prefsEditor-wb fl-theme-wb",by:"fl-theme-prefsEditor-by fl-theme-by",yb:"fl-theme-prefsEditor-yb fl-theme-yb",lgdg:"fl-theme-prefsEditor-lgdg fl-theme-lgdg"},links:"fl-link-enhanced",inputsLarger:"fl-text-larger"}}),b.defaults("fluid.uiEnhancer.browserTextEnhancerBase",{gradeNames:["fluid.component"],fontSizeMap:{"xx-small":"9px","x-small":"11px",small:"13px",medium:"15px",large:"18px","x-large":"23px","xx-large":"30px"}}),b.defaults("fluid.uiEnhancer.starterEnactors",{gradeNames:["fluid.uiEnhancer","fluid.uiEnhancer.cssClassEnhancerBase","fluid.uiEnhancer.browserTextEnhancerBase"],model:"{fluid.prefs.initialModel}.initialModel.preferences",components:{textSize:{type:"fluid.prefs.enactor.textSize",container:"{uiEnhancer}.container",options:{fontSizeMap:"{uiEnhancer}.options.fontSizeMap",model:{value:"{uiEnhancer}.model.textSize"}}},textFont:{type:"fluid.prefs.enactor.textFont",container:"{uiEnhancer}.container",options:{classes:"{uiEnhancer}.options.classnameMap.textFont",model:{value:"{uiEnhancer}.model.textFont"}}},lineSpace:{type:"fluid.prefs.enactor.lineSpace",container:"{uiEnhancer}.container",options:{fontSizeMap:"{uiEnhancer}.options.fontSizeMap",model:{value:"{uiEnhancer}.model.lineSpace"}}},contrast:{type:"fluid.prefs.enactor.contrast",container:"{uiEnhancer}.container",options:{classes:"{uiEnhancer}.options.classnameMap.theme",model:{value:"{uiEnhancer}.model.theme"}}},emphasizeLinks:{type:"fluid.prefs.enactor.emphasizeLinks",container:"{uiEnhancer}.container",options:{cssClass:"{uiEnhancer}.options.classnameMap.links",model:{value:"{uiEnhancer}.model.links"}}},inputsLarger:{type:"fluid.prefs.enactor.inputsLarger",container:"{uiEnhancer}.container",options:{cssClass:"{uiEnhancer}.options.classnameMap.inputsLarger",model:{value:"{uiEnhancer}.model.inputsLarger"}}},tableOfContents:{type:"fluid.prefs.enactor.tableOfContents",container:"{uiEnhancer}.container",options:{tocTemplate:"{uiEnhancer}.options.tocTemplate",model:{toc:"{uiEnhancer}.model.toc"}}}}}),b.defaults("fluid.prefs.starterPanels",{gradeNames:["fluid.prefs.prefsEditor"],selectors:{textSize:".flc-prefsEditor-text-size",textFont:".flc-prefsEditor-text-font",lineSpace:".flc-prefsEditor-line-space",contrast:".flc-prefsEditor-contrast",textControls:".flc-prefsEditor-text-controls",layoutControls:".flc-prefsEditor-layout-controls",linksControls:".flc-prefsEditor-links-controls"},components:{textSize:{type:"fluid.prefs.panel.textSize",container:"{prefsEditor}.dom.textSize",createOnEvent:"onPrefsEditorMarkupReady",options:{gradeNames:"fluid.prefs.prefsEditorConnections",model:{textSize:"{prefsEditor}.model.preferences.textSize"},messageBase:"{messageLoader}.resources.textSize.resourceText",resources:{template:"{templateLoader}.resources.textSize"}}},lineSpace:{type:"fluid.prefs.panel.lineSpace",container:"{prefsEditor}.dom.lineSpace",createOnEvent:"onPrefsEditorMarkupReady",options:{gradeNames:"fluid.prefs.prefsEditorConnections",model:{lineSpace:"{prefsEditor}.model.preferences.lineSpace"},messageBase:"{messageLoader}.resources.lineSpace.resourceText",resources:{template:"{templateLoader}.resources.lineSpace"}}},textFont:{type:"fluid.prefs.panel.textFont",container:"{prefsEditor}.dom.textFont",createOnEvent:"onPrefsEditorMarkupReady",options:{gradeNames:"fluid.prefs.prefsEditorConnections",classnameMap:"{uiEnhancer}.options.classnameMap",model:{value:"{prefsEditor}.model.preferences.textFont"},messageBase:"{messageLoader}.resources.textFont.resourceText",resources:{template:"{templateLoader}.resources.textFont"}}},contrast:{type:"fluid.prefs.panel.contrast",container:"{prefsEditor}.dom.contrast",createOnEvent:"onPrefsEditorMarkupReady",options:{gradeNames:"fluid.prefs.prefsEditorConnections",classnameMap:"{uiEnhancer}.options.classnameMap",model:{value:"{prefsEditor}.model.preferences.theme"},messageBase:"{messageLoader}.resources.contrast.resourceText",resources:{template:"{templateLoader}.resources.contrast"}}},layoutControls:{type:"fluid.prefs.panel.layoutControls",container:"{prefsEditor}.dom.layoutControls",createOnEvent:"onPrefsEditorMarkupReady",options:{gradeNames:"fluid.prefs.prefsEditorConnections",model:{toc:"{prefsEditor}.model.preferences.toc"},messageBase:"{messageLoader}.resources.layoutControls.resourceText",resources:{template:"{templateLoader}.resources.layoutControls"}}},linksControls:{type:"fluid.prefs.panel.linksControls",container:"{prefsEditor}.dom.linksControls",createOnEvent:"onPrefsEditorMarkupReady",options:{gradeNames:"fluid.prefs.prefsEditorConnections",selectors:{emphasizeLinks:".flc-prefsEditor-emphasizeLinks",inputsLarger:".flc-prefsEditor-inputsLarger"},selectorsToIgnore:["emphasizeLinks","inputsLarger"],model:{fluid_prefs_emphasizeLinks:"{prefsEditor}.model.preferences.links",fluid_prefs_inputsLarger:"{prefsEditor}.model.preferences.inputsLarger"},components:{emphasizeLinks:{type:"fluid.prefs.panel.emphasizeLinks",container:"{that}.dom.emphasizeLinks",createOnEvent:"initSubPanels",options:{messageBase:"{messageLoader}.resources.emphasizeLinks.resourceText"}},inputsLarger:{type:"fluid.prefs.panel.inputsLarger",container:"{that}.dom.inputsLarger",createOnEvent:"initSubPanels",options:{messageBase:"{messageLoader}.resources.inputsLarger.resourceText"}}},messageBase:"{messageLoader}.resources.linksControls.resourceText",resources:{template:"{templateLoader}.resources.linksControls",emphasizeLinks:"{templateLoader}.resources.emphasizeLinks",inputsLarger:"{templateLoader}.resources.inputsLarger"}}}}}),b.defaults("fluid.prefs.starterTemplateLoader",{gradeNames:["fluid.prefs.resourceLoader"],resources:{textSize:"%templatePrefix/PrefsEditorTemplate-textSize.html",textFont:"%templatePrefix/PrefsEditorTemplate-textFont.html",lineSpace:"%templatePrefix/PrefsEditorTemplate-lineSpace.html",contrast:"%templatePrefix/PrefsEditorTemplate-contrast.html",layoutControls:"%templatePrefix/PrefsEditorTemplate-layout.html",linksControls:"%templatePrefix/PrefsEditorTemplate-linksControls.html",emphasizeLinks:"%templatePrefix/PrefsEditorTemplate-emphasizeLinks.html",inputsLarger:"%templatePrefix/PrefsEditorTemplate-inputsLarger.html"}}),b.defaults("fluid.prefs.starterSeparatedPanelTemplateLoader",{gradeNames:["fluid.prefs.starterTemplateLoader"],resources:{prefsEditor:"%templatePrefix/SeparatedPanelPrefsEditor.html"}}),b.defaults("fluid.prefs.starterFullPreviewTemplateLoader",{gradeNames:["fluid.prefs.starterTemplateLoader"],resources:{prefsEditor:"%templatePrefix/FullPreviewPrefsEditor.html"}}),b.defaults("fluid.prefs.starterFullNoPreviewTemplateLoader",{gradeNames:["fluid.prefs.starterTemplateLoader"],resources:{prefsEditor:"%templatePrefix/FullNoPreviewPrefsEditor.html"}}),b.defaults("fluid.prefs.starterMessageLoader",{gradeNames:["fluid.prefs.resourceLoader"],resources:{prefsEditor:"%messagePrefix/prefsEditor.json",textSize:"%messagePrefix/textSize.json",textFont:"%messagePrefix/textFont.json",lineSpace:"%messagePrefix/lineSpace.json",contrast:"%messagePrefix/contrast.json",layoutControls:"%messagePrefix/tableOfContents.json",linksControls:"%messagePrefix/linksControls.json",emphasizeLinks:"%messagePrefix/emphasizeLinks.json",inputsLarger:"%messagePrefix/inputsLarger.json"}})}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.registerNamespace("fluid.dom"),b.dom.getDocumentHeight=function(b){var c=a("body",b)[0];return c.offsetHeight},b.defaults("fluid.prefs.separatedPanel",{gradeNames:["fluid.prefs.prefsEditorLoader"],events:{afterRender:null,onReady:null,onCreateSlidingPanelReady:{events:{iframeRendered:"afterRender",onPrefsEditorMessagesLoaded:"onPrefsEditorMessagesLoaded"
}},templatesAndIframeReady:{events:{iframeReady:"afterRender",templatesLoaded:"onPrefsEditorTemplatesLoaded",messagesLoaded:"onPrefsEditorMessagesLoaded"}}},listeners:{onReady:{listener:"fluid.prefs.separatedPanel.bindEvents",args:["{separatedPanel}.prefsEditor","{iframeRenderer}.iframeEnhancer","{separatedPanel}"]},onCreate:{listener:"fluid.prefs.separatedPanel.hideReset",args:["{separatedPanel}"]}},selectors:{reset:".flc-prefsEditor-reset",iframe:".flc-prefsEditor-iframe"},invokers:{bindReset:{funcName:"fluid.bind",args:["{separatedPanel}.dom.reset","click","{arguments}.0"]}},components:{slidingPanel:{type:"fluid.slidingPanel",container:"{separatedPanel}.container",createOnEvent:"onCreateSlidingPanelReady",options:{gradeNames:["fluid.prefs.msgLookup"],strings:{showText:"{that}.msgLookup.slidingPanelShowText",hideText:"{that}.msgLookup.slidingPanelHideText"},invokers:{operateShow:{funcName:"fluid.prefs.separatedPanel.showPanel",args:["{that}.dom.panel","{that}.events.afterPanelShow.fire"],"this":null,method:null},operateHide:{funcName:"fluid.prefs.separatedPanel.hidePanel",args:["{that}.dom.panel","{iframeRenderer}.iframe","{that}.events.afterPanelHide.fire"],"this":null,method:null}},components:{msgResolver:{type:"fluid.messageResolver",options:{messageBase:"{messageLoader}.resources.prefsEditor.resourceText"}}}}},iframeRenderer:{type:"fluid.prefs.separatedPanel.renderIframe",container:"{separatedPanel}.dom.iframe",options:{markupProps:{src:"%templatePrefix/SeparatedPanelPrefsEditorFrame.html"},events:{afterRender:"{separatedPanel}.events.afterRender"},components:{iframeEnhancer:{type:"fluid.uiEnhancer",container:"{iframeRenderer}.renderPrefsEditorContainer",createOnEvent:"afterRender",options:{gradeNames:["{pageEnhancer}.uiEnhancer.options.userGrades"],jQuery:"{iframeRenderer}.jQuery",tocTemplate:"{pageEnhancer}.uiEnhancer.options.tocTemplate"}}}}},prefsEditor:{createOnEvent:"templatesAndIframeReady",container:"{iframeRenderer}.renderPrefsEditorContainer",options:{gradeNames:["fluid.prefs.uiEnhancerRelay"],model:"{separatedPanel}.model",events:{onSignificantDOMChange:null,updateEnhancerModel:"{that}.events.modelChanged"},listeners:{modelChanged:"{that}.save",onCreate:{listener:"{separatedPanel}.bindReset",args:["{that}.reset"]},afterReset:"{that}.applyChanges",onReady:{listener:"{separatedPanel}.events.onReady",args:"{separatedPanel}"}}}}},outerEnhancerOptions:"{originalEnhancerOptions}.options.originalUserOptions",distributeOptions:[{source:"{that}.options.slidingPanel",removeSource:!0,target:"{that > slidingPanel}.options"},{source:"{that}.options.iframeRenderer",removeSource:!0,target:"{that > iframeRenderer}.options"},{source:"{that}.options.iframe",removeSource:!0,target:"{that}.options.selectors.iframe"},{source:"{that}.options.outerEnhancerOptions",removeSource:!0,target:"{that iframeEnhancer}.options"},{source:"{that}.options.terms",target:"{that > iframeRenderer}.options.terms"}]}),b.prefs.separatedPanel.hideReset=function(a){a.locate("reset").hide()},b.defaults("fluid.prefs.separatedPanel.renderIframe",{gradeNames:["fluid.viewComponent"],events:{afterRender:null},styles:{container:"fl-prefsEditor-separatedPanel-iframe"},terms:{templatePrefix:"."},markupProps:{"class":"flc-iframe",src:"%templatePrefix/prefsEditorIframe.html"},listeners:{"onCreate.startLoadingIframe":"fluid.prefs.separatedPanel.renderIframe.startLoadingIframe"}}),b.prefs.separatedPanel.renderIframe.startLoadingIframe=function(c){var d=c.options.styles;c.options.markupProps.src=b.stringTemplate(c.options.markupProps.src,c.options.terms),c.iframeSrc=c.options.markupProps.src,c.iframe=a("<iframe/>"),c.iframe.load(function(){var a=c.iframe[0].contentWindow;c.iframeDocument=a.document,c.jQuery=a.jQuery,c.renderPrefsEditorContainer=c.jQuery("body",c.iframeDocument),c.jQuery(c.iframeDocument).ready(c.events.afterRender.fire)}),c.iframe.attr(c.options.markupProps),c.iframe.addClass(d.container),c.iframe.hide(),c.iframe.appendTo(c.container)},b.prefs.separatedPanel.updateView=function(a){a.events.onPrefsEditorRefresh.fire(),a.events.onSignificantDOMChange.fire()},b.prefs.separatedPanel.bindEvents=function(a,c,d){d.slidingPanel.events.afterPanelShow.addListener(function(){b.prefs.separatedPanel.updateView(a)}),a.events.onPrefsEditorRefresh.addListener(function(){c.updateModel(a.model.preferences)}),a.events.afterReset.addListener(function(a){b.prefs.separatedPanel.updateView(a)}),a.events.onSignificantDOMChange.addListener(function(){var c=a.container[0].ownerDocument,e=b.dom.getDocumentHeight(c),f=d.iframeRenderer.iframe,g={height:e+15},h=d.slidingPanel.locate("panel");h.css({height:""}),f.animate(g,400)}),d.slidingPanel.events.afterPanelHide.addListener(function(){d.iframeRenderer.iframe.height(0),d.iframeRenderer.iframe.hide()}),d.slidingPanel.events.onPanelShow.addListener(function(){d.iframeRenderer.iframe.show(),d.locate("reset").show()}),d.slidingPanel.events.onPanelHide.addListener(function(){d.locate("reset").hide()})},b.prefs.separatedPanel.hidePanel=function(b,c,d){c.clearQueue(),a(b).animate({height:0},{duration:400,complete:d})},b.prefs.separatedPanel.showPanel=function(a,b){setTimeout(b,1)}}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.defaults("fluid.prefs.fullNoPreview",{gradeNames:["fluid.prefs.prefsEditorLoader"],components:{prefsEditor:{container:"{that}.container",options:{listeners:{afterReset:[{listener:"{that}.applyChanges"},{listener:"{that}.save"}],onReady:{listener:"{fullNoPreview}.events.onReady",args:"{fullNoPreview}"}}}}},events:{onReady:null}})}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.defaults("fluid.prefs.fullPreview",{gradeNames:["fluid.prefs.prefsEditorLoader"],outerUiEnhancerOptions:"{originalEnhancerOptions}.options.originalUserOptions",outerUiEnhancerGrades:"{originalEnhancerOptions}.uiEnhancer.options.userGrades",components:{prefsEditor:{container:"{that}.container",options:{components:{preview:{type:"fluid.prefs.preview",createOnEvent:"onReady",container:"{prefsEditor}.dom.previewFrame",options:{listeners:{onReady:"{fullPreview}.events.onPreviewReady"}}}},listeners:{onReady:"{fullPreview}.events.onPrefsEditorReady"},distributeOptions:{source:"{that}.options.preview",removeSource:!0,target:"{that > preview}.options"}}}},events:{onPrefsEditorReady:null,onPreviewReady:null,onReady:{events:{onPrefsEditorReady:"onPrefsEditorReady",onPreviewReady:"onPreviewReady"},args:"{that}"}},distributeOptions:[{source:"{that}.options.outerUiEnhancerOptions",target:"{that enhancer}.options"},{source:"{that}.options.preview",target:"{that preview}.options"},{source:"{that}.options.previewEnhancer",target:"{that enhancer}.options"},{source:"{that}.options.outerUiEnhancerGrades",target:"{that enhancer}.options.gradeNames"}]})}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.registerNamespace("fluid.prefs.schemas"),b.prefs.schemas.merge=function(b,c){return b||(b={type:"object",properties:{}}),c=c.properties||c,a.extend(!0,b.properties,c),b},b.defaults("fluid.prefs.primaryBuilder",{gradeNames:["fluid.component","{that}.buildPrimary"],schemaIndex:{expander:{func:"fluid.indexDefaults",args:["schemaIndex",{gradeNames:"fluid.prefs.schemas",indexFunc:"fluid.prefs.primaryBuilder.defaultSchemaIndexer"}]}},primarySchema:{},typeFilter:[],invokers:{buildPrimary:{funcName:"fluid.prefs.primaryBuilder.buildPrimary",args:["{that}.options.schemaIndex","{that}.options.typeFilter","{that}.options.primarySchema"]}}}),b.prefs.primaryBuilder.buildPrimary=function(a,c,d){var e="fluid.prefs.schemas.suppliedPrimary"+b.allocateGuid();b.defaults(e,{gradeNames:["fluid.prefs.schemas"],schema:b.filterKeys(d.properties||d,c,!1)});var f=[];return b.each(c,function(b){var c=a[b];c&&f.push.apply(f,c)}),f.push(e),f},b.prefs.primaryBuilder.defaultSchemaIndexer=function(a){return a.schema?b.keys(a.schema.properties):void 0},b.defaults("fluid.prefs.schemas",{gradeNames:["fluid.component"],mergePolicy:{schema:b.prefs.schemas.merge}})}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.registerNamespace("fluid.prefs"),b.defaults("fluid.prefs.auxSchema",{gradeNames:["fluid.component"],auxiliarySchema:{loaderGrades:["fluid.prefs.separatedPanel"]}}),b.prefs.expandSchemaValue=function(a,c){return"@"!==c.charAt(0)?c:b.get(a,c.substring(1))},b.prefs.addAtPath=function(c,d,e){var f=b.get(c,d);return b.set(c,d,a.extend(!0,{},f,e)),c},b.prefs.removeKey=function(a,b){var c=a[b];return delete a[b],c},b.prefs.rearrangeDirect=function(a,c,d){var e={},f=b.prefs.removeKey(a,d);return f&&b.set(e,c,f),e},b.prefs.addCommonOptions=function(a,c,d,e){e=e||{};var f=b.get(a,c);if(!f)return a;var g={},h={};return b.each(d,function(d,f){if("container"===f){var i=b.get(a,[c,"type"]),j=b.defaults(i);if(void 0===b.get(j,["argumentMap","container"]))return!1}-1!==f.indexOf("gradeNames")&&(h[f]=b.arrayConcatPolicy),f=b.stringTemplate(f,e),d="string"==typeof d?b.stringTemplate(d,e):d,b.set(g,f,d)}),b.set(a,c,b.merge(h,f,g)),a},b.prefs.containerNeeded=function(a,c){var d=b.get(a,[c,"type"]),e=b.defaults(d);return b.hasGrade(e,"fluid.viewComponent")||b.hasGrade(e,"fluid.rendererComponent")},b.prefs.checkPrimarySchema=function(a,c){return a||b.fail("The primary schema for "+c+" is not defined."),!!a},b.prefs.expandSchemaComponents=function(c,d,e,f,g,h,i,j){var k=b.copy(f)||{},l={},m={},n=b.prefs.removeKey(k,"type"),o=new RegExp("\\.","g"),p=n.replace(o,"_"),q=e.replace(o,"_");if(n){l[p]={type:n,options:k};var r=b.prefs.rearrangeDirect(k,p,"container"),s=b.prefs.rearrangeDirect(k,p,"template"),t=b.prefs.rearrangeDirect(k,p,"message"),u=b.defaults(n).preferenceMap,v=u[e],w=j[e];b.each(v,function(c,d){if(b.prefs.checkPrimarySchema(w,e)){var f={};if(0===d.indexOf("model.")){var g=d.slice(6);b.set(f,"model",b.get(f,"model")||{}),b.prefs.addCommonOptions(f,"model",i,{internalModelName:g,externalModelName:q}),b.set(m,["members","initialModel","preferences",q],w[c])}else b.set(f,d,w[c]);a.extend(!0,k,f)}}),b.prefs.addCommonOptions(l,p,h,{prefKey:p}),b.prefs.addAtPath(c,[d,"components"],l),b.prefs.addAtPath(c,[d,"selectors"],r),b.prefs.addAtPath(c,["templateLoader","resources"],s),b.prefs.addAtPath(c,["messageLoader","resources"],t),b.prefs.addAtPath(c,"initialModel",m)}return c},b.prefs.expandSchemaImpl=function(a,c){var d=b.copy(a);return c=c||d,b.each(d,function(a,e){if("object"==typeof a)d[e]=b.prefs.expandSchemaImpl(a,c);else if("string"==typeof a){var f=b.prefs.expandSchemaValue(c,a);void 0!==f?d[e]=f:delete d[e]}}),d},b.prefs.expandCompositePanels=function(c,d,e,f,g,h,i,j){var k=[];return b.each(d,function(d,e){var l={},m={},n={},o={},p={},q={},r=[],s=b.copy(d);b.set(l,"type",s.type),delete s.type,o=b.prefs.rearrangeDirect(s,e,"container"),p=b.prefs.rearrangeDirect(s,e,"template"),q=b.prefs.rearrangeDirect(s,e,"message");var t=[],u={},v={};b.isPlainObject(s.panels)&&!b.isArrayable(s.panels)?b.each(s.panels,function(a,c){t=t.concat(a),"always"!==c&&b.each(a,function(a){b.set(v,a,c)})}):t=s.panels,b.each(t,function(d){k.push(d);var f=b.get(c,[d,"type"]),m=b.prefs.subPanel.safePrefKey(f);r.push(m);var o=b.copy(b.get(c,[d,"panel"])),s=b.get(o,"type");b.set(u,[m,"type"],s);var t=b.get(v,d);t&&b.set(u,[m,"options","renderOnPreference"],t);var w=b.defaults(s).preferenceMap[f],x=j[f];b.each(w,function(c,d){if(b.prefs.checkPrimarySchema(x,f)){var e;0===d.indexOf("model.")?(b.set(l,["options","model"],b.get(l,["options","model"])||{}),b.prefs.addCommonOptions(l,["options","model"],i,{internalModelName:m,externalModelName:m}),b.set(n,["members","initialModel","preferences",m],x[c])):(e=e||{options:{}},b.set(e,"options."+d,x[c])),a.extend(!0,u[m],e)}}),b.set(p,m,b.get(o,"template")),b.set(q,m,b.get(o,"message")),b.set(l,["options","selectors",m],b.get(o,"container")),b.set(l,["options","resources"],b.get(l,["options","resources"])||{}),b.prefs.addCommonOptions(l.options,"resources",h,{subPrefKey:m}),delete o.type,delete o.template,delete o.message,delete o.container,b.set(u,[m,"options"],a.extend(!0,{},b.get(u,[m,"options"]),o)),b.prefs.addCommonOptions(u,m,g,{compositePanel:e,prefKey:m})}),delete s.panels,b.set(l,["options"],a.extend(!0,{},l.options,s)),b.set(l,["options","selectorsToIgnore"],r),b.set(l,["options","components"],u),m[e]=l,b.prefs.addCommonOptions(m,e,f,{prefKey:e}),b.prefs.addAtPath(c,["panels","components"],m),b.prefs.addAtPath(c,["panels","selectors"],o),b.prefs.addAtPath(c,["templateLoader","resources"],p),b.prefs.addAtPath(c,["messageLoader","resources"],q),b.prefs.addAtPath(c,"initialModel",n),a.extend(!0,c,{panelsToIgnore:k})}),c},b.prefs.expandSchema=function(a,c,d,e,f){var g=b.prefs.expandSchemaImpl(a);g.namespace=g.namespace||"fluid.prefs.created_"+b.allocateGuid();var h=b.get(g,"terms");h&&(delete g.terms,b.set(g,["terms","terms"],h));var i=b.get(g,"groups");return i&&b.prefs.expandCompositePanels(g,i,b.get(c,"panel"),b.get(e,"panel"),b.get(e,"subPanel"),b.get(e,"compositePanelBasedOnSub"),b.get(e,"panelModel"),f),b.each(g,function(a,d){var h="panel";a[h]&&!b.contains(g.panelsToIgnore,d)&&b.prefs.expandSchemaComponents(g,"panels",a.type,a[h],b.get(c,h),b.get(e,h),b.get(e,h+"Model"),f),h="enactor",a[h]&&b.prefs.expandSchemaComponents(g,"enactors",a.type,a[h],b.get(c,h),b.get(e,h),b.get(e,h+"Model"),f),b.each(["template","message"],function(a){d===a&&(b.set(g,[a+"Loader","resources","prefsEditor"],g[a]),delete g[a])})}),g.panelsToIgnore&&delete g.panelsToIgnore,b.each(d,function(a,c){b.prefs.addCommonOptions(g,c,a)}),g},b.defaults("fluid.prefs.auxBuilder",{gradeNames:["fluid.prefs.auxSchema"],mergePolicy:{elementCommonOptions:"noexpand"},topCommonOptions:{panels:{gradeNames:["fluid.prefs.prefsEditor"]},enactors:{gradeNames:["fluid.uiEnhancer"]},templateLoader:{gradeNames:["fluid.prefs.resourceLoader"]},messageLoader:{gradeNames:["fluid.prefs.resourceLoader"]},initialModel:{gradeNames:["fluid.prefs.initialModel"]},terms:{gradeNames:["fluid.component"]}},elementCommonOptions:{panel:{createOnEvent:"onPrefsEditorMarkupReady",container:"{prefsEditor}.dom.%prefKey","options.gradeNames":"fluid.prefs.prefsEditorConnections","options.resources.template":"{templateLoader}.resources.%prefKey","options.messageBase":"{messageLoader}.resources.%prefKey.resourceText"},panelModel:{"%internalModelName":"{prefsEditor}.model.preferences.%externalModelName"},compositePanelBasedOnSub:{"%subPrefKey":"{templateLoader}.resources.%subPrefKey"},subPanel:{container:"{%compositePanel}.dom.%prefKey","options.messageBase":"{messageLoader}.resources.%prefKey.resourceText"},enactor:{container:"{uiEnhancer}.container"},enactorModel:{"%internalModelName":"{uiEnhancer}.model.%externalModelName"}},indexes:{panel:{expander:{func:"fluid.indexDefaults",args:["panelsIndex",{gradeNames:"fluid.prefs.panel",indexFunc:"fluid.prefs.auxBuilder.prefMapIndexer"}]}},enactor:{expander:{func:"fluid.indexDefaults",args:["enactorsIndex",{gradeNames:"fluid.prefs.enactor",indexFunc:"fluid.prefs.auxBuilder.prefMapIndexer"}]}}},mappedDefaults:{},expandedAuxSchema:{expander:{func:"fluid.prefs.expandSchema",args:["{that}.options.auxiliarySchema","{that}.options.indexes","{that}.options.topCommonOptions","{that}.options.elementCommonOptions","{that}.options.mappedDefaults"]}}}),b.prefs.auxBuilder.prefMapIndexer=function(a){return b.keys(a.preferenceMap)}}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a){"use strict";a.defaults("fluid.prefs.termsAware"),a.defaults("fluid.prefs.auxSchema.starter",{gradeNames:["fluid.prefs.auxSchema"],auxiliarySchema:{loaderGrades:["fluid.prefs.separatedPanel"],namespace:"fluid.prefs.constructed",terms:{templatePrefix:"../../framework/preferences/html",messagePrefix:"../../framework/preferences/messages"},template:"%templatePrefix/SeparatedPanelPrefsEditor.html",message:"%messagePrefix/prefsEditor.json",textSize:{type:"fluid.prefs.textSize",enactor:{type:"fluid.prefs.enactor.textSize"},panel:{type:"fluid.prefs.panel.textSize",container:".flc-prefsEditor-text-size",template:"%templatePrefix/PrefsEditorTemplate-textSize.html",message:"%messagePrefix/textSize.json"}},lineSpace:{type:"fluid.prefs.lineSpace",enactor:{type:"fluid.prefs.enactor.lineSpace",fontSizeMap:{"xx-small":"9px","x-small":"11px",small:"13px",medium:"15px",large:"18px","x-large":"23px","xx-large":"30px"}},panel:{type:"fluid.prefs.panel.lineSpace",container:".flc-prefsEditor-line-space",template:"%templatePrefix/PrefsEditorTemplate-lineSpace.html",message:"%messagePrefix/lineSpace.json"}},textFont:{type:"fluid.prefs.textFont",classes:{"default":"",times:"fl-font-times",comic:"fl-font-comic-sans",arial:"fl-font-arial",verdana:"fl-font-verdana"},enactor:{type:"fluid.prefs.enactor.textFont",classes:"@textFont.classes"},panel:{type:"fluid.prefs.panel.textFont",container:".flc-prefsEditor-text-font",classnameMap:{textFont:"@textFont.classes"},template:"%templatePrefix/PrefsEditorTemplate-textFont.html",message:"%messagePrefix/textFont.json"}},contrast:{type:"fluid.prefs.contrast",classes:{"default":"fl-theme-prefsEditor-default",bw:"fl-theme-prefsEditor-bw fl-theme-bw",wb:"fl-theme-prefsEditor-wb fl-theme-wb",by:"fl-theme-prefsEditor-by fl-theme-by",yb:"fl-theme-prefsEditor-yb fl-theme-yb",lgdg:"fl-theme-prefsEditor-lgdg fl-theme-lgdg"},enactor:{type:"fluid.prefs.enactor.contrast",classes:"@contrast.classes"},panel:{type:"fluid.prefs.panel.contrast",container:".flc-prefsEditor-contrast",classnameMap:{theme:"@contrast.classes"},template:"%templatePrefix/PrefsEditorTemplate-contrast.html",message:"%messagePrefix/contrast.json"}},tableOfContents:{type:"fluid.prefs.tableOfContents",enactor:{type:"fluid.prefs.enactor.tableOfContents",tocTemplate:"../../components/tableOfContents/html/TableOfContents.html"},panel:{type:"fluid.prefs.panel.layoutControls",container:".flc-prefsEditor-layout-controls",template:"%templatePrefix/PrefsEditorTemplate-layout.html",message:"%messagePrefix/tableOfContents.json"}},emphasizeLinks:{type:"fluid.prefs.emphasizeLinks",enactor:{type:"fluid.prefs.enactor.emphasizeLinks",cssClass:"fl-link-enhanced"},panel:{type:"fluid.prefs.panel.emphasizeLinks",container:".flc-prefsEditor-emphasizeLinks",template:"%templatePrefix/PrefsEditorTemplate-emphasizeLinks.html",message:"%messagePrefix/emphasizeLinks.json"}},inputsLarger:{type:"fluid.prefs.inputsLarger",enactor:{type:"fluid.prefs.enactor.inputsLarger",cssClass:"fl-text-larger"},panel:{type:"fluid.prefs.panel.inputsLarger",container:".flc-prefsEditor-inputsLarger",template:"%templatePrefix/PrefsEditorTemplate-inputsLarger.html",message:"%messagePrefix/inputsLarger.json"}},groups:{linksControls:{container:".flc-prefsEditor-links-controls",template:"%templatePrefix/PrefsEditorTemplate-linksControls.html",message:"%messagePrefix/linksControls.json",type:"fluid.prefs.panel.linksControls",panels:["emphasizeLinks","inputsLarger"]}}}}),a.defaults("fluid.prefs.schemas.textSize",{gradeNames:["fluid.prefs.schemas"],schema:{"fluid.prefs.textSize":{type:"number","default":1,minimum:1,maximum:2,divisibleBy:.1}}}),a.defaults("fluid.prefs.schemas.lineSpace",{gradeNames:["fluid.prefs.schemas"],schema:{"fluid.prefs.lineSpace":{type:"number","default":1,minimum:1,maximum:2,divisibleBy:.1}}}),a.defaults("fluid.prefs.schemas.textFont",{gradeNames:["fluid.prefs.schemas"],schema:{"fluid.prefs.textFont":{type:"string","default":"default","enum":["default","times","comic","arial","verdana"]}}}),a.defaults("fluid.prefs.schemas.contrast",{gradeNames:["fluid.prefs.schemas"],schema:{"fluid.prefs.contrast":{type:"string","default":"default","enum":["default","bw","wb","by","yb","lgdg"]}}}),a.defaults("fluid.prefs.schemas.tableOfContents",{gradeNames:["fluid.prefs.schemas"],schema:{"fluid.prefs.tableOfContents":{type:"boolean","default":!1}}}),a.defaults("fluid.prefs.schemas.emphasizeLinks",{gradeNames:["fluid.prefs.schemas"],schema:{"fluid.prefs.emphasizeLinks":{type:"boolean","default":!1}}}),a.defaults("fluid.prefs.schemas.inputsLarger",{gradeNames:["fluid.prefs.schemas"],schema:{"fluid.prefs.inputsLarger":{type:"boolean","default":!1}}})}(fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a){"use strict";a.defaults("fluid.prefs.auxSchema.speak",{gradeNames:["fluid.prefs.auxSchema"],auxiliarySchema:{namespace:"fluid.prefs.constructed",terms:{templatePrefix:"../../framework/preferences/html/",messagePrefix:"../../framework/preferences/messages/"},template:"%templatePrefix/SeparatedPanelPrefsEditor.html",message:"%messagePrefix/prefsEditor.json",speak:{type:"fluid.prefs.speak",enactor:{type:"fluid.prefs.enactor.selfVoicing",container:"body"},panel:{type:"fluid.prefs.panel.speak",container:".flc-prefsEditor-speak",template:"%templatePrefix/PrefsEditorTemplate-speak.html",message:"%messagePrefix/speak.json"}}}}),a.defaults("fluid.prefs.schemas.speak",{gradeNames:["fluid.prefs.schemas"],schema:{"fluid.prefs.speak":{type:"boolean","default":!1}}})}(fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.registerNamespace("fluid.prefs"),b.defaults("fluid.prefs.builder",{gradeNames:["fluid.component","fluid.prefs.auxBuilder"],mergePolicy:{auxSchema:"expandedAuxSchema"},assembledPrefsEditorGrade:{expander:{func:"fluid.prefs.builder.generateGrade",args:["prefsEditor","{that}.options.auxSchema.namespace",{gradeNames:["fluid.prefs.assembler.prefsEd","fluid.viewComponent"],componentGrades:"{that}.options.constructedGrades",loaderGrades:"{that}.options.auxSchema.loaderGrades"}]}},assembledUIEGrade:{expander:{func:"fluid.prefs.builder.generateGrade",args:["uie","{that}.options.auxSchema.namespace",{gradeNames:["fluid.viewComponent","fluid.prefs.assembler.uie"],componentGrades:"{that}.options.constructedGrades"}]}},constructedGrades:{expander:{func:"fluid.prefs.builder.constructGrades",args:["{that}.options.auxSchema",["enactors","messages","panels","initialModel","templateLoader","messageLoader","terms"]]}},mappedDefaults:"{primaryBuilder}.options.schema.properties",components:{primaryBuilder:{type:"fluid.prefs.primaryBuilder",options:{typeFilter:{expander:{func:"fluid.prefs.builder.parseAuxSchema",args:"{builder}.options.auxiliarySchema"}}}}},distributeOptions:[{source:"{that}.options.primarySchema",removeSource:!0,target:"{that > primaryBuilder}.options.primarySchema"}]}),b.defaults("fluid.prefs.assembler.uie",{gradeNames:["fluid.viewComponent"],components:{store:{type:"fluid.prefs.globalSettingsStore",options:{distributeOptions:{target:"{that fluid.prefs.store}.options.contextAwareness.strategy.checks.user",record:{contextValue:"{fluid.prefs.assembler.uie}.options.storeType",gradeNames:"{fluid.prefs.assembler.uie}.options.storeType"}}}},enhancer:{type:"fluid.component",options:{gradeNames:"{that}.options.enhancerType",enhancerType:"fluid.pageEnhancer",components:{uiEnhancer:{options:{gradeNames:["{fluid.prefs.assembler.uie}.options.componentGrades.enactors"]}}}}}},distributeOptions:[{source:"{that}.options.enhancer",target:"{that uiEnhancer}.options",removeSource:!0},{source:"{that}.options.store",target:"{that fluid.prefs.store}.options"},{source:"{that}.options.enhancerType",target:"{that > enhancer}.options.enhancerType"}]}),b.defaults("fluid.prefs.assembler.prefsEd",{gradeNames:["fluid.viewComponent","fluid.prefs.assembler.uie"],components:{prefsEditorLoader:{type:"fluid.viewComponent",container:"{fluid.prefs.assembler.prefsEd}.container",priority:"last",options:{gradeNames:["{fluid.prefs.assembler.prefsEd}.options.componentGrades.terms","{fluid.prefs.assembler.prefsEd}.options.componentGrades.messages","{fluid.prefs.assembler.prefsEd}.options.componentGrades.initialModel","{that}.options.loaderGrades"],templateLoader:{gradeNames:["{fluid.prefs.assembler.prefsEd}.options.componentGrades.templateLoader"]},messageLoader:{gradeNames:["{fluid.prefs.assembler.prefsEd}.options.componentGrades.messageLoader"]},prefsEditor:{gradeNames:["{fluid.prefs.assembler.prefsEd}.options.componentGrades.panels","fluid.prefs.uiEnhancerRelay"]},events:{onReady:"{fluid.prefs.assembler.prefsEd}.events.onPrefsEditorReady"}}}},events:{onPrefsEditorReady:null,onReady:{events:{onPrefsEditorReady:"onPrefsEditorReady",onCreate:"onCreate"},args:["{that}"]}},distributeOptions:[{source:"{that}.options.loaderGrades",removeSource:!0,target:"{that > prefsEditorLoader}.options.loaderGrades"},{source:"{that}.options.prefsEditor",removeSource:!0,target:"{that prefsEditor}.options"},{source:"{that}.options.terms",removeSource:!0,target:"{that prefsEditorLoader}.options.terms"}]}),b.prefs.builder.generateGrade=function(a,c,d){var e="%namespace.%name",f=b.stringTemplate(e,{name:a,namespace:c});return b.defaults(f,d),f},b.prefs.builder.constructGrades=function(a,c){var d={};return b.each(c,function(c){var e=a[c];b.get(e,"gradeNames")&&(d[c]=b.prefs.builder.generateGrade(c,a.namespace,e))}),d},b.prefs.builder.parseAuxSchema=function(a){var c=[];return b.each(a,function(a){var b=a.type;b&&c.push(b)}),c},b.prefs.create=function(a,c){c=c||{};var d=b.prefs.builder(c.build);return b.invokeGlobalFunction(d.options.assembledPrefsEditorGrade,[a,c.prefsEditor])}}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.registerNamespace("fluid.overviewPanel"),b.overviewPanel.makeBooleanListener=function(a,b,c,d,e){var f=a.locate(b);f[c](function(b){a.applier.change(d,"toggle"===e?!a.model[d]:e),b.preventDefault()})},b.defaults("fluid.overviewPanel",{gradeNames:["fluid.rendererComponent"],resources:{template:{href:"../html/overviewPanelTemplate.html"}},listeners:{"onCreate.setVisibility":"{that}.setVisibility","onCreate.showTemplate":"fluid.overviewPanel.showTemplate","afterRender.registerToggleListener":{funcName:"fluid.overviewPanel.makeBooleanListener",args:["{that}","toggleControl","click","showPanel","toggle"]},"afterRender.registerCloseListener":{funcName:"fluid.overviewPanel.makeBooleanListener",args:["{that}","closeControl","click","showPanel",!1]},"afterRender.setLinkHrefs":{funcName:"fluid.overviewPanel.setLinkHrefs",args:["{that}","{that}.options.links"]},"afterRender.setToggleControlAria":{"this":"{that}.dom.toggleControl",method:"attr",args:{role:"button","aria-controls":"{that}.containerId"}},"afterRender.setCloseControlAria":{"this":"{that}.dom.closeControl",method:"attr",args:{role:"button","aria-label":"{that}.options.strings.closePanelLabel","aria-controls":"{that}.containerId"}},"afterRender.setAriaStates":"{that}.setAriaStates"},model:{showPanel:!0},modelListeners:{"showPanel.setVisibility":"{that}.setVisibility","showPanel.setAriaStates":"{that}.setAriaStates"},members:{containerId:{expander:{funcName:"fluid.allocateSimpleId",args:"{that}.container"}}},invokers:{setVisibility:{funcName:"fluid.overviewPanel.setVisibility",args:["{that}","{that}.model.showPanel"]},setAriaStates:{funcName:"fluid.overviewPanel.setAriaStates",args:["{that}","{that}.model.showPanel"]}},selectors:{toggleControl:".flc-overviewPanel-toggleControl",titleBegin:".flc-overviewPanel-title-begin",titleLink:".flc-overviewPanel-titleLink",titleLinkText:".flc-overviewPanel-title-linkText",titleEnd:".flc-overviewPanel-title-end",componentName:".flc-overviewPanel-componentName",description:".flc-overviewPanel-description",instructionsHeading:".flc-overviewPanel-instructionsHeading",instructions:".flc-overviewPanel-instructions",demoCodeLink:".flc-overviewPanel-demoCodeLink",demoCodeLinkText:".flc-overviewPanel-demoCodeLinkText",infusionCodeLink:".flc-overviewPanel-infusionCodeLink",infusionCodeLinkText:".flc-overviewPanel-infusionCodeLinkText",apiLink:".flc-overviewPanel-apiLink",apiLinkText:".flc-overviewPanel-apiLinkText",designLink:".flc-overviewPanel-designLink",designLinkText:".flc-overviewPanel-designLinkText",feedbackText:".flc-overviewPanel-feedbackText",feedbackLink:".flc-overviewPanel-feedbackLink",feedbackLinkText:".flc-overviewPanel-feedbackLinkText",closeControl:".flc-overviewPanel-closeControl",closeText:".flc-overviewPanel-closeText"},selectorsToIgnore:["toggleControl","titleLink","demoCodeLink","infusionCodeLink","apiLink","designLink","feedbackLink","closeControl"],protoTree:{titleBegin:{messagekey:"titleBegin"},titleLinkText:{messagekey:"titleLinkText"},titleEnd:{messagekey:"titleEnd"},componentName:{messagekey:"componentName"},description:{markup:"${{that}.options.markup.description}"},instructionsHeading:{messagekey:"instructionsHeading"},instructions:{markup:"${{that}.options.markup.instructions}"},demoCodeLinkText:{messagekey:"demoCodeLinkText"},infusionCodeLinkText:{messagekey:"infusionCodeLinkText"},apiLinkText:{messagekey:"apiLinkText"},designLinkText:{messagekey:"designLinkText"},feedbackText:{messagekey:"feedbackText"},feedbackLinkText:{messagekey:"feedbackLinkText"},closeText:{messagekey:"closeText"}},styles:{hidden:"fl-overviewPanel-hidden"},strings:{titleBegin:"An",titleLinkText:"Infusion",titleEnd:"component demo",componentName:"Component Name",instructionsHeading:"Instructions",demoCodeLinkText:"demo code",infusionCodeLinkText:"get Infusion",apiLinkText:"API",designLinkText:"design",feedbackText:"Found a bug? Have a question?",feedbackLinkText:"Let us know!",closeText:"close",openPanelLabel:"Open the overview panel",closePanelLabel:"Close the overview panel"},markup:{description:"A description of the component should appear here. It should say: <ul><li>What the component does.</li><li>Why it is interesting / useful.</li></ul>",instructions:"<p>Do this to do this. Do that to do that.</p>"},links:{titleLink:"http://fluidproject.org/infusion.html",demoCodeLink:"#",infusionCodeLink:"https://github.com/fluid-project/infusion/",apiLink:"#",designLink:"#",feedbackLink:"#"}}),b.overviewPanel.setVisibility=function(a,b){a.container.toggleClass(a.options.styles.hidden,!b)},b.overviewPanel.showTemplate=function(a){b.fetchResources(a.options.resources,function(){a.refreshView()})},b.overviewPanel.setLinkHrefs=function(a,c){b.each(c,function(b,c){a.locate(c).attr("href",b)})},b.overviewPanel.setAriaStates=function(a,b){a.locate("toggleControl").attr("aria-pressed",!b),a.locate("toggleControl").attr("aria-expanded",b),a.locate("closeControl").attr("aria-expanded",b),b?a.locate("toggleControl").attr("aria-label",a.options.strings.closePanelLabel):a.locate("toggleControl").attr("aria-label",a.options.strings.openPanelLabel)}}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.registerNamespace("fluid.undo"),b.undo.STATE_INITIAL="state_initial",b.undo.STATE_CHANGED="state_changed",b.undo.STATE_REVERTED="state_reverted",b.undo.defaultRenderer=function(b,c){var d=b.options.strings,e="<span class='flc-undo'><a href='#' class='flc-undo-undoControl'>"+d.undo+"</a><a href='#' class='flc-undo-redoControl'>"+d.redo+"</a></span>",f=a(e).attr({role:"region","aria-live":"polite","aria-relevant":"all"});return c.append(f),f},b.undo.refreshView=function(a){a.state===b.undo.STATE_INITIAL?(a.locate("undoContainer").hide(),a.locate("redoContainer").hide()):a.state===b.undo.STATE_CHANGED?(a.locate("undoContainer").show(),a.locate("redoContainer").hide()):a.state===b.undo.STATE_REVERTED&&(a.locate("undoContainer").hide(),a.locate("redoContainer").show())},b.undo.undoControlClick=function(a){return a.state!==b.undo.STATE_REVERTED&&(b.model.copyModel(a.extremalModel,a.component.model),a.component.updateModel(a.initialModel,a),a.state=b.undo.STATE_REVERTED,b.undo.refreshView(a),a.locate("redoControl").focus()),!1},b.undo.redoControlClick=function(a){return a.state!==b.undo.STATE_CHANGED&&(a.component.updateModel(a.extremalModel,a),a.state=b.undo.STATE_CHANGED,b.undo.refreshView(a),a.locate("undoControl").focus()),!1},b.undo.modelChanged=function(a,c,d,e){e!==a&&(a.state=b.undo.STATE_CHANGED,b.model.copyModel(a.initialModel,d),b.undo.refreshView(a))},b.undo.copyInitialModel=function(a){b.model.copyModel(a.initialModel,a.component.model),b.model.copyModel(a.extremalModel,a.component.model)},b.undo.setTabindex=function(a){b.tabindex(a.locate("undoControl"),0),b.tabindex(a.locate("redoControl"),0)},b.defaults("fluid.undo",{gradeNames:["fluid.component"],
members:{state:b.undo.STATE_INITIAL,initialModel:{},extremalModel:{},component:"{fluid.undoable}",container:{expander:{func:"{that}.options.renderer",args:["{that}","{that}.component.container"]}},dom:{expander:{funcName:"fluid.initDomBinder",args:["{that}","{that}.options.selectors"]}}},invokers:{undoControlClick:{funcName:"fluid.undo.undoControlClick",args:"{that}"},redoControlClick:{funcName:"fluid.undo.redoControlClick",args:"{that}"}},listeners:{"onCreate.copyInitialModel":{funcName:"fluid.undo.copyInitialModel",priority:"before:refreshView"},"onCreate.setTabindex":"fluid.undo.setTabindex","onCreate.refreshView":"fluid.undo.refreshView","onCreate.bindUndoClick":{"this":"{that}.dom.undoControl",method:"click",args:"{that}.undoControlClick"},"onCreate.bindRedoClick":{"this":"{that}.dom.redoControl",method:"click",args:"{that}.redoControlClick"},"{fluid.undoable}.events.modelChanged":{funcName:"fluid.undo.modelChanged",args:["{that}","{arguments}.0","{arguments}.1","{arguments}.2"]}},selectors:{undoContainer:".flc-undo-undoControl",undoControl:".flc-undo-undoControl",redoContainer:".flc-undo-redoControl",redoControl:".flc-undo-redoControl"},strings:{undo:"undo edit",redo:"redo edit"},renderer:b.undo.defaultRenderer}),b.defaults("fluid.undoable",{gradeNames:["fluid.modelComponent"],invokers:{updateModel:{}},events:{modelChanged:null}}),b.defaults("fluid.undoDecorator",{gradeNames:["fluid.undo"]})}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.registerNamespace("fluid.tooltip"),b.tooltip.computeContentFunc=function(a){a.contentFunc=a.options.contentFunc?a.options.contentFunc:a.modelToContentFunc()},b.tooltip.updateContentImpl=function(a){a.computeContentFunc(),a.initialised&&a.container.tooltip("option","content",a.contentFunc)},b.tooltip.idSearchFunc=function(c){return function(){var d=this;if(a.contains(d.ownerDocument,d)){var e=c(),f=b.findAncestor(d,function(a){return e[a.id]});return f?e[f.id]:null}return null}},b.tooltip.modelToContentFunc=function(a){var c=a.model;return c.idToContent?b.tooltip.idSearchFunc(function(){return a.model.idToContent}):c.content?function(){return c.content}:void 0},b.tooltip.resolveTooltipTarget=function(c,d){var e=b.resolveEventTarget(d),f=a(e).closest(c);return f[0]},b.tooltip.makeOpenHandler=function(a){return function(c,d){b.tooltip.closeAll(a);var e=b.tooltip.resolveTooltipTarget(a.options.items,c),f=b.allocateSimpleId(e);a.openIdMap[f]=!0,a.initialised&&a.events.afterOpen.fire(a,e,d.tooltip,c)}},b.tooltip.makeCloseHandler=function(a){return function(c,d){if(a.initialised){var e=b.tooltip.resolveTooltipTarget(a.options.items,c);delete a.openIdMap[e.id],a.events.afterClose.fire(a,e,d.tooltip,c)}}},b.tooltip.closeAll=function(a){b.each(a.openIdMap,function(c,d){var e=b.byId(d);a.container.tooltip("close",{type:"close",currentTarget:e,target:e})}),b.clear(a.openIdMap)},b.tooltip.setup=function(c){b.tooltip.updateContentImpl(c);var d={content:c.contentFunc,open:b.tooltip.makeOpenHandler(c),close:b.tooltip.makeCloseHandler(c)},e=a.extend(!0,d,c.options.widgetOptions);c.container.tooltip(e),c.initialised=!0},b.tooltip.doDestroy=function(c){c.initialised&&(b.tooltip.closeAll(c),a.contains(document,c.container[0])&&c.container.tooltip("destroy"),c.initialised=!1)},b.defaults("fluid.tooltip",{gradeNames:["fluid.viewComponent"],widgetOptions:{tooltipClass:"{that}.options.styles.tooltip",position:"{that}.options.position",items:"{that}.options.items",show:{duration:"{that}.options.duration",delay:"{that}.options.delay"},hide:{duration:"{that}.options.duration",delay:"{that}.options.delay"}},invokers:{open:{"this":"{that}.container",method:"tooltip",args:"open"},close:{funcName:"fluid.tooltip.closeAll",args:"{that}"},updateContent:{changePath:"content",value:"{arguments}.0"},computeContentFunc:{funcName:"fluid.tooltip.computeContentFunc",args:["{that}"]},modelToContentFunc:{funcName:"fluid.tooltip.modelToContentFunc",args:"{that}"}},model:{content:"{that}.options.content"},members:{openIdMap:{}},styles:{tooltip:""},events:{afterOpen:null,afterClose:null},listeners:{"onCreate.setup":"fluid.tooltip.setup","onDestroy.doDestroy":"fluid.tooltip.doDestroy"},modelListeners:{"":{funcName:"fluid.tooltip.updateContentImpl",excludeSource:"init",args:"{that}"}},position:{my:"left top",at:"left bottom",offset:"0 5"},items:"*",delay:300})}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.registerNamespace("fluid.inlineEdit"),b.inlineEdit.sendKey=function(a,b,c,d){var e=document.createEvent("KeyEvents");e.initKeyEvent(b,1,1,null,0,0,0,0,c,d),a.dispatchEvent(e)},b.setCaretToEnd=function(c,d){var e=d?d.length:0;try{if(c.focus(),c.setSelectionRange)c.setSelectionRange(e,e),a.browser.mozilla&&e>0&&(b.inlineEdit.sendKey(c,"keypress",92,92),b.inlineEdit.sendKey(c,"keydown",8,0),b.inlineEdit.sendKey(c,"keypress",8,0));else if(c.createTextRange){var f=c.createTextRange();f.move("character",e),f.select()}}catch(g){}},b.inlineEdit.switchToViewMode=function(a){a.editContainer.hide(),a.displayModeRenderer.show()},b.inlineEdit.cancel=function(a){a.isEditing()&&(setTimeout(function(){a.editView.value(a.model.value)},1),b.inlineEdit.switchToViewMode(a),a.events.afterFinishEdit.fire(a.model.value,a.model.value,a.editField[0],a.viewEl[0]))},b.inlineEdit.finish=function(a){var c=a.editView.value(),d=a.model.value,e=a.viewEl[0],f=a.editField[0],g=a.events.onFinishEdit.fire(c,d,f,e);g!==!1&&(a.updateModelValue(c),a.events.afterFinishEdit.fire(c,d,f,e),b.inlineEdit.switchToViewMode(a))},b.inlineEdit.bindEditFinish=function(c){function d(a){return a.keyCode?a.keyCode:a.which?a.which:0}void 0===c.options.submitOnEnter&&(c.options.submitOnEnter="textarea"!==b.unwrap(c.editField).nodeName.toLowerCase());var e=c.textEditButton||a(),f=function(f){var g=d(f);return g===a.ui.keyCode.ESCAPE?(e.focus(),b.inlineEdit.cancel(c),!1):void 0},g=function(f){var g=d(f);return g!==a.ui.keyCode.ENTER?(e.blur(),!0):(b.inlineEdit.finish(c),e.focus(),!1)};c.options.submitOnEnter&&c.editContainer.keypress(g),c.editContainer.keydown(f)},b.inlineEdit.bindBlurHandler=function(a){if(a.options.blurHandlerBinder)a.options.blurHandlerBinder(a);else{var c=function(){return a.isEditing()&&b.inlineEdit.finish(a),!1};a.editField.blur(c)}},b.inlineEdit.initializeEditView=function(a,c){a.editInitialized||(b.inlineEdit.renderEditContainer(a,!a.options.lazyEditView||!c),a.options.lazyEditView&&c||(a.events.onCreateEditView.fire(),a.textEditButton&&b.inlineEdit.bindEditFinish(a),b.inlineEdit.bindBlurHandler(a),a.editView.refreshView(a),a.editInitialized=!0))},b.inlineEdit.edit=function(a){b.inlineEdit.initializeEditView(a,!1);var c=a.viewEl,d=a.displayView.value();a.updateModelValue(""===a.model.value?"":d),a.options.applyEditPadding&&a.editField.width(Math.max(c.width()+a.options.paddings.edit,a.options.paddings.minimumEdit)),a.displayModeRenderer.hide(),a.editContainer.show(),setTimeout(function(){b.setCaretToEnd(a.editField[0],a.editView.value()),a.options.selectOnEdit&&a.editField[0].select()},0),a.events.afterBeginEdit.fire()},b.inlineEdit.clearEmptyViewStyles=function(a,b,c){a.removeClass(b.defaultViewStyle),a.css("padding-right",c),a.removeClass(b.emptyDefaultViewText)},b.inlineEdit.showDefaultViewText=function(a){a.displayView.value(a.options.strings.defaultViewText),a.viewEl.css("padding-right",a.existingPadding),a.viewEl.addClass(a.options.styles.defaultViewStyle)},b.inlineEdit.showNothing=function(b){b.displayView.value(""),a.browser.msie&&"inline"===b.viewEl.css("display")&&b.viewEl.css("display","inline-block")},b.inlineEdit.showEditedText=function(a){a.displayView.value(a.model.value),b.inlineEdit.clearEmptyViewStyles(a.viewEl,a.options.styles,a.existingPadding)},b.inlineEdit.refreshView=function(a,b){a.displayView.refreshView(a,b),a.editView&&a.editView.refreshView(a,b)},b.inlineEdit.updateModelValue=function(b,c,d){var e=b.options.modelComparator,f=e?e(b.model.value,c):b.model.value===c;if(!f){var g=a.extend(!0,{},b.model);b.model.value=c,b.events.modelChanged.fire(b.model,g,d),b.refreshView(d)}},b.inlineEdit.editHandler=function(a){var c=a.events.onBeginEdit.fire();return c===!1?!1:(b.inlineEdit.edit(a),!0)},b.inlineEdit.initTooltips=function(a){var c={content:a.options.tooltipText,position:{my:"left top",at:"left bottom",offset:"0 5"},target:"*",delay:a.options.tooltipDelay,styles:{tooltip:a.options.styles.tooltip}};b.tooltip(a.viewEl,c),a.textEditButton&&b.tooltip(a.textEditButton,c)},b.inlineEdit.calculateInitialPadding=function(a){var b=a.css("padding-right");return b?parseFloat(b):0},b.inlineEdit.setupEditField=function(b,c,d){var e=a(c);return e=e.length?e:a(d),e.addClass(b),e},b.inlineEdit.setupEditContainer=function(b,c,d,e){var f=a(d);return f=f.length?f:a(e),b.after(f),f.append(c),f},b.inlineEdit.defaultEditModeRenderer=function(a){var c=b.inlineEdit.setupEditField(a.options.styles.edit,a.editField,a.options.markup.editField),d=b.inlineEdit.setupEditContainer(a.displayModeRenderer,c,a.editContainer,a.options.markup.editContainer),e=b.inlineEdit.setupEditModeInstruction(a.options.styles.editModeInstruction,a.options.strings.editModeInstruction,a.options.markup.editModeInstruction),f=b.allocateSimpleId(e);return c.attr("aria-describedby",f),b.inlineEdit.positionEditModeInstruction(e,d,c),{container:d,field:c}},b.inlineEdit.renderEditContainer=function(a,c){if(a.editContainer=a.locate("editContainer"),a.editField=a.locate("edit"),1!==a.editContainer.length&&a.editContainer.length>1&&b.fail("InlineEdit did not find a unique container for selector "+a.options.selectors.editContainer+": "+b.dumpEl(a.editContainer)),c){var d=a.options.editModeRenderer(a);d&&(a.editContainer=d.container,a.editField=d.field)}},b.inlineEdit.setupEditModeInstruction=function(b,c,d){var e=a(d);return e.addClass(b),e.text(c),e},b.inlineEdit.positionEditModeInstruction=function(a,b,c){b.append(a),c.focus(function(){a.show();var b=c.offset();a.css({left:b.left}),a.css({top:b.top+c.height()+5})})},b.inlineEdit.setupDisplayModeContainer=function(b,c){var d=a(c);return d=d.length?d:a("<span></span>"),d.addClass(b.displayView),d},b.inlineEdit.setupDisplayText=function(a,b){return a.attr("tabindex","-1"),a.addClass(b),a},b.inlineEdit.setupTextEditButton=function(c,d){var e=c.options,f=c.locate("textEditButton");if(0===f.length){var g=a(c.options.markup.textEditButton);g.addClass(e.styles.textEditButton),g.text(e.tooltipText),b.inlineEdit.updateTextEditButton(g,d.value||e.strings.defaultViewText,e.strings.textEditButton),c.events.modelChanged.addListener(function(){b.inlineEdit.updateTextEditButton(g,d.value||e.strings.defaultViewText,e.strings.textEditButton)}),c.locate("text").after(g),f=c.locate("textEditButton")}return f},b.inlineEdit.updateTextEditButton=function(a,c,d){var e=b.stringTemplate(d,{text:c});a.text(e)},b.inlineEdit.bindHoverHandlers=function(a,b){var c=function(){a.addClass(b)},d=function(){a.removeClass(b)};a.hover(c,d)},b.inlineEdit.bindHighlightHandler=function(b,c,d,e,f){b=a(b);var g=function(a){return function(){c.toggleClass(d.focus,a),c.toggleClass(d.invitation,a),f&&f.value||c.prevObject.text(a?e.defaultFocussedViewText:e.defaultViewText)}};b.focus(g(!0)),b.blur(g(!1))},b.inlineEdit.bindMouseHandlers=function(c,d){c=a(c);var e=b.inlineEdit.makeEditTriggerGuard(c,d);c.click(function(a){return e(a),!1})},b.inlineEdit.bindKeyboardHandlers=function(c,d){c=a(c),c.attr("role","button");var e=b.inlineEdit.makeEditTriggerGuard(c,d);b.activatable(c,function(a){return e(a)})},b.inlineEdit.makeEditTriggerGuard=function(a,c){var d=b.unwrap(a);return function(a){var e=b.findAncestor(a.target,function(a){return/input|select|textarea|button|a/i.test(a.nodeName)||a===d?!0:void 0});return e===d?(c(),!1):void 0}},b.inlineEdit.bindEventHandlers=function(a,c,d){var e=a.options.styles;b.inlineEdit.bindHoverHandlers(d,e.invitation),b.inlineEdit.bindMouseHandlers(a.viewEl,c),b.inlineEdit.bindMouseHandlers(a.textEditButton,c),b.inlineEdit.bindKeyboardHandlers(a.textEditButton,c),b.inlineEdit.bindHighlightHandler(a.viewEl,d,a.options.styles,a.options.strings,a.model),b.inlineEdit.bindHighlightHandler(a.textEditButton,d,a.options.styles,a.options.strings,a.model)},b.inlineEdit.defaultDisplayModeRenderer=function(a,c,d){var e=a.options.styles,f=b.inlineEdit.setupDisplayModeContainer(e),g=a.viewEl.wrap(f).parent();return a.textEditButton=b.inlineEdit.setupTextEditButton(a,d),g.append(a.textEditButton),b.inlineEdit.bindEventHandlers(a,c,g),g},b.inlineEdit.getNodeName=function(a){return b.unwrap(a).nodeName.toLowerCase()},b.defaults("fluid.inlineEdit.standardAccessor",{gradeNames:["fluid.viewComponent"],members:{nodeName:{expander:{funcName:"fluid.inlineEdit.getNodeName",args:"{that}.container"}}},invokers:{value:{funcName:"fluid.inlineEdit.standardAccessor.value",args:["{that}.nodeName","{that}.container","{arguments}.0"]}}}),b.inlineEdit.standardAccessor.value=function(c,d,e){return b["input"===c||"textarea"===c?"value":"text"](a(d),e)},b.defaults("fluid.inlineEdit.standardDisplayView",{gradeNames:["fluid.viewComponent"],invokers:{refreshView:{funcName:"fluid.inlineEdit.standardDisplayView.refreshView",args:["{fluid.inlineEdit}","{that}.container","{arguments}.0"]}}}),b.inlineEdit.standardDisplayView.refreshView=function(c){c.model.value?b.inlineEdit.showEditedText(c):c.options.strings.defaultViewText?b.inlineEdit.showDefaultViewText(c):b.inlineEdit.showNothing(c),0===a.trim(c.viewEl.text()).length&&(c.viewEl.addClass(c.options.styles.emptyDefaultViewText),c.existingPadding<c.options.paddings.minimumView&&c.viewEl.css("padding-right",c.options.paddings.minimumView))},b.defaults("fluid.inlineEdit.standardEditView",{gradeNames:["fluid.viewComponent"],invokers:{refreshView:{funcName:"fluid.inlineEdit.standardEditView.refreshView",args:["{fluid.inlineEdit}","{that}.container","{arguments}.0"]}}}),b.inlineEdit.standardEditView.refreshView=function(a,b,c){(!c||b&&-1===b.index(c))&&a.editView.value(a.model.value)},b.inlineEdit.setup=function(a){a.editContainer&&a.editContainer.hide(),a.tooltipEnabled()&&b.inlineEdit.initTooltips(a)},b.inlineEdit.setIsEditing=function(a,b){a.isEditingState=b},b.inlineEdit.tooltipEnabled=function(b){return b&&a.fn.tooltip},b.inlineEdit.processUndoDecorator=function(a){if(a.options.componentDecorators){var c=b.makeArray(a.options.componentDecorators),d=c[0];"string"==typeof d&&(d={type:d}),"fluid.undoDecorator"===d.type&&(b.set(a.options,["components","undo"],{type:"fluid.undo",options:d.options}),a.decorators=[b.initDependent(a,"undo")])}},b.defaults("fluid.inlineEdit",{gradeNames:["fluid.undoable","fluid.viewComponent"],mergePolicy:{"strings.defaultViewText":"defaultViewText"},members:{isEditingState:!1,viewEl:{expander:{funcName:"fluid.inlineEdit.setupDisplayText",args:["{that}.dom.text","{that}.options.styles.text"]}},existingPadding:{expander:{funcName:"fluid.inlineEdit.calculateInitialPadding",args:"{that}.viewEl"}},displayModeRenderer:{expander:{func:"{that}.options.displayModeRenderer",args:["{that}","{that}.edit","{that}.model"]}}},invokers:{edit:{funcName:"fluid.inlineEdit.editHandler",args:"{that}"},isEditing:{funcName:"fluid.identity",args:"{that}.isEditingState"},finish:{funcName:"fluid.inlineEdit.finish",args:"{that}"},cancel:{funcName:"fluid.inlineEdit.cancel",args:"{that}"},tooltipEnabled:{funcName:"fluid.inlineEdit.tooltipEnabled",args:"{that}.options.useTooltip"},refreshView:{funcName:"fluid.inlineEdit.refreshView",args:["{that}","{arguments}.0"]},updateModelValue:{funcName:"fluid.inlineEdit.updateModelValue",args:["{that}","{arguments}.0","{arguments}.1"]},updateModel:{funcName:"fluid.inlineEdit.updateModelValue",args:["{that}","{arguments}.0.value","{arguments}.1"]}},components:{displayView:{type:"{that}.options.displayView.type",container:"{that}.viewEl",options:{gradeNames:"{fluid.inlineEdit}.options.displayAccessor.type"}},editView:{type:"{that}.options.editView.type",createOnEvent:"onCreateEditView",container:"{that}.editField",options:{gradeNames:"{fluid.inlineEdit}.options.editAccessor.type"}}},model:{value:{expander:{func:"{that}.displayView.value"}}},selectors:{text:".flc-inlineEdit-text",editContainer:".flc-inlineEdit-editContainer",edit:".flc-inlineEdit-edit",textEditButton:".flc-inlineEdit-textEditButton"},styles:{text:"fl-inlineEdit-text",edit:"fl-inlineEdit-edit",invitation:"fl-inlineEdit-invitation",defaultViewStyle:"fl-inlineEdit-emptyText-invitation",emptyDefaultViewText:"fl-inlineEdit-emptyDefaultViewText",focus:"fl-inlineEdit-focus",tooltip:"fl-inlineEdit-tooltip",editModeInstruction:"fl-inlineEdit-editModeInstruction",displayView:"fl-inlineEdit-simple-editableText fl-inlineEdit-textContainer",textEditButton:"fl-hidden-accessible"},events:{modelChanged:null,onBeginEdit:"preventable",afterBeginEdit:null,onFinishEdit:"preventable",afterFinishEdit:null,afterInitEdit:null,onCreateEditView:null},listeners:{onCreate:[{func:"{that}.refreshView"},{funcName:"fluid.inlineEdit.initializeEditView",args:["{that}",!0]},{funcName:"fluid.inlineEdit.setup",args:"{that}"},{funcName:"fluid.inlineEdit.processUndoDecorator",args:"{that}"}],onBeginEdit:{funcName:"fluid.inlineEdit.setIsEditing",args:["{that}",!0]},afterFinishEdit:{funcName:"fluid.inlineEdit.setIsEditing",args:["{that}",!1]}},strings:{textEditButton:"Edit text %text",editModeInstruction:"Escape to cancel, Enter or Tab when finished",defaultViewText:"Click here to edit",defaultFocussedViewText:"Click here or press enter to edit"},markup:{editField:"<input type='text' class='flc-inlineEdit-edit'/>",editContainer:"<span></span>",editModeInstruction:"<p></p>",textEditButton:"<a href='#_' class='flc-inlineEdit-textEditButton'></a>"},paddings:{edit:10,minimumEdit:80,minimumView:60},applyEditPadding:!0,blurHandlerBinder:null,submitOnEnter:void 0,modelComparator:null,displayAccessor:{type:"fluid.inlineEdit.standardAccessor"},displayView:{type:"fluid.inlineEdit.standardDisplayView"},editAccessor:{type:"fluid.inlineEdit.standardAccessor"},editView:{type:"fluid.inlineEdit.standardEditView"},displayModeRenderer:b.inlineEdit.defaultDisplayModeRenderer,editModeRenderer:b.inlineEdit.defaultEditModeRenderer,lazyEditView:!1,useTooltip:!0,tooltipText:"Select or press Enter to edit",tooltipDelay:1e3,selectOnEdit:!1}),b.setupInlineEdits=function(a,c){return b.transform(c,function(c,d){var e={type:"fluid.inlineEdit",container:c},f="inlineEdit-"+d;return b.set(a.options,["components",f],e),b.initDependent(a,f)})},b.defaults("fluid.inlineEditsComponent",{gradeNames:["fluid.viewComponent"],distributeOptions:{source:"{that}.options",exclusions:["members.inlineEdits","selectors.editables","events"],removeSource:!0,target:"{that > fluid.inlineEdit}.options"},members:{inlineEdits:{expander:{funcName:"fluid.setupInlineEdits",args:["{that}","{that}.dom.editables"]}}},selectors:{editables:".flc-inlineEditable"}}),b.inlineEdits=function(a,c){var d=b.inlineEditsComponent(a,c);return d.inlineEdits}}(jQuery,fluid_2_0_0);var fluid_2_0_0=fluid_2_0_0||{};!function(a,b){"use strict";b.defaults("fluid.inlineEdit.editorViewAccessor",{gradeNames:["fluid.viewComponent"],invokers:{value:{funcName:"fluid.inlineEdit.editorViewAccessor.value",args:["{that}.container","{that}.options","{arguments}.0"]}}}),b.inlineEdit.editorViewAccessor.value=function(b,c,d){var e=c.editorGetFn(b);return e&&0!==e.length?void 0===d?c.getValueFn(e):void c.setValueFn(b,e,d):(void 0!==d&&a(b).val(d),"")},b.defaults("fluid.inlineEdit.richTextViewAccessor",{gradeNames:["fluid.viewComponent"],invokers:{value:{funcName:"fluid.inlineEdit.richTextViewAccessor.value",args:["{that}.container","{arguments}.0"]}}}),b.inlineEdit.richTextViewAccessor.value=function(a,c){return b.html(a,c)},b.inlineEdit.normalizeHTML=function(b){var c=a.trim(b.replace(/\s+/g," "));return c=c.replace(/\s+<\//g,"</"),c=c.replace(/<([a-z0-9A-Z\/]+)>/g,function(a){return a.toLowerCase()})},b.inlineEdit.htmlComparator=function(a,c){return b.inlineEdit.normalizeHTML(a)===b.inlineEdit.normalizeHTML(c)},b.inlineEdit.bindRichTextHighlightHandler=function(b,c,d){b=a(b);var e=function(){c.addClass(d)},f=function(){c.removeClass(d)};b.focus(e),b.blur(f)},b.inlineEdit.setupRichTextEditButton=function(b){var c=b.options,d=b.locate("textEditButton");if(0===d.length){var e=a("<a href='#_' class='flc-inlineEdit-textEditButton'></a>");e.text(c.strings.textEditButton),b.locate("text").after(e),d=b.locate("textEditButton")}return d},b.inlineEdit.richTextDisplayModeRenderer=function(a,c){var d=a.options.styles,e=b.inlineEdit.setupDisplayModeContainer(d),f=a.viewEl.wrap(e).parent();return a.textEditButton=b.inlineEdit.setupRichTextEditButton(a),f.append(a.textEditButton),f.addClass(d.focus),b.inlineEdit.bindHoverHandlers(f,d.invitation),b.inlineEdit.bindMouseHandlers(a.textEditButton,c),b.inlineEdit.bindKeyboardHandlers(a.textEditButton,c),b.inlineEdit.bindRichTextHighlightHandler(a.viewEl,f,d.invitation),b.inlineEdit.bindRichTextHighlightHandler(a.textEditButton,f,d.invitation),f};var c=b.registerNamespace("fluid.inlineEdit.tinyMCE");b.inlineEdit.tinyMCE.getEditor=function(a){return tinyMCE.get(a.prop("id"))},b.inlineEdit.tinyMCE.setValue=function(b,c,d){a(b).val(d),c.setContent(d,{format:"raw"})},b.inlineEdit.tinyMCE.getValue=function(a){return a.getContent()},b.defaults("fluid.inlineEdit.tinyMCE.viewAccessor",{gradeNames:["fluid.inlineEdit.editorViewAccessor"],editorGetFn:c.getEditor,setValueFn:c.setValue,getValueFn:c.getValue}),b.inlineEdit.tinyMCE.blurHandlerBinder=function(c){function d(a){setTimeout(function(){tinyMCE.execCommand("mceFocus",!1,c.editField[0].id),a.selection.select(a.getBody(),1),a.selection.collapse(0)},10)}c.events.afterInitEdit.addListener(function(e){d(e);var f=e.getBody();c.deadMansBlur=b.deadMansBlur(c.editField,{cancelByDefault:!0,exclusions:{body:a(f),container:c.container},handler:function(){c[c.options.onBlur]()}}),e.controlManager.onAdd.add(function(a){a.onShowMenu&&a.onShowMenu.add(function(){var d=b.byId(a.element.id);d&&c.deadMansBlur.addExclusion({id:d})})})}),c.events.afterBeginEdit.addListener(function(){var a=tinyMCE.get(c.editField[0].id);a&&d(a),c.deadMansBlur&&c.deadMansBlur.reArm()}),c.events.afterFinishEdit.addListener(function(){c.deadMansBlur.noteProceeded()})},b.inlineEdit.tinyMCE.editModeRenderer=function(a){var c=a.options.tinyMCE;c.elements=b.allocateSimpleId(a.editField);var d=c.init_instance_callback;c.init_instance_callback=function(b){a.events.afterInitEdit.fire(b),d&&d()},setTimeout(function(){tinyMCE.init(c)},1)},b.defaults("fluid.inlineEdit.tinyMCE",{gradeNames:["fluid.inlineEdit"],tinyMCE:{mode:"exact",theme:"simple"},listeners:{onCreate:{"this":"tinyMCE",method:"init",namespace:"initTinyMCE",args:"{that}.options.tinyMCE"}},useTooltip:!0,selectors:{edit:"textarea"},styles:{invitation:"fl-inlineEdit-richText-invitation",displayView:"fl-inlineEdit-textContainer",text:""},strings:{textEditButton:"Edit"},displayAccessor:{type:"fluid.inlineEdit.richTextViewAccessor"},editAccessor:{type:"fluid.inlineEdit.tinyMCE.viewAccessor"},lazyEditView:!0,defaultViewText:"Click Edit",modelComparator:b.inlineEdit.htmlComparator,onBlur:"finish",blurHandlerBinder:b.inlineEdit.tinyMCE.blurHandlerBinder,displayModeRenderer:b.inlineEdit.richTextDisplayModeRenderer,editModeRenderer:b.inlineEdit.tinyMCE.editModeRenderer});var d=b.registerNamespace("fluid.inlineEdit.CKEditor");b.inlineEdit.CKEditor.getEditor=function(a){return CKEDITOR.instances[a.prop("id")]},b.inlineEdit.CKEditor.setValue=function(a,b,c){b.setData(c)},b.inlineEdit.CKEditor.getValue=function(a){return a.getData()},b.defaults("fluid.inlineEdit.CKEditor.viewAccessor",{gradeNames:["fluid.inlineEdit.editorViewAccessor"],editorGetFn:d.getEditor,setValueFn:d.setValue,getValueFn:d.getValue}),b.inlineEdit.CKEditor.focus=function(a){setTimeout(function(){a.focus()},0)},b.inlineEdit.CKEditor.normalizeHTML=function(a){var c=b.inlineEdit.normalizeHTML(a),d=c.indexOf(">");return-1!==d&&d<c.length-1&&" "!==c.charAt(d+1)&&(c=c.substring(0,d+1)+" "+c.substring(d+1)),c},b.inlineEdit.CKEditor.htmlComparator=function(a,c){return b.inlineEdit.CKEditor.normalizeHTML(a)===b.inlineEdit.CKEditor.normalizeHTML(c)},b.inlineEdit.CKEditor.blurHandlerBinder=function(a){a.events.afterInitEdit.addListener(b.inlineEdit.CKEditor.focus),a.events.afterBeginEdit.addListener(function(){var c=b.inlineEdit.CKEditor.getEditor(a.editField);c&&b.inlineEdit.CKEditor.focus(c)})},b.inlineEdit.CKEditor.editModeRenderer=function(c){var d=b.allocateSimpleId(c.editField);a.data(b.unwrap(c.editField),"fluid.inlineEdit.CKEditor",c);var e=CKEDITOR.replace(d,c.options.CKEditor);e.on("instanceReady",function(a){b.inlineEdit.CKEditor.focus(a.editor),c.events.afterInitEdit.fire(a.editor)})},b.defaults("fluid.inlineEdit.CKEditor",{gradeNames:["fluid.inlineEdit"],selectors:{edit:"textarea"},styles:{invitation:"fl-inlineEdit-richText-invitation",displayView:"fl-inlineEdit-textContainer",text:""},strings:{textEditButton:"Edit"},displayAccessor:{type:"fluid.inlineEdit.richTextViewAccessor"},editAccessor:{type:"fluid.inlineEdit.CKEditor.viewAccessor"},lazyEditView:!0,defaultViewText:"Click Edit",modelComparator:b.inlineEdit.CKEditor.htmlComparator,blurHandlerBinder:b.inlineEdit.CKEditor.blurHandlerBinder,displayModeRenderer:b.inlineEdit.richTextDisplayModeRenderer,editModeRenderer:b.inlineEdit.CKEditor.editModeRenderer,CKEditor:{}}),b.registerNamespace("fluid.inlineEdit.dropdown"),b.inlineEdit.dropdown.editModeRenderer=function(c){return b.allocateSimpleId(c.editField),c.editField.selectbox({finishHandler:function(){c.finish()}}),{container:c.editContainer,field:a("input.selectbox",c.editContainer)}},b.inlineEdit.dropdown.blurHandlerBinder=function(c){b.deadMansBlur(c.editField,{exclusions:{selectBox:a("div.selectbox-wrapper",c.editContainer)},handler:function(){c.cancel()}})},b.defaults("fluid.inlineEdit.dropdown",{gradeNames:["fluid.inlineEdit"],applyEditPadding:!1,blurHandlerBinder:b.inlineEdit.dropdown.blurHandlerBinder,editModeRenderer:b.inlineEdit.dropdown.editModeRenderer})}(jQuery,fluid_2_0_0),function(){var a="undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof module&&module.exports?module.exports:global;if(!a.ArrayMath){var b={};b.add=function(a,b,c){var d;if(b instanceof Float32Array)for(d=Math.min(a.length,b.length,c.length)-1;d>=0;--d)a[d]=b[d]+c[d];else for(d=Math.min(a.length,c.length)-1;d>=0;--d)a[d]=b+c[d]},b.sub=function(a,b,c){var d;if(b instanceof Float32Array)for(d=Math.min(a.length,b.length,c.length)-1;d>=0;--d)a[d]=b[d]-c[d];else for(d=Math.min(a.length,c.length)-1;d>=0;--d)a[d]=b-c[d]},b.mul=function(a,b,c){var d;if(b instanceof Float32Array)for(d=Math.min(a.length,b.length,c.length)-1;d>=0;--d)a[d]=b[d]*c[d];else for(d=Math.min(a.length,c.length)-1;d>=0;--d)a[d]=b*c[d]},b.mulCplx=function(a,b,c,d,e,f){var g,h,i,j,k;if(c instanceof Float32Array)for(g=Math.min(a.length,b.length,c.length,d.length,e.length,f.length)-1;g>=0;--g)h=c[g],i=d[g],j=e[g],k=f[g],a[g]=h*j-i*k,b[g]=h*k+i*j;else for(g=Math.min(a.length,b.length,e.length,f.length)-1;g>=0;--g)j=e[g],k=f[g],a[g]=c*j-d*k,b[g]=c*k+d*j},b.div=function(a,b,c){var d;if(b instanceof Float32Array)for(d=Math.min(a.length,b.length,c.length)-1;d>=0;--d)a[d]=b[d]/c[d];else for(d=Math.min(a.length,c.length)-1;d>=0;--d)a[d]=b/c[d]},b.divCplx=function(a,b,c,d,e,f){var g,h,i,j,k,l;if(c instanceof Float32Array)for(g=Math.min(a.length,b.length,c.length,d.length,e.length,f.length)-1;g>=0;--g)h=c[g],i=d[g],j=e[g],k=f[g],l=1/(j*j+k*k),a[g]=(h*j+i*k)*l,b[g]=(i*j-h*k)*l;else for(g=Math.min(a.length,b.length,e.length,f.length)-1;g>=0;--g)j=e[g],k=f[g],l=1/(j*j+k*k),a[g]=(c*j+d*k)*l,b[g]=(d*j-c*k)*l},b.madd=function(a,b,c,d){var e;if(b instanceof Float32Array)for(e=Math.min(a.length,b.length,c.length,d.length)-1;e>=0;--e)a[e]=b[e]*c[e]+d[e];else for(e=Math.min(a.length,c.length,d.length)-1;e>=0;--e)a[e]=b*c[e]+d[e]},b.abs=function(a,b){for(var c=Math.min(a.length,b.length)-1;c>=0;--c)a[c]=Math.abs(b[c])},b.absCplx=function(a,b,c){for(var d=Math.min(a.length,b.length,c.length)-1;d>=0;--d)a[d]=Math.sqrt(b[d]*b[d]+c[d]*c[d])},b.acos=function(a,b){for(var c=Math.min(a.length,b.length)-1;c>=0;--c)a[c]=Math.acos(b[c])},b.asin=function(a,b){for(var c=Math.min(a.length,b.length)-1;c>=0;--c)a[c]=Math.asin(b[c])},b.atan=function(a,b){for(var c=Math.min(a.length,b.length)-1;c>=0;--c)a[c]=Math.atan(b[c])},b.atan2=function(a,b,c){for(var d=Math.min(a.length,c.length,b.length)-1;d>=0;--d)a[d]=Math.atan2(b[d],c[d])},b.ceil=function(a,b){for(var c=Math.min(a.length,b.length)-1;c>=0;--c)a[c]=Math.ceil(b[c])},b.cos=function(a,b){for(var c=Math.min(a.length,b.length)-1;c>=0;--c)a[c]=Math.cos(b[c])},b.exp=function(a,b){for(var c=Math.min(a.length,b.length)-1;c>=0;--c)a[c]=Math.exp(b[c])},b.floor=function(a,b){for(var c=Math.min(a.length,b.length)-1;c>=0;--c)a[c]=Math.floor(b[c])},b.log=function(a,b){for(var c=Math.min(a.length,b.length)-1;c>=0;--c)a[c]=Math.log(b[c])},b.max=function(a){for(var b=-(1/0),c=a.length-1;c>=0;--c){var d=a[c];d>b&&(b=d)}return b},b.min=function(a){for(var b=1/0,c=a.length-1;c>=0;--c){var d=a[c];b>d&&(b=d)}return b},b.pow=function(a,b,c){var d;if(c instanceof Float32Array)for(d=Math.min(a.length,b.length,c.length)-1;d>=0;--d)a[d]=Math.pow(b[d],c[d]);else for(d=Math.min(a.length,b.length)-1;d>=0;--d)a[d]=Math.pow(b[d],c)},b.random=function(a,b,c){b||(b=0),isNaN(parseFloat(c))&&(c=1);for(var d=c-b,e=a.length-1;e>=0;--e)a[e]=Math.random()*d+b},b.round=function(a,b){for(var c=Math.min(a.length,b.length)-1;c>=0;--c)a[c]=Math.round(b[c])},b.sin=function(a,b){for(var c=Math.min(a.length,b.length)-1;c>=0;--c)a[c]=Math.sin(b[c])},b.sqrt=function(a,b){for(var c=Math.min(a.length,b.length)-1;c>=0;--c)a[c]=Math.sqrt(b[c])},b.tan=function(a,b){for(var c=Math.min(a.length,b.length)-1;c>=0;--c)a[c]=Math.tan(b[c])},b.clamp=function(a,b,c,d){for(var e=Math.min(a.length,b.length)-1;e>=0;--e){var f=b[e];a[e]=c>f?c:f>d?d:f}},b.fract=function(a,b){for(var c=Math.min(a.length,b.length)-1;c>=0;--c){var d=b[c];a[c]=d-Math.floor(d)}},b.fill=function(a,b){for(var c=a.length-1;c>=0;--c)a[c]=b},b.ramp=function(a,b,c){var d=a.length-1;if(d>=0&&(a[0]=b),d>0)for(var e=(c-b)/d,f=1;d>=f;++f)a[f]=b+e*f},b.sign=function(a,b){for(var c=Math.min(a.length,b.length)-1;c>=0;--c)a[c]=b[c]<0?-1:1},b.sum=function(a){for(var b=0,c=a.length-1;c>=0;--c)b+=a[c];return b},b.sampleLinear=function(a,b,c){for(var d=b.length,e=d-1,f=Math.min(a.length,c.length)-1;f>=0;--f){var g=c[f];g=0>g?0:g>e?e:g;var h=Math.floor(g),i=g-h,j=b[h],k=b[e>h?h+1:e];a[f]=j+i*(k-j)}},b.sampleLinearRepeat=function(a,b,c){for(var d=b.length,e=d-1,f=Math.min(a.length,c.length)-1;f>=0;--f){var g=c[f];g-=Math.floor(g/d)*d;var h=Math.floor(g),i=g-h,j=b[h],k=b[e>h?h+1:0];a[f]=j+i*(k-j)}},b.sampleCubic=function(a,b,c){for(var d=b.length,e=d-1,f=Math.min(a.length,c.length)-1;f>=0;--f){var g=c[f];g=0>g?0:g>e?e:g;var h=Math.floor(g),i=g-h,j=i*i,k=j*i,l=-2*k+3*j,m=1-l,n=k-j,o=n-j+i,p=b[h>0?h-1:0],q=b[h],r=b[e>h?h+1:e],s=b[e-1>h?h+2:e];a[f]=m*q+l*r+.5*(o*(r-p)+n*(s-q))}},b.sampleCubicRepeat=function(a,b,c){for(var d=b.length,e=d-1,f=Math.min(a.length,c.length)-1;f>=0;--f){var g=c[f];g-=Math.floor(g/d)*d;var h=Math.floor(g),i=g-h,j=i*i,k=j*i,l=-2*k+3*j,m=1-l,n=k-j,o=n-j+i,p=b[h>0?h-1:e],q=b[h],r=b[e>h?h+1:0],s=b[e-1>h?h+2:h+2-Math.floor((h+2)/d)*d];a[f]=m*q+l*r+.5*(o*(r-p)+n*(s-q))}},b.pack=function(a,b,c,d,e,f,g){var h=Math.floor(Math.max(0,a.length-b)/c),i=Math.min(h,d.length);if(e){var i=Math.min(i,e.length);if(f){var i=Math.min(i,f.length);if(g)for(var i=Math.min(i,g.length),j=0;i>j;++j)a[b]=d[j],a[b+1]=e[j],a[b+2]=f[j],a[b+3]=g[j],b+=c;else for(var j=0;i>j;++j)a[b]=d[j],a[b+1]=e[j],a[b+2]=f[j],b+=c}else for(var j=0;i>j;++j)a[b]=d[j],a[b+1]=e[j],b+=c}else for(var j=0;i>j;++j)a[b]=d[j],b+=c},b.unpack=function(a,b,c,d,e,f,g){var h=Math.floor(Math.max(0,a.length-b)/c),i=Math.min(h,d.length);if(e){var i=Math.min(i,e.length);if(f){var i=Math.min(i,f.length);if(g)for(var i=Math.min(i,g.length),j=0;i>j;++j)d[j]=a[b],e[j]=a[b+1],f[j]=a[b+2],g[j]=a[b+3],
b+=c;else for(var j=0;i>j;++j)d[j]=a[b],e[j]=a[b+1],f[j]=a[b+2],b+=c}else for(var j=0;i>j;++j)d[j]=a[b],e[j]=a[b+1],b+=c}else for(var j=0;i>j;++j)d[j]=a[b],b+=c},a.ArrayMath=b}}(),function(){var a="undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof module&&module.exports?module.exports:global;if(!a.Filter){var b=function(a,b){!isNaN(parseFloat(a))&&isFinite(a)||(a=1),b||(b=0),this._b=new Float32Array(a),this._b[0]=1,this._a=new Float32Array(b),this._bHist=new Float32Array(a),this._aHist=new Float32Array(b)};b.prototype.filter=function(a,b){var c,d=this._a,e=d.length,f=this._b,g=f.length,h=this._aHist,i=this._bHist,j=b.length,k=a.length,l=g-1,m=e;for(c=0;(l||m)&&j>c;++c){var n,o;o=g-l,l&&l--;var p=f[0]*b[c];for(n=1;o>n;++n)p+=f[n]*b[c-n];for(;g>n;++n)p+=f[n]*i[n-o];for(o=e-m,m&&m--,n=0;o>n;++n)p-=d[n]*a[c-1-n];for(;e>n;++n)p-=d[n]*h[n-o];a[c]=p}if(3==g&&2==e)for(var q,r,s=f[0],t=f[1],u=f[2],v=d[0],w=d[1],x=b[c-1],y=b[c-2],z=a[c-1],A=a[c-2];j>c;++c)q=y,y=x,x=b[c],r=A,A=z,z=s*x+t*y+u*q-v*A-w*r,a[c]=z;else for(;j>c;++c){var n,p=f[0]*b[c];for(n=1;g>n;++n)p+=f[n]*b[c-n];for(n=0;e>n;++n)p-=d[n]*a[c-1-n];a[c]=p}var B=Math.min(g-1,j);for(c=g-2;c>=B;--c)i[c]=i[c-B];for(c=0;B>c;++c)i[c]=b[j-1-c];for(B=Math.min(e,k),c=e-1;c>=B;--c)h[c]=h[c-B];for(c=0;B>c;++c)h[c]=a[j-1-c]},b.prototype.clearHistory=function(){for(var a=this._bHist.length-1;a>=0;--a)this._bHist[a]=0;for(var a=this._aHist.length-1;a>=0;--a)this._aHist[a]=0},b.prototype.setB=function(a){for(var b=Math.min(this._b.length,a.length),c=0;b>c;++c)this._b[c]=a[c]},b.prototype.setA=function(a){for(var b=Math.min(this._a.length,a.length),c=0;b>c;++c)this._a[c]=a[c]},a.Filter=b}}(),function(){var a="undefined"!=typeof window?window:"undefined"!=typeof self?self:"undefined"!=typeof module&&module.exports?module.exports:global;if(!a.FFT){var b=function(a,b,c,d,e,f,g){for(var h,i,j,k,l,m,n,o,p=0,q=c,r=c+g,s=.7071067811865475,t=q+g;t>q;)j=a[q]*s,k=b[q]*s,l=a[r]*s,m=b[r]*s,n=e[p],o=f[p],h=l*n-m*o,i=l*o+m*n,a[r]=j-h,b[r]=k-i,a[q]=j+h,b[q]=k+i,p+=d,++q,++r},c=function(a,b,c,d,e,f,g){for(var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=0,y=0,z=2*d,A=c,B=c+g,C=c+2*g,D=f[d*g],E=.5773502691896258,F=A+g;F>A;)p=a[A]*E,q=b[A]*E,r=a[B]*E,s=b[B]*E,t=a[C]*E,u=b[C]*E,v=e[x],w=f[x],j=r*v-s*w,k=r*w+s*v,v=e[y],w=f[y],l=t*v-u*w,m=t*w+u*v,n=j+l,o=k+m,h=j-l,i=k-m,r=p-.5*n,s=q-.5*o,h*=D,i*=D,a[A]=p+n,b[A]=q+o,a[C]=r+i,b[C]=s-h,a[B]=r-i,b[B]=s+h,x+=d,y+=z,++A,++B,++C},d=function(a,b,c,d,e,f,g,h){for(var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=0,F=0,G=0,H=2*d,I=3*d,J=c,K=c+g,L=c+2*g,M=c+3*g,N=.5,O=J+g;O>J;)u=a[J]*N,v=b[J]*N,w=a[K]*N,x=b[K]*N,y=a[L]*N,z=b[L]*N,A=a[M]*N,B=b[M]*N,C=e[E],D=f[E],i=w*C-x*D,j=w*D+x*C,C=e[F],D=f[F],k=y*C-z*D,l=y*D+z*C,C=e[G],D=f[G],m=A*C-B*D,n=A*D+B*C,s=u-k,t=v-l,u+=k,v+=l,o=i+m,p=j+n,q=i-m,r=j-n,a[L]=u-o,b[L]=v-p,a[J]=u+o,b[J]=v+p,h?(a[K]=s-r,b[K]=t+q,a[M]=s+r,b[M]=t-q):(a[K]=s+r,b[K]=t-q,a[M]=s-r,b[M]=t+q),E+=d,F+=H,G+=I,++J,++K,++L,++M},e=function(a,b,c,d,e,f,g){for(var h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T=0,U=0,V=0,W=0,X=2*d,Y=3*d,Z=4*d,$=c,_=c+g,aa=c+2*g,ba=c+3*g,ca=c+4*g,da=e[d*g],ea=f[d*g],fa=e[2*d*g],ga=f[2*d*g],ha=.4472135954999579,ia=$+g;ia>$;)H=a[$]*ha,I=b[$]*ha,J=a[_]*ha,K=b[_]*ha,L=a[aa]*ha,M=b[aa]*ha,N=a[ba]*ha,O=b[ba]*ha,P=a[ca]*ha,Q=b[ca]*ha,h=H,i=I,R=e[T],S=f[T],j=J*R-K*S,k=J*S+K*R,R=e[U],S=f[U],l=L*R-M*S,m=L*S+M*R,R=e[V],S=f[V],n=N*R-O*S,o=N*S+O*R,R=e[W],S=f[W],p=P*R-Q*S,q=P*S+Q*R,v=j+p,w=k+q,B=j-p,C=k-q,x=l+n,y=m+o,z=l-n,A=m-o,a[$]=H+v+x,b[$]=I+w+y,r=h+v*da+x*fa,s=i+w*da+y*fa,t=C*ea+A*ga,u=-B*ea-z*ga,a[_]=r-t,b[_]=s-u,a[ca]=r+t,b[ca]=s+u,D=h+v*fa+x*da,E=i+w*fa+y*da,F=-C*ga+A*ea,G=B*ga-z*ea,a[aa]=D+F,b[aa]=E+G,a[ba]=D-F,b[ba]=E-G,T+=d,U+=X,V+=Y,W+=Z,++$,++_,++aa,++ba,++ca},f=function(a,b,c,d,e,f,g,h,i){var j,k,l,m,n,o,p,q,r,s,t=new Float32Array(h),u=new Float32Array(h),v=Math.sqrt(1/h);for(j=0;g>j;++j){for(m=c+j,k=0;h>k;++k)t[k]=a[m]*v,u[k]=b[m]*v,m+=g;m=c+j;var w=d*j;for(k=0;h>k;++k){n=t[0],o=u[0];var x=0;for(l=1;h>l;++l)x+=w,x>=i&&(x-=i),p=t[l],q=u[l],r=e[x],s=f[x],n+=p*r-q*s,o+=p*s+q*r;a[m]=n,b[m]=o,m+=g,w+=d}}},g=function(a,h,i,j,k,l,m,n,o,p,q,r,s,t){var u=o[p++],v=o[p++],w=i,x=i+u*v,y=m*n;if(1==v){do a[i]=j[l],h[i]=k[l],l+=y,++i;while(i!=x)}else do g(a,h,i,j,k,l,m*u,n,o,p,q,r,s,t),l+=y,i+=v;while(i!=x);switch(i=w,u){case 2:b(a,h,i,m,q,r,v);break;case 3:c(a,h,i,m,q,r,v);break;case 4:d(a,h,i,m,q,r,v,t);break;case 5:e(a,h,i,m,q,r,v);break;default:f(a,h,i,m,q,r,v,u,s)}},h=function(a,b){var c=4,d=Math.floor(Math.sqrt(a)),e=0;do{for(;a%c;){switch(c){case 4:c=2;break;case 2:c=3;break;default:c+=2}c>d&&(c=a)}a=Math.floor(a/c),b[e++]=c,b[e++]=a}while(a>1)},i=function(a){a||(a=256),Object.defineProperty(this,"size",{configurable:!1,writable:!1,value:a}),this._twiddlesFwdRe=new Float32Array(a),this._twiddlesFwdIm=new Float32Array(a),this._twiddlesInvRe=this._twiddlesFwdRe,this._twiddlesInvIm=new Float32Array(a);for(var b=0;a>b;++b){var c=-2*Math.PI*b/a,d=Math.cos(c),e=Math.sin(c);this._twiddlesFwdRe[b]=d,this._twiddlesFwdIm[b]=e,this._twiddlesInvIm[b]=-e}this._factors=new Int32Array(64),h(a,this._factors)};i.prototype.forwardCplx=function(a,b,c,d){var e=this._twiddlesFwdRe,f=this._twiddlesFwdIm;g(a,b,0,c,d,0,1,1,this._factors,0,e,f,this.size,!1)},i.prototype.forward=function(a,b,c){this.forwardCplx(a,b,c,new Float32Array(this.size))},i.prototype.inverseCplx=function(a,b,c,d){var e=this._twiddlesInvRe,f=this._twiddlesInvIm;g(a,b,0,c,d,0,1,1,this._factors,0,e,f,this.size,!0)},i.prototype.inverse=function(a,b,c){this.inverseCplx(a,new Float32Array(this.size),b,c)},a.FFT=i}}();var Random=function(a){if(a=void 0===a?(new Date).getTime():a,"number"!=typeof a||Math.ceil(a)!=Math.floor(a))throw new TypeError("seed value must be an integer");this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,this.init_by_array([a],1)};Random.prototype.init_genrand=function(a){for(this.mt[0]=a>>>0,this.mti=1;this.mti<this.N;this.mti++){var a=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(1812433253*((4294901760&a)>>>16)<<16)+1812433253*(65535&a)+this.mti,this.mt[this.mti]>>>=0}},Random.prototype.init_by_array=function(a,b){var c,d,e;for(this.init_genrand(19650218),c=1,d=0,e=this.N>b?this.N:b;e;e--){var f=this.mt[c-1]^this.mt[c-1]>>>30;this.mt[c]=(this.mt[c]^(1664525*((4294901760&f)>>>16)<<16)+1664525*(65535&f))+a[d]+d,this.mt[c]>>>=0,c++,d++,c>=this.N&&(this.mt[0]=this.mt[this.N-1],c=1),d>=b&&(d=0)}for(e=this.N-1;e;e--){var f=this.mt[c-1]^this.mt[c-1]>>>30;this.mt[c]=(this.mt[c]^(1566083941*((4294901760&f)>>>16)<<16)+1566083941*(65535&f))-c,this.mt[c]>>>=0,c++,c>=this.N&&(this.mt[0]=this.mt[this.N-1],c=1)}this.mt[0]=2147483648},Random.prototype.genrand_int32=function(){var a,b=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var c;for(this.mti==this.N+1&&this.init_genrand(5489),c=0;c<this.N-this.M;c++)a=this.mt[c]&this.UPPER_MASK|this.mt[c+1]&this.LOWER_MASK,this.mt[c]=this.mt[c+this.M]^a>>>1^b[1&a];for(;c<this.N-1;c++)a=this.mt[c]&this.UPPER_MASK|this.mt[c+1]&this.LOWER_MASK,this.mt[c]=this.mt[c+(this.M-this.N)]^a>>>1^b[1&a];a=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^a>>>1^b[1&a],this.mti=0}return a=this.mt[this.mti++],a^=a>>>11,a^=a<<7&2636928640,a^=a<<15&4022730752,a^=a>>>18,a>>>0},Random.prototype.genrand_int31=function(){return this.genrand_int32()>>>1},Random.prototype.genrand_real1=function(){return this.genrand_int32()*(1/4294967295)},Random.prototype.random=function(){return this.pythonCompatibility&&(this.skip&&this.genrand_int32(),this.skip=!0),this.genrand_int32()*(1/4294967296)},Random.prototype.genrand_real3=function(){return(this.genrand_int32()+.5)*(1/4294967296)},Random.prototype.genrand_res53=function(){var a=this.genrand_int32()>>>5,b=this.genrand_int32()>>>6;return(67108864*a+b)*(1/9007199254740992)},Random.prototype.LOG4=Math.log(4),Random.prototype.SG_MAGICCONST=1+Math.log(4.5),Random.prototype.exponential=function(a){if(1!=arguments.length)throw new SyntaxError("exponential() must  be called with 'lambda' parameter");var b=this.random();return-Math.log(b)/a},Random.prototype.gamma=function(a,b){if(2!=arguments.length)throw new SyntaxError("gamma() must be called with alpha and beta parameters");if(!(a>1)){if(1==a){for(var c=this.random();1e-7>=c;)c=this.random();return-Math.log(c)*b}for(;;){var c=this.random(),d=(Math.E+a)/Math.E,e=d*c;if(1>=e)var f=Math.pow(e,1/a);else var f=-Math.log((d-e)/a);var g=this.random();if(e>1){if(g<=Math.pow(f,a-1))break}else if(g<=Math.exp(-f))break}return f*b}for(var h=Math.sqrt(2*a-1),i=a-this.LOG4,j=a+h;;){var g=this.random();if(!(1e-7>g||c>.9999999)){var k=1-this.random(),l=Math.log(g/(1-g))/h,f=a*Math.exp(l),m=g*g*k,n=i+j*l-f;if(n+this.SG_MAGICCONST-4.5*m>=0||n>=Math.log(m))return f*b}}},Random.prototype.normal=function(a,b){if(2!=arguments.length)throw new SyntaxError("normal() must be called with mu and sigma parameters");var c=this.lastNormal;if(this.lastNormal=NaN,!c){var d=2*this.random()*Math.PI,e=Math.sqrt(-2*Math.log(1-this.random()));c=Math.cos(d)*e,this.lastNormal=Math.sin(d)*e}return a+c*b},Random.prototype.pareto=function(a){if(1!=arguments.length)throw new SyntaxError("pareto() must be called with alpha parameter");var b=this.random();return 1/Math.pow(1-b,1/a)},Random.prototype.triangular=function(a,b,c){if(3!=arguments.length)throw new SyntaxError("triangular() must be called with lower, upper and mode parameters");var d=(c-a)/(b-a),e=this.random();return d>=e?a+Math.sqrt(e*(b-a)*(c-a)):b-Math.sqrt((1-e)*(b-a)*(b-c))},Random.prototype.uniform=function(a,b){if(2!=arguments.length)throw new SyntaxError("uniform() must be called with lower and upper parameters");return a+this.random()*(b-a)},Random.prototype.weibull=function(a,b){if(2!=arguments.length)throw new SyntaxError("weibull() must be called with alpha and beta parameters");var c=1-this.random();return a*Math.pow(-Math.log(c),1/b)},"undefined"==typeof window&&"undefined"!=typeof module&&module.exports&&(module.exports=Random);var fluid=fluid||require("infusion"),flock=fluid.registerNamespace("flock");!function(){"use strict";var a=fluid.registerNamespace("jQuery");if(flock.fluid=fluid,flock.init=function(a){var b=a?{components:{audioSystem:{options:{model:a}}}}:void 0,c=flock.enviro(b);return c},flock.ALL_CHANNELS=32,flock.OUT_UGEN_ID="flocking-out",flock.PI=Math.PI,flock.TWOPI=2*Math.PI,flock.HALFPI=Math.PI/2,flock.LOG01=Math.log(.1),flock.LOG001=Math.log(.001),flock.ROOT2=Math.sqrt(2),flock.rates={AUDIO:"audio",CONTROL:"control",SCHEDULED:"scheduled",DEMAND:"demand",CONSTANT:"constant"},fluid.registerNamespace("flock.debug"),flock.debug.failHard=!0,flock.browser=function(){if("undefined"==typeof navigator)return{};var a,b,c=navigator.userAgent.toLowerCase(),d={};return a=/(chrome)[ \/]([\w.]+)/.exec(c)||/(webkit)[ \/]([\w.]+)/.exec(c)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(c)||/(msie) ([\w.]+)/.exec(c)||c.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(c)||[],b={browser:a[1]||"",version:a[2]||"0"},b.browser&&(d[b.browser]=!0,d.version=b.version),d.chrome?d.webkit=!0:d.webkit&&(d.safari=!0),d},fluid.registerNamespace("flock.platform"),flock.platform.isBrowser="undefined"!=typeof window,flock.platform.hasRequire="undefined"!=typeof require,flock.platform.os=flock.platform.isBrowser?window.navigator.platform:require("os").platform(),flock.platform.isLinux=flock.platform.os.indexOf("Linux")>-1,flock.platform.isAndroid=flock.platform.isLinux&&flock.platform.os.indexOf("arm")>-1,flock.platform.isIOS="iPhone"===flock.platform.os||"iPad"===flock.platform.os||"iPod"===flock.platform.os,flock.platform.isMobile=flock.platform.isAndroid||flock.platform.isIOS,flock.platform.browser=flock.browser(),flock.platform.isWebAudio="undefined"!=typeof AudioContext||"undefined"!=typeof webkitAudioContext,flock.platform.audioEngine=flock.platform.isBrowser?"webAudio":"nodejs",flock.platform.browser&&void 0!==flock.platform.browser.version){var b=flock.platform.browser.version.indexOf(".");flock.platform.browser.majorVersionNumber=Number(0>b?flock.platform.browser.version:flock.platform.browser.version.substring(0,b))}flock.shim={URL:flock.platform.isBrowser?window.URL||window.webkitURL||window.msURL:void 0},flock.requireModule=function(a,b){if(flock.platform.isBrowser)return window[b||a];if(flock.platform.hasRequire){var c=flock.requireModule.paths[a]||a,d=require(c);return b?d[b]:d}},flock.requireModule.paths={webarraymath:"../third-party/webarraymath/js/webarraymath.js",Random:"../third-party/simjs/js/random-0.26.js"},flock.noOp=function(){},flock.isIterable=function(a){var b=typeof a;return a&&void 0!==a.length&&"string"!==b&&"function"!==b},flock.hasValue=function(a,b){var c=!1;for(var d in a)if(a[d]===b){c=!0;break}return c},flock.hasTag=function(a,b){return a&&b?a.tags&&a.tags.indexOf(b)>-1:!1},flock.randomValue=function(a,b){var c=b-a;return Math.random()*c+a},flock.randomAudioValue=function(){return 2*Math.random()-1},flock.fillBuffer=function(a,b){for(var c=0;c<a.length;c++)a[c]=b(c,a);return a},flock.fillBufferWithValue=function(a,b){for(var c=0;c<a.length;c++)a[c]=b;return a},flock.generateBuffer=function(a,b){var c=new Float32Array(a);return flock.fillBuffer(c,b)},flock.generateBufferWithValue=function(a,b){var c=new Float32Array(a);return flock.fillBufferWithValue(c,b)},flock.generate=function(a,b){var c="function"==typeof b,d="number"==typeof a,e=c?d?flock.generateBuffer:flock.fillBuffer:d?flock.generateBufferWithValue:flock.fillBufferWithValue;return e(a,b)},flock.generate.silence=function(a){return new Float32Array(a)},flock.clearBuffer=function(a){for(var b=0;b<a.length;b++)a[b]=0;return a},flock.reverse=function(a){if(!a||!flock.isIterable(a)||a.length<2)return a;if("function"==typeof a.reverse)return a.reverse();for(var b,c=0,d=a.length-1;d>c;c++,d--)b=a[c],a[c]=a[d],a[d]=b;return a},flock.randomIndex=function(a){var b=a.length-1;return Math.round(Math.random()*b)},flock.arrayChoose=function(a,b){b=b||flock.randomIndex,a=fluid.makeArray(a);var c=b(a);return a[c]},flock.choose=function(a,b){var c,d;return flock.isIterable(a)?d=flock.arrayChoose(a,b):(c=flock.arrayChoose(a.keys,b),d=a[c])},flock.shuffle=function(a){for(var b=a.length-1;b>0;b-=1){var c=Math.floor(Math.random()*(b+1)),d=a[b];a[b]=a[c],a[c]=d}return a},flock.normalize=function(a,b,c){c=c||a;var d,e,f,g=0;for(b=void 0===b?1:b,d=0;d<a.length;d++)e=Math.abs(a[d]),e>g&&(g=e);if(g>0)for(d=0;d<a.length;d++)f=a[d],c[d]=f/g*b;return c},flock.generateFourierTable=function(a,b,c,d,e){return d*=flock.TWOPI,flock.generateBuffer(a,function(a){var f,g,h,i=0;for(f=0;c>f;f++)g=e?e[f]:1,h=(f+1)*(a*b),i+=g*Math.cos(h+d);return i})},flock.generateNormalizedFourierTable=function(a,b,c,d,e){var f=flock.generateBuffer(c,function(a){return e(a+1)}),g=flock.generateFourierTable(a,b,c,d,f);return flock.normalize(g)},flock.fillTable=function(a,b){var c="number"==typeof a?a:a.length;return b(a,flock.TWOPI/c)},flock.tableGenerators={sin:function(a,b){return flock.generateBuffer(a,function(a){return Math.sin(a*b)})},tri:function(a,b){return flock.generateNormalizedFourierTable(a,b,1e3,1,function(a){return a%2===0?0:1/(a*a)})},saw:function(a,b){return flock.generateNormalizedFourierTable(a,b,10,-.25,function(a){return 1/a})},square:function(a,b){return flock.generateNormalizedFourierTable(a,b,10,-.25,function(a){return a%2===0?0:1/a})},hann:function(a){return flock.generateBuffer(a,function(b){var c=Math.sin(Math.PI*b/a);return c*c})},sinWindow:function(a){return flock.generateBuffer(a,function(b){return Math.sin(Math.PI*b/a)})}},flock.range=function(a){var b,c,d={max:Number.NEGATIVE_INFINITY,min:1/0};for(b=0;b<a.length;b++)c=a[b],c>d.max&&(d.max=c),c<d.min&&(d.min=c);return d},flock.scale=function(a){if(a){var b,c=flock.range(a),d=(c.max-c.min)/2,e=(c.max+c.min)/2;for(b=0;b<a.length;b++)a[b]=(a[b]-e)/d;return a}},flock.copyBuffer=function(a,b,c){void 0===c&&(c=a.length);var d,e,f=c-b,g=new Float32Array(f);for(d=b,e=0;c>d;d++,e++)g[e]=a[d];return g},flock.copyToBuffer=function(a,b){for(var c=Math.min(a.length,b.length),d=0;c>d;d++)b[d]=a[d]},flock.parseMidiString=function(a){if(!a||a.length<2)return NaN;a=a.toLowerCase();var b=a.charAt(1),c="#"===b||"b"===b?2:1,d=a.substring(0,c),e=Number(a.substring(c)),f=flock.midiFreq.noteNames[d],g=12*e+f;return g},flock.midiFreq=function(a,b,c,d){return b=void 0===b?440:b,c=void 0===c?69:c,d=d||12,"string"==typeof a&&(a=flock.parseMidiString(a)),b*Math.pow(2,1*(a-c)/d)},flock.midiFreq.noteNames={"b#":0,c:0,"c#":1,db:1,d:2,"d#":3,eb:3,e:4,"e#":5,f:5,"f#":6,gb:6,g:7,"g#":8,ab:8,a:9,"a#":10,bb:10,b:11,cb:11},flock.interpolate={none:function(a,b){return a%=b.length,b[0|a]},linear:function(a,b){var c=b.length;a%=c;var d=0|a,e=(d+1)%c,f=a-d,g=b[d],h=b[e];return g+f*(h-g)},hermite:function(a,b){var c=b.length,d=Math.floor(a),e=d%c,f=a-d,g=e>0?e-1:c-1,h=(e+1)%c,i=(e+2)%c,j=b[g],k=b[e],l=b[h],m=b[i],n=.5*(l-j),o=k-l,p=n+o,q=p+o+.5*(m-k),r=p+q,s=((q*f-r)*f+n)*f+k;return s}},flock.interpolate.cubic=flock.interpolate.hermite,flock.log={fail:function(a){fluid.log(fluid.logLevel.FAIL,a)},warn:function(a){fluid.log(fluid.logLevel.WARN,a)},debug:function(a){fluid.log(fluid.logLevel.INFO,a)}},flock.fail=function(a){if(flock.debug.failHard)throw new Error(a);flock.log.fail(a)},flock.pathParseError=function(a,b,c){var d="Error parsing path '"+b+"'. Segment '"+c+"' could not be resolved. Root object was: "+fluid.prettyPrintJSON(a);flock.fail(d)},flock.get=function(a,b){if(!a)return fluid.getGlobalValue(b);if(1===arguments.length&&"string"==typeof a)return fluid.getGlobalValue(a);if(b&&""!==b){var c,d=""===b?[]:String(b).split("."),e=a[d[0]];for(c=1;c<d.length;c++){if(null===e||void 0===e)return void flock.pathParseError(a,b,d[c-1]);e=e[d[c]]}return e}},flock.set=function(a,b,c){if(a&&b&&""!==b){var d,e,f=String(b).split("."),g=f.length,h=f[0];for(d=1;g>d;d++){if(a=a[h],e=typeof a,"object"!==e)return void flock.fail("Error while setting a value at path '"+b+"'. A non-container object was found at segment '"+h+"'. Value: "+a);h=f[d],void 0===a[h]&&(a[h]={})}return a[h]=c,c}},flock.invoke=function(a,b,c){var d="function"==typeof a?a:flock.get(a,b);return"function"!=typeof d?void flock.fail("Path '"+b+"' does not resolve to a function."):d.apply(null,c)},flock.input={},flock.input.shouldExpand=function(a){return flock.parse.specialInputs.indexOf(a)<0},flock.input.pathExpander=function(a){var b,c=fluid.model.parseEL(a),d="inputs",e=c.length,f=e-1,g=[];for(b=0;f>b;b++){var h=c[b],i=c[b+1];if(g.push(h),"model"===i||"options"===i){g=g.concat(c.slice(b+1,f));break}isNaN(Number(i))&&g.push(d)}return g.push(c[f]),g.join(".")},flock.input.expandPaths=function(a){var b,c,d,e={};for(b in a)c=flock.input.pathExpander(b),d=a[b],e[c]=d;return e},flock.input.expandPath=function(a){return"string"==typeof a?flock.input.pathExpander(a):flock.input.expandPaths(a)},flock.input.getValueForPath=function(a,b){b=flock.input.expandPath(b);var c=flock.get(a,b);return flock.hasTag(c,"flock.ugen.valueType")?c.inputs.value:c},flock.input.getValuesForPathArray=function(a,b){var c,d,e={};for(c=0;c<b.length;c++)d=b[c],e[d]=flock.input.get(a,d);return e},flock.input.getValuesForPathObject=function(a,b){var c;for(c in b)b[c]=flock.input.get(a,c);return b},flock.input.get=function(a,b){return"string"==typeof b?flock.input.getValueForPath(a,b):flock.isIterable(b)?flock.input.getValuesForPathArray(a,b):flock.input.getValuesForPathObject(a,b)},flock.input.resolveValue=function(a,b,c,d,e,f,g){if("string"==typeof c){var h=fluid.extractEL(c,flock.input.valueExpressionSpec);if(h){var i=flock.input.getValueForPath(a,h);return void 0===i&&flock.log.debug("The value expression '"+c+"' resolved to undefined. If this isn't expected, check to ensure that your path is valid."),i}}return flock.input.shouldExpand(e)&&g?g(c,b,d,f):c},flock.input.valueExpressionSpec={ELstyle:"${}"},flock.input.setValueForPath=function(a,b,c,d,e){b=flock.input.expandPath(b);var f=flock.get(a,b),g=b.lastIndexOf("."),h=b.slice(g+1),i=g>-1?flock.get(a,b.slice(0,b.lastIndexOf(".inputs"))):d,j=flock.input.resolveValue(a,b,c,i,h,f,e);return flock.set(a,b,j),i&&i.onInputChanged&&i.onInputChanged(h),j},flock.input.setValuesForPaths=function(a,b,c,d){var e,f,g,h={};for(e in b)f=b[e],g=flock.input.set(a,e,f,c,d),h[e]=g;return h},flock.input.set=function(a,b,c,d,e){return"string"==typeof b?flock.input.setValueForPath(a,b,c,d,e):flock.input.setValuesForPaths(a,b,d,e)},fluid.defaults("flock.audioSystem",{gradeNames:["fluid.modelComponent"],channelRange:{min:1,max:32},outputBusRange:{min:2,max:1024},inputBusRange:{min:1,max:32},model:{rates:{audio:44100,control:689.0625,scheduled:0,demand:0,constant:0},blockSize:64,numBlocks:16,chans:2,numInputBuses:2,numBuses:8,bufferSize:"@expand:flock.audioSystem.defaultBufferSize()"},modelRelay:[{target:"rates.control",singleTransform:{type:"fluid.transforms.binaryOp",left:"{that}.model.rates.audio",operator:"/",right:"{that}.model.blockSize"}},{target:"numBlocks",singleTransform:{type:"fluid.transforms.binaryOp",left:"{that}.model.bufferSize",operator:"/",right:"{that}.model.blockSize"}},{target:"chans",singleTransform:{type:"fluid.transforms.limitRange",input:"{that}.model.chans",min:"{that}.options.channelRange.min",max:"{that}.options.channelRange.max"}},{target:"numInputBuses",singleTransform:{type:"fluid.transforms.limitRange",input:"{that}.model.numInputBuses",min:"{that}.options.inputBusRange.min",max:"{that}.options.inputBusRange.max"}},{target:"numBuses",singleTransform:{type:"fluid.transforms.free",func:"flock.audioSystem.clampNumBuses",args:["{that}.model.numBuses","{that}.options.outputBusRange","{that}.model.chans"]}}]}),flock.audioSystem.clampNumBuses=function(a,b,c){return a=Math.max(a,Math.max(c,b.min)),a=Math.min(a,b.max)},flock.audioSystem.defaultBufferSize=function(){return flock.platform.isMobile?8192:flock.platform.browser.mozilla?2048:1024},fluid.defaults("flock.busManager",{gradeNames:["fluid.modelComponent"],model:{nextAvailableBus:{input:0,interconnect:0}},members:{buses:{expander:{funcName:"flock.enviro.createAudioBuffers",args:["{audioSystem}.model.numBuses","{audioSystem}.model.blockSize"]}}},invokers:{acquireNextBus:{funcName:"flock.busManager.acquireNextBus",args:["{arguments}.0","{that}.buses","{that}.applier","{that}.model","{audioSystem}.model.chans","{audioSystem}.model.numInputBuses"]},reset:{changePath:"nextAvailableBus",value:{input:0,interconnect:0}}}}),flock.busManager.acquireNextBus=function(a,b,c,d,e,f){var g=d.nextAvailableBus[a];if(void 0===g)return void flock.fail("An invalid bus type was specified when invoking flock.busManager.acquireNextBus(). Type was: "+a);var h=g+e,i=e+f;return"interconnect"===a&&(h+=f,i=b.length),h>=i?void flock.fail("Unable to aquire a bus. There are insufficient buses available. Please use an existing bus or configure additional buses using the enviroment's numBuses and numInputBuses parameters."):(c.change("nextAvailableBus."+a,++g),h)},fluid.defaults("flock.outputManager",{gradeNames:["fluid.modelComponent"],model:{audioSettings:"{audioSystem}.model"},invokers:{start:"{that}.events.onStart.fire()",stop:"{that}.events.onStop.fire()",reset:"{that}.events.onReset.fire"},events:{onStart:"{enviro}.events.onStart",onStop:"{enviro}.events.onStop",onReset:"{enviro}.events.onReset"}}),fluid.defaults("flock.nodeListComponent",{gradeNames:"fluid.component",members:{nodeList:"@expand:flock.nodeList()"},invokers:{insert:"flock.nodeList.insert({that}.nodeList, {arguments}.0, {arguments}.1)",head:"flock.nodeList.head({that}.nodeList, {arguments}.0)",tail:"flock.nodeList.tail({that}.nodeList, {arguments}.0)",before:"flock.nodeList.before({that}.nodeList, {arguments}.0, {arguments}.1)",after:"flock.nodeList.after({that}.nodeList, {arguments}.0, {arguments}.1)",remove:"flock.nodeList.remove({that}.nodeList, {arguments}.0)",replace:"flock.nodeList.after({that}.nodeList, {arguments}.0, {arguments}.1)"}}),fluid.defaults("flock.enviro",{gradeNames:["fluid.modelComponent","flock.nodeListComponent","fluid.resolveRootSingle"],singleRootType:"flock.enviro",isGlobalSingleton:!0,members:{buffers:{},bufferSources:{}},components:{asyncScheduler:{type:"flock.scheduler.async"},audioSystem:{type:"flock.audioSystem"},busManager:{type:"flock.busManager"}},model:{isPlaying:!1},invokers:{gen:{funcName:"flock.enviro.gen",args:["{busManager}.buses","{audioSystem}.model","{that}.nodeList.nodes"]},start:"flock.enviro.start({that}.model, {that}.events.onStart.fire)",play:"{that}.start",stop:"flock.enviro.stop({that}.model, {that}.events.onStop.fire)",reset:"{that}.events.onReset.fire()",registerBuffer:"flock.enviro.registerBuffer({arguments}.0, {that}.buffers)",releaseBuffer:"flock.enviro.releaseBuffer({arguments}.0, {that}.buffers)",saveBuffer:{funcName:"flock.enviro.saveBuffer",args:["{arguments}.0","{that}.buffers","{audioSystem}"]}},events:{onStart:null,onPlay:"{that}.events.onStart",onStop:null,onReset:null},listeners:{onCreate:["flock.enviro.registerGlobalSingleton({that})"],onStart:["{that}.applier.change(isPlaying, true)"],onStop:["{that}.applier.change(isPlaying, false)"],onReset:["{that}.stop()","{asyncScheduler}.clearAll()","flock.nodeList.clearAll({that}.nodeList)","{busManager}.reset()","fluid.clear({that}.buffers)"],onDestroy:["{that}.reset()"]}}),flock.enviro.registerGlobalSingleton=function(a){a.options.isGlobalSingleton&&(flock.environment=flock.enviro.shared=a)},flock.enviro.registerBuffer=function(a,b){a.id&&(b[a.id]=a)},flock.enviro.releaseBuffer=function(a,b){if(a){var c="string"==typeof a?a:a.id;delete b[c]}},flock.enviro.saveBuffer=function(a,b,c){if("string"==typeof a&&(a={buffer:a}),"string"==typeof a.buffer){var d=a.buffer;a.buffer=b[d],a.buffer.id=d}return a.type=a.type||"wav",a.path=a.path||a.buffer.id+"."+a.type,a.format=a.format||"int16",c.bufferWriter.save(a,a.buffer)},flock.enviro.gen=function(a,b,c){flock.evaluate.clearBuses(a,b.numBuses,b.blockSize),flock.evaluate.synths(c)},flock.enviro.start=function(a,b){a.isPlaying||b()},flock.enviro.stop=function(a,b){a.isPlaying&&b()},flock.enviro.createAudioBuffers=function(a,b){var c,d=[];for(c=0;a>c;c++)d[c]=new Float32Array(b);return d},fluid.defaults("flock.autoEnviro",{gradeNames:["fluid.component"],members:{enviro:"@expand:flock.autoEnviro.initEnvironment()"}}),flock.autoEnviro.initEnvironment=function(){return flock.environment?flock.environment:flock.init()},fluid.defaults("flock.silentEnviro",{gradeNames:"flock.enviro",listeners:{onCreate:["flock.silentEnviro.insertOutputGainNode({that})"]}}),flock.silentEnviro.insertOutputGainNode=function(a){a.audioSystem.nativeNodeManager&&a.audioSystem.nativeNodeManager.createOutputNode({node:"Gain",params:{gain:0}})},fluid.defaults("flock.node",{gradeNames:["flock.autoEnviro","fluid.modelComponent"],addToEnvironment:"tail",model:{},components:{enviro:"{flock.enviro}"},invokers:{play:{funcName:"flock.node.play",args:["{that}","{that}.enviro","{that}.addToEnvironment"]},pause:"{that}.removeFromEnvironment()",addToEnvironment:{funcName:"flock.node.addToEnvironment",args:["{that}","{arguments}.0","{enviro}.nodeList"]},removeFromEnvironment:{funcName:"flock.node.removeFromEnvironment",args:["{that}","{enviro}.nodeList"]},isPlaying:{funcName:"flock.nodeList.isNodeActive",args:["{enviro}.nodeList","{that}"]}},listeners:{onCreate:["{that}.addToEnvironment({that}.options.addToEnvironment)"],onDestroy:["{that}.removeFromEnvironment()"]}}),flock.node.addToEnvironment=function(a,b,c){if(void 0===b&&(b=a.options.addToEnvironment),void 0!==b&&null!==b&&b!==!1){var d=typeof b;"string"===d&&"head"===b||"tail"===b?flock.nodeList[b](c,a):"number"===d?flock.nodeList.insert(c,a,b):flock.nodeList.tail(c,a)}},flock.node.removeFromEnvironment=function(a,b){flock.nodeList.remove(b,a)},flock.node.play=function(a,b,c){if(-1===b.nodeList.nodes.indexOf(a)){var d=a.options.addToEnvironment||"tail";c(d)}b.model.isPlaying||b.play()},fluid.defaults("flock.noteTarget",{gradeNames:"fluid.component",noteChanges:{on:{"env.gate":1},off:{"env.gate":0}},invokers:{set:{funcName:"fluid.notImplemented"},noteOn:{func:"{that}.events.noteOn.fire"},noteOff:{func:"{that}.events.noteOff.fire"},noteChange:{funcName:"flock.noteTarget.change",args:["{that}","{arguments}.0","{arguments}.1"]}},events:{noteOn:null,noteOff:null},listeners:{"noteOn.handleChange":["{that}.noteChange(on, {arguments}.0)"],"noteOff.handleChange":["{that}.noteChange(off, {arguments}.0)"]}}),flock.noteTarget.change=function(b,c,d){var e=b.options.noteChanges[c],f=a.extend({},e,d);b.set(f)},fluid.defaults("flock.synth",{gradeNames:["flock.node","flock.noteTarget"],rate:flock.rates.AUDIO,addToEnvironment:!0,mergePolicy:{ugens:"nomerge"},ugens:{expander:{funcName:"flock.makeUGens",args:["{that}.options.synthDef","{that}.rate","{that}.nodeList","{enviro}","{that}.audioSettings"]}},members:{rate:"{that}.options.rate",audioSettings:"{enviro}.audioSystem.model",nodeList:"@expand:flock.nodeList()",out:"{that}.options.ugens",genFn:"@expand:fluid.getGlobalValue(flock.evaluate.ugens)"},model:{blockSize:"@expand:flock.synth.calcBlockSize({that}.rate, {enviro}.audioSystem.model)"},invokers:{set:{funcName:"flock.synth.set",args:["{that}","{that}.nodeList.namedNodes","{arguments}.0","{arguments}.1","{arguments}.2"]},get:{funcName:"flock.input.get",args:["{that}.nodeList.namedNodes","{arguments}.0"]},input:{funcName:"flock.synth.input",args:["{arguments}","{that}.get","{that}.set"]}}}),flock.synth.createUGenTree=function(a,b,c){return new flock.UGenTree(a,b,c)},flock.synth.calcBlockSize=function(a,b){return a===flock.rates.AUDIO?b.blockSize:1},flock.synth.set=function(a,b,c,d,e){return flock.input.set(b,c,d,void 0,function(b,c,d,f){return flock.synth.ugenValueParser(a,b,f,e)})},flock.synth.input=function(a,b,c){var d=a[0];return d?"string"==typeof d?a.length<2?b(d):c.apply(null,a):flock.isIterable(d)?b(d):c.apply(null,a):void 0},flock.synth.ugenValueParser=function(a,b,c,d){if(null===b||void 0===b)return c;var e,f,g,h=flock.parse.ugenDef(b,a.enviro,{audioSettings:a.audioSettings,buses:a.enviro.busManager.buses,buffers:a.enviro.buffers}),i=flock.isIterable(h)?h:void 0!==h?[h]:[],j=flock.isIterable(c)?c:void 0!==c?[c]:[],k=Math.min(i.length,j.length),l=d?"swapTree":"replaceTree";for(e=0;k>e;e++)f=flock.ugenNodeList[l](a.nodeList,i[e],j[e]);for(g=e;g<i.length;g++)f++,flock.ugenNodeList.insertTree(a.nodeList,i[g],f);for(g=e;g<j.length;g++)flock.ugenNodeList.removeTree(a.nodeList,j[g]);return h},fluid.defaults("flock.synth.value",{gradeNames:["flock.synth"],rate:"demand",addToEnvironment:!1,invokers:{value:{funcName:"flock.evaluate.synthValue",args:["{that}"]}}}),fluid.defaults("flock.synth.frameRate",{gradeNames:["flock.synth.value"],rate:"scheduled",fps:60,members:{audioSettings:{rates:{scheduled:"{that}.options.fps"}}}}),flock.bufferDesc=function(){throw new Error("flock.bufferDesc is not defined. Did you forget to include the buffers.js file?")}}();var fluid=fluid||require("infusion"),flock=fluid.registerNamespace("flock");!function(){"use strict";flock.nodeList=function(){return{nodes:[],namedNodes:{}}},flock.nodeList.insert=function(a,b,c){return 0>c&&(c=0),a.nodes.splice(c,0,b),flock.nodeList.registerNode(a,b),c},flock.nodeList.registerNode=function(a,b){var c=b.name||b.id;c&&(a.namedNodes[c]=b)},flock.nodeList.head=function(a,b){return flock.nodeList.insert(a,b,0)},flock.nodeList.before=function(a,b,c){var d=a.nodes.indexOf(c);return flock.nodeList.insert(a,b,d)},flock.nodeList.after=function(a,b,c){var d=a.nodes.indexOf(c),e=d+1;return flock.nodeList.insert(a,b,e)},flock.nodeList.tail=function(a,b){var c=a.nodes.length;return flock.nodeList.insert(a,b,c)},flock.nodeList.unregisterNode=function(a,b){var c=b.name||b.id;c&&delete a.namedNodes[c]},flock.nodeList.isNodeActive=function(a,b){var c=a.nodes.indexOf(b);return c>-1},flock.nodeList.remove=function(a,b){if(a){var c=a.nodes.indexOf(b);return c>-1&&(a.nodes.splice(c,1),
flock.nodeList.unregisterNode(a,b)),c}},flock.nodeList.replace=function(a,b,c){var d=a.nodes.indexOf(c);return 0>d?flock.nodeList.tail(a,b):(a.nodes[d]=b,flock.nodeList.unregisterNode(a,c),flock.nodeList.registerNode(a,b),d)},flock.nodeList.clearAll=function(a){a.nodes.length=0;for(var b in a.namedNodes)delete a.namedNodes[b]},flock.ugenNodeList=function(){return flock.nodeList()},flock.ugenNodeList.insertTree=function(a,b,c){var d,e,f=b.inputs;for(d in f)e=f[d],flock.isUGen(e)&&(c=flock.ugenNodeList.insertTree(a,e,c),c++);return flock.nodeList.insert(a,b,c)},flock.ugenNodeList.removeTree=function(a,b){var c,d,e=b.inputs;for(c in e)d=e[c],flock.isUGen(d)&&flock.ugenNodeList.removeTree(a,d);return flock.nodeList.remove(a,b)},flock.ugenNodeList.tailTree=function(a,b){var c=a.nodes.length;return flock.ugenNodeList.insertTree(a,b,c)},flock.ugenNodeList.replaceTree=function(a,b,c){if(!c)return flock.ugenNodeList.tailTree(a,b);var d=flock.ugenNodeList.removeTree(a,c);return flock.ugenNodeList.insertTree(a,b,d),d},flock.ugenNodeList.swapTree=function(a,b,c,d){return d?(flock.ugenNodeList.reattachInputs(a,b,c,d),flock.ugenNodeList.replaceInputs(a,b,c,d)):b.inputs=c.inputs,flock.nodeList.replace(a,b,c)},flock.ugenNodeList.reattachInputs=function(a,b,c,d){for(var e in c.inputs)d.indexOf(e)<0?flock.ugenNodeList.removeTree(a,c.inputs[e]):b.inputs[e]=c.inputs[e]},flock.ugenNodeList.replaceInputs=function(a,b,c,d){for(var e in b.inputs)d.indexOf(e)<0&&flock.ugenNodeList.replaceTree(a,b.inputs[e],c.inputs[e])},flock.makeUGens=function(a,b,c,d,e){a||fluid.log(fluid.logLevel.IMPORTANT,"Warning: An empy synthDef was found while instantiating a unit generator tree.Did you forget to include a 'synthDef' option for your Synth?");var f=b===flock.rates.SCHEDULED||b===flock.rates.DEMAND;return flock.parse.synthDef(a,d,{rate:b,overrideRate:f,visitors:[flock.makeUGens.visitor(c)],buffers:d.buffers,buses:d.busManager.buses,audioSettings:e||d.audioSystem.model})},flock.makeUGens.visitor=function(a){return function(b){flock.nodeList.tail(a,b)}}}();var fluid=fluid||require("infusion"),flock=fluid.registerNamespace("flock");!function(){"use strict";flock.evaluate={synth:function(a){a.genFn(a.nodeList.nodes),a.out&&(a.model.value=a.out.model.value)},synthValue:function(a){return flock.evaluate.synth(a),a.model.value},synths:function(a){for(var b=0;b<a.length;b++)flock.evaluate.synth(a[b])},clearBuses:function(a,b,c){for(var d=0;b>d;d++)for(var e=a[d],f=0;c>f;f++)e[f]=0},ugens:function(a){for(var b,c=0;c<a.length;c++)b=a[c],void 0!==b.gen&&b.gen(b.model.blockSize)}}}();var fluid=fluid||require("infusion"),flock=fluid.registerNamespace("flock");!function(){"use strict";fluid.defaults("flock.modelSynth",{gradeNames:"flock.synth",model:{inputs:{}},modelListeners:{inputs:[{funcName:"flock.modelSynth.updateUGens",args:["{that}.set","{that}.options.ugens","{change}"]}]},invokers:{value:"{that}.events.onEvaluate.fire()"},events:{onEvaluate:null},listeners:{onEvaluate:["{that}.genFn({that}.nodeList.nodes)",{changePath:"value",value:"{that}.out.model.value"}]}}),flock.modelSynth.updateUGens=function(a,b,c){var d={};flock.modelSynth.flattenModel("",c.value,d),a(d)},flock.modelSynth.shouldFlattenValue=function(a){return fluid.isPrimitive(a)||flock.isIterable(a)||a.ugen},flock.modelSynth.flattenModel=function(a,b,c){for(var d in b){var e=b[d],f=fluid.pathUtil.composePath(a,d.toString());flock.modelSynth.shouldFlattenValue(e)?c[f]=e:flock.modelSynth.flattenModel(f,e,c)}return c}}();var fluid=fluid||require("infusion"),flock=fluid.registerNamespace("flock");!function(){"use strict";fluid.defaults("flock.synth.group",{gradeNames:["flock.node","flock.noteTarget"],methodEventMap:{onSet:"set"},members:{nodeList:"@expand:flock.nodeList()",genFn:"@expand:fluid.getGlobalValue(flock.evaluate.synths)"},invokers:{play:"{that}.events.onPlay.fire",pause:"{that}.events.onPause.fire",set:"{that}.events.onSet.fire",get:"flock.synth.group.get({arguments}, {that}.nodeList.nodes)",head:"flock.synth.group.head({arguments}.0, {that})",tail:"flock.synth.group.tail({arguments}.0, {that})",insert:"flock.synth.group.insert({arguments}.0, {arguments}.1, {that})",before:"flock.synth.group.before({arguments}.0, {arguments}.1, {that})",after:"flock.synth.group.after({arguments}.0, {arguments}.1, {that})",remove:"{that}.events.onRemove.fire",input:{funcName:"flock.synth.group.input",args:["{arguments}","{that}.get","{that}.events.onSet.fire"]}},events:{onSet:null,onGen:null,onPlay:null,onPause:null,onInsert:null,onRemove:null},listeners:{onInsert:[{funcName:"flock.synth.group.bindMethods",args:["{arguments}.0","{that}.options.methodEventMap","{that}.events","addListener"]},"flock.synth.group.removeNodeFromEnvironment({arguments}.0)"],onRemove:[{funcName:"flock.synth.group.bindMethods",args:["{arguments}.0","{that}.options.methodEventMap","{that}.events","removeListener"]},{"this":"{that}.nodeList",method:"remove",args:["{arguments}.0"]}]}}),flock.synth.group.head=function(a,b){flock.nodeList.head(b.nodeList,a),b.events.onInsert.fire(a)},flock.synth.group.tail=function(a,b){flock.nodeList.tail(b.nodeList,a),b.events.onInsert.fire(a)},flock.synth.group.insert=function(a,b,c){flock.nodeList.insert(c.nodeList,a,b),c.events.onInsert.fire(a)},flock.synth.group.before=function(a,b,c){flock.nodeList.before(c.nodeList,a,b),c.events.onInsert.fire(a)},flock.synth.group.after=function(a,b,c){flock.nodeList.after(c.nodeList,a,b),c.events.onInsert.fire(a)},flock.synth.group.removeNodeFromEnvironment=function(a){a.removeFromEnvironment()},flock.synth.group.get=function(a,b){var c=b.length-1,d=b[c];return d.get.apply(d,a)},flock.synth.group.input=function(a,b,c){var d=a.length>1?c:b;return d.apply(null,a)},flock.synth.group.bindMethods=function(a,b,c,d){for(var e in b){var f=b[e],g=a[f],h=c[e],i=h[d];i(g)}}}();var fluid=fluid||require("infusion"),flock=fluid.registerNamespace("flock");!function(){"use strict";var a=fluid.registerNamespace("jQuery");fluid.defaults("flock.synth.polyphonic",{gradeNames:["flock.synth.group"],maxVoices:16,amplitudeNormalizer:"static",amplitudeKey:"env.sustain",noteSpecs:"{that}.options.noteChanges",distributeOptions:{source:"{that}.options.voiceAllocatorOptions",target:"{that flock.synth.voiceAllocator}.options",removeSource:!0},voiceAllocatorOptions:{synthDef:"{polyphonic}.options.synthDef",maxVoices:"{polyphonic}.options.maxVoices",amplitudeNormalizer:"{polyphonic}.options.amplitudeNormalizer",amplitudeKey:"{polyphonic}.options.amplitudeKey",listeners:{onCreateVoice:{funcName:"flock.nodeList.tail",args:["{polyphonic}.nodeList","{arguments}.0"]}}},components:{voiceAllocator:{type:"flock.synth.voiceAllocator.lazy"}},invokers:{noteChange:{funcName:"flock.synth.polyphonic.noteChange",args:["{that}","{arguments}.0","{arguments}.1","{arguments}.2"]},createVoice:{func:"{voiceAllocator}.createVoice",args:["{that}.options","{that}.insert"]}},listeners:{"noteOn.handleChange":[{funcName:"flock.synth.polyphonic.noteOn",args:["{that}","{arguments}.0","{arguments}.1"]}],"noteOff.handleChange":[{funcName:"flock.synth.polyphonic.noteOff",args:["{that}","{arguments}.0","{arguments}.1"]}]}}),flock.synth.polyphonic.noteChange=function(b,c,d,e){var f=b.options.noteChanges[c],g=a.extend({},f,e);d.set(g)},flock.synth.polyphonic.noteOn=function(a,b,c){var d=a.voiceAllocator.getFreeVoice();return a.voiceAllocator.activeVoices[b]&&a.noteOff(b),a.voiceAllocator.activeVoices[b]=d,a.noteChange("on",d,c),d},flock.synth.polyphonic.noteOff=function(a,b,c){var d=a.voiceAllocator.activeVoices[b];return d?(a.noteChange("off",d,c),delete a.voiceAllocator.activeVoices[b],a.voiceAllocator.freeVoices.push(d),d):null},fluid.defaults("flock.synth.voiceAllocator",{gradeNames:["fluid.component"],maxVoices:16,amplitudeNormalizer:"static",amplitudeKey:"env.sustain",members:{activeVoices:{},freeVoices:[]},invokers:{createVoice:{funcName:"flock.synth.voiceAllocator.createVoice",args:["{that}.options","{that}.events.onCreateVoice.fire"]}},events:{onCreateVoice:null}}),flock.synth.voiceAllocator.createVoice=function(a,b){var c,d=flock.synth({synthDef:a.synthDef,addToEnvironment:!1}),e=a.amplitudeNormalizer,f=a.amplitudeKey;return e&&("function"==typeof e?e(d,f):"static"===e&&(c=1/a.maxVoices,d.input(f,c))),b(d),d},fluid.defaults("flock.synth.voiceAllocator.lazy",{gradeNames:["flock.synth.voiceAllocator"],invokers:{getFreeVoice:{funcName:"flock.synth.voiceAllocator.lazy.get",args:["{that}.freeVoices","{that}.activeVoices","{that}.createVoice","{that}.options.maxVoices"]}}}),flock.synth.voiceAllocator.lazy.get=function(a,b,c,d){return a.length>1?a.pop():Object.keys(b).length>d?null:c()},fluid.defaults("flock.synth.voiceAllocator.pool",{gradeNames:["flock.synth.voiceAllocator"],invokers:{getFreeVoice:"flock.synth.voiceAllocator.pool.get({that}.freeVoices)"}}),flock.synth.voiceAllocator.pool.get=function(a){return a.length>0?a.pop():void 0},flock.synth.voiceAllocator.pool.allocateVoices=function(a,b,c){for(var d=0;c>d;d++)a[d]=b()}}();var fluid=fluid||require("infusion"),flock=fluid.registerNamespace("flock");!function(){"use strict";fluid.defaults("flock.band",{gradeNames:["fluid.component"],invokers:{play:{func:"{that}.events.onPlay.fire"},pause:{func:"{that}.events.onPause.fire"},set:{func:"{that}.events.onSet.fire"},getSynths:{funcName:"flock.band.getSynths",args:["{that}"]}},events:{onPlay:null,onPause:null,onSet:null},distributeOptions:[{source:"{that}.options.childListeners",removeSource:!0,target:"{that fluid.component}.options.listeners"},{source:"{that}.options.synthListeners",removeSource:!0,target:"{that flock.synth}.options.listeners"}],childListeners:{"{band}.events.onDestroy":{func:"{that}.destroy"}},synthListeners:{"{band}.events.onPlay":{func:"{that}.play"},"{band}.events.onPause":{func:"{that}.pause"},"{band}.events.onSet":{func:"{that}.set"}}}),flock.band.getSynths=function(a){var b=[];return fluid.each(a.options.components,function(c,d){fluid.hasGrade(a[d].options,"flock.synth")&&b.push(a[d])}),b}}();var fluid=fluid||require("infusion"),flock=fluid.registerNamespace("flock");!function(){"use strict";function a(){function a(a,c){var d=function(a,b){return b(c),this},e=function(a){return a(c),this};g.value=c,g.then="reject"===a?d:e,g.resolve=g.reject=function(){throw new Error("Promise already completed")},b(a,c)}function b(a,b){var c,d;for(c=0;c<f.length;c++)d=f[c],d[a]&&d[a](b);f=null}var c=function(b){a("resolve",b),g.state="fulfilled"},d=function(b){a("reject",b),g.state="rejected"},e=function(a,b){if(f)f.push({resolve:a,reject:b});else{var c="fulfilled"===g.state?a:b;c(g.value)}return this},f=[],g={state:"pending",value:void 0,resolve:c,reject:d,then:e,safe:{then:function(a,b){return g.then(a,b),this}}};return g}fluid.defaults("flock.promise",{gradeNames:["fluid.component"],members:{promise:{expander:{funcName:"flock.promise.make"}}}}),flock.promise.make=function(){return new a},flock.bufferDesc=function(a,b,c){var d=flock.platform.isWebAudio&&a instanceof AudioBuffer?flock.bufferDesc.fromAudioBuffer:flock.isIterable(a)?flock.bufferDesc.fromChannelArray:flock.bufferDesc.expand;return d(a,b,c)},flock.bufferDesc.inferFormat=function(a,b,c){var d=a.format,e=a.data;return d.sampleRate=b||d.sampleRate||44100,d.numChannels=c||d.numChannels||a.data.channels.length,d.numSampleFrames=d.numSampleFrames||e.channels.length>0?e.channels[0].length:0,d.duration=d.numSampleFrames/d.sampleRate,a},flock.bufferDesc.fromChannelArray=function(a,b,c){a instanceof Float32Array&&(a=[a]);var d={container:{},format:{numChannels:c,sampleRate:b,numSampleFrames:a[0].length},data:{channels:a}};return flock.bufferDesc.inferFormat(d,b,c)},flock.bufferDesc.expand=function(a,b,c){if(a=a||{data:{channels:[]}},a.container=a.container||{},a.format=a.format||{},a.format.numChannels=c||a.format.numChannels||a.data.channels.length,a.data&&a.data.channels&&(1===a.format.numChannels&&1!==a.data.channels.length&&(a.data.channels=[a.data.channels]),a.format.numChannels!==a.data.channels.length))throw new Error("The specified number of channels does not match the actual channel data. numChannels was: "+a.format.numChannels+" but the sample data contains "+a.data.channels.length+" channels.");return flock.bufferDesc.inferFormat(a,b,c)},flock.bufferDesc.fromAudioBuffer=function(a){var b,c={container:{},format:{sampleRate:a.sampleRate,numChannels:a.numberOfChannels,numSampleFrames:a.length,duration:a.duration},data:{channels:[]}};for(b=0;b<a.numberOfChannels;b++)c.data.channels.push(a.getChannelData(b));return c},flock.bufferDesc.toAudioBuffer=function(a,b){for(var c=a.createBuffer(b.format.numChannels,b.format.numSampleFrames,b.format.sampleRate),d=0;d<b.format.numChannels;d++)c.copyToChannel(b.data.channels[d],d);return c},fluid.defaults("flock.bufferSource",{gradeNames:["fluid.modelComponent"],sampleRate:"{flock.enviro}.audioSystem.model.sampleRate",model:{state:"start",src:null},components:{bufferPromise:{createOnEvent:"onRefreshPromise",type:"flock.promise",options:{listeners:{onCreate:{"this":"{that}.promise",method:"then",args:["{bufferSource}.events.afterFetch.fire","{bufferSource}.events.onError.fire"]}}}}},invokers:{get:{funcName:"flock.bufferSource.get",args:["{that}","{arguments}.0"]},set:{funcName:"flock.bufferSource.set",args:["{that}","{arguments}.0"]},error:{funcName:"flock.bufferSource.error",args:["{that}","{arguments}.0"]}},listeners:{onCreate:{funcName:"{that}.events.onRefreshPromise.fire"},onRefreshPromise:{changePath:"state",value:"start"},onFetch:{changePath:"state",value:"in-progress"},afterFetch:[{changePath:"state",value:"fetched"},{funcName:"{that}.events.onBufferUpdated.fire",args:["{arguments}.0"]}],onBufferUpdated:"{enviro}.registerBuffer({arguments}.0)",onError:{changePath:"state",value:"error"}},events:{onRefreshPromise:null,onError:null,onFetch:null,afterFetch:null,onBufferUpdated:null}}),flock.bufferSource.get=function(a,b){return"in-progress"===a.model.state||b.src===a.model.src&&!b.replace?a.bufferPromise.promise:(b.src&&("fetched"!==a.model.state&&"errored"!==a.model.state||a.model.src===b.src&&!b.replace||a.events.onRefreshPromise.fire(),"start"===a.model.state&&(a.model.src=b.src,a.events.onFetch.fire(b),flock.audio.decode({src:b.src,sampleRate:a.options.sampleRate,success:function(c){b.id&&(c.id=b.id),a.set(c)},error:a.error}))),a.bufferPromise.promise)},flock.bufferSource.set=function(a,b){var c=a.model.state;return"start"!==c&&"in-progress"!==c||a.bufferPromise.promise.resolve(b),a.bufferPromise.promise},flock.bufferSource.error=function(a,b){return a.bufferPromise.promise.reject(b),a.bufferPromise.promise},fluid.defaults("flock.bufferLoader",{gradeNames:["fluid.component"],bufferDefs:[],members:{buffers:[],bufferDefs:"@expand:flock.bufferLoader.expandBufferDefs({that}.options.bufferDefs)"},components:{enviro:"{flock.enviro}"},events:{afterBuffersLoaded:null,onError:null},listeners:{"onCreate.loadBuffers":{funcName:"flock.bufferLoader.loadBuffers",args:["{that}"]},"onError.logError":{funcName:"flock.log.fail"}}}),flock.bufferLoader.idFromURL=function(a){var b=a.lastIndexOf("/"),c=b>-1?b+1:0,d=a.lastIndexOf("."),e=d>-1?d:a.length;return a.substring(c,e)},flock.bufferLoader.idsFromURLs=function(a){return fluid.transform(a,flock.bufferLoader.idFromURL)},flock.bufferLoader.expandFileSequence=function(a){a=a||[];var b,c,d,e=[];for(b=0;b<a.length;b++)c=a[b],d=flock.bufferLoader.idFromURL(c),e.push({id:d,url:c});return e},flock.bufferLoader.expandBufferDef=function(a){return"string"==typeof a&&(a={url:a}),void 0===a.id&&void 0!==a.url&&(a.id=flock.bufferLoader.idFromURL(a.url)),a},flock.bufferLoader.expandBufferDefs=function(a){return a?(a=fluid.makeArray(a),fluid.transform(a,flock.bufferLoader.expandBufferDef)):[]},flock.bufferLoader.loadBuffer=function(a,b,c){try{flock.parse.bufferForDef(a,b,c.enviro)}catch(d){c.events.onError.fire(d.message)}},flock.bufferLoader.loadBuffers=function(a){var b=1,c={setBuffer:function(d){if(a.buffers.push(d),a.buffers.length===a.options.bufferDefs.length)a.events.afterBuffersLoaded.fire(a.buffers);else if(b<a.bufferDefs.length){var e=a.bufferDefs[b];flock.bufferLoader.loadBuffer(e,c,a),b++}}};flock.bufferLoader.loadBuffer(a.bufferDefs[0],c,a)}}();var fluid=fluid||require("infusion"),flock=fluid.registerNamespace("flock");!function(){"use strict";var a=fluid.registerNamespace("jQuery");fluid.registerNamespace("flock.parse"),flock.parse.synthDef=function(a,b,c){return a||(a=[]),flock.parse.synthDef.hasOutUGen(a)||(a=flock.parse.synthDef.makeOutUGenDef(a,c)),flock.parse.ugenForDef(a,b,c)},flock.parse.synthDef.hasOutUGen=function(a){return!flock.isIterable(a)&&(a.id===flock.OUT_UGEN_ID||"flock.ugen.out"===a.ugen||"flock.ugen.valueOut"===a.ugen)},flock.parse.synthDef.makeOutUGenDef=function(a,b){return a={id:flock.OUT_UGEN_ID,ugen:"flock.ugen.valueOut",inputs:{sources:a}},b.rate===flock.rates.AUDIO&&(a.ugen="flock.ugen.out",a.inputs.bus=0,a.inputs.expand=b.audioSettings.chans),a},flock.parse.makeUGen=function(b,c,d,e){var f=e.audioSettings.rates,g=e.audioSettings.blockSize;if(b.rate||(b.rate=flock.rates.AUDIO),!flock.hasValue(flock.rates,b.rate)&&(flock.fail("An invalid rate was specified for a unit generator. ugenDef was: "+fluid.prettyPrintJSON(b)),!flock.debug.failHard)){var h=b.rate;b.rate=flock.rates.AUDIO,flock.log.warn("Overriding invalid unit generator rate. Rate is now '"+b.rate+"'; was: "+fluid.prettyPrintJSON(h))}var i;i=b.options&&void 0!==b.options.sampleRate?b.options.sampleRate:f[b.rate],b.options=a.extend(!0,{},b.options,{sampleRate:i,rate:b.rate,audioSettings:{rates:f,blockSize:g}});var j,k=b.rate===flock.rates.AUDIO?g:1;if(flock.hasTag(b.options,"flock.ugen.multiChannelOutput")){var l=b.options.numOutputs||1;j=[];for(var m=0;l>m;m++)j.push(new Float32Array(k))}else j=new Float32Array(k);var n=fluid.copy(b.options);return n.buffers=e.buffers,n.buses=e.buses,n.enviro=d,flock.invoke(void 0,b.ugen,[c,j,n])},flock.parse.reservedWords=["id","ugen","rate","inputs","options"],flock.parse.specialInputs=["value","buffer","list","table","envelope","durations","values"],flock.parse.expandInputs=function(a){if(a.inputs)return a;var b,c={};for(b in a)-1===flock.parse.reservedWords.indexOf(b)&&(c[b]=a[b],delete a[b]);return a.inputs=c,a},flock.parse.ugenDefForConstantValue=function(a){return{ugen:"flock.ugen.value",rate:flock.rates.CONSTANT,inputs:{value:a}}},flock.parse.expandValueDef=function(a){var b=typeof a;if("number"===b)return flock.parse.ugenDefForConstantValue(a);if("object"===b)return a;throw new Error("Invalid value type found in ugen definition. UGenDef was: "+fluid.prettyPrintJSON(a))},flock.parse.rateMap={ar:flock.rates.AUDIO,kr:flock.rates.CONTROL,sr:flock.rates.SCHEDULED,dr:flock.rates.DEMAND,cr:flock.rates.CONSTANT},flock.parse.expandRate=function(a,b){return a.rate=flock.parse.rateMap[a.rate]||a.rate,b.overrideRate&&a.rate!==flock.rates.CONSTANT&&(a.rate=b.rate),a},flock.parse.ugenDef=function(a,b,c){var d=flock.isIterable(a)?flock.parse.ugensForDefs:flock.parse.ugenForDef,e=d(a,b,c);return e},flock.parse.ugenDef.mergeOptions=function(b){var c=flock.ugenDefaults(b.ugen)||{};return c=fluid.copy(c),c.options=c.ugenOptions,delete c.ugenOptions,a.extend(!0,{},c,b)},flock.parse.ugensForDefs=function(a,b,c){var d,e=[];for(d=0;d<a.length;d++)e[d]=flock.parse.ugenForDef(a[d],b,c);return e},flock.parse.ugenForDef=function(b,c,d){c=c||flock.environment,d=a.extend(!0,{audioSettings:c.audioSystem.model,buses:c.busManager.buses,buffers:c.buffers},d);var e=d,f=e.visitors,g=e.audioSettings.rates;if(b=flock.parse.expandValueDef(b),flock.isIterable(b))return flock.parse.ugensForDefs(b,c,d);b=flock.parse.expandInputs(b),flock.parse.expandRate(b,d),b=flock.parse.ugenDef.mergeOptions(b,d);var h,i=b.inputs,j={};for(h in i){var k=i[h];null!==k&&(j[h]=flock.input.shouldExpand(h,b)?flock.parse.ugenForDef(k,c,d):k)}if(!b.ugen)throw new Error("Unit generator definition lacks a 'ugen' property; can't initialize the synth graph. Value: "+fluid.prettyPrintJSON(b));var l=flock.parse.makeUGen(b,j,c,d);if(b.id&&(l.id=b.id),l.options.ugenDef=b,f)for(var m=0;m<f.length;m++)f[m](l,b,g);return l},flock.parse.expandBufferDef=function(a){return"string"==typeof a?{id:a}:flock.isIterable(a)||a.data||a.format?flock.bufferDesc(a):a},flock.parse.bufferForDef=function(a,b,c){a=flock.parse.expandBufferDef(a),a.data&&a.data.channels?(a=flock.bufferDesc(a),flock.parse.bufferForDef.resolveBuffer(a,b,c)):flock.parse.bufferForDef.resolveDef(a,b,c)},flock.parse.bufferForDef.createBufferSource=function(a){return flock.bufferSource({sampleRate:a.audioSystem.model.sampleRate})},flock.parse.bufferForDef.findSource=function(a,b){var c;return b&&a.id?(c=b.bufferSources[a.id],c||(c=flock.parse.bufferForDef.createBufferSource(b),b.bufferSources[a.id]=c)):c=flock.parse.bufferForDef.createBufferSource(b),c},flock.parse.bufferForDef.bindToPromise=function(a,b,c){var d=function(a){b.events.onBufferUpdated.addListener(d),c&&c.setBuffer(a)},e=function(a){throw!a&&b.model.src&&b.model.src.indexOf(".aif")&&(a="if this is an AIFF file, you might need to include flocking-audiofile-compatibility.js in some browsers."),new Error("Error while resolving buffer "+b.model.src+": "+a)};a.then(d,e)},flock.parse.bufferForDef.resolveDef=function(a,b,c){var d,e=flock.parse.bufferForDef.findSource(a,c);a.src=a.url||a.src,a.selector&&"undefined"!=typeof document&&(a.src=document.querySelector(a.selector).files[0]),d=e.get(a),flock.parse.bufferForDef.bindToPromise(d,e,b)},flock.parse.bufferForDef.resolveBuffer=function(a,b,c){var d=flock.parse.bufferForDef.findSource(a,c),e=d.set(a);flock.parse.bufferForDef.bindToPromise(e,d,b)}}();var fluid=fluid||require("infusion"),flock=fluid.registerNamespace("flock");!function(){"use strict";flock.applyDeferred=function(a,b,c){a&&(c="undefined"==typeof c?0:c,setTimeout(function(){a.apply(null,b)},c))},fluid.registerNamespace("flock.net"),flock.net.readBufferFromUrl=function(a){var b=a.src,c=new XMLHttpRequest;c.onreadystatechange=function(){if(4===c.readyState)if(flock.net.isXHRSuccessful(c))a.success(c.response,flock.file.parseFileExtension(b));else{if(!a.error)throw new Error(c.statusText);a.error(c.statusText)}},c.open(a.method||"GET",b,!0),c.responseType=a.responseType||"arraybuffer",c.send(a.data)},flock.net.isXHRSuccessful=function(a){return 200===a.status||0===a.responseURL.indexOf("file://")&&0===a.status&&a.response},fluid.registerNamespace("flock.file"),flock.file.mimeTypes={"audio/wav":"wav","audio/x-wav":"wav","audio/wave":"wav","audio/x-aiff":"aiff","audio/aiff":"aiff","sound/aiff":"aiff"},flock.file.typeAliases={aif:"aiff",wave:"wav"},flock.file.parseFileExtension=function(a){var b,c,d=a.lastIndexOf(".");if(!(0>d))return b=a.substring(d+1),b=b.toLowerCase(),c=flock.file.typeAliases[b],c||b},flock.file.parseMIMEType=function(a){return flock.file.mimeTypes[a]},flock.file.stringToBuffer=function(a){var b,c=a.length,d=new ArrayBuffer(c),e=new Uint8Array(d);for(b=0;c>b;b++)e[b]=a.charCodeAt(b);return e.buffer},flock.file.readBufferFromDataUrl=function(a){var b=a.src,c=b.indexOf(","),d=b.substring(0,c),e=b.substring(c+1),f=d.indexOf(";base64"),g=f>-1,h=b.indexOf("data:")+5,i=g?f:c,j=b.substring(h,i);g&&(e=atob(e)),flock.applyDeferred(function(){var b=flock.file.stringToBuffer(e);a.success(b,flock.file.parseMIMEType(j))})},flock.file.readBufferFromFile=function(a){var b=new FileReader;return b.onload=function(b){a.success(b.target.result,flock.file.parseFileExtension(a.src.name))},b.readAsArrayBuffer(a.src),b},fluid.registerNamespace("flock.audio"),flock.audio.loadBuffer=function(a){var b=a.src||a.url;if(b){b instanceof ArrayBuffer&&flock.applyDeferred(a.success,[b,a.type]);var c=flock.audio.loadBuffer.readerForSource(b);c(a)}},flock.audio.loadBuffer.readerForSource=function(a){return"undefined"!=typeof File&&a instanceof File?flock.file.readBufferFromFile:0===a.indexOf("data:")?flock.file.readBufferFromDataUrl:flock.net.readBufferFromUrl},flock.audio.decode=function(a){var b=a.success,c=function(c,d){var e=flock.audio.decoderStrategies,f=e[d]||e["default"];a.decoder&&(f="string"==typeof a.decoder?fluid.getGlobalValue(a.decoder):a.decoder),f({rawData:c,type:d,success:b,error:a.error,sampleRate:a.sampleRate})};a.success=c,flock.audio.loadBuffer(a)},flock.audio.decode.webAudio=function(a){var b=flock.webAudio.audioSystem.audioContextSingleton,c=function(b){var c=flock.bufferDesc.fromAudioBuffer(b);a.success(c)};b.decodeAudioData(a.rawData,c,a.error)},flock.audio.decoderStrategies={"default":flock.audio.decode.webAudio},flock.audio.registerDecoderStrategy=function(a,b){if(a)if("object"!=typeof a)"string"==typeof b&&(b=fluid.getGlobalValue(b)),flock.audio.decoderStrategies[a]=b;else for(var c in a)flock.audio.decoderStrategies[c]=a[c]}}();var fluid=fluid||require("infusion"),flock=fluid.registerNamespace("flock");!function(){"use strict";fluid.registerNamespace("flock.audio.encode"),flock.audio.interleave=function(a){var b,c,d=a.format.numSampleFrames,e=a.data.channels,f=a.format.numChannels,g=d*f,h=new Float32Array(g),i=0;for(b=0;d>b;b++)for(c=0;f>c;c++)h[i]=e[c][b],i++;return h},flock.audio.encode=function(a,b,c){return b=b||"wav","wav"!==b.toLowerCase()&&flock.fail("Flocking currently only supports encoding WAVE files."),flock.audio.encode.wav(a,c)},flock.audio.encode.writeFloat32Array=function(a,b,c){for(var d=0;d<c.length;d++)b.setFloat32(a,c[d],!0),a+=4;return b},flock.audio.encode.setString=function(a,b,c){for(var d=0;d<c.length;d++)a.setUint8(b+d,c.charCodeAt(d))},flock.audio.encode.setBytes=function(a,b,c){for(var d=0;d<c.length;d++)a.setUint8(b+d,c[d])},flock.audio.encode.writeAsPCM=function(a,b,c,d){if("setFloat32"===a.setter&&d instanceof Float32Array)return flock.audio.encode.writeFloat32Array(b,c,d);for(var e=0;e<d.length;e++){var f=Math.min(1,d[e]);f=Math.max(-1,f),f=0>f?f*a.scaleNeg:f*a.scalePos,c[a.setter](b,f,!0),b+=a.width}return c},flock.audio.pcm={int16:{scalePos:32767,scaleNeg:32768,setter:"setInt16",width:2},int32:{scalePos:2147483647,scaleNeg:2147483648,setter:"setInt32",width:4},float32:{scalePos:1,scaleNeg:1,setter:"setFloat32",width:4}},flock.audio.encode.wav=function(a,b){b=b||flock.audio.pcm.int16;var c="string"==typeof b?flock.audio.pcm[b]:b;c||flock.fail("Flocking does not support encoding "+b+" format PCM wave files.");var d=flock.audio.interleave(a),e=a.format.numChannels,f=a.format.sampleRate,g="setFloat32"!==c.setter,h=8,i=12,j=16,k=1,l=8,m=d.length*c.width,n=l+m,o=8*c.width;if(e>2||!g){var p=8,q=4,r=p+q;j+=r,e>2?(j+=24,k=65534):(j+=2,k=3)}var s=i+j,t=s+n,u=h+t,v=new ArrayBuffer(u),w=new DataView(v);flock.audio.encode.setString(w,0,"RIFF"),w.setUint32(4,t,!0),flock.audio.encode.setString(w,8,"WAVE"),flock.audio.encode.setString(w,12,"fmt "),w.setUint32(16,j,!0),w.setUint16(20,k,!0),w.setUint16(22,e,!0),w.setUint32(24,f,!0),w.setUint32(28,4*f,!0),w.setUint16(32,e*c.width,!0),w.setUint16(34,o,!0);var x=36;return 3===k?(w.setUint16(x,0,!0),x+=2,x=flock.audio.encode.wav.writeFactChunk(w,x,a.format.numSampleFrames)):65534===k&&(w.setUint16(x,22,!0),x+=2,x=flock.audio.encode.wav.additionalFormat(x,w,o,g),x=flock.audio.encode.wav.writeFactChunk(w,x,a.format.numSampleFrames)),flock.audio.encode.wav.writeDataChunk(c,x,w,d,m),w.buffer},flock.audio.encode.wav.subformats={pcm:new Uint8Array([1,0,0,0,0,0,16,0,128,0,0,170,0,56,155,113]),"float":new Uint8Array([3,0,0,0,0,0,16,0,128,0,0,170,0,56,155,113])},flock.audio.encode.wav.additionalFormat=function(a,b,c,d){b.setUint16(a,c,!0),a+=2,b.setUint32(a,2147483648,!0),a+=4;var e=flock.audio.encode.wav.subformats[d?"pcm":"float"];return flock.audio.encode.setBytes(b,a,e),a+=16},flock.audio.encode.wav.writeFactChunk=function(a,b,c){return flock.audio.encode.setString(a,b,"fact"),b+=4,a.setUint32(b,4,!0),b+=4,a.setUint32(b,c,!0),b+=4},flock.audio.encode.wav.writeDataChunk=function(a,b,c,d,e){flock.audio.encode.setString(c,b,"data"),b+=4,c.setUint32(b,e,!0),b+=4,flock.audio.encode.writeAsPCM(a,b,c,d)}}();var fluid=fluid||require("infusion"),flock=fluid.registerNamespace("flock");!function(){"use strict";flock.shim={URL:"undefined"!=typeof window?window.URL||window.webkitURL||window.msURL:void 0},flock.worker=function(a){var b,c,d=typeof a;if("function"===d)a="("+a.toString()+")();";else if("string"!==d)throw new Error("A flock.worker must be initialized with a String or a Function.");return window.Blob?(c=new Blob([a],{type:"text/javascript"}),b=flock.shim.URL.createObjectURL(c)):b="data:text/javascript;base64,"+window.btoa(a),new Worker(b)},fluid.registerNamespace("flock.scheduler"),fluid.defaults("flock.scheduler.clock",{gradeNames:["fluid.component"],events:{tick:null}}),fluid.defaults("flock.scheduler.intervalClock",{gradeNames:["flock.scheduler.clock"],members:{scheduled:{}},invokers:{schedule:{funcName:"flock.scheduler.intervalClock.schedule",args:["{arguments}.0","{that}.scheduled","{that}.events.tick.fire","{that}.events.onClear.fire"]},clear:{funcName:"flock.scheduler.intervalClock.clear",args:["{arguments}.0","{that}.scheduled","{that}.events.onClear.fire"]},clearAll:{funcName:"flock.scheduler.intervalClock.clearAll",args:["{that}.scheduled","{that}.events.onClear.fire"]},end:"{that}.clearAll"}}),flock.scheduler.intervalClock.schedule=function(a,b,c){var d=setInterval(function(){c(a)},a);b[a]=d},flock.scheduler.intervalClock.clear=function(a,b){var c=b[a];clearInterval(c),delete b[a]},flock.scheduler.intervalClock.clearAll=function(a,b){for(var c in a)flock.scheduler.intervalClock.clear(c,a,b)},fluid.defaults("flock.scheduler.scheduleClock",{gradeNames:["flock.scheduler.clock"],members:{scheduled:[]},invokers:{schedule:{funcName:"flock.scheduler.scheduleClock.schedule",args:["{arguments}.0","{that}.scheduled","{that}.events"]},clear:{funcName:"flock.scheduler.scheduleClock.clear",args:["{arguments}.0","{arguments}.1","{that}.scheduled","{that}.events.onClear.fire"]},clearAll:{funcName:"flock.scheduler.scheduleClock.clearAll",args:["{that}.scheduled","{that}.events.onClear.fire"]},end:"{that}.clearAll"}}),flock.scheduler.scheduleClock.schedule=function(a,b,c){var d;d=setTimeout(function(){clearTimeout(d),c.tick.fire(a)},a),b.push(d)},flock.scheduler.scheduleClock.clear=function(a,b,c){b=void 0===b?c.indexOf(a):b,b>-1&&(c.splice(b,1),clearTimeout(a))},flock.scheduler.scheduleClock.clearAll=function(a){for(var b=0;b<a.length;b++){var c=a[b];clearTimeout(c)}a.length=0},fluid.defaults("flock.scheduler.webWorkerClock",{gradeNames:["fluid.component"],members:{worker:{expander:{funcName:"flock.worker",args:"@expand:fluid.getGlobalValue(flock.scheduler.webWorkerClock.workerImpl)"}}},invokers:{postToWorker:{funcName:"flock.scheduler.webWorkerClock.postToWorker",args:["{arguments}.0","{arguments}.1","{that}.options.messages","{that}.worker"]},schedule:"{that}.postToWorker(schedule, {arguments}.0)",clear:"{that}.postToWorker(clear, {arguments}.0)",clearAll:"{that}.postToWorker(clearAll)",end:"{that}.postToWorker(end)"},events:{tick:null},listeners:{onCreate:{funcName:"flock.scheduler.webWorkerClock.init",args:["{that}"]}},startMsg:{msg:"start",value:"{that}.options.clockType"},messages:{schedule:{msg:"schedule"},clear:{msg:"clear"},clearAll:{msg:"clearAll"},end:{msg:"end"}}}),flock.scheduler.webWorkerClock.init=function(a){a.worker.addEventListener("message",function(b){a.events.tick.fire(b.data.value)},!1),a.worker.postMessage(a.options.startMsg)},flock.scheduler.webWorkerClock.postToWorker=function(a,b,c,d){var e=c[a];void 0!==b&&(e.value=b),d.postMessage(e)},flock.scheduler.webWorkerClock.workerImpl=function(){var a=a||{};a.worker=a.worker||{},a.worker.clock=function(){var a={};return a.tick=function(a){self.postMessage({msg:"tick",value:a})},a},a.worker.intervalClock=function(){var b=a.worker.clock();return b.scheduled={},b.schedule=function(a){var c=setInterval(function(){b.tick(a)},a);b.scheduled[a]=c},b.clear=function(a){var c=b.scheduled[a];clearInterval(c),delete b.scheduled[a]},b.clearAll=function(){for(var a in b.scheduled)b.clear(a)},b},a.worker.scheduleClock=function(){var b=a.worker.clock();return b.scheduled=[],
b.schedule=function(a){var c;c=setTimeout(function(){b.clear(c),b.tick(a)},a),b.scheduled.push(c)},b.clear=function(a,c){c=void 0===c?b.scheduled.indexOf(a):c,c>-1&&b.scheduled.splice(c,1),clearTimeout(a)},b.clearAll=function(){for(var a=0;a<b.scheduled.length;a++){var c=b.scheduled[a];clearTimeout(c)}b.scheduled.length=0},b},self.addEventListener("message",function(b){"start"===b.data.msg?a.clock=a.worker[b.data.value]():"end"===b.data.msg?a.clock&&(a.clock.clearAll(),self.close()):a.clock&&a.clock[b.data.msg](b.data.value)},!1)},fluid.defaults("flock.scheduler.webWorkerIntervalClock",{gradeNames:["flock.scheduler.webWorkerClock"],clockType:"intervalClock"}),fluid.defaults("flock.scheduler.webWorkerScheduleClock",{gradeNames:["flock.scheduler.webWorkerClock"],clockType:"scheduleClock"}),fluid.defaults("flock.scheduler",{gradeNames:["fluid.component"],events:{onScheduled:null,onFinished:null,onClearAll:null},listeners:{onClearAll:["{that}.clock.clearAll()"]}}),flock.scheduler.addListener=function(a,b,c){return b.push(a),c(a),a},flock.scheduler.removeListener=function(a,b,c){if(a){var d=b.indexOf(a);d>-1?(b.splice(d,1),c(a)):a.wrappedListener&&flock.scheduler.removeListener(a.wrappedListener,b,c)}},fluid.defaults("flock.scheduler.repeat",{gradeNames:["flock.scheduler"],members:{listeners:{}},components:{clock:{type:"flock.scheduler.webWorkerIntervalClock"}},invokers:{schedule:{funcName:"flock.scheduler.repeat.schedule",args:["{arguments}.0","{arguments}.1","{timeConverter}","{synthContext}","{that}.listeners","{that}.events.onScheduled.fire"]},clear:"{that}.events.onFinished.fire",clearAll:{funcName:"flock.scheduler.repeat.clearAll",args:["{that}.listeners","{that}.events.onFinished.fire","{that}.events.onClearAll.fire"]},clearInterval:{funcName:"flock.scheduler.repeat.clearInterval",args:["{arguments}.0","{that}.listeners","{that}.events.onFinished.fire"]},addIntervalListener:{funcName:"flock.scheduler.repeat.addIntervalListener",args:["{arguments}.0","{arguments}.1","{that}.listeners","{that}.clock.events.tick.addListener"]},removeIntervalListener:{funcName:"flock.scheduler.repeat.removeIntervalListener",args:["{arguments}.0","{arguments}.1","{that}.listeners","{that}.clock.events.tick.removeListener"]}},listeners:{onScheduled:["{that}.addIntervalListener({arguments}.0, {arguments}.1)","{that}.clock.schedule({arguments}.0)"],onFinished:["{that}.removeIntervalListener({arguments}.0, {arguments}.1)"]}}),flock.scheduler.repeat.intervalListeners=function(a,b){return b[a]},flock.scheduler.repeat.addIntervalListener=function(a,b,c,d){var e=flock.scheduler.repeat.intervalListeners(a,c);flock.scheduler.addListener(b,e,d)},flock.scheduler.repeat.removeIntervalListener=function(a,b,c,d){var e=flock.scheduler.repeat.intervalListeners(a,c);flock.scheduler.removeListener(b,e,d)},flock.scheduler.repeat.schedule=function(a,b,c,d,e,f){a=c.value(a),b=flock.scheduler.async.prepareListener(b,d);var g=flock.scheduler.repeat.wrapValueListener(a,b);return flock.scheduler.repeat.addInterval(a,e),f(a,g),g},flock.scheduler.repeat.wrapValueListener=function(a,b){var c=function(c){c===a&&b(c)};return c.wrappedListener=b,c},flock.scheduler.repeat.addInterval=function(a,b){var c=b[a];c||(c=b[a]=[])},flock.scheduler.repeat.clearAll=function(a,b,c){for(var d in a)flock.scheduler.repeat.clearInterval(d,a,b);c()},flock.scheduler.repeat.clearInterval=function(a,b,c){var d=b[a];if(d)for(var e=0;e<d.length;e++){var f=d[e];c(a,f)}},fluid.defaults("flock.scheduler.once",{gradeNames:["flock.scheduler"],members:{listeners:[]},components:{clock:{type:"flock.scheduler.webWorkerScheduleClock"}},invokers:{schedule:{funcName:"flock.scheduler.once.schedule",args:["{arguments}.0","{arguments}.1","{timeConverter}","{synthContext}","{that}.clear","{that}.events.onScheduled.fire"]},clear:"{that}.events.onFinished.fire",clearAll:{funcName:"flock.scheduler.once.clearAll",args:["{that}.listeners","{that}.events.onFinished.fire","{that}.events.onClearAll.fire"]}},listeners:{onScheduled:[{funcName:"flock.scheduler.addListener",args:["{arguments}.1","{that}.listeners","{that}.clock.events.tick.addListener"]},{func:"{that}.clock.schedule",args:["{arguments}.0"]}],onFinished:{funcName:"flock.scheduler.removeListener",args:["{arguments}.0","{that}.listeners","{that}.clock.events.tick.removeListener"]}}}),flock.scheduler.once.wrapValueListener=function(a,b,c){var d=function(e){e===a&&(b(e),c(d))};return d.wrappedListener=b,d},flock.scheduler.once.schedule=function(a,b,c,d,e,f){a=c.value(a),b=flock.scheduler.async.prepareListener(b,d);var g=flock.scheduler.once.wrapValueListener(a,b,e);return f(a,g),g},flock.scheduler.once.clearAll=function(a,b,c){for(var d=0;d<a.length;d++)b(a[d]);c()},fluid.defaults("flock.scheduler.async",{gradeNames:["fluid.component"],subSchedulerOptions:{components:{timeConverter:"{async}.timeConverter"},listeners:{"{async}.events.onClear":"{that}.clear()","{async}.events.onClearAll":"{that}.clearAll()","{async}.events.onEnd":"{that}.clock.end()"}},distributeOptions:{source:"{that}.options.subSchedulerOptions",removeSource:!0,target:"{that flock.scheduler}.options"},components:{timeConverter:{type:"flock.convert.seconds"},onceScheduler:{type:"flock.scheduler.once"},repeatScheduler:{type:"flock.scheduler.repeat"},synthContext:void 0},invokers:{repeat:{func:"{repeatScheduler}.schedule",args:["{arguments}.0","{arguments}.1"]},once:{func:"{onceScheduler}.schedule",args:["{arguments}.0","{arguments}.1"]},sequence:{funcName:"flock.scheduler.async.sequence",args:["{arguments}.0","{arguments}.1","{that}.once"]},schedule:{funcName:"flock.scheduler.async.schedule",args:["{arguments}.0","{that}"]},clear:"{that}.events.onClear.fire",clearAll:"{that}.events.onClearAll.fire",end:"{that}.events.onEnd.fire"},events:{onClear:null,onClearAll:null,onEnd:null},listeners:{onCreate:"{that}.schedule({that}.options.score)",onEnd:"{that}.clearAll",onDestroy:"{that}.end()"}}),flock.scheduler.async.sequence=function(a,b,c){for(var d=[],e=0;e<a.length;e++){var f=c(a[e],b);d.push(f)}return d},flock.scheduler.async.schedule=function(a,b){if(a){a=flock.isIterable(a)?a:[a];for(var c=0;c<a.length;c++){var d=a[c];flock.invoke(b,d.interval,[d.time,d.change])}}},flock.scheduler.async.prepareListener=function(a,b){return"function"==typeof a?a:flock.scheduler.async.evaluateChangeSpec(a,b)},flock.scheduler.async.getTargetSynth=function(a,b){var c=a.synth;return c?"string"!=typeof c?c:fluid.get(b,c):b},flock.scheduler.async.makeSynthUpdater=function(a,b,c,d){return function(){for(var e in a){var f=a[e];c[e]=flock.evaluate.synthValue(f)}var g=flock.scheduler.async.getTargetSynth(b,d);g?g.set(c):flock.fail("A target synth named "+b.synth+" could not be found in the specified synthContext. Synth context was: "+d)}},flock.scheduler.async.evaluateChangeSpec=function(a,b){var c={},d={};for(var e in a.values){var f=a.values[e];f.synthDef?c[e]=flock.synth.value(f):d[e]=f}return flock.scheduler.async.makeSynthUpdater(c,a,d,b)},fluid.defaults("flock.scheduler.async.tempo",{gradeNames:["flock.scheduler.async"],bpm:60,components:{timeConverter:{type:"flock.convert.beats",options:{bpm:"{tempo}.options.bpm"}}}}),fluid.registerNamespace("flock.convert"),fluid.defaults("flock.convert.ms",{gradeNames:["fluid.component"],invokers:{value:"fluid.identity({arguments}.0)"}}),fluid.defaults("flock.convert.seconds",{gradeNames:["fluid.component"],invokers:{value:"flock.convert.seconds.toMillis({arguments}.0)"}}),flock.convert.seconds.toMillis=function(a){return 1e3*a},fluid.defaults("flock.convert.beats",{gradeNames:["fluid.component"],bpm:60,invokers:{value:"flock.convert.beats.toMillis({arguments}.0, {that}.options.bpm)"}}),flock.convert.beats.toMillis=function(a,b){return 0>=b?0:a/b*6e4}}();var fluid=fluid||require("infusion"),flock=fluid.registerNamespace("flock");!function(){"use strict";fluid.registerNamespace("flock.webAudio"),flock.webAudio.createNode=function(a,b){var c=b.args?fluid.makeArray(b.args):void 0,d="create"+b.node,e=d.indexOf("Node");e>-1&&(d=d.substring(0,e));var f=a[d].apply(a,c);return flock.webAudio.initNodeParams(a,f,b),flock.webAudio.initNodeProperties(f,b),flock.webAudio.initNodeInputs(f,b),f},flock.webAudio.setAudioParamValue=function(a,b,c,d){d=d||0;var e=a.currentTime+d;b.setValueAtTime(c,e)},flock.webAudio.initNodeParams=function(a,b,c){var d=c.params;if(b&&d){for(var e in d){var f=b[e],g=d[e];flock.webAudio.setAudioParamValue(a,f,g)}return b}},flock.webAudio.safariPropertyProhibitions=["channelCount","channelCountMode"],flock.webAudio.shouldSetProperty=function(a){return flock.platform.browser.safari?flock.webAudio.safariPropertyProhibitions.indexOf(a)<0:!0},flock.webAudio.initNodeProperties=function(a,b){var c=b.props;if(c){for(var d in c){var e=c[d];flock.webAudio.shouldSetProperty(d)&&(a[d]=e)}return a}},flock.webAudio.connectInput=function(a,b,c,d){c.connect(a,d,b)},flock.webAudio.initNodeInputs=function(a,b){var c=b.inputs;for(var d in c){var e=c[d],f=parseInt(d,10);e=fluid.makeArray(e);for(var g=0;g<e.length;g++){var h=e[g];flock.webAudio.connectInput(a,f,h)}}},fluid.defaults("flock.webAudio.node",{gradeNames:["fluid.modelComponent"],members:{node:"@expand:flock.webAudio.createNode({audioSystem}.context, {that}.options.nodeSpec)"},nodeSpec:{args:[],params:{},properties:{}}}),fluid.defaults("flock.webAudio.gain",{gradeNames:["flock.webAudio.node"],members:{node:"@expand:flock.webAudio.createNode({audioSystem}.context, {that}.options.nodeSpec)"},nodeSpec:{node:"Gain"}}),fluid.defaults("flock.webAudio.scriptProcessor",{gradeNames:["flock.webAudio.node"],nodeSpec:{node:"ScriptProcessor",args:["{audioSystem}.model.bufferSize","{audioSystem}.model.numInputBuses","{audioSystem}.model.chans"],params:{},properties:{channelCountMode:"explicit"}}}),fluid.defaults("flock.webAudio.channelMerger",{gradeNames:["flock.webAudio.node"],nodeSpec:{node:"ChannelMerger",args:["{audioSystem}.model.numInputBuses"],properties:{channelCountMode:"discrete"}}}),fluid.defaults("flock.webAudio.outputFader",{gradeNames:["fluid.component"],fadeDuration:.5,gainSpec:{node:"Gain",params:{gain:0},properties:{channelCount:"{flock.enviro}.audioSystem.model.chans",channelCountMode:"explicit"}},members:{gainNode:"@expand:flock.webAudio.outputFader.createGainNode({flock.enviro}.audioSystem.nativeNodeManager, {that}.options.gainSpec)",context:"{flock.enviro}.audioSystem.context"},invokers:{fadeIn:{funcName:"flock.webAudio.outputFader.fadeIn",args:["{that}.context","{that}.gainNode","{arguments}.0","{that}.options.fadeDuration"]},fadeTo:{funcName:"flock.webAudio.outputFader.fadeTo",args:["{that}.context","{that}.gainNode","{arguments}.0","{that}.options.fadeDuration"]}}}),flock.webAudio.outputFader.createGainNode=function(a,b){var c=a.createOutputNode(b);return c},flock.webAudio.outputFader.fade=function(a,b,c,d,e){e=e||0;var f=a.currentTime,g=f+e;flock.webAudio.setAudioParamValue(a,b.gain,c),b.gain.linearRampToValueAtTime(d,g)},flock.webAudio.outputFader.fadeTo=function(a,b,c,d){flock.webAudio.outputFader.fade(a,b,b.gain.value,c,d)},flock.webAudio.outputFader.fadeIn=function(a,b,c,d){flock.webAudio.outputFader.fade(a,b,0,c,d)}}();var fluid=fluid||require("infusion"),flock=fluid.registerNamespace("flock");!function(){"use strict";fluid.defaults("flock.webAudio.audioSystem",{gradeNames:["flock.audioSystem"],channelRange:{min:"@expand:flock.webAudio.audioSystem.calcMinChannels()",max:"@expand:flock.webAudio.audioSystem.calcMaxChannels({that}.context.destination)"},members:{context:"@expand:flock.webAudio.audioSystem.createContext()"},model:{rates:{audio:"{that}.context.sampleRate"}},components:{outputManager:{type:"flock.webAudio.outputManager"},nativeNodeManager:{type:"flock.webAudio.nativeNodeManager"},inputDeviceManager:{type:"flock.webAudio.inputDeviceManager"},bufferWriter:{type:"flock.webAudio.bufferWriter"}},listeners:{onCreate:["flock.webAudio.audioSystem.configureDestination({that}.context, {that}.model.chans)"]}}),flock.webAudio.audioSystem.createContext=function(){var a=flock.webAudio.audioSystem;return a.audioContextSingleton||(a.audioContextSingleton=new flock.shim.AudioContext),a.audioContextSingleton},flock.webAudio.audioSystem.calcMaxChannels=function(a){return flock.platform.browser.safari?a.channelCount:a.maxChannelCount},flock.webAudio.audioSystem.calcMinChannels=function(){return flock.platform.browser.safari?2:1},flock.webAudio.audioSystem.configureDestination=function(a,b){flock.platform.browser.safari||(a.destination.channelCount=b,a.destination.channelCountMode="explicit",a.destination.channelInterpretation="discrete")},fluid.defaults("flock.webAudio.enviroContextDistributor",{gradeNames:["fluid.component"],distributeOptions:[{target:"{/ flock.enviro > audioSystem}.options",record:{gradeNames:"flock.webAudio.audioSystem"}}]}),fluid.constructSingle([],{singleRootType:"flock.enviroContextDistributor",type:"flock.webAudio.enviroContextDistributor"})}();var fluid=fluid||require("infusion"),flock=fluid.registerNamespace("flock");!function(){"use strict";fluid.defaults("flock.webAudio.bufferWriter",{gradeNames:"fluid.component",invokers:{save:"flock.webAudio.bufferWriter.saveBuffer({arguments}.0)"}}),flock.webAudio.bufferWriter.saveBuffer=function(a){try{var b=flock.audio.encode.wav(a.buffer,a.format),c=new Blob([b],{type:"audio/wav"});return flock.webAudio.bufferWriter.download(a.path,c),a.success&&a.success(b),b}catch(d){a.error?a.error(d):flock.fail("There was an error while trying to download the buffer named "+a.buffer.id+". Error: "+d)}},flock.webAudio.bufferWriter.download=function(a,b){var c=flock.shim.URL.createObjectURL(b),d=window.document.createElement("a"),e=document.createEvent("Event");d.href=c,d.download=a,e.initEvent("click",!0,!0),d.dispatchEvent(e)}}();var fluid=fluid||require("infusion"),flock=fluid.registerNamespace("flock");!function(){"use strict";fluid.registerNamespace("flock.webAudio.chrome"),flock.webAudio.chrome.getSources=function(a){return MediaStreamTrack.getSources(function(b){var c=fluid.transform(b,function(a){return a.deviceId=a.id,a});a(c)})},flock.webAudio.mediaStreamFailure=function(){flock.fail("Media Capture and Streams are not supported on this browser.")};var a={AudioContext:window.AudioContext||window.webkitAudioContext,getUserMediaImpl:navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||flock.webAudio.mediaStreamFailure,getUserMedia:function(){flock.shim.getUserMediaImpl.apply(navigator,arguments)},getMediaDevicesImpl:navigator.getMediaDevices?navigator.getMediaDevices:"undefined"!=typeof window.MediaStreamTrack?flock.webAudio.chrome.getSources:flock.webAudio.mediaStreamFailure,getMediaDevice:function(){flock.shim.getMediaDevicesImpl.apply(navigator,arguments)}};jQuery.extend(flock.shim,a),fluid.defaults("flock.webAudio.inputDeviceManager",{gradeNames:["fluid.component"],invokers:{openAudioDevice:{funcName:"flock.webAudio.inputDeviceManager.openAudioDevice",args:["{arguments}.0","{that}.openAudioDeviceWithId","{that}.openFirstAudioDeviceWithLabel","{that}.openAudioDeviceWithConstraints"]},openAudioDeviceWithConstraints:{funcName:"flock.webAudio.inputDeviceManager.openAudioDeviceWithConstraints",args:["{audioSystem}.context","{enviro}","{nativeNodeManager}.createMediaStreamInput","{arguments}.0"]},openAudioDeviceWithId:{funcName:"flock.webAudio.inputDeviceManager.openAudioDeviceWithId",args:["{arguments}.0","{that}.openAudioDeviceWithConstraints"]},openFirstAudioDeviceWithLabel:{funcName:"flock.webAudio.inputDeviceManager.openFirstAudioDeviceWithLabel",args:["{arguments}.0","{that}.openAudioDeviceWithId"]}}}),flock.webAudio.inputDeviceManager.openAudioDevice=function(a,b,c,d){if(a){if(a.id)return b(a.id);if(a.label)return c(a.label)}return d()},flock.webAudio.inputDeviceManager.openAudioDeviceWithId=function(a,b){var c={audio:{optional:[{sourceId:a}]}};b(c)},flock.webAudio.inputDeviceManager.openFirstAudioDeviceWithLabel=function(a,b){a&&flock.shim.getMediaDevices(function(c){var d=c.filter(function(b){return b.label.toLowerCase()===a.toLowerCase()?!0:void 0});d.length>0?b(d[0].deviceId):fluid.log(fluid.logLevel.IMPORTANT,"An audio device named '"+a+"' could not be found.")})},flock.webAudio.inputDeviceManager.openAudioDeviceWithConstraints=function(a,b,c,d){function e(a){fluid.log(fluid.logLevel.IMPORTANT,"An error occurred while trying to access the user's microphone. "+a)}function f(a){c(a,g)}d=d||{audio:!0};var g=b.busManager.acquireNextBus("input");return flock.shim.getUserMedia(d,f,e),g}}();var fluid=fluid||require("infusion"),flock=fluid.registerNamespace("flock");!function(){"use strict";fluid.registerNamespace("flock.midi"),flock.midi.requestAccess=function(a,b,c){if(!navigator.requestMIDIAccess){var d="The Web MIDI API is not available. You may need to enable it in your browser's settings.";return fluid.log(fluid.logLevel.WARN,d),void c(d)}var e=navigator.requestMIDIAccess({sysex:a});e.then(b,c)},flock.midi.getPorts=function(a){var b={},c="function"==typeof a.inputs?flock.midi.collectPortsLegacy:flock.midi.collectPorts;return c("inputs",a,b),c("outputs",a,b),b},flock.midi.requestPorts=function(a,b){function c(b){var c=flock.midi.getPorts(b);a(c)}flock.midi.requestAccess(!1,c,b)},flock.midi.createPortViews=function(a){return fluid.transform(a,function(a){return{id:a.id,name:a.name,manufacturer:a.manufacturer,state:a.state,connection:a.connection}})},flock.midi.prettyPrintPorts=function(a){return fluid.prettyPrintJSON({inputs:flock.midi.createPortViews(a.inputs),outputs:flock.midi.createPortViews(a.outputs)})},flock.midi.logPorts=function(){function a(a){var b=flock.midi.prettyPrintPorts(a);console.log(b)}function b(a){console.log(a)}flock.midi.requestPorts(a,b)},flock.midi.collectPorts=function(a,b,c){for(var d=c[a]=c[a]||[],e=b[a].values(),f=e.next();!f.done;)d.push(f.value),f=e.next();return c},flock.midi.collectPortsLegacy=function(a,b,c){return b[a]&&(c[a]=b[a]()),c},flock.midi.read=function(a){var b,c=a[0],d=c>>4,e=15&c;switch(d){case 8:b=flock.midi.read.noteOff;break;case 9:b=a[2]>0?flock.midi.read.noteOn:flock.midi.read.noteOff;break;case 10:b=flock.midi.read.polyAftertouch;break;case 11:b=flock.midi.read.controlChange;break;case 12:b=flock.midi.read.programChange;break;case 13:b=flock.midi.read.channelAftertouch;break;case 14:b=flock.midi.read.pitchbend;break;case 15:b=flock.midi.read.sysex;break;default:throw new Error("Recieved an unrecognized MIDI message: "+a)}return b(e,a)},flock.midi.read.note=function(a,b,c){return{type:a,chan:b,note:c[1],velocity:c[2]}},flock.midi.read.noteOn=function(a,b){return flock.midi.read.note("noteOn",a,b)},flock.midi.read.noteOff=function(a,b){return flock.midi.read.note("noteOff",a,b)},flock.midi.read.polyAftertouch=function(a,b){return{type:"aftertouch",chan:a,note:b[1],pressure:b[2]}},flock.midi.read.controlChange=function(a,b){return{type:"control",chan:a,number:b[1],value:b[2]}},flock.midi.read.programChange=function(a,b){return{type:"program",chan:a,program:b[1]}},flock.midi.read.channelAftertouch=function(a,b){return{type:"aftertouch",chan:a,pressure:b[1]}},flock.midi.read.pitchbend=function(a,b){return{type:"pitchbend",chan:a,value:b[1]<<7|b[2]}},flock.midi.read.sysex=function(a,b){return{type:"system",chan:a,data:b.subarray(1)}},fluid.defaults("flock.midi.system",{gradeNames:["fluid.component"],sysex:!1,members:{access:void 0,ports:void 0},invokers:{requestAccess:{funcName:"flock.midi.requestAccess",args:["{that}.options.sysex","{that}.events.onAccessGranted.fire","{that}.events.onAccessError.fire"]},refreshPorts:{funcName:"flock.midi.system.refreshPorts",args:["{that}","{that}.access","{that}.events.onPortsAvailable.fire"]}},events:{onAccessGranted:null,onAccessError:null,onReady:null,onPortsAvailable:null},listeners:{onCreate:{func:"{that}.requestAccess"},onAccessGranted:["flock.midi.system.setAccess({that}, {arguments}.0)","{that}.refreshPorts()","{that}.events.onReady.fire({that}.ports)"],onAccessError:{funcName:"fluid.log",args:[fluid.logLevel.WARN,"MIDI Access Error: ","{arguments}.0"]}}}),flock.midi.system.setAccess=function(a,b){a.access=b},flock.midi.system.refreshPorts=function(a,b,c){a.ports=flock.midi.getPorts(b),c(a.ports)},fluid.defaults("flock.midi.receiver",{gradeNames:["fluid.component"],events:{raw:null,message:null,note:null,noteOn:null,noteOff:null,control:null,program:null,aftertouch:null,pitchbend:null}}),fluid.defaults("flock.midi.connection",{gradeNames:["flock.midi.receiver"],openImmediately:!1,sysex:!1,distributeOptions:{source:"{that}.options.sysex",target:"{that > system}.options.sysex"},ports:0,invokers:{send:{func:"{that}.events.onSendMessage.fire"},open:{funcName:"flock.midi.connection.bind",args:["{system}.ports","{that}.options.ports","{that}.events.onReady.fire","{that}.events.raw.fire","{that}.events.onSendMessage"]},close:{funcName:"flock.midi.connection.close",args:["{system}.ports","{that}.events.raw.fire"]}},components:{system:{type:"flock.midi.system",options:{events:{onReady:"{connection}.events.onPortsAvailable"}}}},events:{onPortsAvailable:null,onReady:null,onError:null,onSendMessage:null},listeners:{onPortsAvailable:{funcName:"flock.midi.connection.autoOpen",args:["{connection}.options.openImmediately","{connection}.open"]},onError:{funcName:"fluid.log",args:[fluid.logLevel.WARN,"{arguments}.0"]},raw:{funcName:"flock.midi.connection.fireEvent",args:["{arguments}.0","{that}.events"]},onDestroy:["{that}.close()"]}}),flock.midi.connection.autoOpen=function(a,b){a&&b()},flock.midi.findPorts=function(a,b){b=fluid.makeArray(b);var c=[];return fluid.each(b,function(b){var d=flock.midi.findPorts.portFinder(b),e=d(a);c=c.concat(e)}),c},flock.midi.findPorts.portFinder=function(a){if("number"==typeof a)return flock.midi.findPorts.byIndex(a);"string"==typeof a&&(a={name:a});var b=a.id?flock.midi.findPorts.idMatcher(a.id):a.manufacturer&&a.name?flock.midi.findPorts.bothMatcher(a.manufacturer,a.name):a.manufacturer?flock.midi.findPorts.manufacturerMatcher(a.manufacturer):flock.midi.findPorts.nameMatcher(a.name);return function(a){return a.filter(b)}},flock.midi.findPorts.byIndex=function(a){return function(b){var c=b[a];return c?[c]:[]}},flock.midi.findPorts.lowerCaseContainsMatcher=function(a){return function(b){var c;for(var d in a){var e=b[d],f=a[d];if(c="*"===f?!0:e&&e.toLowerCase().indexOf(f.toLowerCase())>-1,!c)break}return c}},flock.midi.findPorts.idMatcher=function(a){return function(b){return b.id===a}},flock.midi.findPorts.bothMatcher=function(a,b){return flock.midi.findPorts.lowerCaseContainsMatcher({manufacturer:a,name:b})},flock.midi.findPorts.manufacturerMatcher=function(a){return flock.midi.findPorts.lowerCaseContainsMatcher({manufacturer:a})},flock.midi.findPorts.nameMatcher=function(a){return flock.midi.findPorts.lowerCaseContainsMatcher({name:a})},flock.midi.findPorts.eachPortOfType=function(a,b,c){var d=fluid.makeArray(a);fluid.each(d,function(a){a.type===b&&c(a)})},flock.midi.connection.openPort=function(a,b){if(a.open){var c=a.open();b.push(c)}return b},flock.midi.connection.listen=function(a,b,c){return flock.midi.findPorts.eachPortOfType(a,"input",function(a){flock.midi.connection.openPort(a,c),a.addEventListener("midimessage",b,!1)}),c},flock.midi.connection.stopListening=function(a,b){flock.midi.findPorts.eachPortOfType(a,"input",function(a){a.close(),a.removeEventListener("midimessage",b,!1)})},flock.midi.connection.bindSender=function(a,b,c){var d=fluid.makeArray(a);return fluid.each(d,function(a){flock.midi.connection.openPort(a,c),b.addListener(a.send.bind(a))}),c},flock.midi.connection.fireReady=function(a,b){!a||a.length<1||Promise.all(a).then(b)},flock.midi.connection.bind=function(a,b,c,d,e){b=flock.midi.connection.expandPortSpec(b);var f=flock.midi.findPorts(a.inputs,b.input),g=flock.midi.findPorts(a.outputs,b.output),h=[];f&&f.length>0?flock.midi.connection.listen(f,d,h):void 0!==b.input&&flock.midi.connection.logNoMatchedPorts("input",b),g&&g.length>0?flock.midi.connection.bindSender(g,e,h):void 0!==b.output&&flock.midi.connection.logNoMatchedPorts("output",b),flock.midi.connection.fireReady(h,c)},flock.midi.connection.close=function(a,b){flock.midi.connection.stopListening(a.inputs,b)},flock.midi.connection.logNoMatchedPorts=function(a,b){fluid.log(fluid.logLevel.WARN,"No matching "+a+" ports were found for port specification: ",b[a])},flock.midi.connection.expandPortSpec=function(a){if(void 0!==a.input||void 0!==a.output)return a;var b={input:{},output:{}};return"number"==typeof a?b.input=b.output=a:(flock.midi.connection.expandPortSpecProperty("manufacturer",a,b),flock.midi.connection.expandPortSpecProperty("name",a,b)),b},flock.midi.connection.expandPortSpecProperty=function(a,b,c){return c.input[a]=c.output[a]=b[a],c},flock.midi.connection.fireEvent=function(a,b){var c=flock.midi.read(a.data),d=c.type?b[c.type]:void 0;b.message.fire(c),"noteOn"!==c.type&&"noteOff"!==c.type||b.note.fire(c),d&&d.fire(c)},fluid.defaults("flock.midi.controller",{gradeNames:["fluid.component"],members:{controlMap:"@expand:flock.midi.controller.optimizeControlMap({that}.options.controlMap)",noteMap:"{that}.options.noteMap"},controlMap:{},noteMap:{},components:{synthContext:{type:"flock.band"},connection:{type:"flock.midi.connection",options:{ports:{input:"*"},openImmediately:!0,listeners:{control:{func:"{controller}.mapControl"},note:{func:"{controller}.mapNote"}}}}},invokers:{mapControl:{funcName:"flock.midi.controller.mapControl",args:["{arguments}.0","{that}.synthContext","{that}.controlMap"]},mapNote:{funcName:"flock.midi.controller.mapNote",args:["{arguments}.0","{that}.synthContext","{that}.noteMap"]}}}),flock.midi.controller.optimizeControlMap=function(a){var b=new Array(127);return fluid.each(a,function(a,c){var d=Number(c);b[d]=a}),b},flock.midi.controller.expandControlMapSpec=function(a,b){return b.transform.id=a,b.valuePath=b.valuePath||"value",b.transform.ugen||(b.transform.ugen="flock.ugen.value"),b},flock.midi.controller.makeValueSynth=function(a,b,c){c=flock.midi.controller.expandControlMapSpec(b,c);var d=c.transform,e=c.valuePath;flock.set(d,e,a);var f=flock.synth.value({synthDef:d});return c.valuePath=b+"."+e,f},flock.midi.controller.transformValue=function(a,b){var c=b.transform,d=typeof c;return"function"===d?c(a):(b.transformSynth?b.transformSynth.set(b.valuePath,a):b.transformSynth=flock.midi.controller.makeValueSynth(a,"flock-midi-controller-in",b),b.transformSynth.value())},flock.midi.controller.setMappedValue=function(a,b,c){if(b){a=b.transform?flock.midi.controller.transformValue(a,b):a;var d=c[b.synth]||c;d.set(b.input,a)}},flock.midi.controller.mapControl=function(a,b,c){var d=c[a.number],e=a.value;flock.midi.controller.setMappedValue(e,d,b)},flock.midi.controller.mapNote=function(a,b,c){var d=c.note,e=a.note,f=c.velocity,g=a.velocity;d&&flock.midi.controller.setMappedValue(e,d,b),f&&flock.midi.controller.setMappedValue(g,f,b)}}();var fluid=fluid||require("infusion"),flock=fluid.registerNamespace("flock");!function(){"use strict";fluid.defaults("flock.webAudio.nativeNodeManager",{gradeNames:["fluid.component"],members:{outputNode:void 0,inputNodes:[]},components:{scriptProcessor:{createOnEvent:"onCreateScriptProcessor",type:"flock.webAudio.scriptProcessor",options:{nodeSpec:{inputs:{0:"{inputMerger}"}}}},merger:{type:"flock.webAudio.channelMerger"}},invokers:{connect:"{that}.events.onConnect.fire",disconnect:"{that}.events.onDisconnect.fire",createNode:{funcName:"flock.webAudio.createNode",args:["{audioSystem}.context","{arguments}.0"]},createInputNode:{funcName:"flock.webAudio.nativeNodeManager.createInputNode",args:["{that}","{arguments}.0","{arguments}.1"]},createMediaStreamInput:{funcName:"flock.webAudio.nativeNodeManager.createInputNode",args:["{that}",{node:"MediaStreamSource",args:["{arguments}.0"]},"{arguments}.1"]},createMediaElementInput:{funcName:"flock.webAudio.nativeNodeManager.createInputNode",args:["{that}",{node:"MediaElementSource",args:["{arguments}.0"]},"{arguments}.1"]},createOutputNode:{funcName:"flock.webAudio.nativeNodeManager.createOutputNode",args:["{that}","{arguments}.0"]},insertInput:{funcName:"flock.webAudio.nativeNodeManager.insertInput",args:["{that}","{audioSystem}.model","{enviro}","{arguments}.0","{arguments}.1"]},removeInput:{funcName:"flock.webAudio.nativeNodeManager.removeInput",args:["{arguments}.0","{that}.inputNodes"]},removeAllInputs:{funcName:"flock.webAudio.nativeNodeManager.removeAllInputs",args:"{that}.inputNodes"},insertOutput:{funcName:"flock.webAudio.nativeNodeManager.insertOutput",args:["{that}","{arguments}.0"]},removeOutput:{funcName:"flock.webAudio.nativeNodeManager.removeOutput",args:["{scriptProcessor}.node"]}},events:{onStart:"{enviro}.events.onStart",onStop:"{enviro}.events.onStop",onReset:"{enviro}.events.onReset",onCreateScriptProcessor:null,onConnect:null,onDisconnect:null},listeners:{onCreate:["{that}.events.onCreateScriptProcessor.fire()",{func:"{that}.insertOutput",args:"{scriptProcessor}.node"}],onStart:["{that}.connect()"],onConnect:[{"this":"{merger}.node",method:"connect",args:["{scriptProcessor}.node"]},{"this":"{that}.outputNode",method:"connect",args:["{audioSystem}.context.destination"]},{funcName:"flock.webAudio.nativeNodeManager.connectOutput",args:["{scriptProcessor}.node","{that}.outputNode"]}],onStop:["{that}.disconnect()"],onDisconnect:[{"this":"{merger}.node",method:"disconnect",args:[0]},{"this":"{scriptProcessor}.node",method:"disconnect",args:[0]},{"this":"{that}.outputNode",method:"disconnect",args:[0]}],onReset:["{that}.removeAllInputs()","{that}.events.onCreateScriptProcessor.fire()"],onDestroy:["{that}.removeAllInputs()","flock.webAudio.nativeNodeManager.disconnectOutput({that})"]}}),flock.webAudio.nativeNodeManager.createInputNode=function(a,b,c){var d=a.createNode(b);return a.insertInput(d,c)},flock.webAudio.nativeNodeManager.createOutputNode=function(a,b){var c=a.createNode(b);return a.insertOutput(c)},flock.webAudio.nativeNodeManager.connectOutput=function(a,b){a!==b&&a.connect(b)},flock.webAudio.nativeNodeManager.disconnectOutput=function(a){a.outputNode&&a.outputNode.disconnect(0)},flock.webAudio.nativeNodeManager.removeAllInputs=function(a){for(var b=0;b<a.length;b++){var c=a[b];c.disconnect(0)}a.length=0},flock.webAudio.nativeNodeManager.insertInput=function(a,b,c,d,e){var f=b.numInputBuses;if(a.inputNodes.length>=f)return void flock.fail("There are too many input nodes connected to Flocking. The maximum number of input buses is currently set to "+f+". Either remove an existing input node or increase Flockings numInputBuses option.");e=void 0===e?c.busManager.acquireNextBus("input"):e;var g=e-b.chans;return a.inputNodes.push(d),d.connect(a.merger.node,0,g),e},flock.webAudio.nativeNodeManager.removeInput=function(a,b){var c=b.indexOf(a);c>-1&&b.splice(c,1),a.disconnect(0)},flock.webAudio.nativeNodeManager.insertOutput=function(a,b){return flock.webAudio.nativeNodeManager.disconnectOutput(a),a.outputNode=b,b},flock.webAudio.nativeNodeManager.removeOutput=function(a){flock.webAudio.nativeNodeManager.insertOutput(a)}}();var fluid=fluid||require("infusion"),flock=fluid.registerNamespace("flock");!function(){"use strict";fluid.defaults("flock.webAudio.outputManager",{gradeNames:["flock.outputManager"],model:{isGenerating:!1,shouldInitIOS:flock.platform.isIOS,audioSettings:{}},invokers:{bindAudioProcess:{funcName:"flock.webAudio.outputManager.bindAudioProcess",args:["{enviro}.nodeList","{busManager}.buses","{nativeNodeManager}","{that}.model"]},unbindAudioProcess:{funcName:"flock.webAudio.outputManager.unbindAudioProcess",args:["{nativeNodeManager}"]}},listeners:{"{nativeNodeManager}.events.onConnect":["{that}.bindAudioProcess()"],"{nativeNodeManager}.events.onDisconnect":["{that}.unbindAudioProcess()"],onStart:[{func:"{that}.applier.change",args:["isGenerating",!0]},{priority:"last",funcName:"flock.webAudio.outputManager.iOSStart",args:["{that}","{audioSystem}.context","{scriptProcessor}.node"]}],onStop:[{func:"{that}.applier.change",args:["isGenerating",!1]
}]}}),flock.webAudio.outputManager.bindAudioProcess=function(a,b,c,d){var e=c.scriptProcessor.node;e.model=d,e.nodeList=a,e.buses=b,e.inputNodes=c.inputNodes,e.onaudioprocess=flock.webAudio.outputManager.writeSamples},flock.webAudio.outputManager.unbindAudioProcess=function(a){a.scriptProcessor.node.onaudioprocess=void 0},flock.webAudio.outputManager.writeSamples=function(a){var b,c,d,e=this.inputNodes?this.inputNodes.length:0,f=this.nodeList.nodes,g=this.model.audioSettings,h=a.inputBuffer,i=a.outputBuffer,j=g.numBlocks,k=this.buses,l=g.numBuses,m=g.blockSize,n=g.chans,o=h.numberOfChannels;if(f.length<1)for(b=0;n>b;b++)flock.clearBuffer(i.getChannelData(b));else for(c=0;j>c;c++){var p=c*m;if(flock.evaluate.clearBuses(k,l,m),e>0)for(b=0;o>b;b++){var q=h.getChannelData(b),r=n+b,s=k[r];for(d=0;m>d;d++)s[d]=q[d+p]}for(flock.evaluate.synths(f),b=0;n>b;b++){var t=k[b],u=i.getChannelData(b);for(d=0;m>d;d++)u[d+p]=t[d]}}},flock.webAudio.outputManager.iOSStart=function(a,b,c){if(a.model.shouldInitIOS){var d=b.createBufferSource();d.connect(c),d.start(0),d.stop(0),d.disconnect(0),a.applier.change("shouldInitIOS",!1)}}}();var fluid=fluid||require("infusion"),flock=fluid.registerNamespace("flock");!function(){"use strict";var a=fluid.registerNamespace("jQuery");flock.ugenDefaults=function(a,b){return 1===arguments.length?flock.ugenDefaults.store[a]:(flock.ugenDefaults.store[a]=b,b)},flock.ugenDefaults.store={},flock.isUGen=function(a){return a&&a.tags&&a.tags.indexOf("flock.ugen")>-1},flock.aliasUGen=function(b,c,d,e){var f=flock.get(b);flock.set(f,c,function(b,c,d){return d=a.extend(!0,{},e,d),f(b,c,d)}),flock.ugenDefaults(b+"."+c,d)},flock.aliasUGens=function(a,b){var c,d;for(c in b)d=b[c],flock.aliasUGen(a,c,{inputs:d.inputDefaults},d.options)},flock.krMul=function(a,b,c){var d,e=c.output[0];for(d=0;a>d;d++)b[d]=b[d]*e},flock.mul=function(a,b,c){var d,e=c.output;for(d=0;a>d;d++)b[d]=b[d]*e[d]},flock.krAdd=function(a,b,c,d){var e,f=d.output[0];for(e=0;a>e;e++)b[e]=b[e]+f},flock.add=function(a,b,c,d){var e,f=d.output;for(e=0;a>e;e++)b[e]=b[e]+f[e]},flock.krMulAdd=function(a,b,c,d){var e,f=c.output[0],g=d.output;for(e=0;a>e;e++)b[e]=b[e]*f+g[e]},flock.mulKrAdd=function(a,b,c,d){var e,f=c.output,g=d.output[0];for(e=0;a>e;e++)b[e]=b[e]*f[e]+g},flock.krMulKrAdd=function(a,b,c,d){var e,f=c.output[0],g=d.output[0];for(e=0;a>e;e++)b[e]=b[e]*f+g},flock.mulAdd=function(a,b,c,d){var e,f=c.output,g=d.output;for(e=0;a>e;e++)b[e]=b[e]*f[e]+g[e]},flock.onMulAddInputChanged=function(a){var b,c=a.inputs.mul,d=a.inputs.add;return c||d?(b=c?d?c.rate!==flock.rates.AUDIO?d.rate!==flock.rates.AUDIO?flock.krMulKrAdd:flock.krMulAdd:d.rate!==flock.rates.AUDIO?flock.mulKrAdd:flock.mulAdd:c.rate!==flock.rates.AUDIO?flock.krMul:flock.mul:d.rate!==flock.rates.AUDIO?flock.krAdd:flock.add,void(a.mulAdd=function(e){b(e,a.output,c,d)})):void(a.mulAdd=flock.noOp)},flock.ugen=function(a,b,c){c=c||{};var d={enviro:c.enviro||flock.environment,rate:c.rate||flock.rates.AUDIO,inputs:a,output:b,options:c,model:c.model||{unscaledValue:0,value:0},multiInputs:{},tags:["flock.ugen"]};return d.lastOutputIdx=d.output.length-1,d.get=function(a){return flock.input.get(d.inputs,a)},d.set=function(a,b){return flock.input.set(d.inputs,a,b,d,function(a){return null!==a&&void 0!==a?flock.parse.ugenDef(a,d.enviro,{audioSettings:d.options.audioSettings,buses:d.buses,buffers:d.buffers}):void 0})},d.input=function(a,b){return a?"string"==typeof a?arguments.length<2?d.get(a):d.set(a,b):flock.isIterable(a)?d.get(a):d.set(a,b):void 0},d.calculateStrides=function(){var a,b,c,e=d.model,f=d.options.strideInputs,g=d.inputs;if(e.strides=e.strides||{},f)for(a=0;a<f.length;a++)b=f[a],c=g[b],c?e.strides[b]=c.rate===flock.rates.AUDIO?1:0:fluid.log(fluid.logLevel.WARN,"An invalid input ('"+b+"') was found on a unit generator: "+d)},d.collectMultiInputs=function(){var a,b,c,e,f=d.options.multiInputNames,g=d.multiInputs;for(a=0;a<f.length;a++)b=f[a],c=g[b],c?c.length=0:c=g[b]=[],e=d.inputs[b],flock.ugen.collectMultiInputs(e,c)},d.onInputChanged=function(a){var b=d.options.multiInputNames;flock.onMulAddInputChanged(d),d.options.strideInputs&&d.calculateStrides(),!b||a&&!b.indexOf(a)||d.collectMultiInputs()},d.init=function(){var a,b,c,e=fluid.makeArray(d.options.tags),f=d.model,g=d.options;for(a=0;a<e.length;a++)d.tags.push(e[a]);if(b=g.audioSettings=g.audioSettings||d.enviro.audioSystem.model,f.sampleRate=g.sampleRate||b.rates[d.rate],f.nyquistRate=f.sampleRate,f.blockSize=d.rate===flock.rates.AUDIO?b.blockSize:1,f.sampleDur=1/f.sampleRate,d.interpolate=flock.interpolate.none,g.interpolation){var h=flock.interpolate[g.interpolation];h?d.interpolate=h:fluid.log(fluid.logLevel.IMPORTANT,"An invalid interpolation type of '"+g.interpolation+"' was specified. Defaulting to none.")}d.rate===flock.rates.DEMAND&&d.inputs.freq&&(c=flock.parse.ugenDefForConstantValue(1),d.inputs.freq=flock.parse.ugenDef(c,d.enviro))},d.init(),d},flock.ugen.collectMultiInputs=function(a,b){flock.isIterable(a)||(a=a=fluid.makeArray(a));for(var c=0;c<a.length;c++){var d=a[c];flock.ugen.collectChannelsForInput(d,b)}return b},flock.ugen.collectChannelsForInput=function(a,b){var c,d=flock.hasTag(a,"flock.ugen.multiChannelOutput"),e=d?a.output:[a.output];for(c=0;c<e.length;c++)b.push({rate:a.rate,output:e[c]});return b},flock.ugen.lastOutputValue=function(a,b){return b[a-1]},flock.ugen.buffer=function(a){a.onBufferInputChanged=function(b){var c=a.model,d=a.inputs;c.bufDef===d.buffer&&"buffer"!==b||(c.bufDef=d.buffer,flock.parse.bufferForDef(c.bufDef,a,a.enviro))},a.setBuffer=function(b){a.buffer=b,a.onBufferReady&&a.onBufferReady(b)},a.initBuffer=function(){a.buffer=a.model.bufDef=flock.bufferDesc({format:{sampleRate:a.options.audioSettings.rates.audio},data:{channels:[new Float32Array(a.output.length)]}})}},flock.ugen.value=function(a,b,c){var d=flock.ugen(a,b,c);return d.value=function(){return d.model.value},d.dynamicGen=function(a){for(var b=d.output,c=d.model,e=0;a>e;e++)b[e]=c.unscaledValue;d.mulAdd(a),c.value=flock.ugen.lastOutputValue(a,b)},d.onInputChanged=function(){var a=d.inputs,b=d.model;b.unscaledValue=a.value,"constant"!==d.rate?d.gen=d.dynamicGen:d.gen=void 0,flock.onMulAddInputChanged(d),d.dynamicGen(1)},d.onInputChanged(),d},flock.ugenDefaults("flock.ugen.value",{rate:"control",inputs:{value:1,mul:null,add:null},ugenOptions:{model:{unscaledValue:1,value:1},tags:["flock.ugen.valueType"]}}),flock.ugen.silence=function(a,b,c){var d=flock.ugen(a,b,c);return d.onInputChanged=function(){for(var a=0;a<d.output.length;a++)d.output[a]=0},d.onInputChanged(),d},flock.ugenDefaults("flock.ugen.silence",{rate:"constant"}),flock.ugen.passThrough=function(a,b,c){var d=flock.ugen(a,b,c);return d.gen=function(a){var b,c,e=d.model,f=d.inputs.source.output,g=d.output;for(b=0;b<f.length;b++)g[b]=c=f[b];for(;a>b;b++)g[b]=c=0;e.unscaledValue=c,d.mulAdd(a),e.value=flock.ugen.lastOutputValue(a,g)},d.onInputChanged(),d},flock.ugenDefaults("flock.ugen.passThrough",{rate:"audio",inputs:{source:null,mul:null,add:null}}),flock.ugen.out=function(a,b,c){var d=flock.ugen(a,b,c);return d.gen=function(a){var b,c,e,f,g,h,i,j,k,l,m=d.model,n=d.multiInputs.sources,o=d.options.buses,p=d.inputs.bus.output[0],q=d.inputs.expand.output[0];if(b=n.length,c=Math.max(q,b),!(1>b)){for(e=0;c>e;e++)for(g=n[e%b],h=g.rate,i=o[p+e],j=h===flock.rates.AUDIO?1:0,k=0,f=0;a>f;f++,k+=j)l=g.output[k],i[f]=i[f]+l;m.value=m.unscaledValue=l,d.mulAdd(a)}},d.init=function(){d.sourceBuffers=[],d.onInputChanged()},d.init(),d},flock.ugenDefaults("flock.ugen.out",{rate:"audio",inputs:{sources:null,bus:0,expand:2},ugenOptions:{tags:["flock.ugen.outputType"],multiInputNames:["sources"]}}),flock.ugen.valueOut=function(a,b,c){var d=flock.ugen(a,b,c);return d.arraySourceGen=function(){var a,b=d.model,c=d.inputs.sources;for(a=0;a<c.length;a++)b.value[a]=c[a].output[0]},d.ugenSourceGen=function(){d.model.value=d.model.unscaledValue=d.inputs.sources.output[0]},d.onInputChanged=function(){var a=d.model,b=d.inputs.sources;flock.isIterable(b)?(d.gen=d.arraySourceGen,a.value=new Float32Array(b.length),a.unscaledValue=a.value):d.gen=d.ugenSourceGen},d.onInputChanged(),d},flock.ugenDefaults("flock.ugen.valueOut",{rate:"control",inputs:{sources:null},ugenOptions:{model:{unscaledValue:null,value:null},tags:["flock.ugen.outputType","flock.ugen.valueType"]}}),flock.ugen["in"]=function(a,b,c){var d=flock.ugen(a,b,c);return d.singleBusGen=function(a){var b=d.model,c=d.output;flock.ugen["in"].readBus(a,c,d.inputs.bus,d.options.buses),b.unscaledValue=flock.ugen.lastOutputValue(a,c),d.mulAdd(a),b.value=flock.ugen.lastOutputValue(a,c)},d.multiBusGen=function(a){var b,c,e,f,g=d.model,h=d.inputs.bus,i=d.options.buses,j=d.output;for(b=0;a>b;b++){for(f=0,c=0;c<h.length;c++)e=0|h[c].output[0],f+=i[e][b];j[b]=f}g.unscaledValue=f,d.mulAdd(a),g.value=flock.ugen.lastOutputValue(a,j)},d.onInputChanged=function(){d.gen=flock.isIterable(d.inputs.bus)?d.multiBusGen:d.singleBusGen,flock.onMulAddInputChanged(d)},d.onInputChanged(),d},flock.ugen["in"].readBus=function(a,b,c,d){var e,f=0|c.output[0],g=d[f];for(e=0;a>e;e++)b[e]=g[e]},flock.ugenDefaults("flock.ugen.in",{rate:"audio",inputs:{bus:0,mul:null,add:null}}),flock.ugen.audioIn=function(a,b,c){var d=flock.ugen(a,b,c);return d.gen=function(a){var b,c,e=d.model,f=d.output,g=d.bus;for(b=0;a>b;b++)f[b]=c=g[b];e.unscaledValue=c,d.mulAdd(a),e.value=flock.ugen.lastOutputValue(a,f)},d.onInputChanged=function(){flock.onMulAddInputChanged(d)},d.init=function(){var a=d.enviro.audioSystem.inputDeviceManager.openAudioDevice(c);d.bus=d.options.buses[a],d.onInputChanged()},d.init(),d},flock.ugenDefaults("flock.ugen.audioIn",{rate:"audio",inputs:{mul:null,add:null}})}();var fluid=fluid||require("infusion"),flock=fluid.registerNamespace("flock");!function(){"use strict";flock.ugen.osc=function(a,b,c){var d=flock.ugen(a,b,c);return d.gen=function(a){var b,c,e,f,g,h=d.model,i=d.inputs,j=i.freq.output,k=i.phase.output,l=i.table,m=h.tableLen,n=h.tableIncHz,o=h.tableIncRad,p=d.output,q=h.phase;for(b=0,c=0,e=0;a>b;b++,c+=h.strides.phase,e+=h.strides.freq)f=q+k[c]*o,f>=m?f-=m:0>f&&(f+=m),p[b]=g=d.interpolate(f,l),q+=j[e]*n,q>=m?q-=m:0>q&&(q+=m);h.phase=q,h.unscaledValue=g,d.mulAdd(a),h.value=flock.ugen.lastOutputValue(a,p)},d.onInputChanged=function(a){if(flock.ugen.osc.onInputChanged(d),!a||"table"===a){var b=d.model,c=d.inputs.table;c.length<1&&(c=d.inputs.table=flock.ugen.osc.emptyTable),b.tableLen=c.length,b.tableIncHz=b.tableLen/b.sampleRate,b.tableIncRad=b.tableLen/flock.TWOPI}},d.onInputChanged(),d},flock.ugen.osc.emptyTable=new Float32Array([0,0,0]),flock.ugen.osc.onInputChanged=function(a){a.calculateStrides(),flock.onMulAddInputChanged(a)},flock.ugenDefaults("flock.ugen.osc",{rate:"audio",inputs:{freq:440,phase:0,table:[],mul:null,add:null},ugenOptions:{interpolation:"linear",model:{phase:0,unscaledValue:0,value:0},strideInputs:["freq","phase"]},tableSize:8192}),flock.ugen.osc.define=function(a,b){var c=a.lastIndexOf("."),d=a.substring(0,c),e=a.substring(c+1),f=flock.get(d);f[e]=function(a,c,d){var e=flock.ugenDefaults("flock.ugen.osc"),f=fluid.merge(null,e,d),g=f.tableSize;return a.table=flock.fillTable(g,b),flock.ugen.osc(a,c,d)},flock.ugenDefaults(a,flock.ugenDefaults("flock.ugen.osc"))},flock.ugen.osc.define("flock.ugen.sinOsc",flock.tableGenerators.sin),flock.ugen.osc.define("flock.ugen.triOsc",flock.tableGenerators.tri),flock.ugen.osc.define("flock.ugen.sawOsc",flock.tableGenerators.saw),flock.ugen.osc.define("flock.ugen.squareOsc",flock.tableGenerators.square),flock.ugen.sin=function(a,b,c){var d=flock.ugen(a,b,c);return d.gen=function(a){var b,c,e,f,g=d.model,h=d.inputs.freq.output,i=d.inputs.phase.output,j=d.output,k=g.phase,l=g.sampleRate;for(b=0,c=0,e=0;a>b;b++,c+=g.strides.phase,e+=g.strides.freq)j[b]=f=Math.sin(k+i[c]),k+=h[e]/l*flock.TWOPI;g.phase=k,g.unscaledValue=f,d.mulAdd(a),g.value=flock.ugen.lastOutputValue(a,j)},d.onInputChanged=function(){flock.ugen.osc.onInputChanged(d)},d.onInputChanged(),d},flock.ugenDefaults("flock.ugen.sin",{rate:"audio",inputs:{freq:440,phase:0,mul:null,add:null},ugenOptions:{model:{phase:0,unscaledValue:0,value:0},strideInputs:["freq","phase"]}}),flock.ugen.lfSaw=function(a,b,c){var d=flock.ugen(a,b,c);return d.gen=function(a){var b,c,e,f=d.model,g=d.inputs.freq.output,h=d.output,i=f.scale,j=d.inputs.phase.output[0],k=f.phase;for(b=0,c=0;a>b;b++,c+=f.strides.freq)h[b]=e=k+j,k+=g[c]*i,k>=1?k-=2:-1>=k&&(k+=2);f.phase=k,f.unscaledValue=e,d.mulAdd(a),f.value=flock.ugen.lastOutputValue(a,h)},d.onInputChanged=function(){var a=d.model;a.freqInc=d.inputs.freq.rate===flock.rates.AUDIO?1:0,a.phase=0,d.calculateStrides(),flock.onMulAddInputChanged(d)},d.init=function(){d.model.scale=2*(1/d.options.sampleRate),d.onInputChanged()},d.init(),d},flock.ugenDefaults("flock.ugen.lfSaw",{rate:"audio",inputs:{freq:440,phase:0,mul:null,add:null},ugenOptions:{model:{phase:0,freqInc:1,unscaledValue:0,value:0},strideInputs:["freq"]}}),flock.ugen.lfPulse=function(a,b,c){var d=flock.ugen(a,b,c);return d.gen=function(a){var b,c,e,f=d.inputs,g=d.model,h=f.freq.output,i=g.freqInc,j=f.width.output[0],k=d.output,l=g.scale,m=void 0!==g.phase?g.phase:f.phase.output[0];for(b=0,c=0;a>b;b++,c+=i)m>=1?(m-=1,k[b]=e=.5>j?1:-1):k[b]=e=j>m?1:-1,m+=h[c]*l;g.phase=m,g.unscaledValue=e,d.mulAdd(a),g.value=flock.ugen.lastOutputValue(a,k)},d.onInputChanged=function(){d.model.freqInc=d.inputs.freq.rate===flock.rates.AUDIO?1:0,flock.onMulAddInputChanged(d)},d.init=function(){d.model.scale=1/d.options.sampleRate,d.onInputChanged()},d.init(),d},flock.ugenDefaults("flock.ugen.lfPulse",{rate:"audio",inputs:{freq:440,phase:0,width:.5,mul:null,add:null},ugenOptions:{model:{phase:0,freqInc:1,unscaledValue:0,value:0}}}),flock.ugen.impulse=function(a,b,c){var d=flock.ugen(a,b,c);return d.gen=function(a){var b,c,e,f=d.inputs,g=d.model,h=d.output,i=f.freq.output,j=g.strides.freq,k=f.phase.output[0],l=g.phase,m=g.scale;for(l+=k,b=0,c=0;a>b;b++,c+=j)l>=1?(l-=1,e=1):e=0,h[b]=e,l+=i[c]*m;g.phase=l-k,g.unscaledValue=e,d.mulAdd(a),g.value=flock.ugen.lastOutputValue(a,h)},d.onInputChanged=function(){d.calculateStrides(),flock.onMulAddInputChanged(d)},d.init=function(){d.model.scale=1/d.model.sampleRate,d.onInputChanged()},d.init(),d},flock.ugenDefaults("flock.ugen.impulse",{rate:"audio",inputs:{freq:440,phase:0,mul:null,add:null},ugenOptions:{model:{phase:0,scale:0,unscaledValue:0,value:0},strideInputs:["freq"]}})}();var fluid=fluid||require("infusion"),flock=fluid.registerNamespace("flock");!function(){"use strict";var a=flock.requireModule("webarraymath","ArrayMath");flock.ugen.math=function(b,c,d){var e=flock.ugen(b,c,d);return e.expandedRight=new Float32Array(e.options.audioSettings.blockSize),e.krSourceKrInputGen=function(){var b=e.model,c=e.activeInput,d=e.inputs[c],f=e.output,g=e.inputs.source.output[0],h=flock.fillBufferWithValue(e.expandedRight,d.output[0]);a[c](f,g,h),b.value=b.unscaledValue=f[f.length-1]},e.krSourceArInputGen=function(){var b=e.model,c=e.activeInput,d=e.inputs[c],f=e.output,g=e.inputs.source.output[0],h=d.output;a[c](f,g,h),b.value=b.unscaledValue=f[f.length-1]},e.arSourceKrInputGen=function(){var b=e.model,c=e.activeInput,d=e.inputs[c],f=e.output,g=e.inputs.source.output,h=flock.fillBufferWithValue(e.expandedRight,d.output[0]);a[c](f,g,h),b.value=b.unscaledValue=f[f.length-1]},e.arSourceArInputGen=function(){var b=e.model,c=e.activeInput,d=e.inputs[c],f=e.output,g=e.inputs.source.output,h=d.output;a[c](f,g,h),b.value=b.unscaledValue=f[f.length-1]},e.onInputChanged=function(){var a,b,c,d=Object.keys(e.inputs);for(a=0;a<d.length;a++)if(b=d[a],"source"!==b){e.activeInput=b,c="audio"===e.inputs[b].rate,e.gen="audio"===e.inputs.source.rate?c?e.arSourceArInputGen:e.arSourceKrInputGen:c?e.krSourceArInputGen:e.krSourceKrInputGen;break}},e.init=function(){if("undefined"==typeof a)throw new Error("ArrayMath is undefined. Please include webarraymath.js to use the flock.math unit generator.");e.onInputChanged()},e.init(),e},flock.ugenDefaults("flock.ugen.math",{rate:"audio",inputs:{source:null}}),flock.ugen.sum=function(a,b,c){var d=flock.ugen(a,b,c);return d.copyGen=function(a){var b,c,e=d.model,f=d.output,g=d.inputs.sources.output;for(b=0;a>b;b++)c=g[b],f[b]=c;e.unscaledValue=c,d.mulAdd(a),e.value=flock.ugen.lastOutputValue(a,f)},d.sumGen=function(a){var b,c,e,f=d.model,g=d.inputs.sources,h=d.output;for(flock.clearBuffer(h),c=0;c<g.length;c++)for(e=g[c].output,b=0;a>b;b++)h[b]+=e[b];f.unscaledValue=flock.ugen.lastOutputValue(a,h),d.mulAdd(a),f.value=flock.ugen.lastOutputValue(a,h)},d.onInputChanged=function(){"number"==typeof d.inputs.sources.length?d.gen=d.sumGen:d.gen=d.copyGen,flock.onMulAddInputChanged(d)},d.onInputChanged(),d},flock.ugenDefaults("flock.ugen.sum",{rate:"audio",inputs:{sources:null}})}();var fluid=fluid||require("infusion"),flock=fluid.registerNamespace("flock");!function(){"use strict";var a=fluid.registerNamespace("jQuery"),b=flock.requireModule("webarraymath","ArrayMath");flock.envelope={},flock.envelope.makeCreator=function(b,c){return function(d){var e=flock.ugenDefaults(b),f=a.extend(!0,{},e,d);return c(f)}},flock.envelope.registerCreators=function(a,b){var c,d;for(var e in b)c=fluid.pathUtil.composePath(a,e),d=b[e],flock.ugenDefaults(c,d.defaults),fluid.setGlobalValue(c,flock.envelope.makeCreator(c,d.transformer))},flock.envelope.creatorSpecs={line:{transformer:function(a){return{levels:[a.start,a.end],times:[a.duration]}},defaults:{start:0,end:1,duration:1}},linear:{transformer:function(a){return{levels:[0,a.level,a.level,0],times:[a.attack,a.sustain,a.release]}},defaults:{level:1,attack:.01,sustain:1,release:1}},tri:{transformer:function(a){return{levels:[0,a.level,0],times:[a.duration,a.duration]}},defaults:{level:1,duration:1}},sin:{transformer:function(a){return{levels:[0,a.level,0],times:[a.duration,a.duration],curve:"sin"}},defaults:{level:1,duration:1}},asr:{transformer:function(a){return{levels:[0,a.sustain,0],times:[a.attack,a.release],sustainPoint:1,curve:-4}},defaults:{sustain:1,attack:.01,release:1}},dadsr:{transformer:function(a){var c=[0,0,a.peak,a.peak*a.sustain,0];return b.add(c,a.bias,c),{levels:c,times:[a.delay,a.attack,a.decay,a.release],sustainPoint:3,curve:-4}},defaults:{delay:.1,attack:.01,decay:.3,sustain:.5,release:1,peak:1,bias:0}},adsr:{transformer:function(a){var c=[0,a.peak,a.peak*a.sustain,0];return b.add(c,a.bias,c),{levels:c,times:[a.attack,a.decay,a.release],sustainPoint:2,curve:-4}},defaults:{attack:.01,decay:.3,sustain:.5,release:1,peak:1,bias:0}}},flock.envelope.registerCreators("flock.envelope",flock.envelope.creatorSpecs),flock.envelope.validate=function(a,b){var c=a.levels,d={};if(a.times?!c||c.length<2?d.levels="An array containing at least two levels must be specified.":(flock.envelope.validate.times(a.times,c,d),flock.envelope.validate.levels(c,d),flock.envelope.validate.curves(a.curve,c,d),flock.envelope.validate.sustainPoint(a.sustainPoint,c,d)):d.times="An array containing at least one time value must be specified.",b!==!1)for(var e in d)flock.fail(d[e]);return d},flock.envelope.validate.times=function(a,b,c){a.length!==b.length-1&&(c.times="The envelope specification should provide one fewer time value than the number of level values. times: "+a+" levels: "+b);for(var d=0;d<a.length;d++){var e=a[d];isNaN(e)&&(c.times="A NaN time value was specified at index "+d+". times: "+a),0>e&&(c.times="All times should be positive values. times: "+a)}},flock.envelope.validate.levels=function(a,b){for(var c=0;c<a.length;c++)isNaN(a[c])&&(b.levels="A NaN level value was specified at index "+c+". levels: "+a)},flock.envelope.validate.curves=function(a,b,c){if(!a)return c;flock.isIterable(a)&&(a.length!==b.length-1&&(c.curve="When curve is specified as an array, there should be one fewer curve value than the number of level values. curve: "+a+" levels: "+b),fluid.each(a,function(b){var d=flock.lineGenerator(b);d||(c.curve="'"+b+"' is not a valid curve type. curve: "+a)}));var d=flock.lineGenerator(a);d||(c.curve="'"+a+"' is not a valid curve type.")},flock.envelope.validate.sustainPoint=function(a,b,c){(0>a||a>=b.length)&&(c.sustainPoint="The specified sustainPoint index is out range for the levels array. sustainPoint: "+a+" levels: "+b)},flock.envelope.expand=function(a){var b="string"==typeof a?fluid.invokeGlobalFunction(a):a.type?fluid.invokeGlobalFunction(a.type,[a]):a;if(b.curves&&!b.curve&&(b.curve=b.curves),!flock.isIterable(b.curve)){var c=b.levels.length-1;b.curve=flock.fillBufferWithValue(new Array(c),b.curve)}return flock.envelope.validate(b,!0),b},flock.fillBufferWithLine=function(a,b,c,d,e,f){e=void 0===e?0:e,f=void 0===f?b.length:f;var g=f-e,h=flock.fillBufferWithLine.singletonModel;h.unscaledValue=c,h.destination=d,h.numSegmentSamps=g-1,"number"==typeof a&&(h.currentCurve=a,a="curve");var i=flock.line[a];return i||flock.fail("No line generator could be found for type "+a),i.init(h),i.gen(g,e,b,h)},flock.fillBufferWithLine.singletonModel={unscaledValue:0,value:0,destination:1},flock.lineGenerator=function(a){var b=typeof a;return"string"===b?flock.line[a]:"number"===b?flock.line.curve:flock.line.linear},flock.line={constant:{init:function(a){a.stepSize=0},gen:function(a,b,c,d){for(var e=d.unscaledValue,f=b;a+b>f;f++)c[f]=e;return c}},step:{init:function(a){a.arrived=!1},gen:function(a,b,c,d){for(var e=b;a+b>e;e++)c[e]=d.unscaledValue,d.arrived||(d.arrived=!0,d.unscaledValue=d.destination);return c}},linear:{init:function(a){a.stepSize=(a.destination-a.unscaledValue)/a.numSegmentSamps},gen:function(a,b,c,d){for(var e=d.unscaledValue,f=d.stepSize,g=b;a+b>g;g++)c[g]=e,e+=f;return d.unscaledValue=e,c}},exponential:{init:function(a){0===a.unscaledValue&&(a.unscaledValue=1e-16),a.stepSize=0===a.numSegmentSamps?0:Math.pow(a.destination/a.unscaledValue,1/a.numSegmentSamps)},gen:function(a,b,c,d){for(var e=d.unscaledValue,f=d.stepSize,g=b;a+b>g;g++)c[g]=e,e*=f;return d.unscaledValue=e,d.stepSize=f,c}},curve:{init:function(a){if(Math.abs(a.currentCurve)<.001)return flock.line.linear.init(a);var b=(a.destination-a.unscaledValue)/(1-Math.exp(a.currentCurve));a.a2=a.unscaledValue+b,a.b1=b,a.stepSize=Math.exp(a.currentCurve/a.numSegmentSamps)},gen:function(a,b,c,d){for(var e=d.unscaledValue,f=d.b1,g=b;a+b>g;g++)c[g]=e,f*=d.stepSize,e=d.a2-f;return d.unscaledValue=e,d.b1=f,c}},sin:{init:function(a){var b=Math.PI/a.numSegmentSamps;a.a2=.5*(a.destination+a.unscaledValue),a.b1=2*Math.cos(b),a.y1=.5*(a.destination-a.unscaledValue),a.y2=a.y1*Math.sin(flock.HALFPI-b),a.unscaledValue=a.a2-a.y1},gen:function(a,b,c,d){for(var e,f=d.unscaledValue,g=d.y1,h=d.y2,i=b;a+b>i;i++)c[i]=f,e=d.b1*g-h,f=d.a2-e,h=g,g=e;return d.unscaledValue=f,d.y1=g,d.y2=h,c}},welsh:{init:function(a){var b=flock.HALFPI/a.numSegmentSamps,c=Math.cos(b);a.b1=2*c,a.destination>=a.unscaledValue?(a.a2=a.unscaledValue,a.y1=0,a.y2=-Math.sin(b)*(a.destination-a.unscaledValue)):(a.a2=a.destination,a.y1=a.unscaledValue-a.destination,a.y2=c*(a.unscaledValue-a.destination)),a.unscaledValue=a.a2+a.y1},gen:function(a,b,c,d){for(var e,f=d.unscaledValue,g=d.y1,h=d.y2,i=b;a+b>i;i++)c[i]=f,e=d.b1*g-h,h=g,g=e,f=d.a2+e;return d.unscaledValue=f,d.y1=g,d.y2=h,c}},squared:{init:function(a){a.y1=Math.sqrt(a.unscaledValue),a.y2=Math.sqrt(a.destination),a.stepSize=(a.y2-a.y1)/a.numSegmentSamps},gen:function(a,b,c,d){for(var e=d.unscaledValue,f=d.y1,g=b;a+b>g;g++)c[g]=e,f+=d.stepSize,e=f*f;return d.y1=f,d.unscaledValue=e,c}},cubed:{init:function(a){var b=.3333333333333333;a.y1=Math.pow(a.unscaledValue,b),a.y2=Math.pow(a.destination,b),a.stepSize=(a.y2-a.y1)/a.numSegmentSamps},gen:function(a,b,c,d){for(var e=d.unscaledValue,f=d.y1,g=b;a+b>g;g++)c[g]=e,f+=d.stepSize,e=f*f*f;return d.y1=f,d.unscaledValue=e,c}}},flock.ugen.line=function(a,b,c){var d=flock.ugen(a,b,c);return d.gen=function(a){var b,c=d.model,e=c.stepSize,f=c.numSteps,g=f>=a?a:f,h=a-g,i=c.level,j=d.output;for(b=0;g>b;b++)j[b]=i,f--,i+=e;if(h>0)for(b=0;h>b;b++)j[b]=i;c.level=c.unscaledValue=i,c.numSteps=f,d.mulAdd(a),c.value=flock.ugen.lastOutputValue(a,j)},d.onInputChanged=function(){var a=d.model;a.start=d.inputs.start.output[0],a.end=d.inputs.end.output[0],a.numSteps=Math.round(d.inputs.duration.output[0]*a.sampleRate),0===a.numSteps?(a.stepSize=0,a.level=a.end):(a.stepSize=(a.end-a.start)/a.numSteps,a.level=a.start),flock.onMulAddInputChanged(d)},d.onInputChanged(),d},flock.ugenDefaults("flock.ugen.line",{rate:"control",inputs:{start:0,end:1,duration:1,mul:null,add:null},ugenOptions:{model:{start:0,end:1,numSteps:0,stepSize:0,level:0,unscaledValue:0,value:0}}}),flock.ugen.xLine=function(a,b,c){var d=flock.ugen(a,b,c);return d.gen=function(a){var b,c=d.model,e=c.multiplier,f=c.numSteps,g=f>=a?a:f,h=a-g,i=c.level,j=d.output;for(b=0;g>b;b++)j[b]=i,f--,i*=e;if(h>0)for(b=0;h>b;b++)j[b]=i;c.level=c.unscaledValue=i,c.numSteps=f,d.mulAdd(a),c.value=flock.ugen.lastOutputValue(a,j)},d.onInputChanged=function(){var a=d.model;flock.onMulAddInputChanged(d),a.start=d.inputs.start.output[0],0===a.start&&(a.start=1e-101),a.end=d.inputs.end.output[0],a.numSteps=Math.round(d.inputs.duration.output[0]*a.sampleRate),a.multiplier=Math.pow(a.end/a.start,1/a.numSteps),a.level=a.start},d.onInputChanged(),d},flock.ugenDefaults("flock.ugen.xLine",{rate:"control",inputs:{start:0,end:1,duration:1,mul:null,add:null},ugenOptions:{model:{start:0,end:1,numSteps:0,multiplier:0,level:0,unscaledValue:0,value:0}}}),flock.ugen.asr=function(a,b,c){var d=flock.ugen(a,b,c);return d.gen=function(a){var b,c,e=d.model,f=d.output,g=e.previousGate,h=d.inputs.gate.output[0],i=e.level,j=e.stage,k=j.currentStep,l=j.stepInc,m=j.numSteps,n=e.targetLevel,o=!1;for(0>=g&&h>0?(n=d.inputs.sustain.output[0],b=d.inputs.attack.output[0],o=!0):0>=h&&k>=m&&(n=d.inputs.start.output[0],b=d.inputs.release.output[0],o=!0),o&&(m=Math.round(b*e.sampleRate),l=(n-i)/m,k=0),c=0;a>c;c++)f[c]=i,k++,i=m>k?i+l:k===m?n:i;e.level=e.unscaledValue=i,e.targetLevel=n,e.previousGate=h,j.currentStep=k,j.stepInc=l,j.numSteps=m,d.mulAdd(a),e.value=flock.ugen.lastOutputValue(a,f)},d.init=function(){var a=d.model;a.level=a.unscaledValue=d.inputs.start.output[0],a.targetLevel=d.inputs.sustain.output[0],d.onInputChanged()},d.init(),d},flock.ugenDefaults("flock.ugen.asr",{rate:"control",inputs:{start:0,attack:.01,sustain:1,release:1,gate:0,mul:null,add:null},ugenOptions:{model:{level:0,targetLevel:0,previousGate:0,unscaledValue:0,value:0,stage:{currentStep:0,stepInc:0,numSteps:0}}}}),flock.ugen.env={},flock.ugen.env.simpleASR=flock.ugen.asr,flock.ugenDefaults("flock.ugen.env.simpleASR",fluid.copy(flock.ugenDefaults("flock.ugen.asr"))),flock.ugen.envGen=function(a,b,c){var d=flock.ugen(a,b,c);return d.krGen=function(a){var b,c=d.model,e=d.output,f=d.inputs,g=f.gate.output[0],h=f.timeScale.output[0],i=0;for(flock.ugen.envGen.checkGate(d,g,h);a>i;)b=Math.min(a-i,c.numSegmentSamps),d.lineGen.gen(b,i,e,c),i+=b,c.numSegmentSamps-=b,c.numSegmentSamps<=0&&flock.ugen.envGen.nextStage(d,h);d.mulAdd(a),c.value=flock.ugen.lastOutputValue(a,e)},d.arGen=function(a){var b,c=d.model,e=d.output,f=d.inputs,g=f.gate.output,h=f.timeScale.output[0];for(b=0;a>b;b++)flock.ugen.envGen.checkGate(d,g[b],h),d.lineGen.gen(1,b,e,c),c.numSegmentSamps--,c.numSegmentSamps<=0&&flock.ugen.envGen.nextStage(d,h);d.mulAdd(a),c.value=flock.ugen.lastOutputValue(a,e)},d.onInputChanged=function(a){a&&"envelope"!==a||(d.envelope=flock.ugen.envGen.initEnvelope(d,d.inputs.envelope)),a&&"gate"!==a||(d.gen=d.inputs.gate.rate===flock.rates.AUDIO?d.arGen:d.krGen),flock.onMulAddInputChanged(d)},d.onInputChanged(),d},flock.ugen.envGen.initEnvelope=function(a,b){var c=a.model,d=flock.envelope.expand(b);return c.stage=0,c.numStages=d.times.length,a.lineGen=flock.line.constant,flock.ugen.envGen.lineGenForStage(a.inputs.timeScale.output[0],d,c),c.unscaledValue=d.levels[c.stage],d},flock.ugen.envGen.checkGate=function(a,b,c){var d=a.model,e=a.envelope;b!==d.previousGate&&(b>0&&d.previousGate<=0?(d.stage=1,a.lineGen=flock.ugen.envGen.lineGenForStage(c,e,d)):0>=b&&d.previousGate>0&&(d.stage=d.numStages,a.lineGen=flock.ugen.envGen.lineGenForStage(c,e,d))),d.previousGate=b},flock.ugen.envGen.nextStage=function(a,b){var c=a.model,d=a.envelope;c.stage===d.sustainPoint?(a.lineGen=flock.line.constant,c.numSegmentSamps=1/0,c.destination=c.unscaledValue):(c.stage++,a.lineGen=flock.ugen.envGen.lineGenForStage(b,d,c))},flock.ugen.envGen.setupStage=function(a,b,c){var d,e,f=b.levels[c.stage];0===c.stage||c.stage>c.numStages?e=1/0:(d=b.times[c.stage-1]*a,e=Math.max(1,Math.round(d*c.sampleRate))),c.numSegmentSamps=e,c.destination=f},flock.ugen.envGen.lineGenForStage=function(a,b,c){var d,e,f=b.curve;return 0===c.stage||c.stage>c.numStages?d=flock.line.constant:(e=f[c.stage-1],c.currentCurve=e,d=flock.lineGenerator(e)),flock.ugen.envGen.setupStage(a,b,c),d.init(c),d},flock.ugenDefaults("flock.ugen.envGen",{rate:"audio",inputs:{envelope:"flock.envelope.adsr",gate:0,timeScale:1,mul:null,add:null},ugenOptions:{model:{previousGate:0,stepSize:0,destination:0,numSegmentSamps:1,unscaledValue:0,value:0,stage:0,numStages:0}}}),flock.ugen.phasor=function(a,b,c){var d=flock.ugen(a,b,c);return d.gen=function(a){var b,c,e,f=d.model,g=d.inputs,h=d.output,i=g.step.output,j=g.trigger.output;for(void 0===f.unscaledValue&&(f.unscaledValue=g.start.output[0]),b=0,c=0,e=0;a>b;b++,c+=f.strides.trigger,e+=f.strides.step)j[c]>0&&f.prevTrig<=0&&(f.unscaledValue=g.reset.output[0]),f.prevTrig=j[c],f.unscaledValue>=g.end.output[0]&&(f.unscaledValue=g.start.output[0]),h[b]=f.unscaledValue,f.unscaledValue+=i[e];d.mulAdd(a),f.value=flock.ugen.lastOutputValue(a,h)},d.onInputChanged(),d},flock.ugenDefaults("flock.ugen.phasor",{rate:"control",inputs:{start:0,end:1,reset:0,step:.1,trigger:0,mul:null,add:null},ugenOptions:{model:{unscaledValue:void 0,value:0},strideInputs:["trigger","step"]}})}();var fluid=fluid||require("infusion"),flock=fluid.registerNamespace("flock");!function(){"use strict";flock.ugen.midiFreq=function(a,b,c){var d=flock.ugen(a,b,c);return d.gen=function(a){var b,c,e,f=d.model,g=f.a4,h=g.freq,i=g.noteNum,j=f.notesPerOctave,k=d.inputs.note.output,l=d.output;for(b=0,c=0;a>b;b++,c+=f.strides.note)l[b]=e=flock.midiFreq(k[c],h,i,j);f.unscaledValue=e,d.mulAdd(a),f.value=flock.ugen.lastOutputValue(a,l)},d.init=function(){d.model.octaveScale=1/d.model.notesPerOctave,d.onInputChanged()},d.init(),d},flock.ugenDefaults("flock.ugen.midiFreq",{rate:"control",inputs:{note:69},ugenOptions:{model:{unscaledValue:0,value:0,a4:{noteNum:69,freq:440},notesPerOctave:12},strideInputs:["note"]}}),flock.ugen.midiAmp=function(a,b,c){var d=flock.ugen(a,b,c);return d.gen=function(a){var b,c,e,f=d.model,g=d.inputs.velocity.output,h=d.output;for(b=0,c=0;a>b;b++,c+=f.strides.velocity)h[b]=e=g[c]/127;f.unscaledValue=e,d.mulAdd(a),f.value=flock.ugen.lastOutputValue(a,h)},d.init=function(){d.onInputChanged()},d.init(),d},flock.ugenDefaults("flock.ugen.midiAmp",{rate:"control",inputs:{velocity:0},ugenOptions:{model:{unscaledValue:0,value:0},strideInputs:["velocity"]}})}();var fluid=fluid||require("infusion"),flock=fluid.registerNamespace("flock");!function(){"use strict";flock.ugen.change=function(a,b,c){var d=flock.ugen(a,b,c);return d.gen=function(a){for(var b,c=d.model,e=d.inputs.initial.output,f=c.strides.initial,g=d.inputs.target.output,h=c.strides.target,i=d.output,j=c.samplesLeft,k=c.crossfadeLevel,l=0,m=0,n=0;a>l;l++,m+=f,n+=h)j>0?(b=e[m],j--):k>0?(b=e[m]*k+g[n]*(1-k),k-=c.crossfadeStepSize):b=g[n],i[l]=b;c.samplesLeft=j,c.crossfadeLevel=k,c.value=c.unscaledValue=b},d.onInputChanged=function(a){var b=d.model,c=d.inputs;"time"!==a&&a||(b.samplesLeft=Math.round(c.time.output[0]*b.sampleRate)),"crossfade"!==a&&a||(b.crossfadeStepSize=1/Math.round(c.crossfade.output[0]*b.sampleRate),b.crossfadeLevel=c.crossfade.output[0]>0?1:0),d.calculateStrides()},d.onInputChanged(),d},flock.ugenDefaults("flock.ugen.change",{rate:"audio",inputs:{initial:0,target:0,time:0,crossfade:0},ugenOptions:{model:{samplesLeft:0,crossfadeStepSize:0,crossfadeLevel:0,unscaledValue:0,value:0},strideInputs:["initial","target"]
}}),flock.ugen.listItem=function(a,b,c){var d=flock.ugen(a,b,c);return d.gen=function(a){var b,c,e,f,g=d.model,h=d.output,i=d.inputs.list,j=i.length-1,k=d.inputs.index.output;for(b=0,e=0;a>b;b++,e+=g.strides.index)f=Math.round(k[e]*j),f=Math.max(0,f),f=Math.min(f,j),c=i[f],h[b]=c;g.unscaledValue=c,d.mulAdd(a),g.value=flock.ugen.lastOutputValue(a,h)},d.onInputChanged(),d},flock.ugenDefaults("flock.ugen.listItem",{rate:"control",inputs:{index:0,list:[0]},ugenOptions:{strideInputs:["index"]}}),flock.ugen.sequence=function(a,b,c){var d=flock.ugen(a,b,c);return d.gen=function(a){var b,c,e,f=d.inputs.values,g=d.inputs,h=g.freq.output,i=g.loop.output[0],j=d.model,k=j.scale,l=d.output,m=g.start?Math.round(g.start.output[0]):0,n=g.end?Math.round(g.end.output[0]):f.length;for(void 0===j.unscaledValue&&(b=f[m],j.unscaledValue=void 0===b?0:b),void 0===j.nextIdx&&(j.nextIdx=m),c=0,e=0;a>c;c++,e+=j.strides.freq){if(j.nextIdx>=n){if(!(i>0)){l[c]=j.unscaledValue;continue}j.nextIdx=m}l[c]=j.unscaledValue=f[j.nextIdx],j.phase+=h[e]*k,j.phase>=1&&(j.phase=0,j.nextIdx++)}d.mulAdd(a),j.value=flock.ugen.lastOutputValue(a,l)},d.onInputChanged=function(){d.model.scale=d.rate!==flock.rates.DEMAND?d.model.sampleDur:1,d.inputs.values&&0!==d.inputs.values.length||!d.inputs.list||(flock.log.warn("The 'list' input to flock.ugen.sequence is deprecated. Use 'values' instead."),d.inputs.values=d.inputs.list),d.inputs.values||(d.inputs.values=[]),d.calculateStrides(),flock.onMulAddInputChanged(d)},d.init=function(){d.onInputChanged()},d.init(),d},flock.ugenDefaults("flock.ugen.sequence",{rate:"control",inputs:{start:0,freq:1,loop:0,values:[]},ugenOptions:{model:{unscaledValue:void 0,value:0,phase:0},strideInputs:["freq"]}}),flock.ugen.sequencer=function(a,b,c){var d=flock.ugen(a,b,c);return d.gen=function(a){var b,c,e=d.model,f=d.options,g=f.resetOnNext,h=d.output,i=d.inputs.loop.output[0],j=d.inputs.durations,k=d.inputs.values;for(e.shouldValidateSequences&&(e.shouldValidateSequences=!1,flock.ugen.sequencer.validateSequences(j,k)),b=0;a>b;b++)0!==k.length&&0!==j.length?(e.samplesRemaining<=0?e.idx<j.length-1?(e.idx++,c=flock.ugen.sequencer.nextStage(j,k,g,e)):i>0?(e.idx=0,c=flock.ugen.sequencer.nextStage(j,k,g,e)):c=f.holdLastValue?e.unscaledValue:0:(c=k[e.idx],e.samplesRemaining--),h[b]=c):h[b]=c=0;e.unscaledValue=c,d.mulAdd(a),e.value=flock.ugen.lastOutputValue(a,h)},d.onInputChanged=function(a){var b=d.model,c=d.inputs;"durations"!==a&&c.durations===b.prevDurations||(b.idx=0,flock.ugen.sequencer.calcDurationsSamps(c.durations,d.model),flock.ugen.sequencer.validateInput("durations",d),b.prevDurations=c.durations),"values"!==a&&c.values===b.prevValues||(b.idx=0,flock.ugen.sequencer.validateInput("values",d),b.prevValues=c.values),d.model.shouldValidateSequences=!0,flock.onMulAddInputChanged(d)},d.init=function(){d.onInputChanged()},d.init(),d},flock.ugen.sequencer.validateInput=function(a,b){var c=b.inputs[a];c&&flock.isIterable(c)||flock.fail("No "+a+" array input was specified for flock.ugen.sequencer: "+fluid.prettyPrintJSON(b.options.ugenDef))},flock.ugen.sequencer.validateSequences=function(a,b){a.length!==b.length&&flock.fail("Mismatched durations and values array lengths for flock.ugen.sequencer. Durations: "+fluid.prettyPrintJSON(a)+", values: "+fluid.prettyPrintJSON(b))},flock.ugen.sequencer.calcDurationsSamps=function(a,b){b.samplesRemaining=Math.floor(a[b.idx]*b.sampleRate)},flock.ugen.sequencer.nextStage=function(a,b,c,d){return flock.ugen.sequencer.calcDurationsSamps(a,d),d.samplesRemaining--,c?0:b[d.idx]},flock.ugenDefaults("flock.ugen.sequencer",{rate:"audio",inputs:{durations:[],values:[],loop:0},ugenOptions:{model:{idx:0,samplesRemaining:0,unscaledValue:0,value:0,prevDurations:[],prevValues:[]},resetOnNext:!1,holdLastvalue:!1}})}(),function(a,b){"use strict";b.defaults("floe.chartAuthoring.axis",{invokers:{manageAxis:{funcName:"floe.chartAuthoring.axis.manageAxis",args:["{that}","{arguments}.0","{arguments}.1","{arguments}.2","{arguments}.3"]}}}),floe.chartAuthoring.axis.manageAxis=function(a,b,c,d,e){var f=a.options.lineOptions.transitionLength,g=!(a.locate(b).length>0);g?a.svg.append("g").attr({transform:d,"class":c}).call(e):a.svg.select("."+c).transition().duration(f).call(e)}}(jQuery,fluid),function(a,b){"use strict";b.defaults("floe.chartAuthoring",{gradeNames:["fluid.viewComponent"],selectors:{chartTitle:".floec-chartTitle",chartDescription:".floec-chartDescription",dataEntryPanel:".floec-dataEntryPanel",pieChart:".floec-pieChart",sonifierPlay:".floec-sonifierPlay",sonifierStop:".floec-sonifierStop"},components:{templateLoader:{type:"fluid.prefs.resourceLoader",options:{events:{onResourcesLoaded:"{chartAuthoring}.events.onTemplatesLoaded"}}},chartAuthoringInterface:{type:"floe.chartAuthoring.templateInjection",createOnEvent:"onTemplatesLoaded",container:"{that}.dom.container",options:{selectors:{reset:".floec-ca-dataEntryPanel-reset"},styles:{reset:"floe-ca-dataEntryPanel-reset"},resources:{template:"{templateLoader}.resources.chartAuthoringInterface"},listeners:{"onTemplateInjected.escalate":"{chartAuthoring}.events.onChartAuthoringInterfaceReady.fire","onCreate.bindResetClick":{"this":"{that}.dom.reset",method:"click",args:["{chartAuthoring}.resetDataEntryPanel"]}},components:{chartTitle:{type:"fluid.inlineEdit",container:"{chartAuthoring}.dom.chartTitle",createOnEvent:"{chartAuthoring}.events.onPieChartReady",options:{strings:{defaultViewText:"{floe.chartAuthoring}.options.strings.defaultTitleText"},listeners:{"afterFinishEdit.modelChange":{func:"{pieChart}.applier.change",args:["svgTitle","{arguments}.0"]}}}},chartDescription:{type:"fluid.inlineEdit",container:"{chartAuthoring}.dom.chartDescription",createOnEvent:"{chartAuthoring}.events.onPieChartReady",options:{strings:{defaultViewText:"{floe.chartAuthoring}.options.strings.defaultDescriptionText"},listeners:{"afterFinishEdit.modelChange":{func:"{pieChart}.applier.change",args:["svgDescription","{arguments}.0"]}}}},dataEntryPanel:{type:"floe.chartAuthoring.dataEntryPanel",createOnEvent:"{chartAuthoring}.events.onPieChartReady",container:"{chartAuthoring}.dom.dataEntryPanel",options:{resources:{template:"{templateLoader}.resources.dataEntryPanel",dataEntry:"{templateLoader}.resources.dataEntry"},modelRelay:{source:"{that}.model.dataSet",target:"{pieChart}.model.dataSet",singleTransform:{type:"fluid.transforms.free",args:["{that}.model.dataSet"],func:"floe.chartAuthoring.dataEntriesToPieChartData"}},listeners:{"onCreate.escalate":{funcName:"{chartAuthoring}.events.onPanelReady.fire"}}}},pieChart:{type:"floe.chartAuthoring.pieChart",createOnEvent:"{chartAuthoring}.events.onChartAuthoringInterfaceReady",container:"{chartAuthoring}.dom.pieChart",options:{resources:{template:"{templateLoader}.resources.pieChart"},listeners:{"onPieChartReady.escalate":"{chartAuthoring}.events.onPieChartReady.fire"}}},sonifier:{type:"floe.chartAuthoring.sonifier",createOnEvent:"{chartAuthoring}.events.onPanelReady",options:{model:{dataSet:"{dataEntryPanel}.model.dataSet"},listeners:{"onCreate.escalate":{funcName:"{chartAuthoring}.events.onSonifierReady.fire"}},modelRelay:{source:"{that}.model.currentlyPlayingData",target:"{floe.chartAuthoring.pieChart}.model.activeDataId",singleTransform:{type:"fluid.transforms.free",args:"{that}.model.currentlyPlayingData",func:"floe.d3.idExtractor"}}}}}}}},events:{onTemplatesLoaded:null,onChartAuthoringInterfaceReady:null,onPanelReady:null,onPieChartReady:null,onSonifierReady:null,onToolReady:{events:{onPanelReady:"onPanelReady",onPieChartReady:"onPieChartReady",onSonifierReady:"onSonifierReady"},args:["{that}"]}},listeners:{"onToolReady.addAriaConnections":"floe.chartAuthoring.addAriaConnections","onToolReady.bindPlayClick":{"this":"{that}.dom.sonifierPlay",method:"click",args:["{chartAuthoringInterface}.sonifier.events.onSonificationRequested.fire"]},"onToolReady.bindStopClick":{"this":"{that}.dom.sonifierStop",method:"click",args:["{chartAuthoringInterface}.sonifier.stopSonification"]}},invokers:{updateDataEntryPanelFromDataSet:{funcName:"floe.chartAuthoring.updateDataEntryPanelFromDataSet",args:["{that}","{arguments}.0"]},resetDataEntryPanel:{funcName:"floe.chartAuthoring.updateDataEntryPanelFromDataSet",args:["{that}",[]]}},strings:{defaultTitleText:"Enter Chart Title",defaultDescriptionText:"Enter Chart Description"},templateLoader:{terms:{templatePrefix:""},resources:{chartAuthoringInterface:"%templatePrefix/chartAuthoringInterfaceTemplate.html",dataEntryPanel:"%templatePrefix/dataEntryPanelTemplate.html",dataEntry:"%templatePrefix/dataEntryTemplate.html",pieChart:"%templatePrefix/pieChartTemplate.html"}},inlineEditCommonOptions:{selectors:{text:".floec-inlineEdit-text"},styles:{text:"floe-inlineEdit-text"}},distributeOptions:[{source:"{that}.options.templateLoader",removeSource:!0,target:"{that > templateLoader}.options"},{source:"{that}.options.pieChart",removeSource:!0,target:"{that pieChart}.options"},{source:"{that}.options.dataEntryPanel",removeSource:!0,target:"{that dataEntryPanel}.options"},{source:"{that}.options.inlineEditCommonOptions",removeSource:!0,target:"{that fluid.inlineEdit}.options"}]}),floe.chartAuthoring.dataEntriesToPieChartData=function(a){var c=[];return b.each(a,function(a,b){var d={id:b,label:a.label,value:a.value};null!==d.value&&c.push(d)}),c},floe.chartAuthoring.addAriaConnections=function(a){var c=b.allocateSimpleId(a.chartAuthoringInterface.pieChart.legend.locate("table")),d=b.allocateSimpleId(a.chartAuthoringInterface.pieChart.pie.locate("pie")),e=b.allocateSimpleId(a.chartAuthoringInterface.dataEntryPanel.locate("totalValue")),f=b.allocateSimpleId(a.chartAuthoringInterface.dataEntryPanel.locate("dataEntryForm"));a.chartAuthoringInterface.dataEntryPanel.locate("dataEntryForm").attr("aria-controls",c+" "+d+" "+e),a.chartAuthoringInterface.locate("reset").attr("aria-controls",f+" "+c+" "+d+" "+e)},floe.chartAuthoring.updateDataEntryPanelFromDataSet=function(b,c){var d=b.chartAuthoringInterface.dataEntryPanel.locate("dataEntry"),e=b.chartAuthoringInterface.dataEntryPanel.dataEntry.options.selectors.label,f=b.chartAuthoringInterface.dataEntryPanel.dataEntry.options.selectors.value;d.each(function(b){var d=void 0!==c[b]?c[b]:{label:"",value:""};a(this).find(e).val(d.label).trigger("change"),a(this).find(f).val(d.value).trigger("change")})}}(jQuery,fluid),function(a,b){"use strict";b.registerNamespace("floe.d3"),floe.d3.jQueryToD3=function(a){return d3.selectAll(a.toArray())},floe.d3.idExtractor=function(a){return b.get(a,"id")||b.get(a,"data.id")},floe.d3.addD3Listeners=function(a,c,d,e){var f=floe.d3.jQueryToD3(a);f.on(c,function(a,c){b.invokeGlobalFunction(d,[a,c,e])})},floe.d3.getColorScale=function(a){return a?d3.scale.ordinal().range(a):d3.scale.category10()}}(jQuery,fluid),function(a,b){"use strict";b.defaults("floe.d3ViewComponent",{gradeNames:["fluid.viewComponent"],members:{classes:{expander:{funcName:"floe.d3ViewComponent.synthesizeClasses",args:["{that}.options.styles","{that}.options.selectors"]}}},model:{dataKeys:{}},invokers:{jQueryToD3:{funcName:"floe.d3.jQueryToD3",args:["{arguments}.0"]},addD3Listeners:{funcName:"floe.d3.addD3Listeners",args:["{arguments}.0","{arguments}.1","{arguments}.2","{that}"]},addElementIdToDataKey:{funcName:"floe.d3ViewComponent.addElementIdToDataKey",args:["{arguments}.0","{arguments}.1","{that}"]},removeElementIdFromDataKey:{funcName:"floe.d3ViewComponent.removeElementIdFromDataKey",args:["{arguments}.0","{arguments}.1","{that}"]},getElementsByDataKey:{funcName:"floe.d3ViewComponent.getElementsByDataKeys",args:[["{arguments}.0"],"{that}"]},trackD3BoundElement:{funcName:"floe.d3ViewComponent.trackD3BoundElement",args:["{arguments}.0","{arguments}.1","{that}"]},exitD3Elements:{funcName:"floe.d3ViewComponent.exitD3Elements",args:["{arguments}.0","{that}"]}}}),floe.d3ViewComponent.isCssClass=function(a){a=a.trim();var b=/^\.[_a-zA-Z]+[_a-zA-Z0-9-]*$/;return b.test(a)},floe.d3ViewComponent.extractSelectorName=function(a){return a?(a=a.trim(),floe.d3ViewComponent.isCssClass(a)?a.substring(1):void b.fail(a+" is not a css class")):void 0},floe.d3ViewComponent.removeArrayDuplicates=function(a){return a.filter(function(a,b,c){return c.indexOf(a)===b})},floe.d3ViewComponent.synthesizeClasses=function(a,c){var d=b.transform(c,function(a){return[floe.d3ViewComponent.extractSelectorName(a)]});d=d||{},b.each(a,function(a,c){var e=a.split(" "),f=b.get(d,c);f&&(e=f.concat(e));var g=floe.d3ViewComponent.removeArrayDuplicates(e);b.set(d,c,g)});var e=b.transform(d,function(a){return a.join(" ")});return e},floe.d3ViewComponent.getTemplatedDisplayValue=function(a,c,d,e){var f=floe.chartAuthoring.percentage.calculate(e.value,a),g=null!==f?f.toFixed(c):f,h=b.stringTemplate(d,{label:e.label,value:e.value,percentage:g,total:a});return h},floe.d3ViewComponent.addElementIdToDataKey=function(a,b,c){var d=["dataKeys",a,b];c.applier.change(d,!0)},floe.d3ViewComponent.removeElementIdFromDataKey=function(a,b,c){var d=["dataKeys",a,b];c.applier.change(d,!1,"DELETE")},floe.d3ViewComponent.getElementsByDataKeys=function(c,d){var e,f=function(b){var c=a(b);return e=void 0!==e?e.add(c):c};return b.each(c,function(a){var c=b.get(d.model.dataKeys,a),g=b.transform(b.keys(c),b.byId);e=b.accumulate(g,f,e)}),e},floe.d3ViewComponent.toggleCSSClassByDataId=function(c,d,e){var f=floe.d3ViewComponent.getElementsByDataKeys(b.keys(e.model.dataKeys),e);f.each(function(b,e){var f=floe.d3.idExtractor(e.__data__),g=c===f;a(e).toggleClass(d,g),e.classList[g?"add":"remove"](d)})},floe.d3ViewComponent.trackD3BoundElement=function(a,c,d){var e=b.allocateSimpleId(c);d.addElementIdToDataKey(a,e)},floe.d3ViewComponent.exitD3Elements=function(a,b){a.each(function(a){b.removeElementIdFromDataKey(floe.d3.idExtractor(a.id),this.id)}),a.remove()}}(jQuery,fluid),function(a,b){"use strict";b.defaults("floe.chartAuthoring.dataEntry",{gradeNames:["floe.chartAuthoring.templateInjection","floe.chartAuthoring.valueBinding"],selectors:{value:".floec-ca-dataEntry-value",percentage:".floec-ca-dataEntry-percentage",label:".floec-ca-dataEntry-label"},strings:{valueInputPlaceholder:"Value",labelInputPlaceholder:"Label",percentage:"%percentage%",valueInputAriaLabel:"Value",labelInputAriaLabel:"Label"},model:{value:null,label:"",percentage:null,total:null},modelRelay:[{source:"value",target:"value",singleTransform:{type:"floe.chartAuthoring.transforms.stringToNumber"}},{source:"",target:"percentage",singleTransform:{type:"floe.chartAuthoring.transforms.percentage",value:"{that}.model.value",total:"{that}.model.total"}}],bindings:{value:"value",label:"label"},percentageDigits:2,invokers:{updatePercentage:{funcName:"floe.chartAuthoring.percentage.render",args:["{that}.dom.percentage","{that}.model.percentage","{that}.options.strings.percentage","{that}.options.percentageDigits"]}},listeners:{"onCreate.updatePercentage":"{that}.updatePercentage","onCreate.setInputAttrs":{"this":"{that}.dom.value",method:"attr",args:{placeholder:"{that}.options.strings.valueInputPlaceholder","aria-label":"{that}.options.strings.valueInputAriaLabel"}},"onCreate.setLabelAttrs":{"this":"{that}.dom.label",method:"attr",args:{placeholder:"{that}.options.strings.labelInputPlaceholder","aria-label":"{that}.options.strings.labelInputAriaLabel"}}},modelListeners:{value:{listener:"{that}.updatePercentage",excludeSource:"init"},total:{listener:"{that}.updatePercentage",excludeSource:"init"}}})}(jQuery,fluid),function(a,b){"use strict";b.defaults("floe.chartAuthoring.dataEntryPanel",{gradeNames:["floe.chartAuthoring.totalRelaying","floe.chartAuthoring.templateInjection"],selectors:{dataEntryForm:".floec-ca-dataEntryPanel-dataEntryForm",dataEntryLabel:".floec-ca-dataEntryPanel-dataEntryLabel",dataEntries:".floec-ca-dataEntryPanel-dataEntries",dataEntry:".floec-ca-dataEntryPanel-dataEntry",totalValue:".floec-ca-dataEntryPanel-totalValue",totalPercentage:".floec-ca-dataEntryPanel-totalPercentage",totalLabel:".floec-ca-dataEntryPanel-totalLabel"},strings:{dataEntryLabel:"Enter your labels and values",emptyTotalValue:"Value",totalPercentage:"%percentage%",totalLabel:"Total"},dynamicComponents:{dataEntry:{createOnEvent:"createDataEntryField",type:"floe.chartAuthoring.dataEntry",container:"{arguments}.0",options:{gradeNames:["{that}.generateModelRelaysConnectionGrade"],invokers:{generateModelRelaysConnectionGrade:{funcName:"floe.chartAuthoring.dataEntryPanel.generateModelRelaysConnectionGrade",args:["{that}.nickName","{that}.id",["dataEntries"]]}},resources:{template:"{dataEntryPanel}.options.resources.dataEntry"}}}},model:{total:{},dataSet:{}},numDataEntryFields:5,events:{createDataEntryField:null},listeners:{"onCreate.renderPanel":"floe.chartAuthoring.dataEntryPanel.renderPanel"},modelListeners:{total:{listener:"floe.chartAuthoring.dataEntryPanel.renderTotals",args:["{that}"]}},resources:{template:{},dataEntry:{}}}),floe.chartAuthoring.dataEntryPanel.generateModelRelaysConnectionGrade=function(a,c){var d="floe.chartAuthoring.dataEntryPanel.modelRelayConnections."+b.allocateGuid(),e="{dataEntryPanel}.model.dataSet."+a+"-"+c+".";return b.defaults(d,{model:{value:e+"value",percentage:e+"percentage",label:e+"label"},modelRelay:{source:"{dataEntryPanel}.model.total.value",target:"total",backward:"never",singleTransform:{type:"fluid.transforms.identity"}}}),d},floe.chartAuthoring.dataEntryPanel.append=function(b,c){return c=a(c).clone(),b.append(c),c},floe.chartAuthoring.dataEntryPanel.renderPanel=function(a){a.locate("dataEntryLabel").text(a.options.strings.dataEntryLabel);var c=a.locate("totalLabel");c.text(a.options.strings.totalLabel);var d=b.allocateSimpleId(c),e=a.locate("totalValue");e.attr({"aria-labelledby":d,"aria-live":"polite"});for(var f=a.locate("dataEntry").remove(),g=1;g<=a.options.numDataEntryFields;g++){var h=floe.chartAuthoring.dataEntryPanel.append(a.locate("dataEntries"),f);a.events.createDataEntryField.fire(h)}},floe.chartAuthoring.dataEntryPanel.renderTotals=function(a){var c,d,e=a.model.total.value;b.isValue(e)?(c=a.model.total.percentage,d=e):(c="",d=a.options.strings.emptyTotalValue),a.locate("totalValue").text(d),floe.chartAuthoring.percentage.render(a.locate("totalPercentage"),c,a.options.strings.totalPercentage)}}(jQuery,fluid),function(a,b){"use strict";b.defaults("floe.chartAuthoring.electricPianoBand",{gradeNames:["flock.band"],components:{midiNoteSynth:{type:"floe.chartAuthoring.midiNoteSynth"},pianoEnvelopeSynth:{type:"floe.chartAuthoring.pianoEnvelopeSynth"},carrierSynth:{type:"floe.chartAuthoring.carrierSynth"}}}),b.defaults("flock.interconnectOutputSynth",{gradeNames:["flock.modelSynth"],outputBus:"@expand:{flock.enviro}.busManager.acquireNextBus(interconnect)",synthDef:{ugen:"flock.ugen.out",bus:"{that}.options.outputBus",expand:1,sources:"{that}.options.ugenDef"}}),b.defaults("floe.chartAuthoring.midiNoteSynth",{gradeNames:["flock.interconnectOutputSynth"],ugenDef:{id:"freq",ugen:"flock.ugen.midiFreq",rate:"control",note:{id:"noteSequencer",ugen:"flock.ugen.sequencer"}},addToEnvironment:"head"}),b.defaults("floe.chartAuthoring.carrierSynth",{gradeNames:["flock.modelSynth"],ugenDef:{ugen:"flock.ugen.sinOsc",phase:0,freq:{ugen:"flock.ugen.in",bus:"{midiNoteSynth}.options.outputBus"},mul:{ugen:"flock.ugen.in",bus:"{pianoEnvelopeSynth}.options.outputBus"}},phases:[0,.5,.25],synthDef:{ugen:"flock.ugen.sum",sources:{expander:{funcName:"floe.chartAuthoring.carrierSynth.additiveExpander",args:["{that}.options.phases","{that}.options.ugenDef"]}}}}),floe.chartAuthoring.carrierSynth.additiveExpander=function(a,c){return b.transform(a,function(a){var d=b.copy(c);return d.phase=a,d})},b.defaults("floe.chartAuthoring.pianoEnvelopeSynth",{gradeNames:["flock.interconnectOutputSynth"],ugenDef:{ugen:"flock.ugen.envGen",envelope:{levels:[0,1,0],times:[.01,.05],curves:["linear",-5],sustainPoint:1},gate:{id:"envelopeSequencer",ugen:"flock.ugen.sequencer"},mul:.05},addToEnviroment:"head"})}(jQuery,fluid),function(a,b){"use strict";b.defaults("floe.chartAuthoring.pieChart.legend",{gradeNames:["floe.chartAuthoring.totalRelaying","floe.d3ViewComponent"],strings:{legendColHeading:"Legend",labelColHeading:"Label",valueColHeading:"Value"},model:{dataSet:[]},legendOptions:{colors:null,sort:!0,showLegendHeadings:!0,labelTextDisplayTemplate:"%label",valueTextDisplayTemplate:"%value",legendPercentageDigits:0},styles:{legend:"floe-ca-pieChart-legend",table:"floe-ca-pieChart-legend-table",row:"floe-ca-pieChart-legend-table-row",headerRow:"floe-ca-pieChart-legend-table-header-row",colorHeader:"floe-ca-pieChart-legend-color-header",labelHeader:"floe-ca-pieChart-legend-label-header",valueHeader:"floe-ca-pieChart-legend-value-header",colorCell:"floe-ca-pieChart-legend-color-cell",labelCell:"floe-ca-pieChart-legend-label-cell",valueCell:"floe-ca-pieChart-legend-value-cell",highlight:"floe-ca-currently-playing"},selectors:{legend:".floec-ca-pieChart-legend",table:".floec-ca-pieChart-legend-table",row:".floec-ca-pieChart-legend-table-row",headerRow:".floec-ca-pieChart-legend-table-header-row",colorHeader:".floec-ca-pieChart-legend-color-header",labelHeader:".floec-ca-pieChart-legend-label-header",valueHeader:".floec-ca-pieChart-legend-value-header",caption:".floec-ca-pieChart-legend-caption",colorCell:".floec-ca-pieChart-legend-color-cell",labelCell:".floec-ca-pieChart-legend-label-cell",valueCell:".floec-ca-pieChart-legend-value-cell"},events:{onLegendCreated:null,onDraw:null},listeners:{"onCreate.create":{funcName:"floe.chartAuthoring.pieChart.legend.create",args:["{that}"]},"onDraw.addRows":{func:"{that}.addRows"},"onDraw.updateRows":{func:"{that}.updateRows",priority:"after:addRows"},"onDraw.removeRows":{func:"{that}.removeRows",priority:"after:updateRows"}},modelListeners:{dataSet:{funcName:"{that}.draw",excludeSource:"init"},activeRowId:{func:"floe.d3ViewComponent.toggleCSSClassByDataId",args:["{that}.model.activeRowId","{that}.options.styles.highlight","{that}"]}},invokers:{draw:{funcName:"floe.chartAuthoring.pieChart.legend.draw",args:["{that}"]},sort:{funcName:"floe.chartAuthoring.utils.sortAscending",args:["{arguments}.0","{arguments}.1"]},getColorCellStyle:{funcName:"floe.chartAuthoring.pieChart.legend.getColorCellStyle",args:["{arguments}.0"]},addRows:{funcName:"floe.chartAuthoring.pieChart.legend.addRows",args:["{that}"]},updateRows:{funcName:"floe.chartAuthoring.pieChart.legend.updateRows",args:["{that}"]},removeRows:{funcName:"floe.chartAuthoring.pieChart.legend.removeRows",args:["{that}"]}}}),floe.chartAuthoring.pieChart.legend.addRows=function(a){var b=a.classes.row,c=a.classes.colorCell,d=a.classes.labelCell,e=a.classes.valueCell,f=a.rows.enter().append("tr");f.attr({"class":b}),f.append("td").attr({"class":c}),f.append("td").attr({"class":d}),f.append("td").attr({"class":e})},floe.chartAuthoring.pieChart.legend.updateRows=function(a){var b=a.options.selectors.colorCell,c=a.options.selectors.labelCell,d=a.options.selectors.valueCell,e=a.options.legendOptions.legendPercentageDigits,f=a.model.total.value,g=a.options.legendOptions.labelTextDisplayTemplate,h=a.options.legendOptions.valueTextDisplayTemplate;a.rows.each(function(i){a.trackD3BoundElement(i.id,this),d3.select(this).select(b).attr({style:a.getColorCellStyle(i),role:"presentation"}),d3.select(this).select(c).text(function(a){return floe.d3ViewComponent.getTemplatedDisplayValue(f,e,g,a)}),d3.select(this).select(d).text(function(a){return floe.d3ViewComponent.getTemplatedDisplayValue(f,e,h,a)})})},floe.chartAuthoring.pieChart.legend.removeRows=function(a){var b=a.rows.exit();a.exitD3Elements(b)},floe.chartAuthoring.pieChart.legend.draw=function(a){var b=a.table,c=a.options.legendOptions,d=floe.chartAuthoring.pieChart.legend.getColorArray(c.colors),e=c.sort,f=floe.chartAuthoring.pieChart.legend.addValueFromArray(a.model.dataSet,d,"color"),g=b.selectAll("tbody");a.rows=g.selectAll("tr").data(f,function(a){return a.id}),a.events.onDraw.fire(),e&&a.rows.sort(a.sort)},floe.chartAuthoring.pieChart.legend.create=function(a){var b=a.container,c=a.classes.table,d=a.classes.headerRow,e=a.classes.colorHeader,f=a.classes.labelHeader,g=a.classes.valueHeader,h=a.options.legendOptions.showLegendHeadings;if(a.table=a.jQueryToD3(b).append("table").attr({"class":c,"aria-live":"polite","aria-relevant":"all"}),null!==a.options.strings.legendTitle&&a.table.append("caption").attr({"class":a.classes.caption}).text(a.options.strings.legendTitle),a.table.append("thead"),a.table.append("tbody"),h){var i=a.table.selectAll("thead"),j=i.append("tr");j.attr({"class":d}),j.append("th").attr({scope:"col","class":e}).html(a.options.strings.legendColHeading),j.append("th").attr({scope:"col","class":f}).html(a.options.strings.labelColHeading),j.append("th").attr({scope:"col","class":g}).html(a.options.strings.valueColHeading)}a.draw(),a.events.onLegendCreated.fire()},floe.chartAuthoring.pieChart.legend.getColorCellStyle=function(a){return"background-color: "+a.color+";"},floe.chartAuthoring.pieChart.legend.addValueFromArray=function(a,c,d){return b.isArrayable(c)?b.transform(a,function(a,e){var f=b.copy(a);return f[d]=c[e],f}):a},floe.chartAuthoring.pieChart.legend.getColorArray=function(a){var b="function"==typeof a?a:floe.d3.getColorScale(a);return b.range()}}(jQuery,fluid),function(a,b){"use strict";b.defaults("floe.chartAuthoring.lineChart.timeSeries.area",{model:{dataSet:[]},selectors:{chartLineArea:".floec-ca-lineChart-chartLineArea"},events:{onChartCreated:null,onDraw:null},listeners:{"onDraw.drawArea":{func:"{that}.drawArea",priority:"after:drawChartLine"}},invokers:{drawArea:{funcName:"floe.chartAuthoring.lineChart.timeSeries.area.drawArea",args:["{that}"]}}}),floe.chartAuthoring.lineChart.timeSeries.area.drawArea=function(a){var b=a.classes.chartLineArea,c=a.svg,d=a.model.dataSet;a.chartLineAreaPaths=c.selectAll("path."+b).data(d,function(a){return a.id}),floe.chartAuthoring.lineChart.timeSeries.area.addArea(a),floe.chartAuthoring.lineChart.timeSeries.area.removeArea(a),floe.chartAuthoring.lineChart.timeSeries.area.updateArea(a)},floe.chartAuthoring.lineChart.timeSeries.area.addArea=function(a){var b=a.classes.chartLineArea,c=a.colorScale,d=floe.chartAuthoring.lineChart.timeSeries.area.getAreaGenerator(a);a.chartLineAreaPaths.enter().append("path").attr({"class":b,fill:function(a,b){return c(b)},opacity:"0.2",d:function(a){return d(a.data)}}),a.chartLineAreaPaths.each(function(b){a.trackD3BoundElement(b.id,this)})},floe.chartAuthoring.lineChart.timeSeries.area.updateArea=function(a){var b=a.options.lineOptions.transitionLength,c=floe.chartAuthoring.lineChart.timeSeries.area.getAreaGenerator(a);a.chartLineAreaPaths.transition().duration(b).attr({d:function(a){return c(a.data)}})},floe.chartAuthoring.lineChart.timeSeries.area.removeArea=function(a){var b=a.chartLineAreaPaths.exit();a.exitD3Elements(b)},floe.chartAuthoring.lineChart.timeSeries.area.getAreaGenerator=function(a){var b=a.options.lineOptions.interpolation,c=a.options.svgOptions.height,d=a.options.lineOptions.padding,e=a.getYScale(),f=a.getXScale(),g=d3.svg.area().interpolate(b).x(function(a){return f(new Date(a.date))}).y0(c-d).y1(function(a){return e(a.value)});return g}}(jQuery,fluid),function(a,b){"use strict";b.defaults("floe.chartAuthoring.lineChart.timeSeries.line",{model:{dataSet:[]},lineOptions:{interpolation:"linear"},selectors:{chartLine:".floec-ca-lineChart-chartLine"},listeners:{"onDraw.drawChartLine":{func:"{that}.drawChartLine"}},modelListeners:{dataSet:[{funcName:"{that}.events.onDraw.fire",excludeSource:"init"}]},invokers:{drawChartLine:{funcName:"floe.chartAuthoring.lineChart.timeSeries.line.drawChartLine",args:["{that}"]}}}),floe.chartAuthoring.lineChart.timeSeries.line.drawChartLine=function(a){var b=a.model.dataSet,c=a.classes.chartLine,d=a.svg;a.chartLinePaths=d.selectAll("path."+c).data(b,function(a){return a.id}),floe.chartAuthoring.lineChart.timeSeries.line.addChartLine(a),floe.chartAuthoring.lineChart.timeSeries.line.removeChartLine(a),floe.chartAuthoring.lineChart.timeSeries.line.updateChartLine(a)},floe.chartAuthoring.lineChart.timeSeries.line.addChartLine=function(a){var b=a.colorScale,c=a.classes.chartLine,d=floe.chartAuthoring.lineChart.timeSeries.line.getLineGenerator(a);a.chartLinePaths.enter().append("path").attr({"class":c,fill:"none",stroke:function(a,c){return b(c)},d:function(a){return d(a.data)}}),a.chartLinePaths.each(function(b){a.trackD3BoundElement(b.id,this)})},floe.chartAuthoring.lineChart.timeSeries.line.updateChartLine=function(a){var b=floe.chartAuthoring.lineChart.timeSeries.line.getLineGenerator(a),c=a.options.lineOptions.transitionLength;a.chartLinePaths.transition().duration(c).attr({d:function(a){return b(a.data)}})},floe.chartAuthoring.lineChart.timeSeries.line.removeChartLine=function(a){var b=a.chartLinePaths.exit();a.exitD3Elements(b)},floe.chartAuthoring.lineChart.timeSeries.line.getLineGenerator=function(a){var b=a.options.lineOptions.interpolation,c=a.getYScale(),d=a.getXScale(),e=d3.svg.line().interpolate(b).x(function(a){return d(new Date(a.date))}).y(function(a){return c(a.value)});return e}}(jQuery,fluid),function(a,b){"use strict";b.defaults("floe.chartAuthoring.lineChart.timeSeriesMultiDataSet",{gradeNames:["floe.chartAuthoring.axis","floe.chartAuthoring.xAxisTimeSeries","floe.chartAuthoring.yAxis","floe.chartAuthoring.lineChart.timeSeries.line","floe.chartAuthoring.valueBinding","floe.svgDrawingArea"],model:{dataSet:[],svgTitle:"Line Chart",svgDescription:"A line chart."},bindings:{title:"svgTitle",description:"svgDescription"},svgOptions:{width:700,height:500},lineOptions:{colors:null,padding:50,interpolation:"linear",transitionLength:2e3},events:{onChartCreated:null,onDraw:null},listeners:{"onCreate.create":{funcName:"floe.chartAuthoring.lineChart.timeSeriesMultiDataSet.create",args:["{that}"]}},modelListeners:{dataSet:[{funcName:"{that}.events.onDraw.fire",excludeSource:"init"}]},invokers:{getXScale:{funcName:"floe.chartAuthoring.lineChart.timeSeriesMultiDataSet.getXScaleTimeSeries",args:["{that}"]},getYScale:{funcName:"floe.chartAuthoring.lineChart.timeSeriesMultiDataSet.getYScale",args:["{that}"]}}}),floe.chartAuthoring.lineChart.timeSeriesMultiDataSet.concatData=function(a,b){return b.concat(a.data)},floe.chartAuthoring.lineChart.timeSeriesMultiDataSet.getYScale=function(a){var c=a.options.svgOptions.height,d=a.options.lineOptions.padding,e=a.model.dataSet,f=b.accumulate(e,floe.chartAuthoring.lineChart.timeSeriesMultiDataSet.concatData,[]),g=d3.max(f,function(a){return a.value});return d3.scale.linear().domain([0,g]).nice().range([c-d,d])},floe.chartAuthoring.lineChart.timeSeriesMultiDataSet.getXScaleTimeSeries=function(a){var c=a.options.svgOptions.width,d=a.options.lineOptions.padding,e=a.model.dataSet,f=b.accumulate(e,floe.chartAuthoring.lineChart.timeSeriesMultiDataSet.concatData,[]),g=d3.max(f,function(a){return new Date(a.date)}),h=d3.min(f,function(a){return new Date(a.date)});return d3.time.scale().domain([h,g]).range([d,c-2*d])},floe.chartAuthoring.lineChart.timeSeriesMultiDataSet.create=function(a){var b=a.options.lineOptions.colors;a.createBaseSVGDrawingArea(),a.colorScale="function"==typeof b?b:floe.d3.getColorScale(b),a.events.onDraw.fire(),a.events.onChartCreated.fire()}}(jQuery,fluid),function(a,b){"use strict";b.defaults("floe.chartAuthoring.lineChart.timeSeries.points",{model:{dataSet:[]},lineOptions:{pointRadius:2},styles:{chartLinePoint:"floe-ca-lineChart-chartLinePoint"},selectors:{chartLinePointGroup:".floec-ca-lineChart-chartLinePointGroup",chartLinePoint:".floec-ca-lineChart-chartLinePoint"},listeners:{"onDraw.drawPoints":{func:"{that}.drawPoints",priority:"after:drawArea"}},invokers:{drawPoints:{funcName:"floe.chartAuthoring.lineChart.timeSeries.points.drawPoints",args:["{that}"]}}}),floe.chartAuthoring.lineChart.timeSeries.points.drawPoints=function(a){var b=a.svg,c=a.model.dataSet,d=a.classes.chartLinePointGroup;a.chartLinePointGroups=b.selectAll("g."+d).data(c,function(a){return a.id}),floe.chartAuthoring.lineChart.timeSeries.points.addPointGroups(a),floe.chartAuthoring.lineChart.timeSeries.points.deletePointGroups(a),
floe.chartAuthoring.lineChart.timeSeries.points.managePoints(a),floe.chartAuthoring.lineChart.timeSeries.points.updatePoints(a)},floe.chartAuthoring.lineChart.timeSeries.points.addPointGroups=function(a){var b=a.classes.chartLinePointGroup;a.chartLinePointGroups.enter().append("g").attr("class",b),a.chartLinePointGroups.each(function(b){a.trackD3BoundElement(b.id,this)})},floe.chartAuthoring.lineChart.timeSeries.points.deletePointGroups=function(a){var b=a.chartLinePointGroups.exit();a.exitD3Elements(b)},floe.chartAuthoring.lineChart.timeSeries.points.managePoints=function(a){var b=a.classes.chartLinePoint,c=a.options.lineOptions.pointRadius,d=a.colorScale,e=a.getYScale(),f=a.getXScale();a.chartLinePointGroups.each(function(g,h){var i=d3.select(this),j=i.selectAll("circle").data(g.data,function(a,b){return g.id+"-"+b});j.enter().append("circle").attr({"class":b,fill:d(h),r:c,cy:function(a){return e(a.value)},cx:function(a){return f(new Date(a.date))}}).each(function(b,c){a.trackD3BoundElement(g.id+"-"+c,this)});var k=j.exit();a.exitD3Elements(k)})},floe.chartAuthoring.lineChart.timeSeries.points.updatePoints=function(a){var b=a.options.lineOptions.transitionLength,c=a.getYScale(),d=a.getXScale();a.chartLinePointGroups.each(function(){var a=d3.select(this);a.selectAll("circle").transition().duration(b).attr({cy:function(a){return c(a.value)},cx:function(a){return d(new Date(a.date))}})})}}(jQuery,fluid),function(a,b){"use strict";b.defaults("floe.chartAuthoring.lineChart.timeSeriesSingleDataSet",{gradeNames:["floe.chartAuthoring.lineChart.timeSeriesMultiDataSet"],model:{dataSet:[]},modelRelay:{source:"{that}.model.dataSet",target:"{that}.model.dataSet",singleTransform:{type:"fluid.transforms.free",args:["{that}.model.dataSet"],func:"floe.chartAuthoring.lineChart.timeSeriesSingleDataSet.wrapSingleDataSet"}}}),floe.chartAuthoring.lineChart.timeSeriesSingleDataSet.wrapSingleDataSet=function(a){return a=[{id:"dataSet",data:a}]}}(jQuery,fluid),function(a,b){"use strict";b.registerNamespace("floe.chartAuthoring.percentage"),floe.chartAuthoring.percentage.isNumber=function(a){return"number"==typeof a&&!isNaN(a)},floe.chartAuthoring.percentage.calculate=function(a,b){var c=floe.chartAuthoring.percentage.isNumber(a)&&floe.chartAuthoring.percentage.isNumber(b);return c?b?a/b*100:0:null},floe.chartAuthoring.percentage.render=function(c,d,e,f){c=a(c),e=e||"%percentage";var g=parseFloat(d);d=g||0===g?g.toFixed(f):"";var h=b.stringTemplate(e,{percentage:d});c.text(h)}}(jQuery,fluid),function(a,b){"use strict";b.defaults("floe.chartAuthoring.pieChart.pie",{gradeNames:["floe.chartAuthoring.valueBinding","floe.chartAuthoring.totalRelaying","floe.svgDrawingArea"],model:{dataSet:[],svgTitle:"Pie Chart",svgDescription:"A pie chart."},bindings:{title:"svgTitle",description:"svgDescription"},svgOptions:{width:300,height:300},pieOptions:{colors:null,outerRadius:null,innerRadius:null,animationDuration:750,sliceTextDisplayTemplate:"%value",sliceTextPercentageDigits:0,displayPieBackground:!0,pieBackgroundColor:"#F2F2F2"},styles:{svg:"floe-ca-pieChart-pie",slice:"floe-ca-pieChart-slice",text:"floe-ca-pieChart-text",highlight:"floe-ca-currently-playing"},selectors:{svg:".floec-ca-pieChart-pie",slice:".floec-ca-pieChart-slice",text:".floec-ca-pieChart-text",title:".floec-ca-pieChart-title",description:".floec-ca-pieChart-description",background:".floec-ca-pieChart-background"},events:{onPieCreated:null,onDraw:null},listeners:{"onCreate.create":{funcName:"floe.chartAuthoring.pieChart.pie.create",args:["{that}"]},"onDraw.addSlices":{func:"{that}.addSlices"},"onDraw.updateSlices":{func:"{that}.updateSlices",priority:"after:addSlices"},"onDraw.removeSlices":{func:"{that}.removeSlices",priority:"after:updateSlices"}},modelListeners:{dataSet:{funcName:"{that}.draw",excludeSource:"init"},activeSliceId:{func:"floe.d3ViewComponent.toggleCSSClassByDataId",args:["{that}.model.activeSliceId","{that}.options.styles.highlight","{that}"]}},invokers:{draw:{funcName:"floe.chartAuthoring.pieChart.pie.draw",args:["{that}"]},textTransform:{funcName:"floe.chartAuthoring.pieChart.textTransform",args:["{that}.arc","{arguments}.0"]},addSlices:{funcName:"floe.chartAuthoring.pieChart.pie.addSlices",args:["{that}"]},updateSlices:{funcName:"floe.chartAuthoring.pieChart.pie.updateSlices",args:["{that}"]},removeSlices:{funcName:"floe.chartAuthoring.pieChart.pie.removeSlices",args:["{that}"]}}}),floe.chartAuthoring.pieChart.pie.addSlices=function(a){var b=a.colorScale,c=a.arc,d=a.classes.slice,e=a.classes.text;a.paths.enter().append("path").attr({fill:function(a,c){return b(c)},d:c,"class":d,role:"presentation"}).each(function(a){this._current=a}),a.texts.enter().append("text").attr({"text-anchor":"middle","class":e,transform:a.textTransform})},floe.chartAuthoring.pieChart.pie.updateSlices=function(a){var b=a.arc,c=a.options.pieOptions.animationDuration,d=a.options.pieOptions.sliceTextPercentageDigits,e=a.model.total.value,f=a.options.pieOptions.sliceTextDisplayTemplate;a.paths.transition().duration(c).attrTween("d",function(a){var c=d3.interpolate(this._current,a);return this._current=c(0),function(a){return b(c(a))}}),a.texts.text(function(a){return floe.d3ViewComponent.getTemplatedDisplayValue(e,d,f,a)}),a.paths.each(function(b){a.trackD3BoundElement(b.data.id,this)}),a.texts.each(function(b){a.trackD3BoundElement(b.data.id,this)}),a.texts.transition().duration(c).attr("transform",a.textTransform)},floe.chartAuthoring.pieChart.pie.removeSlices=function(a){var b=a.paths.exit();a.exitD3Elements(b);var c=a.texts.exit();a.exitD3Elements(c)},floe.chartAuthoring.pieChart.pie.draw=function(a){var b=a.pieGroup,c=a.pie,d=a.model.dataSet;a.paths=b.selectAll("path").data(c(d)),a.texts=b.selectAll("text").data(c(d)),a.events.onDraw.fire()},floe.chartAuthoring.pieChart.pie.create=function(a){var b=a.options.pieOptions,c=a.options.svgOptions.width,d=b.colors,e=b.outerRadius||c/2,f=b.innerRadius||0,g=b.displayPieBackground,h=b.pieBackgroundColor,i=a.classes.background;a.arc=d3.svg.arc().innerRadius(f).outerRadius(e),a.pie=d3.layout.pie().value(function(a){return"object"==typeof a?a.value:a}),a.createBaseSVGDrawingArea(),g&&a.svg.append("circle").attr({cx:e,cy:e,r:e,fill:h,"class":i}),a.pieGroup=a.svg.append("g").attr({transform:"translate("+e+","+e+")"}),a.colorScale="function"==typeof d?d:floe.d3.getColorScale(d),a.draw(),a.events.onPieCreated.fire()},floe.chartAuthoring.pieChart.textTransform=function(a,b){return"translate("+a.centroid(b)+")"}}(jQuery,fluid),function(a,b){"use strict";b.defaults("floe.chartAuthoring.pieChart",{gradeNames:["floe.chartAuthoring.templateInjection"],members:{drawingOptions:{expander:{funcName:"floe.chartAuthoring.pieChart.consolidateDrawingOptions",args:["{that}.options.pieChartOptions"]}}},components:{pie:{type:"floe.chartAuthoring.pieChart.pie",createOnEvent:"onTemplateInjected",container:"{that}.dom.pie",options:{pieOptions:"{pieChart}.drawingOptions",svgOptions:"{pieChart}.options.svgOptions",model:{dataSet:"{pieChart}.model.dataSet",svgTitle:"{pieChart}.model.svgTitle",svgDescription:"{pieChart}.model.svgDescription",activeSliceId:"{pieChart}.model.activeDataId"},events:{onPieCreated:"{pieChart}.events.onPieCreated",onDraw:"{pieChart}.events.onPieRedrawn"}}},legend:{type:"floe.chartAuthoring.pieChart.legend",createOnEvent:"onTemplateInjected",container:"{that}.dom.legend",options:{legendOptions:"{pieChart}.drawingOptions",strings:{legendTitle:"{pieChart}.options.pieChartOptions.legendTitle"},model:{dataSet:"{pieChart}.model.dataSet",activeRowId:"{pieChart}.model.activeDataId"},events:{onLegendCreated:"{pieChart}.events.onLegendCreated",onDraw:"{pieChart}.events.onLegendRedrawn"}}}},model:{dataSet:[],svgTitle:"Pie Chart",svgDescription:"A pie chart."},svgOptions:{},pieChartOptions:{},selectors:{pie:".floec-ca-pieChart-pie",legend:".floec-ca-pieChart-legend"},events:{onPieCreated:null,onLegendCreated:null,onPieRedrawn:null,onLegendRedrawn:null,onPieChartReady:{events:{onPieCreated:"onPieCreated",onLegendCreated:"onLegendCreated"},args:["{that}"]},onPieChartRedrawn:{events:{onPieRedrawn:"onPieRedrawn",onLegendRedrawn:"onLegendRedrawn"}}},resources:{template:{}}}),floe.chartAuthoring.pieChart.consolidateDrawingOptions=function(a){var c=b.copy(a);return b.set(c,"colors",floe.d3.getColorScale(a.colors)),c}}(jQuery,fluid),function(a,b){"use strict";b.defaults("floe.chartAuthoring.sonifier",{gradeNames:["floe.chartAuthoring.totalRelaying","floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy"],components:{textToSpeech:{type:"fluid.textToSpeech",options:{model:{utteranceOpts:{lang:"en-US"}}}},enviro:{type:"flock.enviro"},synth:{type:"floe.chartAuthoring.electricPianoBand",options:{components:{scheduler:{type:"flock.scheduler.async",options:{synthContext:"floe.chartAuthoring.electricPianoBand"}}}}}},model:{isPlaying:!1,isTextToSpeechSupported:{expander:{func:"fluid.textToSpeech.isSupported"}}},modelListeners:{dataSet:{funcName:"{that}.sonifyData"},sonificationQueue:{funcName:"{that}.beginSonificationQueue"}},playbackOptions:{gapDuration:1,zoom:1},invokers:{stopSonification:{funcName:"floe.chartAuthoring.sonifier.stopSonification",args:"{that}"},beginSonificationQueue:{funcName:"floe.chartAuthoring.sonifier.processSonificationQueue",args:[0,!0,"{that}"]},playDataAndQueueNext:{funcName:"floe.chartAuthoring.sonifier.playDataAndQueueNext",args:["{that}"]}},events:{onSonificationRequested:null,onSonificationDataQueued:null,onVoiceLabelCompleted:"{textToSpeech}.events.onStop",onSonificationStopped:null},listeners:{"onSonificationRequested.startEnviro":{func:"{that}.enviro.start"},"onSonificationRequested.queueData":{funcName:"floe.chartAuthoring.sonifier.addToSonificationQueue",args:["{that}"],priority:"after:onSonificationRequested.startEnviro"},"onVoiceLabelCompleted.playDataAndQueueNext":"{that}.playDataAndQueueNext"}}),floe.chartAuthoring.sonifier.addToSonificationQueue=function(a){a.model.isPlaying||(a.applier.change("sonificationQueue",a.model.sonifiedData),a.events.onSonificationDataQueued.fire())},floe.chartAuthoring.sonifier.processSonificationQueue=function(a,b,c){var d=c.model.sonificationQueue;if(0!==d.length){c.applier.change("isPlaying",!0);var e=c.options.playbackOptions.gapDuration,f=b?a:a+e;floe.chartAuthoring.sonifier.scheduleNextPlayData(f,c)}},floe.chartAuthoring.sonifier.scheduleNextPlayData=function(a,b){var c=b.synth,d=b.model.sonificationQueue[0],e=b.textToSpeech;c.scheduler.once(a,function(){b.applier.change("currentlyPlayingData",d),b.model.isTextToSpeechSupported?e.queueSpeech(d.label):b.events.onVoiceLabelCompleted.fire()})},floe.chartAuthoring.sonifier.playDataAndQueueNext=function(a){var c=a.synth,d=a.model.sonificationQueue,e=d.shift(),f=b.get(e,"notes.totalDuration")||0;d.length>0?floe.chartAuthoring.sonifier.processSonificationQueue(f,!1,a):c.scheduler.once(f,function(){a.stopSonification()}),void 0!==e&&(c.midiNoteSynth.applier.change("inputs.noteSequencer",e.notes),c.pianoEnvelopeSynth.applier.change("inputs.envelopeSequencer",e.envelope))},floe.chartAuthoring.sonifier.stopSonification=function(a){if(a.model.isPlaying){a.applier.change("sonificationQueue",[]),a.synth.scheduler.clearAll();var b={durations:[],values:[]};a.synth.midiNoteSynth.applier.change("inputs.noteSequencer",b),a.synth.pianoEnvelopeSynth.applier.change("inputs.envelopeSequencer",b),a.isTextToSpeechSupported&&a.textToSpeech.cancel(),a.enviro.stop(),a.applier.change("isPlaying",!1),a.applier.change("currentlyPlayingData",!1),a.events.onSonificationStopped.fire()}}}(jQuery,fluid),function(a,b){"use strict";b.defaults("floe.svgDrawingArea",{gradeNames:["floe.d3ViewComponent"],model:{svgTitle:"An SVG",svgDescription:"An SVG image"},svgOptions:{width:500,height:500,preserveAspectRatio:"none"},selectors:{title:".floec-ca-svgDrawingArea-title",description:".floec-ca-svgDrawingArea-description",svg:".floec-ca-svgDrawingArea-svg"},invokers:{createBaseSVGDrawingArea:{funcName:"floe.svgDrawingArea.createBaseSVGDrawingArea",args:["{that}"]}}}),floe.svgDrawingArea.getViewBoxConfiguration=function(a,b,c,d){return a+","+b+","+c+","+d},floe.svgDrawingArea.createBaseSVGDrawingArea=function(a){var c=a.container,d=a.options.svgOptions.width,e=a.options.svgOptions.height,f=a.options.svgOptions.preserveAspectRatio,g=a.classes.title,h=a.classes.description,i=a.classes.svg;a.svg=a.jQueryToD3(c).append("svg").attr({width:d,height:e,"class":i,viewBox:floe.svgDrawingArea.getViewBoxConfiguration(0,0,d,e),preserveAspectRatio:f,role:"img"}),a.svg.append("title").attr({"class":g}).text(a.model.svgTitle);var j=b.allocateSimpleId(a.locate("title"));a.svg.append("desc").attr({"class":h}).text(a.model.svgDescription);var k=b.allocateSimpleId(a.locate("description"));a.svg.attr({"aria-labelledby":j+" "+k})}}(jQuery,fluid),function(a,b){"use strict";b.defaults("floe.chartAuthoring.templateInjection",{gradeNames:["fluid.viewComponent"],listeners:{"onCreate.injectTemplate":{"this":"{that}.container",method:"html",args:["{that}.options.resources.template.resourceText"],priority:"first"},"onCreate.templateInjected":{listener:"{that}.events.onTemplateInjected.fire"}},resources:{template:{resourceText:""}},events:{onTemplateInjected:null}})}(jQuery,fluid),function(a,b){"use strict";b.defaults("floe.chartAuthoring.totalRelaying",{gradeNames:["fluid.modelComponent"],model:{total:{},dataSet:{}},modelRelay:[{source:"dataSet",target:"total.value",singleTransform:{type:"floe.chartAuthoring.transforms.reduce",value:"{that}.model.dataSet",initialValue:null,extractor:"floe.chartAuthoring.transforms.reduce.valueExtractor",func:"floe.chartAuthoring.transforms.reduce.add"}},{source:"total.value",target:"total.percentage",singleTransform:{type:"floe.chartAuthoring.transforms.percentage",value:"{that}.model.total.value",total:"{that}.model.total.value"}}]})}(jQuery,fluid),function(a,b){"use strict";b.registerNamespace("floe.chartAuthoring.transforms"),b.defaults("floe.chartAuthoring.transforms.stringToNumber",{gradeNames:["fluid.standardTransformFunction"]}),floe.chartAuthoring.transforms.stringToNumber=function(a){var b=parseFloat(a);return isNaN(b)?null:b},b.defaults("floe.chartAuthoring.transforms.percentage",{gradeNames:["fluid.standardOutputTransformFunction"]}),floe.chartAuthoring.transforms.percentage=function(a){return floe.chartAuthoring.percentage.calculate(a.value,a.total)},b.defaults("floe.chartAuthoring.transforms.reduce",{gradeNames:["fluid.standardOutputTransformFunction"]}),floe.chartAuthoring.transforms.reduce=function(a){var c=a.value,d=a.extractor||"fluid.identity";return b.isPlainObject(c)&&!b.isArrayable(c)&&(c=b.values(c)),b.accumulate(c,function(c,e){return c=b.invokeGlobalFunction(d,[c]),b.isValue(c)&&!isNaN(c)?b.invokeGlobalFunction(a.func,[c,e]):e},a.initialValue)},floe.chartAuthoring.transforms.reduce.add=function(a,b){return a+(b||0)},floe.chartAuthoring.transforms.reduce.valueExtractor=function(a){return a.value?a.value:a}}(jQuery,fluid),function(a,b){"use strict";b.defaults("floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy",{sonificationOptions:{strategies:{unitDivisor:{config:{divisor:10,notes:{durations:{play:{divisorReturnValue:3/8,remainderReturnValue:1/8}},values:{divisorReturnValue:91,remainderReturnValue:89}},envelope:{durations:{play:{divisorReturnValue:1/8,remainderReturnValue:1/24},silence:{divisorReturnValue:.25,remainderReturnValue:1/12}},values:{trueValue:1,falseValue:0}}}}}},invokers:{sonifyData:{changePath:"sonifiedData",value:{expander:{func:"{that}.unitDivisorStrategy",args:"{that}.options.sonificationOptions.strategies.unitDivisor.config.divisor"}}},unitDivisorStrategy:{funcName:"floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy.unitDivisorStrategy",args:["{that}","{arguments}.0"]}}}),floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy.unitDivisorStrategy=function(a,c){var d=a.model.dataSet,e=a.model.total.value,f=[],g=a.options.sonificationOptions,h=a.options.playbackOptions,i=floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy.applyZoomToDurationConfig(g.strategies.unitDivisor.config.notes.durations.play,h.zoom),j=g.strategies.unitDivisor.config.notes.values,k=floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy.applyZoomToDurationConfig(g.strategies.unitDivisor.config.envelope.durations,h.zoom),l=g.strategies.unitDivisor.config.envelope.values;return b.each(d,function(a,b){if(null!==a.value){var d=Number(floe.chartAuthoring.percentage.calculate(a.value,e).toFixed(0)),g=floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy.getDivisorStrategyUnits(d,c),h=floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy.getConfigByDivisor(g,c,i),m=floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy.getConfigByDivisor(g,c,j),n=floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy.getSonificationEnvelopeDurationsByDivisor(g,c,k),o=floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy.getSonificationEnvelopeValuesByDivisor(n,k,l),p={id:b,label:a.label,value:a.value,percentage:d,units:g,notes:{durations:h,values:m,totalDuration:floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy.getTotalDuration(h)},envelope:{durations:n,values:o}};f.push(p)}}),f.sort(floe.chartAuthoring.utils.sortAscending),f},floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy.getTotalDuration=function(a){var c=function(a,b){return a+b};return b.accumulate(a,c,0)},floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy.getDivisorStrategyUnits=function(a,b){for(var c=Math.floor(a/b),d=a%b,e=[],f=[],g=0;c>g;g++)e.push(b);for(g=0;d>g;g++)f.push(1);return e.concat(f)},floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy.getConfigByDivisor=function(a,c,d){var e=b.transform(a,function(a){return d[a===c?"divisorReturnValue":"remainderReturnValue"]});return e},floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy.getSonificationEnvelopeDurationsByDivisor=function(a,b,c){var d=floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy.getConfigByDivisor(a,b,c.play),e=floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy.getConfigByDivisor(a,b,c.silence);return floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy.interleaveTransform(d,e)},floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy.getSonificationEnvelopeValuesByDivisor=function(a,b,c){var d=function(a){return a===b.play.divisorReturnValue||a===b.play.remainderReturnValue};return floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy.truthValueTransform(a,d,c.trueValue,c.falseValue)},floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy.truthValueTransform=function(a,c,d,e){var f=b.transform(a,function(a){var b=c(a)?d:e;return b});return f},floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy.interleaveTransform=function(a,c){var d=a.length>=c.length?a:c,e=b.transform(d,function(b,d){var e=a[d],f=c[d];return void 0!==e&&void 0!==f?[a[d],c[d]]:void 0!==e?[e]:void 0!==f?f:[]}),f=function(a,b){return b.concat(a)};return b.accumulate(e,f,[])},floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy.multiplierTransform=function(a,c){if(b.isPlainObject(a)){var d=b.transform(a,function(a){return floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy.multiplierTransform(a,c)});return d}return"number"==typeof a?a*c:a},floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy.applyZoomToDurationConfig=function(a,c){var d=b.transform(a,function(a){return floe.chartAuthoring.sonifier.unitDivisorSonificationStrategy.multiplierTransform(a,c)});return d}}(jQuery,fluid),function(a,b){"use strict";b.registerNamespace("floe.chartAuthoring.utils"),floe.chartAuthoring.utils.sortAscending=function(a,b){return b.value-a.value}}(jQuery,fluid),function(a,b){"use strict";b.defaults("floe.chartAuthoring.valueBinding",{gradeNames:["fluid.viewComponent","{that}.generateModelListenersConnectionGrade"],bindings:{},invokers:{generateModelListenersConnectionGrade:{funcName:"floe.chartAuthoring.valueBinding.generateModelListenersConnectionGrade",args:["{that}.options.bindings","floe.chartAuthoring.valueBinding.updateDOM"]},bindDOMChange:"floe.chartAuthoring.valueBinding.bindDOMChange"},listeners:{"onCreate.setInitialDOM":"floe.chartAuthoring.valueBinding.setInitialDOM","onCreate.bindDOMChange":"{that}.bindDOMChange"}}),floe.chartAuthoring.valueBinding.bindDOMChange=function(a){b.each(a.options.bindings,function(b,c){var d=a.locate(c);d.on("change",function(){a.applier.change(b,d.val())})})},floe.chartAuthoring.valueBinding.updateDOM=function(b,c){b=a(b),b[b.is("input")?"val":"text"](c)},floe.chartAuthoring.valueBinding.setInitialDOM=function(a){b.each(a.options.bindings,function(c,d){floe.chartAuthoring.valueBinding.updateDOM(a.locate(d),b.get(a.model,c))})},floe.chartAuthoring.valueBinding.generateModelListenersConnectionGrade=function(a,c){var d="floe.valueBindingModelConnections."+b.allocateGuid(),e={};return b.each(a,function(a,b){e[a]=e[a]||[],e[a].push({listener:c,args:["{that}.dom."+b,"{change}.value"],excludeSource:"init"})}),b.defaults(d,{modelListeners:e}),d}}(jQuery,fluid),function(a,b){"use strict";b.defaults("floe.chartAuthoring.xAxis",{model:{dataSet:[]},axisOptions:{numberOfXAxisTicks:6,xAxisTickFormat:"d"},selectors:{xAxis:".floec-ca-lineChart-x-axis"},events:{onChartCreated:null,onDraw:null},listeners:{"onDraw.drawXAxis":{func:"{that}.drawXAxis",priority:"before:drawChartLine"}},invokers:{drawXAxis:{funcName:"floe.chartAuthoring.xAxis.drawXAxis",args:["{that}"]},getXAxisTickFormat:{funcName:"floe.chartAuthoring.xAxis.getXAxisTickFormat",args:["{that}"]}}}),floe.chartAuthoring.xAxis.drawXAxis=function(a){var b=a.classes.xAxis,c=a.options.lineOptions.padding,d=a.options.svgOptions.height,e="translate(0,"+(d-c)+")",f=floe.chartAuthoring.xAxis.getXAxis(a);a.manageAxis("xAxis",b,e,f)},floe.chartAuthoring.xAxis.getXAxis=function(a){var b=a.getXScale(),c=a.options.axisOptions.numberOfXAxisTicks,d=d3.svg.axis().tickFormat(a.getXAxisTickFormat()).ticks(c).orient("bottom").scale(b);return d},floe.chartAuthoring.xAxis.getXAxisTickFormat=function(a){var b=a.options.axisOptions.xAxisTickFormat;return d3.format(b)}}(jQuery,fluid),function(a,b){"use strict";b.defaults("floe.chartAuthoring.xAxisTimeSeries",{gradeNames:["floe.chartAuthoring.xAxis"],model:{dataSet:[]},axisOptions:{XAxisTimeSeriesTickFormats:{milliseconds:"%.L",seconds:":%S",minute:"%I:%M",hour:"%I %p",day:"%a %d",firstDayOfMonth:"%b %d",month:"%b",year:"%Y"}},invokers:{getXAxisTickFormat:{funcName:"floe.chartAuthoring.xAxisTimeSeries.getXAxisTickFormat",args:["{that}"]}}}),floe.chartAuthoring.xAxisTimeSeries.getXAxisTickFormat=function(a){var b=a.options.axisOptions.XAxisTimeSeriesTickFormats,c=d3.time.format.multi([[b.milliseconds,function(a){return a.getMilliseconds()}],[b.seconds,function(a){return a.getSeconds()}],[b.minute,function(a){return a.getMinutes()}],[b.hour,function(a){return a.getHours()}],[b.day,function(a){return a.getDay()&&1!==a.getDate()}],[b.firstDayOfMonth,function(a){return 1!==a.getDate()}],[b.month,function(a){return a.getMonth()}],[b.year,function(){return!0}]]);return c}}(jQuery,fluid),function(a,b){"use strict";b.defaults("floe.chartAuthoring.yAxis",{model:{dataSet:[]},selectors:{yAxis:".floec-ca-lineChart-y-axis"},axisOptions:{numberOfYAxisTicks:10,yAxisTickFormat:"d"},events:{onChartCreated:null,onDraw:null},listeners:{"onDraw.drawYAxis":{func:"{that}.drawYAxis",priority:"before:drawChartLine"}},invokers:{drawYAxis:{funcName:"floe.chartAuthoring.yAxis.drawYAxis",args:["{that}"]},getYAxisTickFormat:{funcName:"floe.chartAuthoring.yAxis.getYAxisTickFormat",args:["{that}"]}}}),floe.chartAuthoring.yAxis.drawYAxis=function(a){var b=a.classes.yAxis,c=a.options.lineOptions.padding,d="translate("+c+",0)",e=floe.chartAuthoring.yAxis.getYAxis(a);a.manageAxis("yAxis",b,d,e)},floe.chartAuthoring.yAxis.getYAxis=function(a){var b=a.options.svgOptions.width,c=a.options.lineOptions.padding,d=a.getYScale(),e=a.options.axisOptions.numberOfYAxisTicks,f=d3.svg.axis().orient("left").scale(d).tickFormat(a.getYAxisTickFormat()).ticks(e).innerTickSize(-b+3*c).outerTickSize(0).tickPadding(10);return f},floe.chartAuthoring.yAxis.getYAxisTickFormat=function(a){var b=a.options.axisOptions.yAxisTickFormat;return d3.format(b)}}(jQuery,fluid),function(a,b){"use strict";b.defaults("gpii.qualityInfrastructure.frontEnd.baseMetricsPanel",{gradeNames:["floe.chartAuthoring.templateInjection"],selectors:{summary:".gpiic-metricsPanel-summary",graph:".gpiic-metricsPanel-graph"},resources:{template:{resourceText:'<div class="gpiic-metricsPanel-summary"></div><div class="gpiic-metricsPanel-graph"></div>'}},model:{currentEventsDataViewSettings:{metricsEndDate:new Date,daysBack:180}},components:{jsonpLoader:{type:"gpii.qualityInfrastructure.frontEnd.jsonp",options:{jsonpOptions:{},events:{onJSONPLoaded:"{baseMetricsPanel}.events.onJSONPLoaded"}}},graph:{type:"floe.chartAuthoring.lineChart.timeSeriesSingleDataSet",container:"{baseMetricsPanel}.dom.graph",createOnEvent:"{baseMetricsPanel}.events.onServiceResponseReady",options:{model:{dataSet:"{baseMetricsPanel}.model.currentEventsDataView"},axisOptions:{numberOfXAxisTicks:6,numberOfYAxisTicks:6},svgOptions:{height:150,width:500,preserveAspectRatio:"xMidYMid"},lineOptions:{padding:25,colors:["#009688"]}}}},events:{onJSONPLoaded:null,onServiceResponseReady:null},listeners:{"onJSONPLoaded.convertServiceResponse":{funcName:"gpii.qualityInfrastructure.frontEnd.baseMetricsPanel.convertServiceResponse",args:["{that}"]}},modelListeners:{currentEventsDataViewSettings:{funcName:"gpii.qualityInfrastructure.frontEnd.baseMetricsPanel.updateCurrentEventsDataView",excludeSource:"init",args:"{that}"}}}),gpii.qualityInfrastructure.frontEnd.baseMetricsPanel.convertServiceResponse=function(a){var b=a.jsonpLoader.model.jsonpData.summary,c=gpii.qualityInfrastructure.frontEnd.baseMetricsPanel.transformEventsData(a.jsonpLoader.model.jsonpData.events),d=new Date(c[0].date);a.applier.change("summary",b),a.applier.change("events",c),a.applier.change("currentEventsDataViewSettings.metricsEndDate",d),gpii.qualityInfrastructure.frontEnd.baseMetricsPanel.updateCurrentEventsDataView(a),a.events.onServiceResponseReady.fire()},gpii.qualityInfrastructure.frontEnd.baseMetricsPanel.updateCurrentEventsDataViewException=function(a){this.message=a,this.name="gpii.qualityInfrastructure.frontEnd.baseMetricsPanel.updateCurrentEventsDataViewException"},gpii.qualityInfrastructure.frontEnd.baseMetricsPanel.updateCurrentEventsDataView=function(a){var b,c=a.model.events,d=a.model.currentEventsDataViewSettings.metricsEndDate,e=a.model.currentEventsDataViewSettings.daysBack,f=a.model.currentEventsDataViewSettings.metricsStartDate;if(b=void 0!==f?gpii.qualityInfrastructure.frontEnd.baseMetricsPanel.filterEventsData(c,f,d):gpii.qualityInfrastructure.frontEnd.baseMetricsPanel.filterEventsDataByDaysBack(c,d,e),0===b.length)throw new gpii.qualityInfrastructure.frontEnd.baseMetricsPanel.updateCurrentEventsDataViewException("Filter would result in empty dataSet object");a.applier.change("currentEventsDataView",b)},gpii.qualityInfrastructure.frontEnd.baseMetricsPanel.transformEventsData=function(a){return b.transform(a,function(a){return{date:a.timestamp,value:a.value}})},gpii.qualityInfrastructure.frontEnd.baseMetricsPanel.isDateObject=function(a){var b="function"==typeof a.getMonth;return b},gpii.qualityInfrastructure.frontEnd.baseMetricsPanel.getWorkableDate=function(a){var b=gpii.qualityInfrastructure.frontEnd.baseMetricsPanel.isDateObject(a)?a:Date.parse(a);return isNaN(b)?b:new Date(a)},gpii.qualityInfrastructure.frontEnd.baseMetricsPanel.filterEventsData=function(a,c,d){var e=b.copy(a);return c=gpii.qualityInfrastructure.frontEnd.baseMetricsPanel.getWorkableDate(c),d=gpii.qualityInfrastructure.frontEnd.baseMetricsPanel.getWorkableDate(d),b.remove_if(e,function(a){var b=Date.parse(a.date),e=b>=c&&d>=b;return!e}),e},gpii.qualityInfrastructure.frontEnd.baseMetricsPanel.filterEventsDataByDaysBack=function(a,b,c){b=gpii.qualityInfrastructure.frontEnd.baseMetricsPanel.getWorkableDate(b);var d=new Date(b);return d.setDate(-c),gpii.qualityInfrastructure.frontEnd.baseMetricsPanel.filterEventsData(a,d,b)}}(jQuery,fluid),function(a,b){"use strict";b.defaults("gpii.qualityInfrastructure.frontEnd.commitsMetricsPanel",{gradeNames:["gpii.qualityInfrastructure.frontEnd.baseMetricsPanel"],resources:{template:{resourceText:'<div class="gpiic-metricsPanel-summary"><h2>Loading Commits Metrics...</h2></div><div class="gpiic-metricsPanel-graph"><h3>Number of Commits</h3></div>'}},components:{summary:{type:"gpii.qualityInfrastructure.frontEnd.commitsSummaryPanel",container:"{commitsMetricsPanel}.dom.summary",createOnEvent:"{commitsMetricsPanel}.events.onServiceResponseReady",options:{model:{timeOfLastCommit:"{commitsMetricsPanel}.model.summary.timeOfLastCommit",mostFrequentCommitterTotalCommits:"{commitsMetricsPanel}.model.summary.mostFrequentCommitterTotalCommits",mostFrequentCommitter:"{commitsMetricsPanel}.model.summary.mostFrequentCommitter",totalCommits:"{commitsMetricsPanel}.model.summary.totalCommits"}}},graph:{options:{model:{svgTitle:"Commits line chart",svgDescription:"A line chart showing statistics for commits"}}}}})}(jQuery,fluid),function(a,b){"use strict";b.defaults("gpii.qualityInfrastructure.frontEnd.commitsSummaryPanel",{gradeNames:["floe.chartAuthoring.templateInjection","floe.chartAuthoring.valueBinding"],selectors:{lastCommitDaysAgo:".gpiic-commitsSummary-lastCommitDaysAgo",mostFrequentCommitterTotalCommits:".gpiic-commitsSummary-mostFrequentCommitterTotalCommits",mostFrequentCommitter:".gpiic-commitsSummary-mostFrequentCommitter",totalCommits:".gpiic-commitsSummary-totalCommits"},model:{},bindings:{lastCommitDaysAgo:"lastCommitDaysAgo",mostFrequentCommitterTotalCommits:"mostFrequentCommitterTotalCommits",mostFrequentCommitter:"mostFrequentCommitter",totalCommits:"totalCommits"},modelRelay:[{source:"{that}.model.timeOfLastCommit",target:"{that}.model.lastCommitDaysAgo",singleTransform:{type:"fluid.transforms.free",args:["{that}.model.timeOfLastCommit"],func:"gpii.qualityInfrastructure.frontEnd.commitsSummaryPanel.getDaysAgo"}}],resources:{template:{resourceText:'<h2>Commits</h2><p>Last commit made <span class="gpiic-commitsSummary-lastCommitDaysAgo"></span>.</p><p><span class="gpiic-commitsSummary-mostFrequentCommitterTotalCommits"></span> commits made by <span class="gpiic-commitsSummary-mostFrequentCommitter"></span>.</p><p>Total commits: <span class="gpiic-commitsSummary-totalCommits"></span></p>'}}}),gpii.qualityInfrastructure.frontEnd.commitsSummaryPanel.getDaysAgo=function(a){a="function"==typeof a.getMonth?a:Date.parse(a);var b=new Date,c=gpii.qualityInfrastructure.frontEnd.commitsSummaryPanel.getDaysBetween(a,b);return 0===c?"today":c+" days ago"},gpii.qualityInfrastructure.frontEnd.commitsSummaryPanel.getDaysBetween=function(a,b){var c=b-a,d=gpii.qualityInfrastructure.frontEnd.commitsSummaryPanel.millisecondsToDays(c);return d},gpii.qualityInfrastructure.frontEnd.commitsSummaryPanel.millisecondsToDays=function(a){var b=Math.round(a/1e3/60/60/24);return b}}(jQuery,fluid),function(a,b){"use strict";b.defaults("gpii.qualityInfrastructure.frontEnd.contributorsMetricsPanel.graph",{gradeNames:["floe.chartAuthoring.lineChart.timeSeriesSingleDataSet","floe.chartAuthoring.lineChart.timeSeries.area"],model:{svgTitle:"Contributors line chart",svgDescription:"A line chart showing statistics for contributors"}}),b.defaults("gpii.qualityInfrastructure.frontEnd.contributorsMetricsPanel",{gradeNames:["gpii.qualityInfrastructure.frontEnd.baseMetricsPanel"],resources:{template:{resourceText:'<div class="gpiic-metricsPanel-summary"><h2>Loading Contributors Metrics...</h2></div><div class="gpiic-metricsPanel-graph"><h3>Amount of Contribution</h3></div>'}},components:{summary:{type:"gpii.qualityInfrastructure.frontEnd.contributorsSummaryPanel",container:"{contributorsMetricsPanel}.dom.summary",createOnEvent:"{contributorsMetricsPanel}.events.onServiceResponseReady",
options:{model:{numberOfContributors:"{contributorsMetricsPanel}.model.summary.numberOfContributors"}}},graph:{type:"gpii.qualityInfrastructure.frontEnd.contributorsMetricsPanel.graph",options:{lineOptions:{interpolation:"cardinal"}}}}})}(jQuery,fluid),function(a,b){"use strict";b.defaults("gpii.qualityInfrastructure.frontEnd.contributorsSummaryPanel",{gradeNames:["floe.chartAuthoring.templateInjection","floe.chartAuthoring.valueBinding"],selectors:{numberOfContributors:".gpiic-commitsSummary-numberOfContributors"},model:{},bindings:{numberOfContributors:"numberOfContributors"},resources:{template:{resourceText:'<h2>Contributors</h2><p><span class="gpiic-commitsSummary-numberOfContributors"></span> People have contributed.</p>'}}})}(jQuery,fluid),function(a,b){"use strict";b.registerNamespace("gpii.qualityInfrastructure.frontEnd"),gpii.qualityInfrastructure.frontEnd.qualityInfrastructureSettings={host:"http://qi-backend.gpii.net",apiVersion:"a",endpointSuffix:""},gpii.qualityInfrastructure.frontEnd.getEndpointURL=function(a,b,c,d,e){return b+"/"+c+"/"+d+"/"+a+e},gpii.qualityInfrastructure.frontEnd.createPanel=function(a,b,c,d){var e=gpii.qualityInfrastructure.frontEnd.qualityInfrastructureSettings.host,f=gpii.qualityInfrastructure.frontEnd.qualityInfrastructureSettings.apiVersion,g=gpii.qualityInfrastructure.frontEnd.qualityInfrastructureSettings.endpointSuffix,h=gpii.qualityInfrastructure.frontEnd.getEndpointURL(c,e,f,a,g);return d(b,{components:{jsonpLoader:{options:{jsonpOptions:{url:h}}}}})},gpii.qualityInfrastructure.frontEnd.createCommitsPanel=function(a,b){return gpii.qualityInfrastructure.frontEnd.createPanel(a,b,"commits",gpii.qualityInfrastructure.frontEnd.commitsMetricsPanel)},gpii.qualityInfrastructure.frontEnd.createContributorsPanel=function(a,b){return gpii.qualityInfrastructure.frontEnd.createPanel(a,b,"contributors",gpii.qualityInfrastructure.frontEnd.contributorsMetricsPanel)}}(jQuery,fluid),function(a,b){"use strict";b.defaults("gpii.qualityInfrastructure.frontEnd.jsonp",{gradeNames:["fluid.modelComponent"],jsonpOptions:{url:"",callbackParameter:"callback",allowCache:!0},listeners:{"onCreate.loadJSONP":{func:"{that}.loadJSONP"}},invokers:{loadJSONP:{funcName:"gpii.qualityInfrastructure.frontEnd.jsonp.loadJSONP",args:["{that}"]}},events:{onJSONPLoaded:null},model:{}}),gpii.qualityInfrastructure.frontEnd.jsonp.storeResult=function(a,b){a.applier.change("jsonpData",b),a.events.onJSONPLoaded.fire()},gpii.qualityInfrastructure.frontEnd.jsonp.loadJSONP=function(b){var c=b.options.jsonpOptions.url,d=b.options.jsonpOptions.callbackParameter,e=b.options.jsonpOptions.allowCache;gpii.qualityInfrastructure.frontEnd.jsonp.storeResultStatic=function(a){gpii.qualityInfrastructure.frontEnd.jsonp.storeResult(b,a)},a.ajax({url:c,dataType:"jsonp",jsonp:d,cache:e,success:function(a){gpii.qualityInfrastructure.frontEnd.jsonp.storeResult(b,a)}})}}(jQuery,fluid);